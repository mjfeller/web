<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>applied Martti Kühne&#39;s dmenu monitor patch https://gist.github.com/mar77i/3349298/raw/f6581ca96627f4c71c0bd1faf531daaf2a613b95/monarg.patch becomes upstream now - dmenu - dynamic menu
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="dmenu Atom Feed" href="../atom.xml" />
<link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="/logo.png" alt="" width="32" height="32" /></a></td><td><h1>dmenu</h1><span class="desc">dynamic menu
</span></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/13f787306f46a5f838987e3b546d85d1bb1c3c01.html">13f787306f46a5f838987e3b546d85d1bb1c3c01</a>
<b>parent</b> <a href="../commit/597d4b43379433a5bf86d490f747c0eeda38bba8.html">597d4b43379433a5bf86d490f747c0eeda38bba8</a>
<b>Author:</b> Anselm R Garbe &lt;<a href="mailto:anselm@garbe.us">anselm@garbe.us</a>&gt;
<b>Date:</b>   Fri,  2 Aug 2013 22:30:20 +0200

applied Martti Kühne&#39;s dmenu monitor patch
https://gist.github.com/mar77i/3349298/raw/f6581ca96627f4c71c0bd1faf531daaf2a613b95/monarg.patch becomes upstream now

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">LICENSE</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">dmenu.1</a></td><td> | </td><td class="num">5</td><td><span class="i">+++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">dmenu.c</a></td><td> | </td><td class="num">11</td><td><span class="i">++++++++</span><span class="d">---</span></td></tr>
</table></pre><pre>3 files changed, 14 insertions(+), 4 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/LICENSE.html">LICENSE</a> b/<a href="../file/LICENSE.html">LICENSE</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -1,7 +1,7 @@
</a> MIT/X Consortium License
 
<a href="#h0-0-2" id="h0-0-2" class="i">+© 2006-2013 Anselm R Garbe &lt;anselm@garbe.us&gt;
</a> © 2010-2012 Connor Lane Smith &lt;cls@lubutu.com&gt;
<a href="#h0-0-4" id="h0-0-4" class="d">-© 2006-2012 Anselm R Garbe &lt;anselm@garbe.us&gt;
</a> © 2009 Gottox &lt;gottox@s01.de&gt;
 © 2009 Markus Schnalke &lt;meillo@marmaro.de&gt;
 © 2009 Evan Gates &lt;evan.gates@gmail.com&gt;
<b>diff --git a/<a id="h1" href="../file/dmenu.1.html">dmenu.1</a> b/<a href="../file/dmenu.1.html">dmenu.1</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -7,6 +7,8 @@ dmenu \- dynamic menu
</a> .RB [ \-f ]
 .RB [ \-i ]
 .RB [ \-l
<a href="#h1-0-3" id="h1-0-3" class="i">+.RB [ \-m
</a><a href="#h1-0-4" id="h1-0-4" class="i">+.IR monitor ]
</a> .IR lines ]
 .RB [ \-p
 .IR prompt ]
<a href="#h1-1" id="h1-1" class="h">@@ -49,6 +51,9 @@ dmenu matches menu items case insensitively.
</a> .BI \-l &quot; lines&quot;
 dmenu lists items vertically, with the given number of lines.
 .TP
<a href="#h1-1-3" id="h1-1-3" class="i">+.BI \-m &quot; monitor&quot;
</a><a href="#h1-1-4" id="h1-1-4" class="i">+dmenu is displayed on the monitor supplied.
</a><a href="#h1-1-5" id="h1-1-5" class="i">+.TP
</a> .BI \-p &quot; prompt&quot;
 defines the prompt to be displayed to the left of the input field.
 .TP
<b>diff --git a/<a id="h2" href="../file/dmenu.c.html">dmenu.c</a> b/<a href="../file/dmenu.c.html">dmenu.c</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -54,6 +54,7 @@ static Item *matches, *matchend;
</a> static Item *prev, *curr, *next, *sel;
 static Window win;
 static XIC xic;
<a href="#h2-0-3" id="h2-0-3" class="i">+static int mon = -1;
</a> 
 #include &quot;config.h&quot;
 
<a href="#h2-1" id="h2-1" class="h">@@ -84,6 +85,8 @@ main(int argc, char *argv[]) {
</a> 		/* these options take one argument */
 		else if(!strcmp(argv[i], &quot;-l&quot;))   /* number of lines in vertical list */
 			lines = atoi(argv[++i]);
<a href="#h2-1-3" id="h2-1-3" class="i">+		else if(!strcmp(argv[i], &quot;-m&quot;))
</a><a href="#h2-1-4" id="h2-1-4" class="i">+			mon = atoi(argv[++i]);
</a> 		else if(!strcmp(argv[i], &quot;-p&quot;))   /* adds prompt to left of input field */
 			prompt = argv[++i];
 		else if(!strcmp(argv[i], &quot;-fn&quot;))  /* font or font set */
<a href="#h2-2" id="h2-2" class="h">@@ -557,7 +560,9 @@ setup(void) {
</a> 		XWindowAttributes wa;
 
 		XGetInputFocus(dc-&gt;dpy, &amp;w, &amp;di);
<a href="#h2-2-3" id="h2-2-3" class="d">-		if(w != root &amp;&amp; w != PointerRoot &amp;&amp; w != None) {
</a><a href="#h2-2-4" id="h2-2-4" class="i">+		if(mon != -1 &amp;&amp; mon &lt; n)
</a><a href="#h2-2-5" id="h2-2-5" class="i">+			i = mon;
</a><a href="#h2-2-6" id="h2-2-6" class="i">+		if(!i &amp;&amp; w != root &amp;&amp; w != PointerRoot &amp;&amp; w != None) {
</a> 			/* find top-level window containing current input focus */
 			do {
 				if(XQueryTree(dc-&gt;dpy, (pw = w), &amp;dw, &amp;w, &amp;dws, &amp;du) &amp;&amp; dws)
<a href="#h2-3" id="h2-3" class="h">@@ -572,7 +577,7 @@ setup(void) {
</a> 					}
 		}
 		/* no focused window is on screen, so use pointer location instead */
<a href="#h2-3-3" id="h2-3-3" class="d">-		if(!area &amp;&amp; XQueryPointer(dc-&gt;dpy, root, &amp;dw, &amp;dw, &amp;x, &amp;y, &amp;di, &amp;di, &amp;du))
</a><a href="#h2-3-4" id="h2-3-4" class="i">+		if(mon == -1 &amp;&amp; !area &amp;&amp; XQueryPointer(dc-&gt;dpy, root, &amp;dw, &amp;dw, &amp;x, &amp;y, &amp;di, &amp;di, &amp;du))
</a> 			for(i = 0; i &lt; n; i++)
 				if(INTERSECT(x, y, 1, 1, info[i]))
 					break;
<a href="#h2-4" id="h2-4" class="h">@@ -614,7 +619,7 @@ setup(void) {
</a> 
 void
 usage(void) {
<a href="#h2-4-3" id="h2-4-3" class="d">-	fputs(&quot;usage: dmenu [-b] [-f] [-i] [-l lines] [-p prompt] [-fn font]\n&quot;
</a><a href="#h2-4-4" id="h2-4-4" class="i">+	fputs(&quot;usage: dmenu [-b] [-f] [-i] [-l lines] [-p prompt] [-fn font] [-m monitor]\n&quot;
</a> 	      &quot;             [-nb color] [-nf color] [-sb color] [-sf color] [-v]\n&quot;, stderr);
 	exit(EXIT_FAILURE);
 }
</pre>
</div>
</body>
</html>
