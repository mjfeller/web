<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>FAQ: add entry about color emoji Xft bug - st-light - Unnamed repository; edit this file &#39;description&#39; to name the repository.
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="st-light Atom Feed" href="../atom.xml" />
<link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="/logo.png" alt="" width="32" height="32" /></a></td><td><h1>st-light</h1><span class="desc">Unnamed repository; edit this file &#39;description&#39; to name the repository.
</span></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/caa1d8fbea2b92bca24652af0fee874bdbbbb3e5.html">caa1d8fbea2b92bca24652af0fee874bdbbbb3e5</a>
<b>parent</b> <a href="../commit/f1546cf9c1f9fc52d26dbbcf73210901e83c7ecf.html">f1546cf9c1f9fc52d26dbbcf73210901e83c7ecf</a>
<b>Author:</b> Hiltjo Posthuma &lt;<a href="mailto:hiltjo@codemadness.org">hiltjo@codemadness.org</a>&gt;
<b>Date:</b>   Fri, 17 May 2019 13:00:10 +0200

FAQ: add entry about color emoji Xft bug

This has been asked many times on IRC and the mailinglist. Make it easier to
find information about this particular Xft issue by adding it to the FAQ.

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">FAQ</a></td><td> | </td><td class="num">27</td><td><span class="i">+++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
</table></pre><pre>1 file changed, 27 insertions(+), 0 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/FAQ.html">FAQ</a> b/<a href="../file/FAQ.html">FAQ</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -165,3 +165,30 @@ Apply [1].
</a> 
 [1] http://st.suckless.org/patches/delkey
 
<a href="#h0-0-3" id="h0-0-3" class="i">+## BadLength X error in Xft when trying to render emoji
</a><a href="#h0-0-4" id="h0-0-4" class="i">+
</a><a href="#h0-0-5" id="h0-0-5" class="i">+Xft makes st crash when rendering color emojis with the following error:
</a><a href="#h0-0-6" id="h0-0-6" class="i">+
</a><a href="#h0-0-7" id="h0-0-7" class="i">+&quot;X Error of failed request:  BadLength (poly request too large or internal Xlib length error)&quot;
</a><a href="#h0-0-8" id="h0-0-8" class="i">+  Major opcode of failed request:  139 (RENDER)
</a><a href="#h0-0-9" id="h0-0-9" class="i">+  Minor opcode of failed request:  20 (RenderAddGlyphs)
</a><a href="#h0-0-10" id="h0-0-10" class="i">+  Serial number of failed request: 1595
</a><a href="#h0-0-11" id="h0-0-11" class="i">+  Current serial number in output stream:  1818&quot;
</a><a href="#h0-0-12" id="h0-0-12" class="i">+
</a><a href="#h0-0-13" id="h0-0-13" class="i">+This is a known bug in Xft (not st) which happens on some platforms and
</a><a href="#h0-0-14" id="h0-0-14" class="i">+combination of particular fonts and fontconfig settings.
</a><a href="#h0-0-15" id="h0-0-15" class="i">+
</a><a href="#h0-0-16" id="h0-0-16" class="i">+See also:
</a><a href="#h0-0-17" id="h0-0-17" class="i">+https://gitlab.freedesktop.org/xorg/lib/libxft/issues/6
</a><a href="#h0-0-18" id="h0-0-18" class="i">+https://bugs.freedesktop.org/show_bug.cgi?id=107534
</a><a href="#h0-0-19" id="h0-0-19" class="i">+https://bugzilla.redhat.com/show_bug.cgi?id=1498269
</a><a href="#h0-0-20" id="h0-0-20" class="i">+
</a><a href="#h0-0-21" id="h0-0-21" class="i">+The solution is to remove color emoji fonts or disable this in the fontconfig
</a><a href="#h0-0-22" id="h0-0-22" class="i">+XML configuration.  As an ugly workaround (which may work only on newer
</a><a href="#h0-0-23" id="h0-0-23" class="i">+fontconfig versions (FC_COLOR)), the following code can be used to mask color
</a><a href="#h0-0-24" id="h0-0-24" class="i">+fonts:
</a><a href="#h0-0-25" id="h0-0-25" class="i">+
</a><a href="#h0-0-26" id="h0-0-26" class="i">+	FcPatternAddBool(fcpattern, FC_COLOR, FcFalse);
</a><a href="#h0-0-27" id="h0-0-27" class="i">+
</a><a href="#h0-0-28" id="h0-0-28" class="i">+Please don&#39;t bother reporting this bug to st, but notify the upstream Xft
</a><a href="#h0-0-29" id="h0-0-29" class="i">+developers about fixing this bug.
</a></pre>
</div>
</body>
</html>
