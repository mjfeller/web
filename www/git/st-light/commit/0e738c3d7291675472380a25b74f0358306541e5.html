<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Style inquisition. - st-light - Unnamed repository; edit this file &#39;description&#39; to name the repository.
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="st-light Atom Feed" href="../atom.xml" />
<link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="/logo.png" alt="" width="32" height="32" /></a></td><td><h1>st-light</h1><span class="desc">Unnamed repository; edit this file &#39;description&#39; to name the repository.
</span></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/0e738c3d7291675472380a25b74f0358306541e5.html">0e738c3d7291675472380a25b74f0358306541e5</a>
<b>parent</b> <a href="../commit/7f297e297ccec99a66b7af46e2b1725545ba3746.html">7f297e297ccec99a66b7af46e2b1725545ba3746</a>
<b>Author:</b> Christoph Lohmann &lt;<a href="mailto:20h@r-36.net">20h@r-36.net</a>&gt;
<b>Date:</b>   Tue, 19 Feb 2013 16:04:54 +0100

Style inquisition.

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">st.c</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++++++++</span><span class="d">----------------------</span></td></tr>
</table></pre><pre>1 file changed, 22 insertions(+), 22 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/st.c.html">st.c</a> b/<a href="../file/st.c.html">st.c</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -1662,7 +1662,7 @@ csihandle(void) {
</a> 		tmoveto(0, term.c.y-csiescseq.arg[0]);
 		break;
 	case &#39;g&#39;: /* TBC -- Tabulation clear */
<a href="#h0-0-3" id="h0-0-3" class="d">-		switch (csiescseq.arg[0]) {
</a><a href="#h0-0-4" id="h0-0-4" class="i">+		switch(csiescseq.arg[0]) {
</a> 		case 0: /* clear current tab stop */
 			term.tabs[term.c.x] = 0;
 			break;
<a href="#h0-1" id="h0-1" class="h">@@ -1927,7 +1927,7 @@ techo(char *buf, int len) {
</a> 		if(c == &#39;\033&#39;) {		/* escape */
 			tputc(&quot;^&quot;, 1);
 			tputc(&quot;[&quot;, 1);
<a href="#h0-1-3" id="h0-1-3" class="d">-		} else if (c &lt; &#39;\x20&#39;) {	/* control code */
</a><a href="#h0-1-4" id="h0-1-4" class="i">+		} else if(c &lt; &#39;\x20&#39;) {	/* control code */
</a> 			if(c != &#39;\n&#39; &amp;&amp; c != &#39;\r&#39; &amp;&amp; c != &#39;\t&#39;) {
 				c |= &#39;\x40&#39;;
 				tputc(&quot;^&quot;, 1);
<a href="#h0-2" id="h0-2" class="h">@@ -1937,7 +1937,7 @@ techo(char *buf, int len) {
</a> 			break;
 		}
 	}
<a href="#h0-2-3" id="h0-2-3" class="d">-	if (len)
</a><a href="#h0-2-4" id="h0-2-4" class="i">+	if(len)
</a> 		tputc(buf, len);
 }
 
<a href="#h0-3" id="h0-3" class="h">@@ -1947,7 +1947,7 @@ tputc(char *c, int len) {
</a> 	bool control = ascii &lt; &#39;\x20&#39; || ascii == 0177;
 
 	if(iofd != -1) {
<a href="#h0-3-3" id="h0-3-3" class="d">-		if (xwrite(iofd, c, len) &lt; 0) {
</a><a href="#h0-3-4" id="h0-3-4" class="i">+		if(xwrite(iofd, c, len) &lt; 0) {
</a> 			fprintf(stderr, &quot;Error writing in %s:%s\n&quot;,
 				opt_io, strerror(errno));
 			close(iofd);
<a href="#h0-4" id="h0-4" class="h">@@ -2471,8 +2471,8 @@ xunloadfonts(void) {
</a> 	 * Free the loaded fonts in the font cache. This is done backwards
 	 * from the frccur.
 	 */
<a href="#h0-4-3" id="h0-4-3" class="d">-	for (i = 0, ip = frccur; i &lt; frclen; i++, ip--) {
</a><a href="#h0-4-4" id="h0-4-4" class="d">-		if (ip &lt; 0)
</a><a href="#h0-4-5" id="h0-4-5" class="i">+	for(i = 0, ip = frccur; i &lt; frclen; i++, ip--) {
</a><a href="#h0-4-6" id="h0-4-6" class="i">+		if(ip &lt; 0)
</a> 			ip = LEN(frc) - 1;
 		XftFontClose(xw.dpy, frc[ip].font);
 	}
<a href="#h0-5" id="h0-5" class="h">@@ -2515,7 +2515,7 @@ xinit(void) {
</a> 	xw.vis = XDefaultVisual(xw.dpy, xw.scr);
 
 	/* font */
<a href="#h0-5-3" id="h0-5-3" class="d">-	if (!FcInit())
</a><a href="#h0-5-4" id="h0-5-4" class="i">+	if(!FcInit())
</a> 		die(&quot;Could not init fontconfig.\n&quot;);
 
 	usedfont = (opt_font == NULL)? font : opt_font;
<a href="#h0-6" id="h0-6" class="h">@@ -2718,7 +2718,7 @@ xdraws(char *s, Glyph base, int x, int y, int charlen, int bytelen) {
</a> 	XftDrawRect(xw.draw, bg, winx, winy, width, xw.ch);
 
 	fcsets[0] = font-&gt;set;
<a href="#h0-6-3" id="h0-6-3" class="d">-	for (xp = winx; bytelen &gt; 0;) {
</a><a href="#h0-6-4" id="h0-6-4" class="i">+	for(xp = winx; bytelen &gt; 0;) {
</a> 		/*
 		 * Search for the range in the to be printed string of glyphs
 		 * that are in the main font. Then print that range. If
<a href="#h0-7" id="h0-7" class="h">@@ -2728,22 +2728,22 @@ xdraws(char *s, Glyph base, int x, int y, int charlen, int bytelen) {
</a> 		u8fs = s;
 		u8fblen = 0;
 		u8fl = 0;
<a href="#h0-7-3" id="h0-7-3" class="d">-		for (;;) {
</a><a href="#h0-7-4" id="h0-7-4" class="i">+		for(;;) {
</a> 			u8c = s;
 			u8cblen = utf8decode(s, &amp;u8char);
 			s += u8cblen;
 			bytelen -= u8cblen;
 
 			doesexist = XftCharIndex(xw.dpy, font-&gt;match, u8char);
<a href="#h0-7-11" id="h0-7-11" class="d">-			if (!doesexist || bytelen &lt;= 0) {
</a><a href="#h0-7-12" id="h0-7-12" class="d">-				if (bytelen &lt;= 0) {
</a><a href="#h0-7-13" id="h0-7-13" class="d">-					if (doesexist) {
</a><a href="#h0-7-14" id="h0-7-14" class="i">+			if(!doesexist || bytelen &lt;= 0) {
</a><a href="#h0-7-15" id="h0-7-15" class="i">+				if(bytelen &lt;= 0) {
</a><a href="#h0-7-16" id="h0-7-16" class="i">+					if(doesexist) {
</a> 						u8fl++;
 						u8fblen += u8cblen;
 					}
 				}
 
<a href="#h0-7-22" id="h0-7-22" class="d">-				if (u8fl &gt; 0) {
</a><a href="#h0-7-23" id="h0-7-23" class="i">+				if(u8fl &gt; 0) {
</a> 					XftDrawStringUtf8(xw.draw, fg,
 							font-&gt;match, xp,
 							winy + font-&gt;ascent,
<a href="#h0-8" id="h0-8" class="h">@@ -2757,23 +2757,23 @@ xdraws(char *s, Glyph base, int x, int y, int charlen, int bytelen) {
</a> 			u8fl++;
 			u8fblen += u8cblen;
 		}
<a href="#h0-8-3" id="h0-8-3" class="d">-		if (doesexist)
</a><a href="#h0-8-4" id="h0-8-4" class="i">+		if(doesexist)
</a> 			break;
 
 		frp = frccur;
 		/* Search the font cache. */
<a href="#h0-8-9" id="h0-8-9" class="d">-		for (i = 0; i &lt; frclen; i++, frp--) {
</a><a href="#h0-8-10" id="h0-8-10" class="d">-			if (frp &lt;= 0)
</a><a href="#h0-8-11" id="h0-8-11" class="i">+		for(i = 0; i &lt; frclen; i++, frp--) {
</a><a href="#h0-8-12" id="h0-8-12" class="i">+			if(frp &lt;= 0)
</a> 				frp = LEN(frc) - 1;
 
<a href="#h0-8-15" id="h0-8-15" class="d">-			if (frc[frp].c == u8char
</a><a href="#h0-8-16" id="h0-8-16" class="i">+			if(frc[frp].c == u8char
</a> 					&amp;&amp; frc[frp].flags == frcflags) {
 				break;
 			}
 		}
 
 		/* Nothing was found. */
<a href="#h0-8-23" id="h0-8-23" class="d">-		if (i &gt;= frclen) {
</a><a href="#h0-8-24" id="h0-8-24" class="i">+		if(i &gt;= frclen) {
</a> 			/*
 			 * Nothing was found in the cache. Now use
 			 * some dozen of Fontconfig calls to get the
<a href="#h0-9" id="h0-9" class="h">@@ -2801,9 +2801,9 @@ xdraws(char *s, Glyph base, int x, int y, int charlen, int bytelen) {
</a> 			 */
 			frccur++;
 			frclen++;
<a href="#h0-9-3" id="h0-9-3" class="d">-			if (frccur &gt;= LEN(frc))
</a><a href="#h0-9-4" id="h0-9-4" class="i">+			if(frccur &gt;= LEN(frc))
</a> 				frccur = 0;
<a href="#h0-9-6" id="h0-9-6" class="d">-			if (frclen &gt; LEN(frc)) {
</a><a href="#h0-9-7" id="h0-9-7" class="i">+			if(frclen &gt; LEN(frc)) {
</a> 				frclen = LEN(frc);
 				XftFontClose(xw.dpy, frc[frccur].font);
 			}
<a href="#h0-10" id="h0-10" class="h">@@ -3085,7 +3085,7 @@ kpress(XEvent *ev) {
</a> 	Status status;
 	Shortcut *bp;
 
<a href="#h0-10-3" id="h0-10-3" class="d">-	if (IS_SET(MODE_KBDLOCK))
</a><a href="#h0-10-4" id="h0-10-4" class="i">+	if(IS_SET(MODE_KBDLOCK))
</a> 		return;
 
 	len = XmbLookupString(xw.xic, e, xstr, sizeof(xstr), &amp;ksym, &amp;status);
<a href="#h0-11" id="h0-11" class="h">@@ -3107,7 +3107,7 @@ kpress(XEvent *ev) {
</a> 		if(len == 0)
 			return;
 
<a href="#h0-11-3" id="h0-11-3" class="d">-		if (len == 1 &amp;&amp; e-&gt;state &amp; Mod1Mask)
</a><a href="#h0-11-4" id="h0-11-4" class="i">+		if(len == 1 &amp;&amp; e-&gt;state &amp; Mod1Mask)
</a> 			*cp++ = &#39;\033&#39;;
 
 		memcpy(cp, xstr, len);
</pre>
</div>
</body>
</html>
