<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Use BSD-style function notation - st-light - Unnamed repository; edit this file &#39;description&#39; to name the repository.
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="st-light Atom Feed" href="../atom.xml" />
<link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="/logo.png" alt="" width="32" height="32" /></a></td><td><h1>st-light</h1><span class="desc">Unnamed repository; edit this file &#39;description&#39; to name the repository.
</span></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/13233574ed1ead29bb7e99e71a0665e62c640617.html">13233574ed1ead29bb7e99e71a0665e62c640617</a>
<b>parent</b> <a href="../commit/9de853a98da8fe0f458b244970f0e0d3e9b38a50.html">9de853a98da8fe0f458b244970f0e0d3e9b38a50</a>
<b>Author:</b> FRIGN &lt;<a href="mailto:dev@frign.de">dev@frign.de</a>&gt;
<b>Date:</b>   Thu,  9 Jul 2015 23:59:50 +0200

Use BSD-style function notation

Put the opening brace on a new line. This was already used for some
functions inside st.c.

Signed-off-by: Christoph Lohmann &lt;20h@r-36.net&gt;

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">st.c</a></td><td> | </td><td class="num">385</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------</span></td></tr>
</table></pre><pre>1 file changed, 256 insertions(+), 129 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/st.c.html">st.c</a> b/<a href="../file/st.c.html">st.c</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -550,7 +550,8 @@ static Fontcache frc[16];
</a> static int frclen = 0;
 
 ssize_t
<a href="#h0-0-3" id="h0-0-3" class="d">-xwrite(int fd, const char *s, size_t len) {
</a><a href="#h0-0-4" id="h0-0-4" class="i">+xwrite(int fd, const char *s, size_t len)
</a><a href="#h0-0-5" id="h0-0-5" class="i">+{
</a> 	size_t aux = len;
 
 	while(len &gt; 0) {
<a href="#h0-1" id="h0-1" class="h">@@ -564,7 +565,8 @@ xwrite(int fd, const char *s, size_t len) {
</a> }
 
 void *
<a href="#h0-1-3" id="h0-1-3" class="d">-xmalloc(size_t len) {
</a><a href="#h0-1-4" id="h0-1-4" class="i">+xmalloc(size_t len)
</a><a href="#h0-1-5" id="h0-1-5" class="i">+{
</a> 	void *p = malloc(len);
 
 	if(!p)
<a href="#h0-2" id="h0-2" class="h">@@ -574,7 +576,8 @@ xmalloc(size_t len) {
</a> }
 
 void *
<a href="#h0-2-3" id="h0-2-3" class="d">-xrealloc(void *p, size_t len) {
</a><a href="#h0-2-4" id="h0-2-4" class="i">+xrealloc(void *p, size_t len)
</a><a href="#h0-2-5" id="h0-2-5" class="i">+{
</a> 	if((p = realloc(p, len)) == NULL)
 		die(&quot;Out of memory\n&quot;);
 
<a href="#h0-3" id="h0-3" class="h">@@ -582,7 +585,8 @@ xrealloc(void *p, size_t len) {
</a> }
 
 char *
<a href="#h0-3-3" id="h0-3-3" class="d">-xstrdup(char *s) {
</a><a href="#h0-3-4" id="h0-3-4" class="i">+xstrdup(char *s)
</a><a href="#h0-3-5" id="h0-3-5" class="i">+{
</a> 	if((s = strdup(s)) == NULL)
 		die(&quot;Out of memory\n&quot;);
 
<a href="#h0-4" id="h0-4" class="h">@@ -590,7 +594,8 @@ xstrdup(char *s) {
</a> }
 
 size_t
<a href="#h0-4-3" id="h0-4-3" class="d">-utf8decode(char *c, Rune *u, size_t clen) {
</a><a href="#h0-4-4" id="h0-4-4" class="i">+utf8decode(char *c, Rune *u, size_t clen)
</a><a href="#h0-4-5" id="h0-4-5" class="i">+{
</a> 	size_t i, j, len, type;
 	Rune udecoded;
 
<a href="#h0-5" id="h0-5" class="h">@@ -613,7 +618,8 @@ utf8decode(char *c, Rune *u, size_t clen) {
</a> }
 
 Rune
<a href="#h0-5-3" id="h0-5-3" class="d">-utf8decodebyte(char c, size_t *i) {
</a><a href="#h0-5-4" id="h0-5-4" class="i">+utf8decodebyte(char c, size_t *i)
</a><a href="#h0-5-5" id="h0-5-5" class="i">+{
</a> 	for(*i = 0; *i &lt; LEN(utfmask); ++(*i))
 		if(((uchar)c &amp; utfmask[*i]) == utfbyte[*i])
 			return (uchar)c &amp; ~utfmask[*i];
<a href="#h0-6" id="h0-6" class="h">@@ -621,7 +627,8 @@ utf8decodebyte(char c, size_t *i) {
</a> }
 
 size_t
<a href="#h0-6-3" id="h0-6-3" class="d">-utf8encode(Rune u, char *c) {
</a><a href="#h0-6-4" id="h0-6-4" class="i">+utf8encode(Rune u, char *c)
</a><a href="#h0-6-5" id="h0-6-5" class="i">+{
</a> 	size_t len, i;
 
 	len = utf8validate(&amp;u, 0);
<a href="#h0-7" id="h0-7" class="h">@@ -636,12 +643,14 @@ utf8encode(Rune u, char *c) {
</a> }
 
 char
<a href="#h0-7-3" id="h0-7-3" class="d">-utf8encodebyte(Rune u, size_t i) {
</a><a href="#h0-7-4" id="h0-7-4" class="i">+utf8encodebyte(Rune u, size_t i)
</a><a href="#h0-7-5" id="h0-7-5" class="i">+{
</a> 	return utfbyte[i] | (u &amp; ~utfmask[i]);
 }
 
 char *
<a href="#h0-7-10" id="h0-7-10" class="d">-utf8strchr(char *s, Rune u) {
</a><a href="#h0-7-11" id="h0-7-11" class="i">+utf8strchr(char *s, Rune u)
</a><a href="#h0-7-12" id="h0-7-12" class="i">+{
</a> 	Rune r;
 	size_t i, j, len;
 
<a href="#h0-8" id="h0-8" class="h">@@ -656,7 +665,8 @@ utf8strchr(char *s, Rune u) {
</a> }
 
 size_t
<a href="#h0-8-3" id="h0-8-3" class="d">-utf8validate(Rune *u, size_t i) {
</a><a href="#h0-8-4" id="h0-8-4" class="i">+utf8validate(Rune *u, size_t i)
</a><a href="#h0-8-5" id="h0-8-5" class="i">+{
</a> 	if(!BETWEEN(*u, utfmin[i], utfmax[i]) || BETWEEN(*u, 0xD800, 0xDFFF))
 		*u = UTF_INVALID;
 	for(i = 1; *u &gt; utfmax[i]; ++i)
<a href="#h0-9" id="h0-9" class="h">@@ -665,7 +675,8 @@ utf8validate(Rune *u, size_t i) {
</a> }
 
 void
<a href="#h0-9-3" id="h0-9-3" class="d">-selinit(void) {
</a><a href="#h0-9-4" id="h0-9-4" class="i">+selinit(void)
</a><a href="#h0-9-5" id="h0-9-5" class="i">+{
</a> 	memset(&amp;sel.tclick1, 0, sizeof(sel.tclick1));
 	memset(&amp;sel.tclick2, 0, sizeof(sel.tclick2));
 	sel.mode = SEL_IDLE;
<a href="#h0-10" id="h0-10" class="h">@@ -678,7 +689,8 @@ selinit(void) {
</a> }
 
 int
<a href="#h0-10-3" id="h0-10-3" class="d">-x2col(int x) {
</a><a href="#h0-10-4" id="h0-10-4" class="i">+x2col(int x)
</a><a href="#h0-10-5" id="h0-10-5" class="i">+{
</a> 	x -= borderpx;
 	x /= xw.cw;
 
<a href="#h0-11" id="h0-11" class="h">@@ -686,7 +698,8 @@ x2col(int x) {
</a> }
 
 int
<a href="#h0-11-3" id="h0-11-3" class="d">-y2row(int y) {
</a><a href="#h0-11-4" id="h0-11-4" class="i">+y2row(int y)
</a><a href="#h0-11-5" id="h0-11-5" class="i">+{
</a> 	y -= borderpx;
 	y /= xw.ch;
 
<a href="#h0-12" id="h0-12" class="h">@@ -694,7 +707,8 @@ y2row(int y) {
</a> }
 
 int
<a href="#h0-12-3" id="h0-12-3" class="d">-tlinelen(int y) {
</a><a href="#h0-12-4" id="h0-12-4" class="i">+tlinelen(int y)
</a><a href="#h0-12-5" id="h0-12-5" class="i">+{
</a> 	int i = term.col;
 
 	if(term.line[y][i - 1].mode &amp; ATTR_WRAP)
<a href="#h0-13" id="h0-13" class="h">@@ -707,7 +721,8 @@ tlinelen(int y) {
</a> }
 
 void
<a href="#h0-13-3" id="h0-13-3" class="d">-selnormalize(void) {
</a><a href="#h0-13-4" id="h0-13-4" class="i">+selnormalize(void)
</a><a href="#h0-13-5" id="h0-13-5" class="i">+{
</a> 	int i;
 
 	if(sel.type == SEL_REGULAR &amp;&amp; sel.ob.y != sel.oe.y) {
<a href="#h0-14" id="h0-14" class="h">@@ -734,7 +749,8 @@ selnormalize(void) {
</a> }
 
 int
<a href="#h0-14-3" id="h0-14-3" class="d">-selected(int x, int y) {
</a><a href="#h0-14-4" id="h0-14-4" class="i">+selected(int x, int y)
</a><a href="#h0-14-5" id="h0-14-5" class="i">+{
</a> 	if(sel.mode == SEL_EMPTY)
 		return 0;
 
<a href="#h0-15" id="h0-15" class="h">@@ -748,7 +764,8 @@ selected(int x, int y) {
</a> }
 
 void
<a href="#h0-15-3" id="h0-15-3" class="d">-selsnap(int *x, int *y, int direction) {
</a><a href="#h0-15-4" id="h0-15-4" class="i">+selsnap(int *x, int *y, int direction)
</a><a href="#h0-15-5" id="h0-15-5" class="i">+{
</a> 	int newx, newy, xt, yt;
 	int delim, prevdelim;
 	Glyph *gp, *prevgp;
<a href="#h0-16" id="h0-16" class="h">@@ -820,7 +837,8 @@ selsnap(int *x, int *y, int direction) {
</a> }
 
 void
<a href="#h0-16-3" id="h0-16-3" class="d">-getbuttoninfo(XEvent *e) {
</a><a href="#h0-16-4" id="h0-16-4" class="i">+getbuttoninfo(XEvent *e)
</a><a href="#h0-16-5" id="h0-16-5" class="i">+{
</a> 	int type;
 	uint state = e-&gt;xbutton.state &amp; ~(Button1Mask | forceselmod);
 
<a href="#h0-17" id="h0-17" class="h">@@ -840,7 +858,8 @@ getbuttoninfo(XEvent *e) {
</a> }
 
 void
<a href="#h0-17-3" id="h0-17-3" class="d">-mousereport(XEvent *e) {
</a><a href="#h0-17-4" id="h0-17-4" class="i">+mousereport(XEvent *e)
</a><a href="#h0-17-5" id="h0-17-5" class="i">+{
</a> 	int x = x2col(e-&gt;xbutton.x), y = y2row(e-&gt;xbutton.y),
 	    button = e-&gt;xbutton.button, state = e-&gt;xbutton.state,
 	    len;
<a href="#h0-18" id="h0-18" class="h">@@ -903,7 +922,8 @@ mousereport(XEvent *e) {
</a> }
 
 void
<a href="#h0-18-3" id="h0-18-3" class="d">-bpress(XEvent *e) {
</a><a href="#h0-18-4" id="h0-18-4" class="i">+bpress(XEvent *e)
</a><a href="#h0-18-5" id="h0-18-5" class="i">+{
</a> 	struct timespec now;
 	Mousekey *mk;
 
<a href="#h0-19" id="h0-19" class="h">@@ -952,7 +972,8 @@ bpress(XEvent *e) {
</a> }
 
 char *
<a href="#h0-19-3" id="h0-19-3" class="d">-getsel(void) {
</a><a href="#h0-19-4" id="h0-19-4" class="i">+getsel(void)
</a><a href="#h0-19-5" id="h0-19-5" class="i">+{
</a> 	char *str, *ptr;
 	int y, bufsize, lastx, linelen;
 	Glyph *gp, *last;
<a href="#h0-20" id="h0-20" class="h">@@ -1002,12 +1023,14 @@ getsel(void) {
</a> }
 
 void
<a href="#h0-20-3" id="h0-20-3" class="d">-selcopy(Time t) {
</a><a href="#h0-20-4" id="h0-20-4" class="i">+selcopy(Time t)
</a><a href="#h0-20-5" id="h0-20-5" class="i">+{
</a> 	xsetsel(getsel(), t);
 }
 
 void
<a href="#h0-20-10" id="h0-20-10" class="d">-selnotify(XEvent *e) {
</a><a href="#h0-20-11" id="h0-20-11" class="i">+selnotify(XEvent *e)
</a><a href="#h0-20-12" id="h0-20-12" class="i">+{
</a> 	ulong nitems, ofs, rem;
 	int format;
 	uchar *data, *last, *repl;
<a href="#h0-21" id="h0-21" class="h">@@ -1052,13 +1075,15 @@ selnotify(XEvent *e) {
</a> }
 
 void
<a href="#h0-21-3" id="h0-21-3" class="d">-selpaste(const Arg *dummy) {
</a><a href="#h0-21-4" id="h0-21-4" class="i">+selpaste(const Arg *dummy)
</a><a href="#h0-21-5" id="h0-21-5" class="i">+{
</a> 	XConvertSelection(xw.dpy, XA_PRIMARY, sel.xtarget, XA_PRIMARY,
 			xw.win, CurrentTime);
 }
 
 void
<a href="#h0-21-11" id="h0-21-11" class="d">-clipcopy(const Arg *dummy) {
</a><a href="#h0-21-12" id="h0-21-12" class="i">+clipcopy(const Arg *dummy)
</a><a href="#h0-21-13" id="h0-21-13" class="i">+{
</a> 	Atom clipboard;
 
 	if(sel.clipboard != NULL)
<a href="#h0-22" id="h0-22" class="h">@@ -1072,7 +1097,8 @@ clipcopy(const Arg *dummy) {
</a> }
 
 void
<a href="#h0-22-3" id="h0-22-3" class="d">-clippaste(const Arg *dummy) {
</a><a href="#h0-22-4" id="h0-22-4" class="i">+clippaste(const Arg *dummy)
</a><a href="#h0-22-5" id="h0-22-5" class="i">+{
</a> 	Atom clipboard;
 
 	clipboard = XInternAtom(xw.dpy, &quot;CLIPBOARD&quot;, 0);
<a href="#h0-23" id="h0-23" class="h">@@ -1081,7 +1107,8 @@ clippaste(const Arg *dummy) {
</a> }
 
 void
<a href="#h0-23-3" id="h0-23-3" class="d">-selclear(XEvent *e) {
</a><a href="#h0-23-4" id="h0-23-4" class="i">+selclear(XEvent *e)
</a><a href="#h0-23-5" id="h0-23-5" class="i">+{
</a> 	if(sel.ob.x == -1)
 		return;
 	sel.mode = SEL_IDLE;
<a href="#h0-24" id="h0-24" class="h">@@ -1090,7 +1117,8 @@ selclear(XEvent *e) {
</a> }
 
 void
<a href="#h0-24-3" id="h0-24-3" class="d">-selrequest(XEvent *e) {
</a><a href="#h0-24-4" id="h0-24-4" class="i">+selrequest(XEvent *e)
</a><a href="#h0-24-5" id="h0-24-5" class="i">+{
</a> 	XSelectionRequestEvent *xsre;
 	XSelectionEvent xev;
 	Atom xa_targets, string, clipboard;
<a href="#h0-25" id="h0-25" class="h">@@ -1147,7 +1175,8 @@ selrequest(XEvent *e) {
</a> }
 
 void
<a href="#h0-25-3" id="h0-25-3" class="d">-xsetsel(char *str, Time t) {
</a><a href="#h0-25-4" id="h0-25-4" class="i">+xsetsel(char *str, Time t)
</a><a href="#h0-25-5" id="h0-25-5" class="i">+{
</a> 	free(sel.primary);
 	sel.primary = str;
 
<a href="#h0-26" id="h0-26" class="h">@@ -1157,7 +1186,8 @@ xsetsel(char *str, Time t) {
</a> }
 
 void
<a href="#h0-26-3" id="h0-26-3" class="d">-brelease(XEvent *e) {
</a><a href="#h0-26-4" id="h0-26-4" class="i">+brelease(XEvent *e)
</a><a href="#h0-26-5" id="h0-26-5" class="i">+{
</a> 	if(IS_SET(MODE_MOUSE) &amp;&amp; !(e-&gt;xbutton.state &amp; forceselmod)) {
 		mousereport(e);
 		return;
<a href="#h0-27" id="h0-27" class="h">@@ -1177,7 +1207,8 @@ brelease(XEvent *e) {
</a> }
 
 void
<a href="#h0-27-3" id="h0-27-3" class="d">-bmotion(XEvent *e) {
</a><a href="#h0-27-4" id="h0-27-4" class="i">+bmotion(XEvent *e)
</a><a href="#h0-27-5" id="h0-27-5" class="i">+{
</a> 	int oldey, oldex, oldsby, oldsey;
 
 	if(IS_SET(MODE_MOUSE) &amp;&amp; !(e-&gt;xbutton.state &amp; forceselmod)) {
<a href="#h0-28" id="h0-28" class="h">@@ -1200,7 +1231,8 @@ bmotion(XEvent *e) {
</a> }
 
 void
<a href="#h0-28-3" id="h0-28-3" class="d">-die(const char *errstr, ...) {
</a><a href="#h0-28-4" id="h0-28-4" class="i">+die(const char *errstr, ...)
</a><a href="#h0-28-5" id="h0-28-5" class="i">+{
</a> 	va_list ap;
 
 	va_start(ap, errstr);
<a href="#h0-29" id="h0-29" class="h">@@ -1210,7 +1242,8 @@ die(const char *errstr, ...) {
</a> }
 
 void
<a href="#h0-29-3" id="h0-29-3" class="d">-execsh(void) {
</a><a href="#h0-29-4" id="h0-29-4" class="i">+execsh(void)
</a><a href="#h0-29-5" id="h0-29-5" class="i">+{
</a> 	char **args, *sh, *prog;
 	const struct passwd *pw;
 	char buf[sizeof(long) * 8 + 1];
<a href="#h0-30" id="h0-30" class="h">@@ -1259,7 +1292,8 @@ execsh(void) {
</a> }
 
 void
<a href="#h0-30-3" id="h0-30-3" class="d">-sigchld(int a) {
</a><a href="#h0-30-4" id="h0-30-4" class="i">+sigchld(int a)
</a><a href="#h0-30-5" id="h0-30-5" class="i">+{
</a> 	int stat;
 	pid_t p;
 
<a href="#h0-31" id="h0-31" class="h">@@ -1300,7 +1334,8 @@ stty(void)
</a> }
 
 void
<a href="#h0-31-3" id="h0-31-3" class="d">-ttynew(void) {
</a><a href="#h0-31-4" id="h0-31-4" class="i">+ttynew(void)
</a><a href="#h0-31-5" id="h0-31-5" class="i">+{
</a> 	int m, s;
 	struct winsize w = {term.row, term.col, 0, 0};
 
<a href="#h0-32" id="h0-32" class="h">@@ -1352,7 +1387,8 @@ ttynew(void) {
</a> }
 
 void
<a href="#h0-32-3" id="h0-32-3" class="d">-ttyread(void) {
</a><a href="#h0-32-4" id="h0-32-4" class="i">+ttyread(void)
</a><a href="#h0-32-5" id="h0-32-5" class="i">+{
</a> 	static char buf[BUFSIZ];
 	static int buflen = 0;
 	char *ptr;
<a href="#h0-33" id="h0-33" class="h">@@ -1378,13 +1414,15 @@ ttyread(void) {
</a> }
 
 void
<a href="#h0-33-3" id="h0-33-3" class="d">-ttywrite(const char *s, size_t n) {
</a><a href="#h0-33-4" id="h0-33-4" class="i">+ttywrite(const char *s, size_t n)
</a><a href="#h0-33-5" id="h0-33-5" class="i">+{
</a> 	if(xwrite(cmdfd, s, n) == -1)
 		die(&quot;write error on tty: %s\n&quot;, strerror(errno));
 }
 
 void
<a href="#h0-33-11" id="h0-33-11" class="d">-ttysend(char *s, size_t n) {
</a><a href="#h0-33-12" id="h0-33-12" class="i">+ttysend(char *s, size_t n)
</a><a href="#h0-33-13" id="h0-33-13" class="i">+{
</a> 	int len;
 	Rune u;
 
<a href="#h0-34" id="h0-34" class="h">@@ -1398,7 +1436,8 @@ ttysend(char *s, size_t n) {
</a> }
 
 void
<a href="#h0-34-3" id="h0-34-3" class="d">-ttyresize(void) {
</a><a href="#h0-34-4" id="h0-34-4" class="i">+ttyresize(void)
</a><a href="#h0-34-5" id="h0-34-5" class="i">+{
</a> 	struct winsize w;
 
 	w.ws_row = term.row;
<a href="#h0-35" id="h0-35" class="h">@@ -1410,7 +1449,8 @@ ttyresize(void) {
</a> }
 
 int
<a href="#h0-35-3" id="h0-35-3" class="d">-tattrset(int attr) {
</a><a href="#h0-35-4" id="h0-35-4" class="i">+tattrset(int attr)
</a><a href="#h0-35-5" id="h0-35-5" class="i">+{
</a> 	int i, j;
 
 	for(i = 0; i &lt; term.row-1; i++) {
<a href="#h0-36" id="h0-36" class="h">@@ -1424,7 +1464,8 @@ tattrset(int attr) {
</a> }
 
 void
<a href="#h0-36-3" id="h0-36-3" class="d">-tsetdirt(int top, int bot) {
</a><a href="#h0-36-4" id="h0-36-4" class="i">+tsetdirt(int top, int bot)
</a><a href="#h0-36-5" id="h0-36-5" class="i">+{
</a> 	int i;
 
 	LIMIT(top, 0, term.row-1);
<a href="#h0-37" id="h0-37" class="h">@@ -1435,7 +1476,8 @@ tsetdirt(int top, int bot) {
</a> }
 
 void
<a href="#h0-37-3" id="h0-37-3" class="d">-tsetdirtattr(int attr) {
</a><a href="#h0-37-4" id="h0-37-4" class="i">+tsetdirtattr(int attr)
</a><a href="#h0-37-5" id="h0-37-5" class="i">+{
</a> 	int i, j;
 
 	for(i = 0; i &lt; term.row-1; i++) {
<a href="#h0-38" id="h0-38" class="h">@@ -1449,12 +1491,14 @@ tsetdirtattr(int attr) {
</a> }
 
 void
<a href="#h0-38-3" id="h0-38-3" class="d">-tfulldirt(void) {
</a><a href="#h0-38-4" id="h0-38-4" class="i">+tfulldirt(void)
</a><a href="#h0-38-5" id="h0-38-5" class="i">+{
</a> 	tsetdirt(0, term.row-1);
 }
 
 void
<a href="#h0-38-10" id="h0-38-10" class="d">-tcursor(int mode) {
</a><a href="#h0-38-11" id="h0-38-11" class="i">+tcursor(int mode)
</a><a href="#h0-38-12" id="h0-38-12" class="i">+{
</a> 	static TCursor c[2];
 	int alt = IS_SET(MODE_ALTSCREEN);
 
<a href="#h0-39" id="h0-39" class="h">@@ -1467,7 +1511,8 @@ tcursor(int mode) {
</a> }
 
 void
<a href="#h0-39-3" id="h0-39-3" class="d">-treset(void) {
</a><a href="#h0-39-4" id="h0-39-4" class="i">+treset(void)
</a><a href="#h0-39-5" id="h0-39-5" class="i">+{
</a> 	uint i;
 
 	term.c = (TCursor){{
<a href="#h0-40" id="h0-40" class="h">@@ -1494,7 +1539,8 @@ treset(void) {
</a> }
 
 void
<a href="#h0-40-3" id="h0-40-3" class="d">-tnew(int col, int row) {
</a><a href="#h0-40-4" id="h0-40-4" class="i">+tnew(int col, int row)
</a><a href="#h0-40-5" id="h0-40-5" class="i">+{
</a> 	term = (Term){ .c = { .attr = { .fg = defaultfg, .bg = defaultbg } } };
 	tresize(col, row);
 	term.numlock = 1;
<a href="#h0-41" id="h0-41" class="h">@@ -1503,7 +1549,8 @@ tnew(int col, int row) {
</a> }
 
 void
<a href="#h0-41-3" id="h0-41-3" class="d">-tswapscreen(void) {
</a><a href="#h0-41-4" id="h0-41-4" class="i">+tswapscreen(void)
</a><a href="#h0-41-5" id="h0-41-5" class="i">+{
</a> 	Line *tmp = term.line;
 
 	term.line = term.alt;
<a href="#h0-42" id="h0-42" class="h">@@ -1513,7 +1560,8 @@ tswapscreen(void) {
</a> }
 
 void
<a href="#h0-42-3" id="h0-42-3" class="d">-tscrolldown(int orig, int n) {
</a><a href="#h0-42-4" id="h0-42-4" class="i">+tscrolldown(int orig, int n)
</a><a href="#h0-42-5" id="h0-42-5" class="i">+{
</a> 	int i;
 	Line temp;
 
<a href="#h0-43" id="h0-43" class="h">@@ -1532,7 +1580,8 @@ tscrolldown(int orig, int n) {
</a> }
 
 void
<a href="#h0-43-3" id="h0-43-3" class="d">-tscrollup(int orig, int n) {
</a><a href="#h0-43-4" id="h0-43-4" class="i">+tscrollup(int orig, int n)
</a><a href="#h0-43-5" id="h0-43-5" class="i">+{
</a> 	int i;
 	Line temp;
 
<a href="#h0-44" id="h0-44" class="h">@@ -1551,7 +1600,8 @@ tscrollup(int orig, int n) {
</a> }
 
 void
<a href="#h0-44-3" id="h0-44-3" class="d">-selscroll(int orig, int n) {
</a><a href="#h0-44-4" id="h0-44-4" class="i">+selscroll(int orig, int n)
</a><a href="#h0-44-5" id="h0-44-5" class="i">+{
</a> 	if(sel.ob.x == -1)
 		return;
 
<a href="#h0-45" id="h0-45" class="h">@@ -1580,7 +1630,8 @@ selscroll(int orig, int n) {
</a> }
 
 void
<a href="#h0-45-3" id="h0-45-3" class="d">-tnewline(int first_col) {
</a><a href="#h0-45-4" id="h0-45-4" class="i">+tnewline(int first_col)
</a><a href="#h0-45-5" id="h0-45-5" class="i">+{
</a> 	int y = term.c.y;
 
 	if(y == term.bot) {
<a href="#h0-46" id="h0-46" class="h">@@ -1592,7 +1643,8 @@ tnewline(int first_col) {
</a> }
 
 void
<a href="#h0-46-3" id="h0-46-3" class="d">-csiparse(void) {
</a><a href="#h0-46-4" id="h0-46-4" class="i">+csiparse(void)
</a><a href="#h0-46-5" id="h0-46-5" class="i">+{
</a> 	char *p = csiescseq.buf, *np;
 	long int v;
 
<a href="#h0-47" id="h0-47" class="h">@@ -1622,12 +1674,14 @@ csiparse(void) {
</a> 
 /* for absolute user moves, when decom is set */
 void
<a href="#h0-47-3" id="h0-47-3" class="d">-tmoveato(int x, int y) {
</a><a href="#h0-47-4" id="h0-47-4" class="i">+tmoveato(int x, int y)
</a><a href="#h0-47-5" id="h0-47-5" class="i">+{
</a> 	tmoveto(x, y + ((term.c.state &amp; CURSOR_ORIGIN) ? term.top: 0));
 }
 
 void
<a href="#h0-47-10" id="h0-47-10" class="d">-tmoveto(int x, int y) {
</a><a href="#h0-47-11" id="h0-47-11" class="i">+tmoveto(int x, int y)
</a><a href="#h0-47-12" id="h0-47-12" class="i">+{
</a> 	int miny, maxy;
 
 	if(term.c.state &amp; CURSOR_ORIGIN) {
<a href="#h0-48" id="h0-48" class="h">@@ -1643,7 +1697,8 @@ tmoveto(int x, int y) {
</a> }
 
 void
<a href="#h0-48-3" id="h0-48-3" class="d">-tsetchar(Rune u, Glyph *attr, int x, int y) {
</a><a href="#h0-48-4" id="h0-48-4" class="i">+tsetchar(Rune u, Glyph *attr, int x, int y)
</a><a href="#h0-48-5" id="h0-48-5" class="i">+{
</a> 	static char *vt100_0[62] = { /* 0x41 - 0x7e */
 		&quot;↑&quot;, &quot;↓&quot;, &quot;→&quot;, &quot;←&quot;, &quot;█&quot;, &quot;▚&quot;, &quot;☃&quot;, /* A - G */
 		0, 0, 0, 0, 0, 0, 0, 0, /* H - O */
<a href="#h0-49" id="h0-49" class="h">@@ -1678,7 +1733,8 @@ tsetchar(Rune u, Glyph *attr, int x, int y) {
</a> }
 
 void
<a href="#h0-49-3" id="h0-49-3" class="d">-tclearregion(int x1, int y1, int x2, int y2) {
</a><a href="#h0-49-4" id="h0-49-4" class="i">+tclearregion(int x1, int y1, int x2, int y2)
</a><a href="#h0-49-5" id="h0-49-5" class="i">+{
</a> 	int x, y, temp;
 	Glyph *gp;
 
<a href="#h0-50" id="h0-50" class="h">@@ -1707,7 +1763,8 @@ tclearregion(int x1, int y1, int x2, int y2) {
</a> }
 
 void
<a href="#h0-50-3" id="h0-50-3" class="d">-tdeletechar(int n) {
</a><a href="#h0-50-4" id="h0-50-4" class="i">+tdeletechar(int n)
</a><a href="#h0-50-5" id="h0-50-5" class="i">+{
</a> 	int dst, src, size;
 	Glyph *line;
 
<a href="#h0-51" id="h0-51" class="h">@@ -1723,7 +1780,8 @@ tdeletechar(int n) {
</a> }
 
 void
<a href="#h0-51-3" id="h0-51-3" class="d">-tinsertblank(int n) {
</a><a href="#h0-51-4" id="h0-51-4" class="i">+tinsertblank(int n)
</a><a href="#h0-51-5" id="h0-51-5" class="i">+{
</a> 	int dst, src, size;
 	Glyph *line;
 
<a href="#h0-52" id="h0-52" class="h">@@ -1739,19 +1797,22 @@ tinsertblank(int n) {
</a> }
 
 void
<a href="#h0-52-3" id="h0-52-3" class="d">-tinsertblankline(int n) {
</a><a href="#h0-52-4" id="h0-52-4" class="i">+tinsertblankline(int n)
</a><a href="#h0-52-5" id="h0-52-5" class="i">+{
</a> 	if(BETWEEN(term.c.y, term.top, term.bot))
 		tscrolldown(term.c.y, n);
 }
 
 void
<a href="#h0-52-11" id="h0-52-11" class="d">-tdeleteline(int n) {
</a><a href="#h0-52-12" id="h0-52-12" class="i">+tdeleteline(int n)
</a><a href="#h0-52-13" id="h0-52-13" class="i">+{
</a> 	if(BETWEEN(term.c.y, term.top, term.bot))
 		tscrollup(term.c.y, n);
 }
 
 int32_t
<a href="#h0-52-19" id="h0-52-19" class="d">-tdefcolor(int *attr, int *npar, int l) {
</a><a href="#h0-52-20" id="h0-52-20" class="i">+tdefcolor(int *attr, int *npar, int l)
</a><a href="#h0-52-21" id="h0-52-21" class="i">+{
</a> 	int32_t idx = -1;
 	uint r, g, b;
 
<a href="#h0-53" id="h0-53" class="h">@@ -1800,7 +1861,8 @@ tdefcolor(int *attr, int *npar, int l) {
</a> }
 
 void
<a href="#h0-53-3" id="h0-53-3" class="d">-tsetattr(int *attr, int l) {
</a><a href="#h0-53-4" id="h0-53-4" class="i">+tsetattr(int *attr, int l)
</a><a href="#h0-53-5" id="h0-53-5" class="i">+{
</a> 	int i;
 	int32_t idx;
 
<a href="#h0-54" id="h0-54" class="h">@@ -1900,7 +1962,8 @@ tsetattr(int *attr, int l) {
</a> }
 
 void
<a href="#h0-54-3" id="h0-54-3" class="d">-tsetscroll(int t, int b) {
</a><a href="#h0-54-4" id="h0-54-4" class="i">+tsetscroll(int t, int b)
</a><a href="#h0-54-5" id="h0-54-5" class="i">+{
</a> 	int temp;
 
 	LIMIT(t, 0, term.row-1);
<a href="#h0-55" id="h0-55" class="h">@@ -1915,7 +1978,8 @@ tsetscroll(int t, int b) {
</a> }
 
 void
<a href="#h0-55-3" id="h0-55-3" class="d">-tsetmode(int priv, int set, int *args, int narg) {
</a><a href="#h0-55-4" id="h0-55-4" class="i">+tsetmode(int priv, int set, int *args, int narg)
</a><a href="#h0-55-5" id="h0-55-5" class="i">+{
</a> 	int *lim, mode;
 	int alt;
 
<a href="#h0-56" id="h0-56" class="h">@@ -2047,7 +2111,8 @@ tsetmode(int priv, int set, int *args, int narg) {
</a> }
 
 void
<a href="#h0-56-3" id="h0-56-3" class="d">-csihandle(void) {
</a><a href="#h0-56-4" id="h0-56-4" class="i">+csihandle(void)
</a><a href="#h0-56-5" id="h0-56-5" class="i">+{
</a> 	char buf[40];
 	int len;
 
<a href="#h0-57" id="h0-57" class="h">@@ -2256,7 +2321,8 @@ csihandle(void) {
</a> }
 
 void
<a href="#h0-57-3" id="h0-57-3" class="d">-csidump(void) {
</a><a href="#h0-57-4" id="h0-57-4" class="i">+csidump(void)
</a><a href="#h0-57-5" id="h0-57-5" class="i">+{
</a> 	int i;
 	uint c;
 
<a href="#h0-58" id="h0-58" class="h">@@ -2279,12 +2345,14 @@ csidump(void) {
</a> }
 
 void
<a href="#h0-58-3" id="h0-58-3" class="d">-csireset(void) {
</a><a href="#h0-58-4" id="h0-58-4" class="i">+csireset(void)
</a><a href="#h0-58-5" id="h0-58-5" class="i">+{
</a> 	memset(&amp;csiescseq, 0, sizeof(csiescseq));
 }
 
 void
<a href="#h0-58-10" id="h0-58-10" class="d">-strhandle(void) {
</a><a href="#h0-58-11" id="h0-58-11" class="i">+strhandle(void)
</a><a href="#h0-58-12" id="h0-58-12" class="i">+{
</a> 	char *p = NULL;
 	int j, narg, par;
 
<a href="#h0-59" id="h0-59" class="h">@@ -2334,7 +2402,8 @@ strhandle(void) {
</a> }
 
 void
<a href="#h0-59-3" id="h0-59-3" class="d">-strparse(void) {
</a><a href="#h0-59-4" id="h0-59-4" class="i">+strparse(void)
</a><a href="#h0-59-5" id="h0-59-5" class="i">+{
</a> 	int c;
 	char *p = strescseq.buf;
 
<a href="#h0-60" id="h0-60" class="h">@@ -2355,7 +2424,8 @@ strparse(void) {
</a> }
 
 void
<a href="#h0-60-3" id="h0-60-3" class="d">-strdump(void) {
</a><a href="#h0-60-4" id="h0-60-4" class="i">+strdump(void)
</a><a href="#h0-60-5" id="h0-60-5" class="i">+{
</a> 	int i;
 	uint c;
 
<a href="#h0-61" id="h0-61" class="h">@@ -2380,12 +2450,14 @@ strdump(void) {
</a> }
 
 void
<a href="#h0-61-3" id="h0-61-3" class="d">-strreset(void) {
</a><a href="#h0-61-4" id="h0-61-4" class="i">+strreset(void)
</a><a href="#h0-61-5" id="h0-61-5" class="i">+{
</a> 	memset(&amp;strescseq, 0, sizeof(strescseq));
 }
 
 void
<a href="#h0-61-10" id="h0-61-10" class="d">-tprinter(char *s, size_t len) {
</a><a href="#h0-61-11" id="h0-61-11" class="i">+tprinter(char *s, size_t len)
</a><a href="#h0-61-12" id="h0-61-12" class="i">+{
</a> 	if(iofd != -1 &amp;&amp; xwrite(iofd, s, len) &lt; 0) {
 		fprintf(stderr, &quot;Error writing in %s:%s\n&quot;,
 			opt_io, strerror(errno));
<a href="#h0-62" id="h0-62" class="h">@@ -2395,22 +2467,26 @@ tprinter(char *s, size_t len) {
</a> }
 
 void
<a href="#h0-62-3" id="h0-62-3" class="d">-toggleprinter(const Arg *arg) {
</a><a href="#h0-62-4" id="h0-62-4" class="i">+toggleprinter(const Arg *arg)
</a><a href="#h0-62-5" id="h0-62-5" class="i">+{
</a> 	term.mode ^= MODE_PRINT;
 }
 
 void
<a href="#h0-62-10" id="h0-62-10" class="d">-printscreen(const Arg *arg) {
</a><a href="#h0-62-11" id="h0-62-11" class="i">+printscreen(const Arg *arg)
</a><a href="#h0-62-12" id="h0-62-12" class="i">+{
</a> 	tdump();
 }
 
 void
<a href="#h0-62-17" id="h0-62-17" class="d">-printsel(const Arg *arg) {
</a><a href="#h0-62-18" id="h0-62-18" class="i">+printsel(const Arg *arg)
</a><a href="#h0-62-19" id="h0-62-19" class="i">+{
</a> 	tdumpsel();
 }
 
 void
<a href="#h0-62-24" id="h0-62-24" class="d">-tdumpsel(void) {
</a><a href="#h0-62-25" id="h0-62-25" class="i">+tdumpsel(void)
</a><a href="#h0-62-26" id="h0-62-26" class="i">+{
</a> 	char *ptr;
 
 	if((ptr = getsel())) {
<a href="#h0-63" id="h0-63" class="h">@@ -2420,7 +2496,8 @@ tdumpsel(void) {
</a> }
 
 void
<a href="#h0-63-3" id="h0-63-3" class="d">-tdumpline(int n) {
</a><a href="#h0-63-4" id="h0-63-4" class="i">+tdumpline(int n)
</a><a href="#h0-63-5" id="h0-63-5" class="i">+{
</a> 	char buf[UTF_SIZ];
 	Glyph *bp, *end;
 
<a href="#h0-64" id="h0-64" class="h">@@ -2434,7 +2511,8 @@ tdumpline(int n) {
</a> }
 
 void
<a href="#h0-64-3" id="h0-64-3" class="d">-tdump(void) {
</a><a href="#h0-64-4" id="h0-64-4" class="i">+tdump(void)
</a><a href="#h0-64-5" id="h0-64-5" class="i">+{
</a> 	int i;
 
 	for(i = 0; i &lt; term.row; ++i)
<a href="#h0-65" id="h0-65" class="h">@@ -2442,7 +2520,8 @@ tdump(void) {
</a> }
 
 void
<a href="#h0-65-3" id="h0-65-3" class="d">-tputtab(int n) {
</a><a href="#h0-65-4" id="h0-65-4" class="i">+tputtab(int n)
</a><a href="#h0-65-5" id="h0-65-5" class="i">+{
</a> 	uint x = term.c.x;
 
 	if(n &gt; 0) {
<a href="#h0-66" id="h0-66" class="h">@@ -2458,7 +2537,8 @@ tputtab(int n) {
</a> }
 
 void
<a href="#h0-66-3" id="h0-66-3" class="d">-techo(Rune u) {
</a><a href="#h0-66-4" id="h0-66-4" class="i">+techo(Rune u)
</a><a href="#h0-66-5" id="h0-66-5" class="i">+{
</a> 	if(ISCONTROL(u)) { /* control code */
 		if(u &amp; 0x80) {
 			u &amp;= 0x7f;
<a href="#h0-67" id="h0-67" class="h">@@ -2473,7 +2553,8 @@ techo(Rune u) {
</a> }
 
 void
<a href="#h0-67-3" id="h0-67-3" class="d">-tdeftran(char ascii) {
</a><a href="#h0-67-4" id="h0-67-4" class="i">+tdeftran(char ascii)
</a><a href="#h0-67-5" id="h0-67-5" class="i">+{
</a> 	static char cs[] = &quot;0B&quot;;
 	static int vcs[] = {CS_GRAPHIC0, CS_USA};
 	char *p;
<a href="#h0-68" id="h0-68" class="h">@@ -2486,7 +2567,8 @@ tdeftran(char ascii) {
</a> }
 
 void
<a href="#h0-68-3" id="h0-68-3" class="d">-tdectest(char c) {
</a><a href="#h0-68-4" id="h0-68-4" class="i">+tdectest(char c)
</a><a href="#h0-68-5" id="h0-68-5" class="i">+{
</a> 	int x, y;
 
 	if(c == &#39;8&#39;) { /* DEC screen alignment test. */
<a href="#h0-69" id="h0-69" class="h">@@ -2498,7 +2580,8 @@ tdectest(char c) {
</a> }
 
 void
<a href="#h0-69-3" id="h0-69-3" class="d">-tstrsequence(uchar c) {
</a><a href="#h0-69-4" id="h0-69-4" class="i">+tstrsequence(uchar c)
</a><a href="#h0-69-5" id="h0-69-5" class="i">+{
</a> 	switch (c) {
 	case 0x90:   /* DCS -- Device Control String */
 		c = &#39;P&#39;;
<a href="#h0-70" id="h0-70" class="h">@@ -2519,7 +2602,8 @@ tstrsequence(uchar c) {
</a> }
 
 void
<a href="#h0-70-3" id="h0-70-3" class="d">-tcontrolcode(uchar ascii) {
</a><a href="#h0-70-4" id="h0-70-4" class="i">+tcontrolcode(uchar ascii)
</a><a href="#h0-70-5" id="h0-70-5" class="i">+{
</a> 	switch(ascii) {
 	case &#39;\t&#39;:   /* HT */
 		tputtab(1);
<a href="#h0-71" id="h0-71" class="h">@@ -2602,7 +2686,8 @@ tcontrolcode(uchar ascii) {
</a>  * more characters for this sequence, otherwise 0
  */
 int
<a href="#h0-71-3" id="h0-71-3" class="d">-eschandle(uchar ascii) {
</a><a href="#h0-71-4" id="h0-71-4" class="i">+eschandle(uchar ascii)
</a><a href="#h0-71-5" id="h0-71-5" class="i">+{
</a> 	switch(ascii) {
 	case &#39;[&#39;:
 		term.esc |= ESC_CSI;
<a href="#h0-72" id="h0-72" class="h">@@ -2681,7 +2766,8 @@ eschandle(uchar ascii) {
</a> }
 
 void
<a href="#h0-72-3" id="h0-72-3" class="d">-tputc(Rune u) {
</a><a href="#h0-72-4" id="h0-72-4" class="i">+tputc(Rune u)
</a><a href="#h0-72-5" id="h0-72-5" class="i">+{
</a> 	char c[UTF_SIZ];
 	int control;
 	int width, len;
<a href="#h0-73" id="h0-73" class="h">@@ -2803,7 +2889,8 @@ tputc(Rune u) {
</a> }
 
 void
<a href="#h0-73-3" id="h0-73-3" class="d">-tresize(int col, int row) {
</a><a href="#h0-73-4" id="h0-73-4" class="i">+tresize(int col, int row)
</a><a href="#h0-73-5" id="h0-73-5" class="i">+{
</a> 	int i;
 	int minrow = MIN(row, term.row);
 	int mincol = MIN(col, term.col);
<a href="#h0-74" id="h0-74" class="h">@@ -2887,7 +2974,8 @@ tresize(int col, int row) {
</a> }
 
 void
<a href="#h0-74-3" id="h0-74-3" class="d">-xresize(int col, int row) {
</a><a href="#h0-74-4" id="h0-74-4" class="i">+xresize(int col, int row)
</a><a href="#h0-74-5" id="h0-74-5" class="i">+{
</a> 	xw.tw = MAX(1, col * xw.cw);
 	xw.th = MAX(1, row * xw.ch);
 
<a href="#h0-75" id="h0-75" class="h">@@ -2899,12 +2987,14 @@ xresize(int col, int row) {
</a> }
 
 ushort
<a href="#h0-75-3" id="h0-75-3" class="d">-sixd_to_16bit(int x) {
</a><a href="#h0-75-4" id="h0-75-4" class="i">+sixd_to_16bit(int x)
</a><a href="#h0-75-5" id="h0-75-5" class="i">+{
</a> 	return x == 0 ? 0 : 0x3737 + 0x2828 * x;
 }
 
 int
<a href="#h0-75-10" id="h0-75-10" class="d">-xloadcolor(int i, const char *name, Color *ncolor) {
</a><a href="#h0-75-11" id="h0-75-11" class="i">+xloadcolor(int i, const char *name, Color *ncolor)
</a><a href="#h0-75-12" id="h0-75-12" class="i">+{
</a> 	XRenderColor color = { .alpha = 0xffff };
 
 	if(!name) {
<a href="#h0-76" id="h0-76" class="h">@@ -2926,7 +3016,8 @@ xloadcolor(int i, const char *name, Color *ncolor) {
</a> }
 
 void
<a href="#h0-76-3" id="h0-76-3" class="d">-xloadcols(void) {
</a><a href="#h0-76-4" id="h0-76-4" class="i">+xloadcols(void)
</a><a href="#h0-76-5" id="h0-76-5" class="i">+{
</a> 	int i;
 	static int loaded;
 	Color *cp;
<a href="#h0-77" id="h0-77" class="h">@@ -2947,7 +3038,8 @@ xloadcols(void) {
</a> }
 
 int
<a href="#h0-77-3" id="h0-77-3" class="d">-xsetcolorname(int x, const char *name) {
</a><a href="#h0-77-4" id="h0-77-4" class="i">+xsetcolorname(int x, const char *name)
</a><a href="#h0-77-5" id="h0-77-5" class="i">+{
</a> 	Color ncolor;
 
 	if(!BETWEEN(x, 0, LEN(dc.col)))
<a href="#h0-78" id="h0-78" class="h">@@ -2963,7 +3055,8 @@ xsetcolorname(int x, const char *name) {
</a> }
 
 void
<a href="#h0-78-3" id="h0-78-3" class="d">-xtermclear(int col1, int row1, int col2, int row2) {
</a><a href="#h0-78-4" id="h0-78-4" class="i">+xtermclear(int col1, int row1, int col2, int row2)
</a><a href="#h0-78-5" id="h0-78-5" class="i">+{
</a> 	XftDrawRect(xw.draw,
 			&amp;dc.col[IS_SET(MODE_REVERSE) ? defaultfg : defaultbg],
 			borderpx + col1 * xw.cw,
<a href="#h0-79" id="h0-79" class="h">@@ -2976,14 +3069,16 @@ xtermclear(int col1, int row1, int col2, int row2) {
</a>  * Absolute coordinates.
  */
 void
<a href="#h0-79-3" id="h0-79-3" class="d">-xclear(int x1, int y1, int x2, int y2) {
</a><a href="#h0-79-4" id="h0-79-4" class="i">+xclear(int x1, int y1, int x2, int y2)
</a><a href="#h0-79-5" id="h0-79-5" class="i">+{
</a> 	XftDrawRect(xw.draw,
 			&amp;dc.col[IS_SET(MODE_REVERSE)? defaultfg : defaultbg],
 			x1, y1, x2-x1, y2-y1);
 }
 
 void
<a href="#h0-79-12" id="h0-79-12" class="d">-xhints(void) {
</a><a href="#h0-79-13" id="h0-79-13" class="i">+xhints(void)
</a><a href="#h0-79-14" id="h0-79-14" class="i">+{
</a> 	XClassHint class = {opt_class ? opt_class : termname, termname};
 	XWMHints wm = {.flags = InputHint, .input = 1};
 	XSizeHints *sizeh = NULL;
<a href="#h0-80" id="h0-80" class="h">@@ -3015,7 +3110,8 @@ xhints(void) {
</a> }
 
 int
<a href="#h0-80-3" id="h0-80-3" class="d">-xgeommasktogravity(int mask) {
</a><a href="#h0-80-4" id="h0-80-4" class="i">+xgeommasktogravity(int mask)
</a><a href="#h0-80-5" id="h0-80-5" class="i">+{
</a> 	switch(mask &amp; (XNegative|YNegative)) {
 	case 0:
 		return NorthWestGravity;
<a href="#h0-81" id="h0-81" class="h">@@ -3028,7 +3124,8 @@ xgeommasktogravity(int mask) {
</a> }
 
 int
<a href="#h0-81-3" id="h0-81-3" class="d">-xloadfont(Font *f, FcPattern *pattern) {
</a><a href="#h0-81-4" id="h0-81-4" class="i">+xloadfont(Font *f, FcPattern *pattern)
</a><a href="#h0-81-5" id="h0-81-5" class="i">+{
</a> 	FcPattern *match;
 	FcResult result;
 
<a href="#h0-82" id="h0-82" class="h">@@ -3056,7 +3153,8 @@ xloadfont(Font *f, FcPattern *pattern) {
</a> }
 
 void
<a href="#h0-82-3" id="h0-82-3" class="d">-xloadfonts(char *fontstr, double fontsize) {
</a><a href="#h0-82-4" id="h0-82-4" class="i">+xloadfonts(char *fontstr, double fontsize)
</a><a href="#h0-82-5" id="h0-82-5" class="i">+{
</a> 	FcPattern *pattern;
 	double fontval;
 	float ceilf(float);
<a href="#h0-83" id="h0-83" class="h">@@ -3130,7 +3228,8 @@ xloadfonts(char *fontstr, double fontsize) {
</a> }
 
 void
<a href="#h0-83-3" id="h0-83-3" class="d">-xunloadfont(Font *f) {
</a><a href="#h0-83-4" id="h0-83-4" class="i">+xunloadfont(Font *f)
</a><a href="#h0-83-5" id="h0-83-5" class="i">+{
</a> 	XftFontClose(xw.dpy, f-&gt;match);
 	FcPatternDestroy(f-&gt;pattern);
 	if(f-&gt;set)
<a href="#h0-84" id="h0-84" class="h">@@ -3138,7 +3237,8 @@ xunloadfont(Font *f) {
</a> }
 
 void
<a href="#h0-84-3" id="h0-84-3" class="d">-xunloadfonts(void) {
</a><a href="#h0-84-4" id="h0-84-4" class="i">+xunloadfonts(void)
</a><a href="#h0-84-5" id="h0-84-5" class="i">+{
</a> 	/* Free the loaded fonts in the font cache.  */
 	while(frclen &gt; 0)
 		XftFontClose(xw.dpy, frc[--frclen].font);
<a href="#h0-85" id="h0-85" class="h">@@ -3150,7 +3250,8 @@ xunloadfonts(void) {
</a> }
 
 void
<a href="#h0-85-3" id="h0-85-3" class="d">-xzoom(const Arg *arg) {
</a><a href="#h0-85-4" id="h0-85-4" class="i">+xzoom(const Arg *arg)
</a><a href="#h0-85-5" id="h0-85-5" class="i">+{
</a> 	Arg larg;
 
 	larg.f = usedfontsize + arg-&gt;f;
<a href="#h0-86" id="h0-86" class="h">@@ -3158,7 +3259,8 @@ xzoom(const Arg *arg) {
</a> }
 
 void
<a href="#h0-86-3" id="h0-86-3" class="d">-xzoomabs(const Arg *arg) {
</a><a href="#h0-86-4" id="h0-86-4" class="i">+xzoomabs(const Arg *arg)
</a><a href="#h0-86-5" id="h0-86-5" class="i">+{
</a> 	xunloadfonts();
 	xloadfonts(usedfont, arg-&gt;f);
 	cresize(0, 0);
<a href="#h0-87" id="h0-87" class="h">@@ -3167,7 +3269,8 @@ xzoomabs(const Arg *arg) {
</a> }
 
 void
<a href="#h0-87-3" id="h0-87-3" class="d">-xzoomreset(const Arg *arg) {
</a><a href="#h0-87-4" id="h0-87-4" class="i">+xzoomreset(const Arg *arg)
</a><a href="#h0-87-5" id="h0-87-5" class="i">+{
</a> 	Arg larg;
 
 	if(defaultfontsize &gt; 0) {
<a href="#h0-88" id="h0-88" class="h">@@ -3177,7 +3280,8 @@ xzoomreset(const Arg *arg) {
</a> }
 
 void
<a href="#h0-88-3" id="h0-88-3" class="d">-xinit(void) {
</a><a href="#h0-88-4" id="h0-88-4" class="i">+xinit(void)
</a><a href="#h0-88-5" id="h0-88-5" class="i">+{
</a> 	XGCValues gcvalues;
 	Cursor cursor;
 	Window parent;
<a href="#h0-89" id="h0-89" class="h">@@ -3408,7 +3512,8 @@ xmakeglyphfontspecs(XftGlyphFontSpec *specs, const Glyph *glyphs, int len, int x
</a> }
 
 void
<a href="#h0-89-3" id="h0-89-3" class="d">-xdrawglyphfontspecs(const XftGlyphFontSpec *specs, Glyph base, int len, int x, int y) {
</a><a href="#h0-89-4" id="h0-89-4" class="i">+xdrawglyphfontspecs(const XftGlyphFontSpec *specs, Glyph base, int len, int x, int y)
</a><a href="#h0-89-5" id="h0-89-5" class="i">+{
</a> 	int charlen = len * ((base.mode &amp; ATTR_WIDE) ? 2 : 1);
 	int winx = borderpx + x * xw.cw, winy = borderpx + y * xw.ch,
 	    width = charlen * xw.cw;
<a href="#h0-90" id="h0-90" class="h">@@ -3541,7 +3646,8 @@ xdrawglyphfontspecs(const XftGlyphFontSpec *specs, Glyph base, int len, int x, i
</a> }
 
 void
<a href="#h0-90-3" id="h0-90-3" class="d">-xdrawglyph(Glyph g, int x, int y) {
</a><a href="#h0-90-4" id="h0-90-4" class="i">+xdrawglyph(Glyph g, int x, int y)
</a><a href="#h0-90-5" id="h0-90-5" class="i">+{
</a> 	int numspecs;
 	XftGlyphFontSpec spec;
 	numspecs = xmakeglyphfontspecs(&amp;spec, &amp;g, 1, x, y);
<a href="#h0-91" id="h0-91" class="h">@@ -3549,7 +3655,8 @@ xdrawglyph(Glyph g, int x, int y) {
</a> }
 
 void
<a href="#h0-91-3" id="h0-91-3" class="d">-xdrawcursor(void) {
</a><a href="#h0-91-4" id="h0-91-4" class="i">+xdrawcursor(void)
</a><a href="#h0-91-5" id="h0-91-5" class="i">+{
</a> 	static int oldx = 0, oldy = 0;
 	int curx;
 	Glyph g = {&#39; &#39;, ATTR_NULL, defaultbg, defaultcs};
<a href="#h0-92" id="h0-92" class="h">@@ -3626,7 +3733,8 @@ xdrawcursor(void) {
</a> 
 
 void
<a href="#h0-92-3" id="h0-92-3" class="d">-xsettitle(char *p) {
</a><a href="#h0-92-4" id="h0-92-4" class="i">+xsettitle(char *p)
</a><a href="#h0-92-5" id="h0-92-5" class="i">+{
</a> 	XTextProperty prop;
 
 	Xutf8TextListToTextProperty(xw.dpy, &amp;p, 1, XUTF8StringStyle,
<a href="#h0-93" id="h0-93" class="h">@@ -3637,18 +3745,21 @@ xsettitle(char *p) {
</a> }
 
 void
<a href="#h0-93-3" id="h0-93-3" class="d">-xresettitle(void) {
</a><a href="#h0-93-4" id="h0-93-4" class="i">+xresettitle(void)
</a><a href="#h0-93-5" id="h0-93-5" class="i">+{
</a> 	xsettitle(opt_title ? opt_title : &quot;st&quot;);
 }
 
 void
<a href="#h0-93-10" id="h0-93-10" class="d">-redraw(void) {
</a><a href="#h0-93-11" id="h0-93-11" class="i">+redraw(void)
</a><a href="#h0-93-12" id="h0-93-12" class="i">+{
</a> 	tfulldirt();
 	draw();
 }
 
 void
<a href="#h0-93-18" id="h0-93-18" class="d">-draw(void) {
</a><a href="#h0-93-19" id="h0-93-19" class="i">+draw(void)
</a><a href="#h0-93-20" id="h0-93-20" class="i">+{
</a> 	drawregion(0, 0, term.col, term.row);
 	XCopyArea(xw.dpy, xw.buf, xw.win, dc.gc, 0, 0, xw.w,
 			xw.h, 0, 0);
<a href="#h0-94" id="h0-94" class="h">@@ -3658,7 +3769,8 @@ draw(void) {
</a> }
 
 void
<a href="#h0-94-3" id="h0-94-3" class="d">-drawregion(int x1, int y1, int x2, int y2) {
</a><a href="#h0-94-4" id="h0-94-4" class="i">+drawregion(int x1, int y1, int x2, int y2)
</a><a href="#h0-94-5" id="h0-94-5" class="i">+{
</a> 	int i, x, y, ox, numspecs;
 	Glyph base, new;
 	XftGlyphFontSpec* specs;
<a href="#h0-95" id="h0-95" class="h">@@ -3703,30 +3815,35 @@ drawregion(int x1, int y1, int x2, int y2) {
</a> }
 
 void
<a href="#h0-95-3" id="h0-95-3" class="d">-expose(XEvent *ev) {
</a><a href="#h0-95-4" id="h0-95-4" class="i">+expose(XEvent *ev)
</a><a href="#h0-95-5" id="h0-95-5" class="i">+{
</a> 	redraw();
 }
 
 void
<a href="#h0-95-10" id="h0-95-10" class="d">-visibility(XEvent *ev) {
</a><a href="#h0-95-11" id="h0-95-11" class="i">+visibility(XEvent *ev)
</a><a href="#h0-95-12" id="h0-95-12" class="i">+{
</a> 	XVisibilityEvent *e = &amp;ev-&gt;xvisibility;
 
 	MODBIT(xw.state, e-&gt;state != VisibilityFullyObscured, WIN_VISIBLE);
 }
 
 void
<a href="#h0-95-19" id="h0-95-19" class="d">-unmap(XEvent *ev) {
</a><a href="#h0-95-20" id="h0-95-20" class="i">+unmap(XEvent *ev)
</a><a href="#h0-95-21" id="h0-95-21" class="i">+{
</a> 	xw.state &amp;= ~WIN_VISIBLE;
 }
 
 void
<a href="#h0-95-26" id="h0-95-26" class="d">-xsetpointermotion(int set) {
</a><a href="#h0-95-27" id="h0-95-27" class="i">+xsetpointermotion(int set)
</a><a href="#h0-95-28" id="h0-95-28" class="i">+{
</a> 	MODBIT(xw.attrs.event_mask, set, PointerMotionMask);
 	XChangeWindowAttributes(xw.dpy, xw.win, CWEventMask, &amp;xw.attrs);
 }
 
 void
<a href="#h0-95-34" id="h0-95-34" class="d">-xseturgency(int add) {
</a><a href="#h0-95-35" id="h0-95-35" class="i">+xseturgency(int add)
</a><a href="#h0-95-36" id="h0-95-36" class="i">+{
</a> 	XWMHints *h = XGetWMHints(xw.dpy, xw.win);
 
 	MODBIT(h-&gt;flags, add, XUrgencyHint);
<a href="#h0-96" id="h0-96" class="h">@@ -3735,7 +3852,8 @@ xseturgency(int add) {
</a> }
 
 void
<a href="#h0-96-3" id="h0-96-3" class="d">-focus(XEvent *ev) {
</a><a href="#h0-96-4" id="h0-96-4" class="i">+focus(XEvent *ev)
</a><a href="#h0-96-5" id="h0-96-5" class="i">+{
</a> 	XFocusChangeEvent *e = &amp;ev-&gt;xfocus;
 
 	if(e-&gt;mode == NotifyGrab)
<a href="#h0-97" id="h0-97" class="h">@@ -3756,17 +3874,20 @@ focus(XEvent *ev) {
</a> }
 
 int
<a href="#h0-97-3" id="h0-97-3" class="d">-match(uint mask, uint state) {
</a><a href="#h0-97-4" id="h0-97-4" class="i">+match(uint mask, uint state)
</a><a href="#h0-97-5" id="h0-97-5" class="i">+{
</a> 	return mask == XK_ANY_MOD || mask == (state &amp; ~ignoremod);
 }
 
 void
<a href="#h0-97-10" id="h0-97-10" class="d">-numlock(const Arg *dummy) {
</a><a href="#h0-97-11" id="h0-97-11" class="i">+numlock(const Arg *dummy)
</a><a href="#h0-97-12" id="h0-97-12" class="i">+{
</a> 	term.numlock ^= 1;
 }
 
 char*
<a href="#h0-97-17" id="h0-97-17" class="d">-kmap(KeySym k, uint state) {
</a><a href="#h0-97-18" id="h0-97-18" class="i">+kmap(KeySym k, uint state)
</a><a href="#h0-97-19" id="h0-97-19" class="i">+{
</a> 	Key *kp;
 	int i;
 
<a href="#h0-98" id="h0-98" class="h">@@ -3805,7 +3926,8 @@ kmap(KeySym k, uint state) {
</a> }
 
 void
<a href="#h0-98-3" id="h0-98-3" class="d">-kpress(XEvent *ev) {
</a><a href="#h0-98-4" id="h0-98-4" class="i">+kpress(XEvent *ev)
</a><a href="#h0-98-5" id="h0-98-5" class="i">+{
</a> 	XKeyEvent *e = &amp;ev-&gt;xkey;
 	KeySym ksym;
 	char buf[32], *customkey;
<a href="#h0-99" id="h0-99" class="h">@@ -3852,7 +3974,8 @@ kpress(XEvent *ev) {
</a> 
 
 void
<a href="#h0-99-3" id="h0-99-3" class="d">-cmessage(XEvent *e) {
</a><a href="#h0-99-4" id="h0-99-4" class="i">+cmessage(XEvent *e)
</a><a href="#h0-99-5" id="h0-99-5" class="i">+{
</a> 	/*
 	 * See xembed specs
 	 *  http://standards.freedesktop.org/xembed-spec/xembed-spec-latest.html
<a href="#h0-100" id="h0-100" class="h">@@ -3872,7 +3995,8 @@ cmessage(XEvent *e) {
</a> }
 
 void
<a href="#h0-100-3" id="h0-100-3" class="d">-cresize(int width, int height) {
</a><a href="#h0-100-4" id="h0-100-4" class="i">+cresize(int width, int height)
</a><a href="#h0-100-5" id="h0-100-5" class="i">+{
</a> 	int col, row;
 
 	if(width != 0)
<a href="#h0-101" id="h0-101" class="h">@@ -3889,7 +4013,8 @@ cresize(int width, int height) {
</a> }
 
 void
<a href="#h0-101-3" id="h0-101-3" class="d">-resize(XEvent *e) {
</a><a href="#h0-101-4" id="h0-101-4" class="i">+resize(XEvent *e)
</a><a href="#h0-101-5" id="h0-101-5" class="i">+{
</a> 	if(e-&gt;xconfigure.width == xw.w &amp;&amp; e-&gt;xconfigure.height == xw.h)
 		return;
 
<a href="#h0-102" id="h0-102" class="h">@@ -3897,7 +4022,8 @@ resize(XEvent *e) {
</a> }
 
 void
<a href="#h0-102-3" id="h0-102-3" class="d">-run(void) {
</a><a href="#h0-102-4" id="h0-102-4" class="i">+run(void)
</a><a href="#h0-102-5" id="h0-102-5" class="i">+{
</a> 	XEvent ev;
 	int w = xw.w, h = xw.h;
 	fd_set rfd;
<a href="#h0-103" id="h0-103" class="h">@@ -4004,7 +4130,8 @@ run(void) {
</a> }
 
 void
<a href="#h0-103-3" id="h0-103-3" class="d">-usage(void) {
</a><a href="#h0-103-4" id="h0-103-4" class="i">+usage(void)
</a><a href="#h0-103-5" id="h0-103-5" class="i">+{
</a> 	die(&quot;%s &quot; VERSION &quot; (c) 2010-2015 st engineers\n&quot;
 	&quot;usage: st [-a] [-v] [-c class] [-f font] [-g geometry] [-o file]\n&quot;
 	&quot;          [-i] [-t title] [-w windowid] [-e command ...] [command ...]\n&quot;
<a href="#h0-104" id="h0-104" class="h">@@ -4014,7 +4141,8 @@ usage(void) {
</a> }
 
 int
<a href="#h0-104-3" id="h0-104-3" class="d">-main(int argc, char *argv[]) {
</a><a href="#h0-104-4" id="h0-104-4" class="i">+main(int argc, char *argv[])
</a><a href="#h0-104-5" id="h0-104-5" class="i">+{
</a> 	uint cols = 80, rows = 24;
 
 	xw.l = xw.t = 0;
<a href="#h0-105" id="h0-105" class="h">@@ -4075,4 +4203,3 @@ run:
</a> 
 	return 0;
 }
<a href="#h0-105-3" id="h0-105-3" class="d">-
</a></pre>
</div>
</body>
</html>
