<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>use GNU Stow - rice - config file
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="rice Atom Feed" href="../atom.xml" />
<link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="/logo.png" alt="" width="32" height="32" /></a></td><td><h1>rice</h1><span class="desc">config file
</span></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/6b9faaa6ca38658a2d600e034824ca8024fdc028.html">6b9faaa6ca38658a2d600e034824ca8024fdc028</a>
<b>parent</b> <a href="../commit/4701a1fce5ab4069fc9c336b17ff572408680fca.html">4701a1fce5ab4069fc9c336b17ff572408680fca</a>
<b>Author:</b> mark &lt;<a href="mailto:mjf@localhost.localdomain">mjf@localhost.localdomain</a>&gt;
<b>Date:</b>   Fri,  7 Dec 2018 16:56:09 -0700

use GNU Stow

<b>Diffstat:</b>
<table><tr><td class="D">D</td><td><a href="#h0">.config/alacritty/alacritty.yml</a></td><td> | </td><td class="num">457</td><td><span class="i"></span><span class="d">-------------------------------------------------------------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h1">.config/nvim/init.vim</a></td><td> | </td><td class="num">3</td><td><span class="i"></span><span class="d">---</span></td></tr>
<tr><td class="D">D</td><td><a href="#h2">.config/oh-my-zsh</a></td><td> | </td><td class="num">1</td><td><span class="i"></span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">.gitignore</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h4">.oh-my-zsh</a></td><td> | </td><td class="num">1</td><td><span class="i"></span><span class="d">-</span></td></tr>
<tr><td class="D">D</td><td><a href="#h5">.scripts/compiler</a></td><td> | </td><td class="num">34</td><td><span class="i"></span><span class="d">----------------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h6">.vim/autoload/plug.vim</a></td><td> | </td><td class="num">2458</td><td><span class="i"></span><span class="d">-------------------------------------------------------------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h7">.vimrc</a></td><td> | </td><td class="num">25</td><td><span class="i"></span><span class="d">-------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h8">.zshenv</a></td><td> | </td><td class="num">50</td><td><span class="i"></span><span class="d">--------------------------------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h9">.zshrc</a></td><td> | </td><td class="num">77</td><td><span class="i"></span><span class="d">-----------------------------------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">README</a></td><td> | </td><td class="num">29</td><td><span class="i">+++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h11">dots/.bin/alacritty</a></td><td> | </td><td class="num">0</td><td><span class="i"></span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h12">dots/.bin/lock</a></td><td> | </td><td class="num">13</td><td><span class="i">+++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h13">dots/.bin/settings</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h14">dots/.config/alacritty/alacritty.yml</a></td><td> | </td><td class="num">460</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="R">R</td><td><a href="#h15">.config/htop/htoprc -&gt; dots/.config/htop/htoprc</a></td><td> | </td><td class="num">0</td><td><span class="i"></span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h16">dots/.config/i3/config</a></td><td> | </td><td class="num">223</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h17">dots/.config/i3status/config</a></td><td> | </td><td class="num">45</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="R">R</td><td><a href="#h18">.config/mpd/mpd.conf -&gt; dots/.config/mpd/mpd.conf</a></td><td> | </td><td class="num">0</td><td><span class="i"></span><span class="d"></span></td></tr>
<tr><td class="R">R</td><td><a href="#h19">.config/ncmpcpp/bindings -&gt; dots/.config/ncmpcpp/bindings</a></td><td> | </td><td class="num">0</td><td><span class="i"></span><span class="d"></span></td></tr>
<tr><td class="R">R</td><td><a href="#h20">.config/ncmpcpp/config -&gt; dots/.config/ncmpcpp/config</a></td><td> | </td><td class="num">0</td><td><span class="i"></span><span class="d"></span></td></tr>
<tr><td class="R">R</td><td><a href="#h21">.config/neofetch/config.conf -&gt; dots/.config/neofetch/config.conf</a></td><td> | </td><td class="num">0</td><td><span class="i"></span><span class="d"></span></td></tr>
<tr><td class="R">R</td><td><a href="#h22">.config/notmuch/config -&gt; dots/.config/notmuch/config</a></td><td> | </td><td class="num">0</td><td><span class="i"></span><span class="d"></span></td></tr>
<tr><td class="R">R</td><td><a href="#h23">.config/zsh/.zcompdump -&gt; dots/.config/zsh/.zcompdump</a></td><td> | </td><td class="num">0</td><td><span class="i"></span><span class="d"></span></td></tr>
<tr><td class="R">R</td><td><a href="#h24">.config/zsh/.zsh-update -&gt; dots/.config/zsh/.zsh-update</a></td><td> | </td><td class="num">0</td><td><span class="i"></span><span class="d"></span></td></tr>
<tr><td class="R">R</td><td><a href="#h25">.config/zsh/oh-my-zsh.sh -&gt; dots/.config/zsh/oh-my-zsh.sh</a></td><td> | </td><td class="num">0</td><td><span class="i"></span><span class="d"></span></td></tr>
<tr><td class="R">R</td><td><a href="#h26">.tmux.conf -&gt; dots/.tmux.conf</a></td><td> | </td><td class="num">0</td><td><span class="i"></span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h27">dots/.vim/autoload/plug.vim</a></td><td> | </td><td class="num">2526</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h28">dots/.vimrc</a></td><td> | </td><td class="num">26</td><td><span class="i">++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h29">dots/.zshenv</a></td><td> | </td><td class="num">51</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h30">dots/.zshrc</a></td><td> | </td><td class="num">77</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="D">D</td><td><a href="#h31">link.sh</a></td><td> | </td><td class="num">36</td><td><span class="i"></span><span class="d">------------------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h32">progs.csv</a></td><td> | </td><td class="num">23</td><td><span class="i"></span><span class="d">-----------------------</span></td></tr>
</table></pre><pre>33 files changed, 3454 insertions(+), 3167 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/.config/alacritty/alacritty.yml.html">.config/alacritty/alacritty.yml</a> b/<a href="../file/.config/alacritty/alacritty.yml.html">.config/alacritty/alacritty.yml</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -1,457 +0,0 @@
</a><a href="#h0-0-0" id="h0-0-0" class="d">-# Configuration for Alacritty, the GPU enhanced terminal emulator
</a><a href="#h0-0-1" id="h0-0-1" class="d">-
</a><a href="#h0-0-2" id="h0-0-2" class="d">-# Any items in the `env` entry below will be added as
</a><a href="#h0-0-3" id="h0-0-3" class="d">-# environment variables. Some entries may override variables
</a><a href="#h0-0-4" id="h0-0-4" class="d">-# set by alacritty it self.
</a><a href="#h0-0-5" id="h0-0-5" class="d">-env:
</a><a href="#h0-0-6" id="h0-0-6" class="d">-  # TERM env customization.
</a><a href="#h0-0-7" id="h0-0-7" class="d">-  #
</a><a href="#h0-0-8" id="h0-0-8" class="d">-  # If this property is not set, alacritty will set it to xterm-256color.
</a><a href="#h0-0-9" id="h0-0-9" class="d">-  #
</a><a href="#h0-0-10" id="h0-0-10" class="d">-  # Note that some xterm terminfo databases don&#39;t declare support for italics.
</a><a href="#h0-0-11" id="h0-0-11" class="d">-  # You can verify this by checking for the presence of `smso` and `sitm` in
</a><a href="#h0-0-12" id="h0-0-12" class="d">-  # `infocmp xterm-256color`.
</a><a href="#h0-0-13" id="h0-0-13" class="d">-  TERM: xterm-256color
</a><a href="#h0-0-14" id="h0-0-14" class="d">-
</a><a href="#h0-0-15" id="h0-0-15" class="d">-window:
</a><a href="#h0-0-16" id="h0-0-16" class="d">-  # Window dimensions in character columns and lines
</a><a href="#h0-0-17" id="h0-0-17" class="d">-  # (changes require restart)
</a><a href="#h0-0-18" id="h0-0-18" class="d">-  dimensions:
</a><a href="#h0-0-19" id="h0-0-19" class="d">-    columns: 160
</a><a href="#h0-0-20" id="h0-0-20" class="d">-    lines: 50
</a><a href="#h0-0-21" id="h0-0-21" class="d">-
</a><a href="#h0-0-22" id="h0-0-22" class="d">-  # Adds this many blank pixels of padding around the window
</a><a href="#h0-0-23" id="h0-0-23" class="d">-  # Units are physical pixels; this is not DPI aware.
</a><a href="#h0-0-24" id="h0-0-24" class="d">-  # (change requires restart)
</a><a href="#h0-0-25" id="h0-0-25" class="d">-  padding:
</a><a href="#h0-0-26" id="h0-0-26" class="d">-    x: 45
</a><a href="#h0-0-27" id="h0-0-27" class="d">-    y: 45
</a><a href="#h0-0-28" id="h0-0-28" class="d">-
</a><a href="#h0-0-29" id="h0-0-29" class="d">-  # Window decorations
</a><a href="#h0-0-30" id="h0-0-30" class="d">-  # Setting this to false will result in window without borders and title bar.
</a><a href="#h0-0-31" id="h0-0-31" class="d">-  decorations: transparent
</a><a href="#h0-0-32" id="h0-0-32" class="d">-
</a><a href="#h0-0-33" id="h0-0-33" class="d">-# Display tabs using this many cells (changes require restart)
</a><a href="#h0-0-34" id="h0-0-34" class="d">-tabspaces: 8
</a><a href="#h0-0-35" id="h0-0-35" class="d">-
</a><a href="#h0-0-36" id="h0-0-36" class="d">-# When true, bold text is drawn using the bright variant of colors.
</a><a href="#h0-0-37" id="h0-0-37" class="d">-draw_bold_text_with_bright_colors: true
</a><a href="#h0-0-38" id="h0-0-38" class="d">-
</a><a href="#h0-0-39" id="h0-0-39" class="d">-# Font configuration (changes require restart)
</a><a href="#h0-0-40" id="h0-0-40" class="d">-font:
</a><a href="#h0-0-41" id="h0-0-41" class="d">-  # The normal (roman) font face to use.
</a><a href="#h0-0-42" id="h0-0-42" class="d">-  normal:
</a><a href="#h0-0-43" id="h0-0-43" class="d">-    family: Fira Mono
</a><a href="#h0-0-44" id="h0-0-44" class="d">-    # Style can be specified to pick a specific face.
</a><a href="#h0-0-45" id="h0-0-45" class="d">-    # style: Regular
</a><a href="#h0-0-46" id="h0-0-46" class="d">-
</a><a href="#h0-0-47" id="h0-0-47" class="d">-  # The bold font face
</a><a href="#h0-0-48" id="h0-0-48" class="d">-  bold:
</a><a href="#h0-0-49" id="h0-0-49" class="d">-    family: Fira Mono
</a><a href="#h0-0-50" id="h0-0-50" class="d">-    # Style can be specified to pick a specific face.
</a><a href="#h0-0-51" id="h0-0-51" class="d">-    # style: Bold
</a><a href="#h0-0-52" id="h0-0-52" class="d">-
</a><a href="#h0-0-53" id="h0-0-53" class="d">-  # The italic font face
</a><a href="#h0-0-54" id="h0-0-54" class="d">-  italic:
</a><a href="#h0-0-55" id="h0-0-55" class="d">-    family: Fira Mono
</a><a href="#h0-0-56" id="h0-0-56" class="d">-    # Style can be specified to pick a specific face.
</a><a href="#h0-0-57" id="h0-0-57" class="d">-    # style: Italic
</a><a href="#h0-0-58" id="h0-0-58" class="d">-
</a><a href="#h0-0-59" id="h0-0-59" class="d">-  # Point size of the font
</a><a href="#h0-0-60" id="h0-0-60" class="d">-  size: 12.0
</a><a href="#h0-0-61" id="h0-0-61" class="d">-
</a><a href="#h0-0-62" id="h0-0-62" class="d">-  # Offset is the extra space around each character. offset.y can be thought of
</a><a href="#h0-0-63" id="h0-0-63" class="d">-  # as modifying the linespacing, and offset.x as modifying the letter spacing.
</a><a href="#h0-0-64" id="h0-0-64" class="d">-  offset:
</a><a href="#h0-0-65" id="h0-0-65" class="d">-    x: 0
</a><a href="#h0-0-66" id="h0-0-66" class="d">-    y: 0
</a><a href="#h0-0-67" id="h0-0-67" class="d">-
</a><a href="#h0-0-68" id="h0-0-68" class="d">-  # Glyph offset determines the locations of the glyphs within their cells with
</a><a href="#h0-0-69" id="h0-0-69" class="d">-  # the default being at the bottom. Increase the x offset to move the glyph to
</a><a href="#h0-0-70" id="h0-0-70" class="d">-  # the right, increase the y offset to move the glyph upward.
</a><a href="#h0-0-71" id="h0-0-71" class="d">-  glyph_offset:
</a><a href="#h0-0-72" id="h0-0-72" class="d">-    x: 0
</a><a href="#h0-0-73" id="h0-0-73" class="d">-    y: 0
</a><a href="#h0-0-74" id="h0-0-74" class="d">-
</a><a href="#h0-0-75" id="h0-0-75" class="d">-  # OS X only: use thin stroke font rendering. Thin strokes are suitable
</a><a href="#h0-0-76" id="h0-0-76" class="d">-  # for retina displays, but for non-retina you probably want this set to
</a><a href="#h0-0-77" id="h0-0-77" class="d">-  # false.
</a><a href="#h0-0-78" id="h0-0-78" class="d">-  use_thin_strokes: false
</a><a href="#h0-0-79" id="h0-0-79" class="d">-
</a><a href="#h0-0-80" id="h0-0-80" class="d">-# Should display the render timer
</a><a href="#h0-0-81" id="h0-0-81" class="d">-render_timer: false
</a><a href="#h0-0-82" id="h0-0-82" class="d">-
</a><a href="#h0-0-83" id="h0-0-83" class="d">-# Use custom cursor colors. If true, display the cursor in the cursor.foreground
</a><a href="#h0-0-84" id="h0-0-84" class="d">-# and cursor.background colors, otherwise invert the colors of the cursor.
</a><a href="#h0-0-85" id="h0-0-85" class="d">-custom_cursor_colors: false
</a><a href="#h0-0-86" id="h0-0-86" class="d">-
</a><a href="#h0-0-87" id="h0-0-87" class="d">-# Colors (Tomorrow Night Bright)
</a><a href="#h0-0-88" id="h0-0-88" class="d">-colors:
</a><a href="#h0-0-89" id="h0-0-89" class="d">-  # Default colors
</a><a href="#h0-0-90" id="h0-0-90" class="d">-  primary:
</a><a href="#h0-0-91" id="h0-0-91" class="d">-    background: &#39;#1d2021&#39;
</a><a href="#h0-0-92" id="h0-0-92" class="d">-    foreground: &#39;#ebdbb2&#39;
</a><a href="#h0-0-93" id="h0-0-93" class="d">-
</a><a href="#h0-0-94" id="h0-0-94" class="d">-  # Colors the cursor will use if `custom_cursor_colors` is true
</a><a href="#h0-0-95" id="h0-0-95" class="d">-  cursor:
</a><a href="#h0-0-96" id="h0-0-96" class="d">-    text: &#39;#282828&#39;
</a><a href="#h0-0-97" id="h0-0-97" class="d">-    cursor: &#39;#ebdbb2&#39;
</a><a href="#h0-0-98" id="h0-0-98" class="d">-
</a><a href="#h0-0-99" id="h0-0-99" class="d">-  # Normal colors
</a><a href="#h0-0-100" id="h0-0-100" class="d">-  normal:
</a><a href="#h0-0-101" id="h0-0-101" class="d">-    black:   &#39;#282828&#39;
</a><a href="#h0-0-102" id="h0-0-102" class="d">-    red:     &#39;#cc241d&#39;
</a><a href="#h0-0-103" id="h0-0-103" class="d">-    green:   &#39;#98971a&#39;
</a><a href="#h0-0-104" id="h0-0-104" class="d">-    yellow:  &#39;#d79921&#39;
</a><a href="#h0-0-105" id="h0-0-105" class="d">-    blue:    &#39;#458588&#39;
</a><a href="#h0-0-106" id="h0-0-106" class="d">-    magenta: &#39;#b16286&#39;
</a><a href="#h0-0-107" id="h0-0-107" class="d">-    cyan:    &#39;#689d6a&#39;
</a><a href="#h0-0-108" id="h0-0-108" class="d">-    white:   &#39;#a89984&#39;
</a><a href="#h0-0-109" id="h0-0-109" class="d">-
</a><a href="#h0-0-110" id="h0-0-110" class="d">-  # Bright colors
</a><a href="#h0-0-111" id="h0-0-111" class="d">-  bright:
</a><a href="#h0-0-112" id="h0-0-112" class="d">-    black:   &#39;#928374&#39;
</a><a href="#h0-0-113" id="h0-0-113" class="d">-    red:     &#39;#fb4934&#39;
</a><a href="#h0-0-114" id="h0-0-114" class="d">-    green:   &#39;#b8bb26&#39;
</a><a href="#h0-0-115" id="h0-0-115" class="d">-    yellow:  &#39;#fabd2f&#39;
</a><a href="#h0-0-116" id="h0-0-116" class="d">-    blue:    &#39;#83a598&#39;
</a><a href="#h0-0-117" id="h0-0-117" class="d">-    magenta: &#39;#d3869b&#39;
</a><a href="#h0-0-118" id="h0-0-118" class="d">-    cyan:    &#39;#8ec07c&#39;
</a><a href="#h0-0-119" id="h0-0-119" class="d">-    white:   &#39;#ebdbb2&#39;
</a><a href="#h0-0-120" id="h0-0-120" class="d">-
</a><a href="#h0-0-121" id="h0-0-121" class="d">-  # # Dim colors (Optional)
</a><a href="#h0-0-122" id="h0-0-122" class="d">-  # dim:
</a><a href="#h0-0-123" id="h0-0-123" class="d">-  #   black:   &#39;0x333333&#39;
</a><a href="#h0-0-124" id="h0-0-124" class="d">-  #   red:     &#39;0xf2777a&#39;
</a><a href="#h0-0-125" id="h0-0-125" class="d">-  #   green:   &#39;0x99cc99&#39;
</a><a href="#h0-0-126" id="h0-0-126" class="d">-  #   yellow:  &#39;0xffcc66&#39;
</a><a href="#h0-0-127" id="h0-0-127" class="d">-  #   blue:    &#39;0x6699cc&#39;
</a><a href="#h0-0-128" id="h0-0-128" class="d">-  #   magenta: &#39;0xcc99cc&#39;
</a><a href="#h0-0-129" id="h0-0-129" class="d">-  #   cyan:    &#39;0x66cccc&#39;
</a><a href="#h0-0-130" id="h0-0-130" class="d">-  #   white:   &#39;0xdddddd&#39;
</a><a href="#h0-0-131" id="h0-0-131" class="d">-
</a><a href="#h0-0-132" id="h0-0-132" class="d">-
</a><a href="#h0-0-133" id="h0-0-133" class="d">-# Visual Bell
</a><a href="#h0-0-134" id="h0-0-134" class="d">-#
</a><a href="#h0-0-135" id="h0-0-135" class="d">-# Any time the BEL code is received, Alacritty &quot;rings&quot; the visual bell. Once
</a><a href="#h0-0-136" id="h0-0-136" class="d">-# rung, the terminal background will be set to white and transition back to the
</a><a href="#h0-0-137" id="h0-0-137" class="d">-# default background color. You can control the rate of this transition by
</a><a href="#h0-0-138" id="h0-0-138" class="d">-# setting the `duration` property (represented in milliseconds). You can also
</a><a href="#h0-0-139" id="h0-0-139" class="d">-# configure the transition function by setting the `animation` property.
</a><a href="#h0-0-140" id="h0-0-140" class="d">-#
</a><a href="#h0-0-141" id="h0-0-141" class="d">-# Possible values for `animation`
</a><a href="#h0-0-142" id="h0-0-142" class="d">-# `Ease`
</a><a href="#h0-0-143" id="h0-0-143" class="d">-# `EaseOut`
</a><a href="#h0-0-144" id="h0-0-144" class="d">-# `EaseOutSine`
</a><a href="#h0-0-145" id="h0-0-145" class="d">-# `EaseOutQuad`
</a><a href="#h0-0-146" id="h0-0-146" class="d">-# `EaseOutCubic`
</a><a href="#h0-0-147" id="h0-0-147" class="d">-# `EaseOutQuart`
</a><a href="#h0-0-148" id="h0-0-148" class="d">-# `EaseOutQuint`
</a><a href="#h0-0-149" id="h0-0-149" class="d">-# `EaseOutExpo`
</a><a href="#h0-0-150" id="h0-0-150" class="d">-# `EaseOutCirc`
</a><a href="#h0-0-151" id="h0-0-151" class="d">-# `Linear`
</a><a href="#h0-0-152" id="h0-0-152" class="d">-#
</a><a href="#h0-0-153" id="h0-0-153" class="d">-# To completely disable the visual bell, set its duration to 0.
</a><a href="#h0-0-154" id="h0-0-154" class="d">-#
</a><a href="#h0-0-155" id="h0-0-155" class="d">-visual_bell:
</a><a href="#h0-0-156" id="h0-0-156" class="d">-  animation: EaseOutExpo
</a><a href="#h0-0-157" id="h0-0-157" class="d">-  duration: 0
</a><a href="#h0-0-158" id="h0-0-158" class="d">-
</a><a href="#h0-0-159" id="h0-0-159" class="d">-# Background opacity
</a><a href="#h0-0-160" id="h0-0-160" class="d">-background_opacity: 1.0
</a><a href="#h0-0-161" id="h0-0-161" class="d">-
</a><a href="#h0-0-162" id="h0-0-162" class="d">-# Mouse bindings
</a><a href="#h0-0-163" id="h0-0-163" class="d">-#
</a><a href="#h0-0-164" id="h0-0-164" class="d">-# Currently doesn&#39;t support modifiers. Both the `mouse` and `action` fields must
</a><a href="#h0-0-165" id="h0-0-165" class="d">-# be specified.
</a><a href="#h0-0-166" id="h0-0-166" class="d">-#
</a><a href="#h0-0-167" id="h0-0-167" class="d">-# Values for `mouse`:
</a><a href="#h0-0-168" id="h0-0-168" class="d">-# - Middle
</a><a href="#h0-0-169" id="h0-0-169" class="d">-# - Left
</a><a href="#h0-0-170" id="h0-0-170" class="d">-# - Right
</a><a href="#h0-0-171" id="h0-0-171" class="d">-# - Numeric identifier such as `5`
</a><a href="#h0-0-172" id="h0-0-172" class="d">-#
</a><a href="#h0-0-173" id="h0-0-173" class="d">-# Values for `action`:
</a><a href="#h0-0-174" id="h0-0-174" class="d">-# - Paste
</a><a href="#h0-0-175" id="h0-0-175" class="d">-# - PasteSelection
</a><a href="#h0-0-176" id="h0-0-176" class="d">-# - Copy (TODO)
</a><a href="#h0-0-177" id="h0-0-177" class="d">-mouse_bindings:
</a><a href="#h0-0-178" id="h0-0-178" class="d">-  - { mouse: Middle, action: PasteSelection }
</a><a href="#h0-0-179" id="h0-0-179" class="d">-
</a><a href="#h0-0-180" id="h0-0-180" class="d">-mouse:
</a><a href="#h0-0-181" id="h0-0-181" class="d">-  # Click settings
</a><a href="#h0-0-182" id="h0-0-182" class="d">-  #
</a><a href="#h0-0-183" id="h0-0-183" class="d">-  # The `double_click` and `triple_click` settings control the time
</a><a href="#h0-0-184" id="h0-0-184" class="d">-  # alacritty should wait for accepting multiple clicks as one double
</a><a href="#h0-0-185" id="h0-0-185" class="d">-  # or triple click.
</a><a href="#h0-0-186" id="h0-0-186" class="d">-  double_click: { threshold: 300 }
</a><a href="#h0-0-187" id="h0-0-187" class="d">-  triple_click: { threshold: 300 }
</a><a href="#h0-0-188" id="h0-0-188" class="d">-
</a><a href="#h0-0-189" id="h0-0-189" class="d">-  # Faux Scrollback
</a><a href="#h0-0-190" id="h0-0-190" class="d">-  #
</a><a href="#h0-0-191" id="h0-0-191" class="d">-  # The `faux_scrollback_lines` setting controls the number
</a><a href="#h0-0-192" id="h0-0-192" class="d">-  # of lines the terminal should scroll when the alternate
</a><a href="#h0-0-193" id="h0-0-193" class="d">-  # screen buffer is active. This is used to allow mouse
</a><a href="#h0-0-194" id="h0-0-194" class="d">-  # scrolling for applications like `man`.
</a><a href="#h0-0-195" id="h0-0-195" class="d">-  #
</a><a href="#h0-0-196" id="h0-0-196" class="d">-  # To disable this completely, set `faux_scrollback_lines` to 0.
</a><a href="#h0-0-197" id="h0-0-197" class="d">-  faux_scrollback_lines: 1
</a><a href="#h0-0-198" id="h0-0-198" class="d">-
</a><a href="#h0-0-199" id="h0-0-199" class="d">-selection:
</a><a href="#h0-0-200" id="h0-0-200" class="d">-  semantic_escape_chars: &quot;,│`|:\&quot;&#39; ()[]{}&lt;&gt;&quot;
</a><a href="#h0-0-201" id="h0-0-201" class="d">-
</a><a href="#h0-0-202" id="h0-0-202" class="d">-dynamic_title: true
</a><a href="#h0-0-203" id="h0-0-203" class="d">-
</a><a href="#h0-0-204" id="h0-0-204" class="d">-hide_cursor_when_typing: true
</a><a href="#h0-0-205" id="h0-0-205" class="d">-
</a><a href="#h0-0-206" id="h0-0-206" class="d">-# Style of the cursor
</a><a href="#h0-0-207" id="h0-0-207" class="d">-#
</a><a href="#h0-0-208" id="h0-0-208" class="d">-# Values for &#39;cursor_style&#39;:
</a><a href="#h0-0-209" id="h0-0-209" class="d">-# - Block
</a><a href="#h0-0-210" id="h0-0-210" class="d">-# - Underline
</a><a href="#h0-0-211" id="h0-0-211" class="d">-# - Beam
</a><a href="#h0-0-212" id="h0-0-212" class="d">-cursor_style: Block
</a><a href="#h0-0-213" id="h0-0-213" class="d">-
</a><a href="#h0-0-214" id="h0-0-214" class="d">-# Live config reload (changes require restart)
</a><a href="#h0-0-215" id="h0-0-215" class="d">-live_config_reload: true
</a><a href="#h0-0-216" id="h0-0-216" class="d">-
</a><a href="#h0-0-217" id="h0-0-217" class="d">-# Shell
</a><a href="#h0-0-218" id="h0-0-218" class="d">-#
</a><a href="#h0-0-219" id="h0-0-219" class="d">-# You can set shell.program to the path of your favorite shell, e.g. /bin/fish.
</a><a href="#h0-0-220" id="h0-0-220" class="d">-# Entries in shell.args are passed unmodified as arguments to the shell.
</a><a href="#h0-0-221" id="h0-0-221" class="d">-#
</a><a href="#h0-0-222" id="h0-0-222" class="d">-shell:
</a><a href="#h0-0-223" id="h0-0-223" class="d">-  program: /bin/zsh
</a><a href="#h0-0-224" id="h0-0-224" class="d">-#   args:
</a><a href="#h0-0-225" id="h0-0-225" class="d">-#     - --login
</a><a href="#h0-0-226" id="h0-0-226" class="d">-
</a><a href="#h0-0-227" id="h0-0-227" class="d">-# Key bindings
</a><a href="#h0-0-228" id="h0-0-228" class="d">-#
</a><a href="#h0-0-229" id="h0-0-229" class="d">-# Each binding is defined as an object with some properties. Most of the
</a><a href="#h0-0-230" id="h0-0-230" class="d">-# properties are optional. All of the alphabetical keys should have a letter for
</a><a href="#h0-0-231" id="h0-0-231" class="d">-# the `key` value such as `V`. Function keys are probably what you would expect
</a><a href="#h0-0-232" id="h0-0-232" class="d">-# as well (F1, F2, ..). The number keys above the main keyboard are encoded as
</a><a href="#h0-0-233" id="h0-0-233" class="d">-# `Key1`, `Key2`, etc. Keys on the number pad are encoded `Number1`, `Number2`,
</a><a href="#h0-0-234" id="h0-0-234" class="d">-# etc.  These all match the glutin::VirtualKeyCode variants.
</a><a href="#h0-0-235" id="h0-0-235" class="d">-#
</a><a href="#h0-0-236" id="h0-0-236" class="d">-# A list with all available `key` names can be found here:
</a><a href="#h0-0-237" id="h0-0-237" class="d">-# https://docs.rs/glutin/*/glutin/enum.VirtualKeyCode.html#variants
</a><a href="#h0-0-238" id="h0-0-238" class="d">-#
</a><a href="#h0-0-239" id="h0-0-239" class="d">-# Possible values for `mods`
</a><a href="#h0-0-240" id="h0-0-240" class="d">-# `Command`, `Super` refer to the super/command/windows key
</a><a href="#h0-0-241" id="h0-0-241" class="d">-# `Control` for the control key
</a><a href="#h0-0-242" id="h0-0-242" class="d">-# `Shift` for the Shift key
</a><a href="#h0-0-243" id="h0-0-243" class="d">-# `Alt` and `Option` refer to alt/option
</a><a href="#h0-0-244" id="h0-0-244" class="d">-#
</a><a href="#h0-0-245" id="h0-0-245" class="d">-# mods may be combined with a `|`. For example, requiring control and shift
</a><a href="#h0-0-246" id="h0-0-246" class="d">-# looks like:
</a><a href="#h0-0-247" id="h0-0-247" class="d">-#
</a><a href="#h0-0-248" id="h0-0-248" class="d">-# mods: Control|Shift
</a><a href="#h0-0-249" id="h0-0-249" class="d">-#
</a><a href="#h0-0-250" id="h0-0-250" class="d">-# The parser is currently quite sensitive to whitespace and capitalization -
</a><a href="#h0-0-251" id="h0-0-251" class="d">-# capitalization must match exactly, and piped items must not have whitespace
</a><a href="#h0-0-252" id="h0-0-252" class="d">-# around them.
</a><a href="#h0-0-253" id="h0-0-253" class="d">-#
</a><a href="#h0-0-254" id="h0-0-254" class="d">-# Either an `action`, `chars`, or `command` field must be present.
</a><a href="#h0-0-255" id="h0-0-255" class="d">-#   `action` must be one of `Paste`, `PasteSelection`, `Copy`, or `Quit`.
</a><a href="#h0-0-256" id="h0-0-256" class="d">-#   `chars` writes the specified string every time that binding is activated.
</a><a href="#h0-0-257" id="h0-0-257" class="d">-#     These should generally be escape sequences, but they can be configured to
</a><a href="#h0-0-258" id="h0-0-258" class="d">-#     send arbitrary strings of bytes.
</a><a href="#h0-0-259" id="h0-0-259" class="d">-#   `command` must be a map containing a `program` string, and `args` array of
</a><a href="#h0-0-260" id="h0-0-260" class="d">-#     strings. For example:
</a><a href="#h0-0-261" id="h0-0-261" class="d">-#     - { ... , command: { program: &quot;alacritty&quot;, args: [&quot;-e&quot;, &quot;vttest&quot;] } }
</a><a href="#h0-0-262" id="h0-0-262" class="d">-key_bindings:
</a><a href="#h0-0-263" id="h0-0-263" class="d">-  - { key: V,        mods: Command, action: Paste                        }
</a><a href="#h0-0-264" id="h0-0-264" class="d">-  - { key: C,        mods: Command, action: Copy                         }
</a><a href="#h0-0-265" id="h0-0-265" class="d">-  - { key: Q,        mods: Command, action: Quit                         }
</a><a href="#h0-0-266" id="h0-0-266" class="d">-  - { key: W,        mods: Command, action: Quit                         }
</a><a href="#h0-0-267" id="h0-0-267" class="d">-  - { key: Home,                    chars: &quot;\x1bOH&quot;,   mode: AppCursor   }
</a><a href="#h0-0-268" id="h0-0-268" class="d">-  - { key: Home,                    chars: &quot;\x1b[H&quot;,   mode: ~AppCursor  }
</a><a href="#h0-0-269" id="h0-0-269" class="d">-  - { key: End,                     chars: &quot;\x1bOF&quot;,   mode: AppCursor   }
</a><a href="#h0-0-270" id="h0-0-270" class="d">-  - { key: End,                     chars: &quot;\x1b[F&quot;,   mode: ~AppCursor  }
</a><a href="#h0-0-271" id="h0-0-271" class="d">-  - { key: Key0,     mods: Command, action: ResetFontSize                }
</a><a href="#h0-0-272" id="h0-0-272" class="d">-  - { key: Equals,   mods: Command, action: IncreaseFontSize             }
</a><a href="#h0-0-273" id="h0-0-273" class="d">-  - { key: Minus,    mods: Command, action: DecreaseFontSize             }
</a><a href="#h0-0-274" id="h0-0-274" class="d">-  - { key: PageUp,   mods: Shift,   chars: &quot;\x1b[5;2~&quot;                   }
</a><a href="#h0-0-275" id="h0-0-275" class="d">-  - { key: PageUp,   mods: Control, chars: &quot;\x1b[5;5~&quot;                   }
</a><a href="#h0-0-276" id="h0-0-276" class="d">-  - { key: PageUp,                  chars: &quot;\x1b[5~&quot;                     }
</a><a href="#h0-0-277" id="h0-0-277" class="d">-  - { key: PageDown, mods: Shift,   chars: &quot;\x1b[6;2~&quot;                   }
</a><a href="#h0-0-278" id="h0-0-278" class="d">-  - { key: PageDown, mods: Control, chars: &quot;\x1b[6;5~&quot;                   }
</a><a href="#h0-0-279" id="h0-0-279" class="d">-  - { key: PageDown,                chars: &quot;\x1b[6~&quot;                     }
</a><a href="#h0-0-280" id="h0-0-280" class="d">-  - { key: Tab,      mods: Shift,   chars: &quot;\x1b[Z&quot;                      }
</a><a href="#h0-0-281" id="h0-0-281" class="d">-  - { key: Back,                    chars: &quot;\x7f&quot;                        }
</a><a href="#h0-0-282" id="h0-0-282" class="d">-  - { key: Back,     mods: Alt,     chars: &quot;\x1b\x7f&quot;                    }
</a><a href="#h0-0-283" id="h0-0-283" class="d">-  - { key: Insert,                  chars: &quot;\x1b[2~&quot;                     }
</a><a href="#h0-0-284" id="h0-0-284" class="d">-  - { key: Delete,                  chars: &quot;\x1b[3~&quot;                     }
</a><a href="#h0-0-285" id="h0-0-285" class="d">-  - { key: Left,     mods: Shift,   chars: &quot;\x1b[1;2D&quot;                   }
</a><a href="#h0-0-286" id="h0-0-286" class="d">-  - { key: Left,     mods: Control, chars: &quot;\x1b[1;5D&quot;                   }
</a><a href="#h0-0-287" id="h0-0-287" class="d">-  - { key: Left,     mods: Alt,     chars: &quot;\x1b[1;3D&quot;                   }
</a><a href="#h0-0-288" id="h0-0-288" class="d">-  - { key: Left,                    chars: &quot;\x1b[D&quot;,   mode: ~AppCursor  }
</a><a href="#h0-0-289" id="h0-0-289" class="d">-  - { key: Left,                    chars: &quot;\x1bOD&quot;,   mode: AppCursor   }
</a><a href="#h0-0-290" id="h0-0-290" class="d">-  - { key: Right,    mods: Shift,   chars: &quot;\x1b[1;2C&quot;                   }
</a><a href="#h0-0-291" id="h0-0-291" class="d">-  - { key: Right,    mods: Control, chars: &quot;\x1b[1;5C&quot;                   }
</a><a href="#h0-0-292" id="h0-0-292" class="d">-  - { key: Right,    mods: Alt,     chars: &quot;\x1b[1;3C&quot;                   }
</a><a href="#h0-0-293" id="h0-0-293" class="d">-  - { key: Right,                   chars: &quot;\x1b[C&quot;,   mode: ~AppCursor  }
</a><a href="#h0-0-294" id="h0-0-294" class="d">-  - { key: Right,                   chars: &quot;\x1bOC&quot;,   mode: AppCursor   }
</a><a href="#h0-0-295" id="h0-0-295" class="d">-  - { key: Up,       mods: Shift,   chars: &quot;\x1b[1;2A&quot;                   }
</a><a href="#h0-0-296" id="h0-0-296" class="d">-  - { key: Up,       mods: Control, chars: &quot;\x1b[1;5A&quot;                   }
</a><a href="#h0-0-297" id="h0-0-297" class="d">-  - { key: Up,       mods: Alt,     chars: &quot;\x1b[1;3A&quot;                   }
</a><a href="#h0-0-298" id="h0-0-298" class="d">-  - { key: Up,                      chars: &quot;\x1b[A&quot;,   mode: ~AppCursor  }
</a><a href="#h0-0-299" id="h0-0-299" class="d">-  - { key: Up,                      chars: &quot;\x1bOA&quot;,   mode: AppCursor   }
</a><a href="#h0-0-300" id="h0-0-300" class="d">-  - { key: Down,     mods: Shift,   chars: &quot;\x1b[1;2B&quot;                   }
</a><a href="#h0-0-301" id="h0-0-301" class="d">-  - { key: Down,     mods: Control, chars: &quot;\x1b[1;5B&quot;                   }
</a><a href="#h0-0-302" id="h0-0-302" class="d">-  - { key: Down,     mods: Alt,     chars: &quot;\x1b[1;3B&quot;                   }
</a><a href="#h0-0-303" id="h0-0-303" class="d">-  - { key: Down,                    chars: &quot;\x1b[B&quot;,   mode: ~AppCursor  }
</a><a href="#h0-0-304" id="h0-0-304" class="d">-  - { key: Down,                    chars: &quot;\x1bOB&quot;,   mode: AppCursor   }
</a><a href="#h0-0-305" id="h0-0-305" class="d">-  - { key: F1,                      chars: &quot;\x1bOP&quot;                      }
</a><a href="#h0-0-306" id="h0-0-306" class="d">-  - { key: F2,                      chars: &quot;\x1bOQ&quot;                      }
</a><a href="#h0-0-307" id="h0-0-307" class="d">-  - { key: F3,                      chars: &quot;\x1bOR&quot;                      }
</a><a href="#h0-0-308" id="h0-0-308" class="d">-  - { key: F4,                      chars: &quot;\x1bOS&quot;                      }
</a><a href="#h0-0-309" id="h0-0-309" class="d">-  - { key: F5,                      chars: &quot;\x1b[15~&quot;                    }
</a><a href="#h0-0-310" id="h0-0-310" class="d">-  - { key: F6,                      chars: &quot;\x1b[17~&quot;                    }
</a><a href="#h0-0-311" id="h0-0-311" class="d">-  - { key: F7,                      chars: &quot;\x1b[18~&quot;                    }
</a><a href="#h0-0-312" id="h0-0-312" class="d">-  - { key: F8,                      chars: &quot;\x1b[19~&quot;                    }
</a><a href="#h0-0-313" id="h0-0-313" class="d">-  - { key: F9,                      chars: &quot;\x1b[20~&quot;                    }
</a><a href="#h0-0-314" id="h0-0-314" class="d">-  - { key: F10,                     chars: &quot;\x1b[21~&quot;                    }
</a><a href="#h0-0-315" id="h0-0-315" class="d">-  - { key: F11,                     chars: &quot;\x1b[23~&quot;                    }
</a><a href="#h0-0-316" id="h0-0-316" class="d">-  - { key: F12,                     chars: &quot;\x1b[24~&quot;                    }
</a><a href="#h0-0-317" id="h0-0-317" class="d">-  - { key: F1,       mods: Shift,   chars: &quot;\x1b[1;2P&quot;                   }
</a><a href="#h0-0-318" id="h0-0-318" class="d">-  - { key: F2,       mods: Shift,   chars: &quot;\x1b[1;2Q&quot;                   }
</a><a href="#h0-0-319" id="h0-0-319" class="d">-  - { key: F3,       mods: Shift,   chars: &quot;\x1b[1;2R&quot;                   }
</a><a href="#h0-0-320" id="h0-0-320" class="d">-  - { key: F4,       mods: Shift,   chars: &quot;\x1b[1;2S&quot;                   }
</a><a href="#h0-0-321" id="h0-0-321" class="d">-  - { key: F5,       mods: Shift,   chars: &quot;\x1b[15;2~&quot;                  }
</a><a href="#h0-0-322" id="h0-0-322" class="d">-  - { key: F6,       mods: Shift,   chars: &quot;\x1b[17;2~&quot;                  }
</a><a href="#h0-0-323" id="h0-0-323" class="d">-  - { key: F7,       mods: Shift,   chars: &quot;\x1b[18;2~&quot;                  }
</a><a href="#h0-0-324" id="h0-0-324" class="d">-  - { key: F8,       mods: Shift,   chars: &quot;\x1b[19;2~&quot;                  }
</a><a href="#h0-0-325" id="h0-0-325" class="d">-  - { key: F9,       mods: Shift,   chars: &quot;\x1b[20;2~&quot;                  }
</a><a href="#h0-0-326" id="h0-0-326" class="d">-  - { key: F10,      mods: Shift,   chars: &quot;\x1b[21;2~&quot;                  }
</a><a href="#h0-0-327" id="h0-0-327" class="d">-  - { key: F11,      mods: Shift,   chars: &quot;\x1b[23;2~&quot;                  }
</a><a href="#h0-0-328" id="h0-0-328" class="d">-  - { key: F12,      mods: Shift,   chars: &quot;\x1b[24;2~&quot;                  }
</a><a href="#h0-0-329" id="h0-0-329" class="d">-  - { key: F1,       mods: Control, chars: &quot;\x1b[1;5P&quot;                   }
</a><a href="#h0-0-330" id="h0-0-330" class="d">-  - { key: F2,       mods: Control, chars: &quot;\x1b[1;5Q&quot;                   }
</a><a href="#h0-0-331" id="h0-0-331" class="d">-  - { key: F3,       mods: Control, chars: &quot;\x1b[1;5R&quot;                   }
</a><a href="#h0-0-332" id="h0-0-332" class="d">-  - { key: F4,       mods: Control, chars: &quot;\x1b[1;5S&quot;                   }
</a><a href="#h0-0-333" id="h0-0-333" class="d">-  - { key: F5,       mods: Control, chars: &quot;\x1b[15;5~&quot;                  }
</a><a href="#h0-0-334" id="h0-0-334" class="d">-  - { key: F6,       mods: Control, chars: &quot;\x1b[17;5~&quot;                  }
</a><a href="#h0-0-335" id="h0-0-335" class="d">-  - { key: F7,       mods: Control, chars: &quot;\x1b[18;5~&quot;                  }
</a><a href="#h0-0-336" id="h0-0-336" class="d">-  - { key: F8,       mods: Control, chars: &quot;\x1b[19;5~&quot;                  }
</a><a href="#h0-0-337" id="h0-0-337" class="d">-  - { key: F9,       mods: Control, chars: &quot;\x1b[20;5~&quot;                  }
</a><a href="#h0-0-338" id="h0-0-338" class="d">-  - { key: F10,      mods: Control, chars: &quot;\x1b[21;5~&quot;                  }
</a><a href="#h0-0-339" id="h0-0-339" class="d">-  - { key: F11,      mods: Control, chars: &quot;\x1b[23;5~&quot;                  }
</a><a href="#h0-0-340" id="h0-0-340" class="d">-  - { key: F12,      mods: Control, chars: &quot;\x1b[24;5~&quot;                  }
</a><a href="#h0-0-341" id="h0-0-341" class="d">-  - { key: F1,       mods: Alt,     chars: &quot;\x1b[1;6P&quot;                   }
</a><a href="#h0-0-342" id="h0-0-342" class="d">-  - { key: F2,       mods: Alt,     chars: &quot;\x1b[1;6Q&quot;                   }
</a><a href="#h0-0-343" id="h0-0-343" class="d">-  - { key: F3,       mods: Alt,     chars: &quot;\x1b[1;6R&quot;                   }
</a><a href="#h0-0-344" id="h0-0-344" class="d">-  - { key: F4,       mods: Alt,     chars: &quot;\x1b[1;6S&quot;                   }
</a><a href="#h0-0-345" id="h0-0-345" class="d">-  - { key: F5,       mods: Alt,     chars: &quot;\x1b[15;6~&quot;                  }
</a><a href="#h0-0-346" id="h0-0-346" class="d">-  - { key: F6,       mods: Alt,     chars: &quot;\x1b[17;6~&quot;                  }
</a><a href="#h0-0-347" id="h0-0-347" class="d">-  - { key: F7,       mods: Alt,     chars: &quot;\x1b[18;6~&quot;                  }
</a><a href="#h0-0-348" id="h0-0-348" class="d">-  - { key: F8,       mods: Alt,     chars: &quot;\x1b[19;6~&quot;                  }
</a><a href="#h0-0-349" id="h0-0-349" class="d">-  - { key: F9,       mods: Alt,     chars: &quot;\x1b[20;6~&quot;                  }
</a><a href="#h0-0-350" id="h0-0-350" class="d">-  - { key: F10,      mods: Alt,     chars: &quot;\x1b[21;6~&quot;                  }
</a><a href="#h0-0-351" id="h0-0-351" class="d">-  - { key: F11,      mods: Alt,     chars: &quot;\x1b[23;6~&quot;                  }
</a><a href="#h0-0-352" id="h0-0-352" class="d">-  - { key: F12,      mods: Alt,     chars: &quot;\x1b[24;6~&quot;                  }
</a><a href="#h0-0-353" id="h0-0-353" class="d">-  - { key: F1,       mods: Command, chars: &quot;\x1b[1;3P&quot;                   }
</a><a href="#h0-0-354" id="h0-0-354" class="d">-  - { key: F2,       mods: Command, chars: &quot;\x1b[1;3Q&quot;                   }
</a><a href="#h0-0-355" id="h0-0-355" class="d">-  - { key: F3,       mods: Command, chars: &quot;\x1b[1;3R&quot;                   }
</a><a href="#h0-0-356" id="h0-0-356" class="d">-  - { key: F4,       mods: Command, chars: &quot;\x1b[1;3S&quot;                   }
</a><a href="#h0-0-357" id="h0-0-357" class="d">-  - { key: F5,       mods: Command, chars: &quot;\x1b[15;3~&quot;                  }
</a><a href="#h0-0-358" id="h0-0-358" class="d">-  - { key: F6,       mods: Command, chars: &quot;\x1b[17;3~&quot;                  }
</a><a href="#h0-0-359" id="h0-0-359" class="d">-  - { key: F7,       mods: Command, chars: &quot;\x1b[18;3~&quot;                  }
</a><a href="#h0-0-360" id="h0-0-360" class="d">-  - { key: F8,       mods: Command, chars: &quot;\x1b[19;3~&quot;                  }
</a><a href="#h0-0-361" id="h0-0-361" class="d">-  - { key: F9,       mods: Command, chars: &quot;\x1b[20;3~&quot;                  }
</a><a href="#h0-0-362" id="h0-0-362" class="d">-  - { key: F10,      mods: Command, chars: &quot;\x1b[21;3~&quot;                  }
</a><a href="#h0-0-363" id="h0-0-363" class="d">-  - { key: F11,      mods: Command, chars: &quot;\x1b[23;3~&quot;                  }
</a><a href="#h0-0-364" id="h0-0-364" class="d">-  - { key: F12,      mods: Command, chars: &quot;\x1b[24;3~&quot;                  }
</a><a href="#h0-0-365" id="h0-0-365" class="d">-
</a><a href="#h0-0-366" id="h0-0-366" class="d">-  # Alt key
</a><a href="#h0-0-367" id="h0-0-367" class="d">-  - { key: A,         mods: Alt,       chars: &quot;\x1ba&quot;                       }
</a><a href="#h0-0-368" id="h0-0-368" class="d">-  - { key: B,         mods: Alt,       chars: &quot;\x1bb&quot;                       }
</a><a href="#h0-0-369" id="h0-0-369" class="d">-  - { key: C,         mods: Alt,       chars: &quot;\x1bc&quot;                       }
</a><a href="#h0-0-370" id="h0-0-370" class="d">-  - { key: D,         mods: Alt,       chars: &quot;\x1bd&quot;                       }
</a><a href="#h0-0-371" id="h0-0-371" class="d">-  - { key: E,         mods: Alt,       chars: &quot;\x1be&quot;                       }
</a><a href="#h0-0-372" id="h0-0-372" class="d">-  - { key: F,         mods: Alt,       chars: &quot;\x1bf&quot;                       }
</a><a href="#h0-0-373" id="h0-0-373" class="d">-  - { key: G,         mods: Alt,       chars: &quot;\x1bg&quot;                       }
</a><a href="#h0-0-374" id="h0-0-374" class="d">-  - { key: H,         mods: Alt,       chars: &quot;\x1bh&quot;                       }
</a><a href="#h0-0-375" id="h0-0-375" class="d">-  - { key: I,         mods: Alt,       chars: &quot;\x1bi&quot;                       }
</a><a href="#h0-0-376" id="h0-0-376" class="d">-  - { key: J,         mods: Alt,       chars: &quot;\x1bj&quot;                       }
</a><a href="#h0-0-377" id="h0-0-377" class="d">-  - { key: K,         mods: Alt,       chars: &quot;\x1bk&quot;                       }
</a><a href="#h0-0-378" id="h0-0-378" class="d">-  - { key: L,         mods: Alt,       chars: &quot;\x1bl&quot;                       }
</a><a href="#h0-0-379" id="h0-0-379" class="d">-  - { key: M,         mods: Alt,       chars: &quot;\x1bm&quot;                       }
</a><a href="#h0-0-380" id="h0-0-380" class="d">-  - { key: N,         mods: Alt,       chars: &quot;\x1bn&quot;                       }
</a><a href="#h0-0-381" id="h0-0-381" class="d">-  - { key: O,         mods: Alt,       chars: &quot;\x1bo&quot;                       }
</a><a href="#h0-0-382" id="h0-0-382" class="d">-  - { key: P,         mods: Alt,       chars: &quot;\x1bp&quot;                       }
</a><a href="#h0-0-383" id="h0-0-383" class="d">-  - { key: Q,         mods: Alt,       chars: &quot;\x1bq&quot;                       }
</a><a href="#h0-0-384" id="h0-0-384" class="d">-  - { key: R,         mods: Alt,       chars: &quot;\x1br&quot;                       }
</a><a href="#h0-0-385" id="h0-0-385" class="d">-  - { key: S,         mods: Alt,       chars: &quot;\x1bs&quot;                       }
</a><a href="#h0-0-386" id="h0-0-386" class="d">-  - { key: T,         mods: Alt,       chars: &quot;\x1bt&quot;                       }
</a><a href="#h0-0-387" id="h0-0-387" class="d">-  - { key: U,         mods: Alt,       chars: &quot;\x1bu&quot;                       }
</a><a href="#h0-0-388" id="h0-0-388" class="d">-  - { key: V,         mods: Alt,       chars: &quot;\x1bv&quot;                       }
</a><a href="#h0-0-389" id="h0-0-389" class="d">-  - { key: W,         mods: Alt,       chars: &quot;\x1bw&quot;                       }
</a><a href="#h0-0-390" id="h0-0-390" class="d">-  - { key: X,         mods: Alt,       chars: &quot;\x1bx&quot;                       }
</a><a href="#h0-0-391" id="h0-0-391" class="d">-  - { key: Y,         mods: Alt,       chars: &quot;\x1by&quot;                       }
</a><a href="#h0-0-392" id="h0-0-392" class="d">-  - { key: Z,         mods: Alt,       chars: &quot;\x1bz&quot;                       }
</a><a href="#h0-0-393" id="h0-0-393" class="d">-  - { key: A,         mods: Alt|Shift, chars: &quot;\x1bA&quot;                       }
</a><a href="#h0-0-394" id="h0-0-394" class="d">-  - { key: B,         mods: Alt|Shift, chars: &quot;\x1bB&quot;                       }
</a><a href="#h0-0-395" id="h0-0-395" class="d">-  - { key: C,         mods: Alt|Shift, chars: &quot;\x1bC&quot;                       }
</a><a href="#h0-0-396" id="h0-0-396" class="d">-  - { key: D,         mods: Alt|Shift, chars: &quot;\x1bD&quot;                       }
</a><a href="#h0-0-397" id="h0-0-397" class="d">-  - { key: E,         mods: Alt|Shift, chars: &quot;\x1bE&quot;                       }
</a><a href="#h0-0-398" id="h0-0-398" class="d">-  - { key: F,         mods: Alt|Shift, chars: &quot;\x1bF&quot;                       }
</a><a href="#h0-0-399" id="h0-0-399" class="d">-  - { key: G,         mods: Alt|Shift, chars: &quot;\x1bG&quot;                       }
</a><a href="#h0-0-400" id="h0-0-400" class="d">-  - { key: H,         mods: Alt|Shift, chars: &quot;\x1bH&quot;                       }
</a><a href="#h0-0-401" id="h0-0-401" class="d">-  - { key: I,         mods: Alt|Shift, chars: &quot;\x1bI&quot;                       }
</a><a href="#h0-0-402" id="h0-0-402" class="d">-  - { key: J,         mods: Alt|Shift, chars: &quot;\x1bJ&quot;                       }
</a><a href="#h0-0-403" id="h0-0-403" class="d">-  - { key: K,         mods: Alt|Shift, chars: &quot;\x1bK&quot;                       }
</a><a href="#h0-0-404" id="h0-0-404" class="d">-  - { key: L,         mods: Alt|Shift, chars: &quot;\x1bL&quot;                       }
</a><a href="#h0-0-405" id="h0-0-405" class="d">-  - { key: M,         mods: Alt|Shift, chars: &quot;\x1bM&quot;                       }
</a><a href="#h0-0-406" id="h0-0-406" class="d">-  - { key: N,         mods: Alt|Shift, chars: &quot;\x1bN&quot;                       }
</a><a href="#h0-0-407" id="h0-0-407" class="d">-  - { key: O,         mods: Alt|Shift, chars: &quot;\x1bO&quot;                       }
</a><a href="#h0-0-408" id="h0-0-408" class="d">-  - { key: P,         mods: Alt|Shift, chars: &quot;\x1bP&quot;                       }
</a><a href="#h0-0-409" id="h0-0-409" class="d">-  - { key: Q,         mods: Alt|Shift, chars: &quot;\x1bQ&quot;                       }
</a><a href="#h0-0-410" id="h0-0-410" class="d">-  - { key: R,         mods: Alt|Shift, chars: &quot;\x1bR&quot;                       }
</a><a href="#h0-0-411" id="h0-0-411" class="d">-  - { key: S,         mods: Alt|Shift, chars: &quot;\x1bS&quot;                       }
</a><a href="#h0-0-412" id="h0-0-412" class="d">-  - { key: T,         mods: Alt|Shift, chars: &quot;\x1bT&quot;                       }
</a><a href="#h0-0-413" id="h0-0-413" class="d">-  - { key: U,         mods: Alt|Shift, chars: &quot;\x1bU&quot;                       }
</a><a href="#h0-0-414" id="h0-0-414" class="d">-  - { key: V,         mods: Alt|Shift, chars: &quot;\x1bV&quot;                       }
</a><a href="#h0-0-415" id="h0-0-415" class="d">-  - { key: W,         mods: Alt|Shift, chars: &quot;\x1bW&quot;                       }
</a><a href="#h0-0-416" id="h0-0-416" class="d">-  - { key: X,         mods: Alt|Shift, chars: &quot;\x1bX&quot;                       }
</a><a href="#h0-0-417" id="h0-0-417" class="d">-  - { key: Y,         mods: Alt|Shift, chars: &quot;\x1bY&quot;                       }
</a><a href="#h0-0-418" id="h0-0-418" class="d">-  - { key: Z,         mods: Alt|Shift, chars: &quot;\x1bZ&quot;                       }
</a><a href="#h0-0-419" id="h0-0-419" class="d">-  - { key: Key1,      mods: Alt,       chars: &quot;\x1b1&quot;                       }
</a><a href="#h0-0-420" id="h0-0-420" class="d">-  - { key: Key2,      mods: Alt,       chars: &quot;\x1b2&quot;                       }
</a><a href="#h0-0-421" id="h0-0-421" class="d">-  - { key: Key3,      mods: Alt,       chars: &quot;\x1b3&quot;                       }
</a><a href="#h0-0-422" id="h0-0-422" class="d">-  - { key: Key4,      mods: Alt,       chars: &quot;\x1b4&quot;                       }
</a><a href="#h0-0-423" id="h0-0-423" class="d">-  - { key: Key5,      mods: Alt,       chars: &quot;\x1b5&quot;                       }
</a><a href="#h0-0-424" id="h0-0-424" class="d">-  - { key: Key6,      mods: Alt,       chars: &quot;\x1b6&quot;                       }
</a><a href="#h0-0-425" id="h0-0-425" class="d">-  - { key: Key7,      mods: Alt,       chars: &quot;\x1b7&quot;                       }
</a><a href="#h0-0-426" id="h0-0-426" class="d">-  - { key: Key8,      mods: Alt,       chars: &quot;\x1b8&quot;                       }
</a><a href="#h0-0-427" id="h0-0-427" class="d">-  - { key: Key9,      mods: Alt,       chars: &quot;\x1b9&quot;                       }
</a><a href="#h0-0-428" id="h0-0-428" class="d">-  - { key: Key0,      mods: Alt,       chars: &quot;\x1b0&quot;                       }
</a><a href="#h0-0-429" id="h0-0-429" class="d">-  - { key: Space,     mods: Control,   chars: &quot;\x00&quot;                        } # Ctrl + Space
</a><a href="#h0-0-430" id="h0-0-430" class="d">-  - { key: Grave,     mods: Alt,       chars: &quot;\x1b`&quot;                       } # Alt + `
</a><a href="#h0-0-431" id="h0-0-431" class="d">-  - { key: Grave,     mods: Alt|Shift, chars: &quot;\x1b~&quot;                       } # Alt + ~
</a><a href="#h0-0-432" id="h0-0-432" class="d">-  - { key: Period,    mods: Alt,       chars: &quot;\x1b.&quot;                       } # Alt + .
</a><a href="#h0-0-433" id="h0-0-433" class="d">-  - { key: Key8,      mods: Alt|Shift, chars: &quot;\x1b*&quot;                       } # Alt + *
</a><a href="#h0-0-434" id="h0-0-434" class="d">-  - { key: Key3,      mods: Alt|Shift, chars: &quot;\x1b#&quot;                       } # Alt + #
</a><a href="#h0-0-435" id="h0-0-435" class="d">-  - { key: Period,    mods: Alt|Shift, chars: &quot;\x1b&gt;&quot;                       } # Alt + &gt;
</a><a href="#h0-0-436" id="h0-0-436" class="d">-  - { key: Comma,     mods: Alt|Shift, chars: &quot;\x1b&lt;&quot;                       } # Alt + &lt;
</a><a href="#h0-0-437" id="h0-0-437" class="d">-  - { key: Minus,     mods: Alt|Shift, chars: &quot;\x1b_&quot;                       } # Alt + _
</a><a href="#h0-0-438" id="h0-0-438" class="d">-  - { key: Key5,      mods: Alt|Shift, chars: &quot;\x1b%&quot;                       } # Alt + %
</a><a href="#h0-0-439" id="h0-0-439" class="d">-  - { key: Key6,      mods: Alt|Shift, chars: &quot;\x1b^&quot;                       } # Alt + ^
</a><a href="#h0-0-440" id="h0-0-440" class="d">-  - { key: Backslash, mods: Alt,       chars: &quot;\x1b\\&quot;                      } # Alt + \
</a><a href="#h0-0-441" id="h0-0-441" class="d">-  - { key: Backslash, mods: Alt|Shift, chars: &quot;\x1b|&quot;                       } # Alt + |
</a><a href="#h0-0-442" id="h0-0-442" class="d">-
</a><a href="#h0-0-443" id="h0-0-443" class="d">-  - { key: Period,   mods: Alt,       chars: &quot;\x1b.&quot;                       }
</a><a href="#h0-0-444" id="h0-0-444" class="d">-  - { key: Key8,     mods: Alt|Shift, chars: &quot;\x1b*&quot;                       }
</a><a href="#h0-0-445" id="h0-0-445" class="d">-  - { key: Key3,     mods: Alt|Shift, chars: &quot;\x1b#&quot;                       }
</a><a href="#h0-0-446" id="h0-0-446" class="d">-
</a><a href="#h0-0-447" id="h0-0-447" class="d">-  - { key: Key1,     mods: Alt,     chars: &quot;\x1b1&quot;                       }
</a><a href="#h0-0-448" id="h0-0-448" class="d">-  - { key: Key2,     mods: Alt,     chars: &quot;\x1b2&quot;                       }
</a><a href="#h0-0-449" id="h0-0-449" class="d">-  - { key: Key3,     mods: Alt,     chars: &quot;\x1b3&quot;                       }
</a><a href="#h0-0-450" id="h0-0-450" class="d">-  - { key: Key4,     mods: Alt,     chars: &quot;\x1b4&quot;                       }
</a><a href="#h0-0-451" id="h0-0-451" class="d">-  - { key: Key5,     mods: Alt,     chars: &quot;\x1b5&quot;                       }
</a><a href="#h0-0-452" id="h0-0-452" class="d">-  - { key: Key6,     mods: Alt,     chars: &quot;\x1b6&quot;                       }
</a><a href="#h0-0-453" id="h0-0-453" class="d">-  - { key: Key7,     mods: Alt,     chars: &quot;\x1b7&quot;                       }
</a><a href="#h0-0-454" id="h0-0-454" class="d">-  - { key: Key8,     mods: Alt,     chars: &quot;\x1b8&quot;                       }
</a><a href="#h0-0-455" id="h0-0-455" class="d">-  - { key: Key9,     mods: Alt,     chars: &quot;\x1b9&quot;                       }
</a><a href="#h0-0-456" id="h0-0-456" class="d">-  - { key: Key0,     mods: Alt,     chars: &quot;\x1b0&quot;                       }
</a><b>diff --git a/<a id="h1" href="../file/.config/nvim/init.vim.html">.config/nvim/init.vim</a> b/<a href="../file/.config/nvim/init.vim.html">.config/nvim/init.vim</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -1,3 +0,0 @@
</a><a href="#h1-0-0" id="h1-0-0" class="d">-set runtimepath^=~/.vim runtimepath+=~/.vim/after
</a><a href="#h1-0-1" id="h1-0-1" class="d">-let &amp;packpath = &amp;runtimepath
</a><a href="#h1-0-2" id="h1-0-2" class="d">-source ~/.vimrc
</a><b>diff --git a/<a id="h2" href="../file/.config/oh-my-zsh.html">.config/oh-my-zsh</a> b/<a href="../file/.config/oh-my-zsh.html">.config/oh-my-zsh</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -1 +0,0 @@
</a><a href="#h2-0-0" id="h2-0-0" class="d">-Subproject commit d2725d44fce59ea7060b4d712c5739512a56882d
</a><b>diff --git a/<a id="h3" href="../file/.gitignore.html">.gitignore</a> b/<a href="../file/.gitignore.html">.gitignore</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -1,2 +1,2 @@
</a><a href="#h3-0-0" id="h3-0-0" class="d">-# mpd
</a><a href="#h3-0-1" id="h3-0-1" class="d">-.config/ncmpcpp/lyrics
</a><a href="#h3-0-2" id="h3-0-2" class="i">+dots/.vim/plugged
</a><a href="#h3-0-3" id="h3-0-3" class="i">+dots/.vim/.netrwhist
</a><b>diff --git a/<a id="h4" href="../file/.oh-my-zsh.html">.oh-my-zsh</a> b/<a href="../file/.oh-my-zsh.html">.oh-my-zsh</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -1 +0,0 @@
</a><a href="#h4-0-0" id="h4-0-0" class="d">-Subproject commit 2af2d1aa31caa534c419e72d75daa667ff725de2
</a><b>diff --git a/<a id="h5" href="../file/.scripts/compiler.html">.scripts/compiler</a> b/<a href="../file/.scripts/compiler.html">.scripts/compiler</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -1,34 +0,0 @@
</a><a href="#h5-0-0" id="h5-0-0" class="d">-#!/bin/sh
</a><a href="#h5-0-1" id="h5-0-1" class="d">-
</a><a href="#h5-0-2" id="h5-0-2" class="d">-# This script will compile or run another finishing operation on a document. I
</a><a href="#h5-0-3" id="h5-0-3" class="d">-# have this script run via vim.
</a><a href="#h5-0-4" id="h5-0-4" class="d">-#
</a><a href="#h5-0-5" id="h5-0-5" class="d">-# tex files: Compiles to pdf, including bibliography if necessary
</a><a href="#h5-0-6" id="h5-0-6" class="d">-# md files: Compiles to pdf via pandoc
</a><a href="#h5-0-7" id="h5-0-7" class="d">-# rmd files: Compiles via R Markdown
</a><a href="#h5-0-8" id="h5-0-8" class="d">-# c files: Compiles via whatever compiler is set to cc. Usually gcc.
</a><a href="#h5-0-9" id="h5-0-9" class="d">-# py files: runs via python command
</a><a href="#h5-0-10" id="h5-0-10" class="d">-# go files: compiles and runs with &quot;go run&quot;
</a><a href="#h5-0-11" id="h5-0-11" class="d">-# config.h files: (For suckless utils) recompiles and installs program.
</a><a href="#h5-0-12" id="h5-0-12" class="d">-# all others: run `sent` to show a presentation
</a><a href="#h5-0-13" id="h5-0-13" class="d">-
</a><a href="#h5-0-14" id="h5-0-14" class="d">-file=$1
</a><a href="#h5-0-15" id="h5-0-15" class="d">-dir=$(dirname &quot;$file&quot;)
</a><a href="#h5-0-16" id="h5-0-16" class="d">-base=&quot;${file%.*}&quot;
</a><a href="#h5-0-17" id="h5-0-17" class="d">-shebang=$(sed -n 1p &quot;$file&quot;)
</a><a href="#h5-0-18" id="h5-0-18" class="d">-
</a><a href="#h5-0-19" id="h5-0-19" class="d">-cd &quot;$dir&quot; || exit
</a><a href="#h5-0-20" id="h5-0-20" class="d">-
</a><a href="#h5-0-21" id="h5-0-21" class="d">-shebangtest() {
</a><a href="#h5-0-22" id="h5-0-22" class="d">-	case &quot;$shebang&quot; in
</a><a href="#h5-0-23" id="h5-0-23" class="d">-		\#\!*) &quot;$file&quot; ;;
</a><a href="#h5-0-24" id="h5-0-24" class="d">-		*) sent &quot;$file&quot; 2&gt;/dev/null &amp; ;;
</a><a href="#h5-0-25" id="h5-0-25" class="d">-	esac
</a><a href="#h5-0-26" id="h5-0-26" class="d">-}
</a><a href="#h5-0-27" id="h5-0-27" class="d">-
</a><a href="#h5-0-28" id="h5-0-28" class="d">-case &quot;$file&quot; in
</a><a href="#h5-0-29" id="h5-0-29" class="d">-	*\.ms) groff -ms $file | pstopdf -i -o &quot;$base&quot;.pdf ;;
</a><a href="#h5-0-30" id="h5-0-30" class="d">-	*\.py) python &quot;$file&quot; ;;
</a><a href="#h5-0-31" id="h5-0-31" class="d">-	*\.go) go run &quot;$file&quot; ;;
</a><a href="#h5-0-32" id="h5-0-32" class="d">-	*) shebangtest ;;
</a><a href="#h5-0-33" id="h5-0-33" class="d">-esac
</a><b>diff --git a/<a id="h6" href="../file/.vim/autoload/plug.vim.html">.vim/autoload/plug.vim</a> b/<a href="../file/.vim/autoload/plug.vim.html">.vim/autoload/plug.vim</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -1,2458 +0,0 @@
</a><a href="#h6-0-0" id="h6-0-0" class="d">-&quot; vim-plug: Vim plugin manager
</a><a href="#h6-0-1" id="h6-0-1" class="d">-&quot; ============================
</a><a href="#h6-0-2" id="h6-0-2" class="d">-&quot;
</a><a href="#h6-0-3" id="h6-0-3" class="d">-&quot; Download plug.vim and put it in ~/.vim/autoload
</a><a href="#h6-0-4" id="h6-0-4" class="d">-&quot;
</a><a href="#h6-0-5" id="h6-0-5" class="d">-&quot;   curl -fLo ~/.vim/autoload/plug.vim --create-dirs \
</a><a href="#h6-0-6" id="h6-0-6" class="d">-&quot;     https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
</a><a href="#h6-0-7" id="h6-0-7" class="d">-&quot;
</a><a href="#h6-0-8" id="h6-0-8" class="d">-&quot; Edit your .vimrc
</a><a href="#h6-0-9" id="h6-0-9" class="d">-&quot;
</a><a href="#h6-0-10" id="h6-0-10" class="d">-&quot;   call plug#begin(&#39;~/.vim/plugged&#39;)
</a><a href="#h6-0-11" id="h6-0-11" class="d">-&quot;
</a><a href="#h6-0-12" id="h6-0-12" class="d">-&quot;   &quot; Make sure you use single quotes
</a><a href="#h6-0-13" id="h6-0-13" class="d">-&quot;
</a><a href="#h6-0-14" id="h6-0-14" class="d">-&quot;   &quot; Shorthand notation; fetches https://github.com/junegunn/vim-easy-align
</a><a href="#h6-0-15" id="h6-0-15" class="d">-&quot;   Plug &#39;junegunn/vim-easy-align&#39;
</a><a href="#h6-0-16" id="h6-0-16" class="d">-&quot;
</a><a href="#h6-0-17" id="h6-0-17" class="d">-&quot;   &quot; Any valid git URL is allowed
</a><a href="#h6-0-18" id="h6-0-18" class="d">-&quot;   Plug &#39;https://github.com/junegunn/vim-github-dashboard.git&#39;
</a><a href="#h6-0-19" id="h6-0-19" class="d">-&quot;
</a><a href="#h6-0-20" id="h6-0-20" class="d">-&quot;   &quot; Multiple Plug commands can be written in a single line using | separators
</a><a href="#h6-0-21" id="h6-0-21" class="d">-&quot;   Plug &#39;SirVer/ultisnips&#39; | Plug &#39;honza/vim-snippets&#39;
</a><a href="#h6-0-22" id="h6-0-22" class="d">-&quot;
</a><a href="#h6-0-23" id="h6-0-23" class="d">-&quot;   &quot; On-demand loading
</a><a href="#h6-0-24" id="h6-0-24" class="d">-&quot;   Plug &#39;scrooloose/nerdtree&#39;, { &#39;on&#39;:  &#39;NERDTreeToggle&#39; }
</a><a href="#h6-0-25" id="h6-0-25" class="d">-&quot;   Plug &#39;tpope/vim-fireplace&#39;, { &#39;for&#39;: &#39;clojure&#39; }
</a><a href="#h6-0-26" id="h6-0-26" class="d">-&quot;
</a><a href="#h6-0-27" id="h6-0-27" class="d">-&quot;   &quot; Using a non-master branch
</a><a href="#h6-0-28" id="h6-0-28" class="d">-&quot;   Plug &#39;rdnetto/YCM-Generator&#39;, { &#39;branch&#39;: &#39;stable&#39; }
</a><a href="#h6-0-29" id="h6-0-29" class="d">-&quot;
</a><a href="#h6-0-30" id="h6-0-30" class="d">-&quot;   &quot; Using a tagged release; wildcard allowed (requires git 1.9.2 or above)
</a><a href="#h6-0-31" id="h6-0-31" class="d">-&quot;   Plug &#39;fatih/vim-go&#39;, { &#39;tag&#39;: &#39;*&#39; }
</a><a href="#h6-0-32" id="h6-0-32" class="d">-&quot;
</a><a href="#h6-0-33" id="h6-0-33" class="d">-&quot;   &quot; Plugin options
</a><a href="#h6-0-34" id="h6-0-34" class="d">-&quot;   Plug &#39;nsf/gocode&#39;, { &#39;tag&#39;: &#39;v.20150303&#39;, &#39;rtp&#39;: &#39;vim&#39; }
</a><a href="#h6-0-35" id="h6-0-35" class="d">-&quot;
</a><a href="#h6-0-36" id="h6-0-36" class="d">-&quot;   &quot; Plugin outside ~/.vim/plugged with post-update hook
</a><a href="#h6-0-37" id="h6-0-37" class="d">-&quot;   Plug &#39;junegunn/fzf&#39;, { &#39;dir&#39;: &#39;~/.fzf&#39;, &#39;do&#39;: &#39;./install --all&#39; }
</a><a href="#h6-0-38" id="h6-0-38" class="d">-&quot;
</a><a href="#h6-0-39" id="h6-0-39" class="d">-&quot;   &quot; Unmanaged plugin (manually installed and updated)
</a><a href="#h6-0-40" id="h6-0-40" class="d">-&quot;   Plug &#39;~/my-prototype-plugin&#39;
</a><a href="#h6-0-41" id="h6-0-41" class="d">-&quot;
</a><a href="#h6-0-42" id="h6-0-42" class="d">-&quot;   &quot; Initialize plugin system
</a><a href="#h6-0-43" id="h6-0-43" class="d">-&quot;   call plug#end()
</a><a href="#h6-0-44" id="h6-0-44" class="d">-&quot;
</a><a href="#h6-0-45" id="h6-0-45" class="d">-&quot; Then reload .vimrc and :PlugInstall to install plugins.
</a><a href="#h6-0-46" id="h6-0-46" class="d">-&quot;
</a><a href="#h6-0-47" id="h6-0-47" class="d">-&quot; Plug options:
</a><a href="#h6-0-48" id="h6-0-48" class="d">-&quot;
</a><a href="#h6-0-49" id="h6-0-49" class="d">-&quot;| Option                  | Description                                      |
</a><a href="#h6-0-50" id="h6-0-50" class="d">-&quot;| ----------------------- | ------------------------------------------------ |
</a><a href="#h6-0-51" id="h6-0-51" class="d">-&quot;| `branch`/`tag`/`commit` | Branch/tag/commit of the repository to use       |
</a><a href="#h6-0-52" id="h6-0-52" class="d">-&quot;| `rtp`                   | Subdirectory that contains Vim plugin            |
</a><a href="#h6-0-53" id="h6-0-53" class="d">-&quot;| `dir`                   | Custom directory for the plugin                  |
</a><a href="#h6-0-54" id="h6-0-54" class="d">-&quot;| `as`                    | Use different name for the plugin                |
</a><a href="#h6-0-55" id="h6-0-55" class="d">-&quot;| `do`                    | Post-update hook (string or funcref)             |
</a><a href="#h6-0-56" id="h6-0-56" class="d">-&quot;| `on`                    | On-demand loading: Commands or `&lt;Plug&gt;`-mappings |
</a><a href="#h6-0-57" id="h6-0-57" class="d">-&quot;| `for`                   | On-demand loading: File types                    |
</a><a href="#h6-0-58" id="h6-0-58" class="d">-&quot;| `frozen`                | Do not update unless explicitly specified        |
</a><a href="#h6-0-59" id="h6-0-59" class="d">-&quot;
</a><a href="#h6-0-60" id="h6-0-60" class="d">-&quot; More information: https://github.com/junegunn/vim-plug
</a><a href="#h6-0-61" id="h6-0-61" class="d">-&quot;
</a><a href="#h6-0-62" id="h6-0-62" class="d">-&quot;
</a><a href="#h6-0-63" id="h6-0-63" class="d">-&quot; Copyright (c) 2017 Junegunn Choi
</a><a href="#h6-0-64" id="h6-0-64" class="d">-&quot;
</a><a href="#h6-0-65" id="h6-0-65" class="d">-&quot; MIT License
</a><a href="#h6-0-66" id="h6-0-66" class="d">-&quot;
</a><a href="#h6-0-67" id="h6-0-67" class="d">-&quot; Permission is hereby granted, free of charge, to any person obtaining
</a><a href="#h6-0-68" id="h6-0-68" class="d">-&quot; a copy of this software and associated documentation files (the
</a><a href="#h6-0-69" id="h6-0-69" class="d">-&quot; &quot;Software&quot;), to deal in the Software without restriction, including
</a><a href="#h6-0-70" id="h6-0-70" class="d">-&quot; without limitation the rights to use, copy, modify, merge, publish,
</a><a href="#h6-0-71" id="h6-0-71" class="d">-&quot; distribute, sublicense, and/or sell copies of the Software, and to
</a><a href="#h6-0-72" id="h6-0-72" class="d">-&quot; permit persons to whom the Software is furnished to do so, subject to
</a><a href="#h6-0-73" id="h6-0-73" class="d">-&quot; the following conditions:
</a><a href="#h6-0-74" id="h6-0-74" class="d">-&quot;
</a><a href="#h6-0-75" id="h6-0-75" class="d">-&quot; The above copyright notice and this permission notice shall be
</a><a href="#h6-0-76" id="h6-0-76" class="d">-&quot; included in all copies or substantial portions of the Software.
</a><a href="#h6-0-77" id="h6-0-77" class="d">-&quot;
</a><a href="#h6-0-78" id="h6-0-78" class="d">-&quot; THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
</a><a href="#h6-0-79" id="h6-0-79" class="d">-&quot; EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
</a><a href="#h6-0-80" id="h6-0-80" class="d">-&quot; MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
</a><a href="#h6-0-81" id="h6-0-81" class="d">-&quot; NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
</a><a href="#h6-0-82" id="h6-0-82" class="d">-&quot; LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
</a><a href="#h6-0-83" id="h6-0-83" class="d">-&quot; OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
</a><a href="#h6-0-84" id="h6-0-84" class="d">-&quot; WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
</a><a href="#h6-0-85" id="h6-0-85" class="d">-
</a><a href="#h6-0-86" id="h6-0-86" class="d">-if exists(&#39;g:loaded_plug&#39;)
</a><a href="#h6-0-87" id="h6-0-87" class="d">-  finish
</a><a href="#h6-0-88" id="h6-0-88" class="d">-endif
</a><a href="#h6-0-89" id="h6-0-89" class="d">-let g:loaded_plug = 1
</a><a href="#h6-0-90" id="h6-0-90" class="d">-
</a><a href="#h6-0-91" id="h6-0-91" class="d">-let s:cpo_save = &amp;cpo
</a><a href="#h6-0-92" id="h6-0-92" class="d">-set cpo&amp;vim
</a><a href="#h6-0-93" id="h6-0-93" class="d">-
</a><a href="#h6-0-94" id="h6-0-94" class="d">-let s:plug_src = &#39;https://github.com/junegunn/vim-plug.git&#39;
</a><a href="#h6-0-95" id="h6-0-95" class="d">-let s:plug_tab = get(s:, &#39;plug_tab&#39;, -1)
</a><a href="#h6-0-96" id="h6-0-96" class="d">-let s:plug_buf = get(s:, &#39;plug_buf&#39;, -1)
</a><a href="#h6-0-97" id="h6-0-97" class="d">-let s:mac_gui = has(&#39;gui_macvim&#39;) &amp;&amp; has(&#39;gui_running&#39;)
</a><a href="#h6-0-98" id="h6-0-98" class="d">-let s:is_win = has(&#39;win32&#39;) || has(&#39;win64&#39;)
</a><a href="#h6-0-99" id="h6-0-99" class="d">-let s:nvim = has(&#39;nvim-0.2&#39;) || (has(&#39;nvim&#39;) &amp;&amp; exists(&#39;*jobwait&#39;) &amp;&amp; !s:is_win)
</a><a href="#h6-0-100" id="h6-0-100" class="d">-let s:vim8 = has(&#39;patch-8.0.0039&#39;) &amp;&amp; exists(&#39;*job_start&#39;)
</a><a href="#h6-0-101" id="h6-0-101" class="d">-let s:me = resolve(expand(&#39;&lt;sfile&gt;:p&#39;))
</a><a href="#h6-0-102" id="h6-0-102" class="d">-let s:base_spec = { &#39;branch&#39;: &#39;master&#39;, &#39;frozen&#39;: 0 }
</a><a href="#h6-0-103" id="h6-0-103" class="d">-let s:TYPE = {
</a><a href="#h6-0-104" id="h6-0-104" class="d">-\   &#39;string&#39;:  type(&#39;&#39;),
</a><a href="#h6-0-105" id="h6-0-105" class="d">-\   &#39;list&#39;:    type([]),
</a><a href="#h6-0-106" id="h6-0-106" class="d">-\   &#39;dict&#39;:    type({}),
</a><a href="#h6-0-107" id="h6-0-107" class="d">-\   &#39;funcref&#39;: type(function(&#39;call&#39;))
</a><a href="#h6-0-108" id="h6-0-108" class="d">-\ }
</a><a href="#h6-0-109" id="h6-0-109" class="d">-let s:loaded = get(s:, &#39;loaded&#39;, {})
</a><a href="#h6-0-110" id="h6-0-110" class="d">-let s:triggers = get(s:, &#39;triggers&#39;, {})
</a><a href="#h6-0-111" id="h6-0-111" class="d">-
</a><a href="#h6-0-112" id="h6-0-112" class="d">-function! plug#begin(...)
</a><a href="#h6-0-113" id="h6-0-113" class="d">-  if a:0 &gt; 0
</a><a href="#h6-0-114" id="h6-0-114" class="d">-    let s:plug_home_org = a:1
</a><a href="#h6-0-115" id="h6-0-115" class="d">-    let home = s:path(fnamemodify(expand(a:1), &#39;:p&#39;))
</a><a href="#h6-0-116" id="h6-0-116" class="d">-  elseif exists(&#39;g:plug_home&#39;)
</a><a href="#h6-0-117" id="h6-0-117" class="d">-    let home = s:path(g:plug_home)
</a><a href="#h6-0-118" id="h6-0-118" class="d">-  elseif !empty(&amp;rtp)
</a><a href="#h6-0-119" id="h6-0-119" class="d">-    let home = s:path(split(&amp;rtp, &#39;,&#39;)[0]) . &#39;/plugged&#39;
</a><a href="#h6-0-120" id="h6-0-120" class="d">-  else
</a><a href="#h6-0-121" id="h6-0-121" class="d">-    return s:err(&#39;Unable to determine plug home. Try calling plug#begin() with a path argument.&#39;)
</a><a href="#h6-0-122" id="h6-0-122" class="d">-  endif
</a><a href="#h6-0-123" id="h6-0-123" class="d">-  if fnamemodify(home, &#39;:t&#39;) ==# &#39;plugin&#39; &amp;&amp; fnamemodify(home, &#39;:h&#39;) ==# s:first_rtp
</a><a href="#h6-0-124" id="h6-0-124" class="d">-    return s:err(&#39;Invalid plug home. &#39;.home.&#39; is a standard Vim runtime path and is not allowed.&#39;)
</a><a href="#h6-0-125" id="h6-0-125" class="d">-  endif
</a><a href="#h6-0-126" id="h6-0-126" class="d">-
</a><a href="#h6-0-127" id="h6-0-127" class="d">-  let g:plug_home = home
</a><a href="#h6-0-128" id="h6-0-128" class="d">-  let g:plugs = {}
</a><a href="#h6-0-129" id="h6-0-129" class="d">-  let g:plugs_order = []
</a><a href="#h6-0-130" id="h6-0-130" class="d">-  let s:triggers = {}
</a><a href="#h6-0-131" id="h6-0-131" class="d">-
</a><a href="#h6-0-132" id="h6-0-132" class="d">-  call s:define_commands()
</a><a href="#h6-0-133" id="h6-0-133" class="d">-  return 1
</a><a href="#h6-0-134" id="h6-0-134" class="d">-endfunction
</a><a href="#h6-0-135" id="h6-0-135" class="d">-
</a><a href="#h6-0-136" id="h6-0-136" class="d">-function! s:define_commands()
</a><a href="#h6-0-137" id="h6-0-137" class="d">-  command! -nargs=+ -bar Plug call plug#(&lt;args&gt;)
</a><a href="#h6-0-138" id="h6-0-138" class="d">-  if !executable(&#39;git&#39;)
</a><a href="#h6-0-139" id="h6-0-139" class="d">-    return s:err(&#39;`git` executable not found. Most commands will not be available. To suppress this message, prepend `silent!` to `call plug#begin(...)`.&#39;)
</a><a href="#h6-0-140" id="h6-0-140" class="d">-  endif
</a><a href="#h6-0-141" id="h6-0-141" class="d">-  command! -nargs=* -bar -bang -complete=customlist,s:names PlugInstall call s:install(&lt;bang&gt;0, [&lt;f-args&gt;])
</a><a href="#h6-0-142" id="h6-0-142" class="d">-  command! -nargs=* -bar -bang -complete=customlist,s:names PlugUpdate  call s:update(&lt;bang&gt;0, [&lt;f-args&gt;])
</a><a href="#h6-0-143" id="h6-0-143" class="d">-  command! -nargs=0 -bar -bang PlugClean call s:clean(&lt;bang&gt;0)
</a><a href="#h6-0-144" id="h6-0-144" class="d">-  command! -nargs=0 -bar PlugUpgrade if s:upgrade() | execute &#39;source&#39; s:esc(s:me) | endif
</a><a href="#h6-0-145" id="h6-0-145" class="d">-  command! -nargs=0 -bar PlugStatus  call s:status()
</a><a href="#h6-0-146" id="h6-0-146" class="d">-  command! -nargs=0 -bar PlugDiff    call s:diff()
</a><a href="#h6-0-147" id="h6-0-147" class="d">-  command! -nargs=? -bar -bang -complete=file PlugSnapshot call s:snapshot(&lt;bang&gt;0, &lt;f-args&gt;)
</a><a href="#h6-0-148" id="h6-0-148" class="d">-endfunction
</a><a href="#h6-0-149" id="h6-0-149" class="d">-
</a><a href="#h6-0-150" id="h6-0-150" class="d">-function! s:to_a(v)
</a><a href="#h6-0-151" id="h6-0-151" class="d">-  return type(a:v) == s:TYPE.list ? a:v : [a:v]
</a><a href="#h6-0-152" id="h6-0-152" class="d">-endfunction
</a><a href="#h6-0-153" id="h6-0-153" class="d">-
</a><a href="#h6-0-154" id="h6-0-154" class="d">-function! s:to_s(v)
</a><a href="#h6-0-155" id="h6-0-155" class="d">-  return type(a:v) == s:TYPE.string ? a:v : join(a:v, &quot;\n&quot;) . &quot;\n&quot;
</a><a href="#h6-0-156" id="h6-0-156" class="d">-endfunction
</a><a href="#h6-0-157" id="h6-0-157" class="d">-
</a><a href="#h6-0-158" id="h6-0-158" class="d">-function! s:glob(from, pattern)
</a><a href="#h6-0-159" id="h6-0-159" class="d">-  return s:lines(globpath(a:from, a:pattern))
</a><a href="#h6-0-160" id="h6-0-160" class="d">-endfunction
</a><a href="#h6-0-161" id="h6-0-161" class="d">-
</a><a href="#h6-0-162" id="h6-0-162" class="d">-function! s:source(from, ...)
</a><a href="#h6-0-163" id="h6-0-163" class="d">-  let found = 0
</a><a href="#h6-0-164" id="h6-0-164" class="d">-  for pattern in a:000
</a><a href="#h6-0-165" id="h6-0-165" class="d">-    for vim in s:glob(a:from, pattern)
</a><a href="#h6-0-166" id="h6-0-166" class="d">-      execute &#39;source&#39; s:esc(vim)
</a><a href="#h6-0-167" id="h6-0-167" class="d">-      let found = 1
</a><a href="#h6-0-168" id="h6-0-168" class="d">-    endfor
</a><a href="#h6-0-169" id="h6-0-169" class="d">-  endfor
</a><a href="#h6-0-170" id="h6-0-170" class="d">-  return found
</a><a href="#h6-0-171" id="h6-0-171" class="d">-endfunction
</a><a href="#h6-0-172" id="h6-0-172" class="d">-
</a><a href="#h6-0-173" id="h6-0-173" class="d">-function! s:assoc(dict, key, val)
</a><a href="#h6-0-174" id="h6-0-174" class="d">-  let a:dict[a:key] = add(get(a:dict, a:key, []), a:val)
</a><a href="#h6-0-175" id="h6-0-175" class="d">-endfunction
</a><a href="#h6-0-176" id="h6-0-176" class="d">-
</a><a href="#h6-0-177" id="h6-0-177" class="d">-function! s:ask(message, ...)
</a><a href="#h6-0-178" id="h6-0-178" class="d">-  call inputsave()
</a><a href="#h6-0-179" id="h6-0-179" class="d">-  echohl WarningMsg
</a><a href="#h6-0-180" id="h6-0-180" class="d">-  let answer = input(a:message.(a:0 ? &#39; (y/N/a) &#39; : &#39; (y/N) &#39;))
</a><a href="#h6-0-181" id="h6-0-181" class="d">-  echohl None
</a><a href="#h6-0-182" id="h6-0-182" class="d">-  call inputrestore()
</a><a href="#h6-0-183" id="h6-0-183" class="d">-  echo &quot;\r&quot;
</a><a href="#h6-0-184" id="h6-0-184" class="d">-  return (a:0 &amp;&amp; answer =~? &#39;^a&#39;) ? 2 : (answer =~? &#39;^y&#39;) ? 1 : 0
</a><a href="#h6-0-185" id="h6-0-185" class="d">-endfunction
</a><a href="#h6-0-186" id="h6-0-186" class="d">-
</a><a href="#h6-0-187" id="h6-0-187" class="d">-function! s:ask_no_interrupt(...)
</a><a href="#h6-0-188" id="h6-0-188" class="d">-  try
</a><a href="#h6-0-189" id="h6-0-189" class="d">-    return call(&#39;s:ask&#39;, a:000)
</a><a href="#h6-0-190" id="h6-0-190" class="d">-  catch
</a><a href="#h6-0-191" id="h6-0-191" class="d">-    return 0
</a><a href="#h6-0-192" id="h6-0-192" class="d">-  endtry
</a><a href="#h6-0-193" id="h6-0-193" class="d">-endfunction
</a><a href="#h6-0-194" id="h6-0-194" class="d">-
</a><a href="#h6-0-195" id="h6-0-195" class="d">-function! plug#end()
</a><a href="#h6-0-196" id="h6-0-196" class="d">-  if !exists(&#39;g:plugs&#39;)
</a><a href="#h6-0-197" id="h6-0-197" class="d">-    return s:err(&#39;Call plug#begin() first&#39;)
</a><a href="#h6-0-198" id="h6-0-198" class="d">-  endif
</a><a href="#h6-0-199" id="h6-0-199" class="d">-
</a><a href="#h6-0-200" id="h6-0-200" class="d">-  if exists(&#39;#PlugLOD&#39;)
</a><a href="#h6-0-201" id="h6-0-201" class="d">-    augroup PlugLOD
</a><a href="#h6-0-202" id="h6-0-202" class="d">-      autocmd!
</a><a href="#h6-0-203" id="h6-0-203" class="d">-    augroup END
</a><a href="#h6-0-204" id="h6-0-204" class="d">-    augroup! PlugLOD
</a><a href="#h6-0-205" id="h6-0-205" class="d">-  endif
</a><a href="#h6-0-206" id="h6-0-206" class="d">-  let lod = { &#39;ft&#39;: {}, &#39;map&#39;: {}, &#39;cmd&#39;: {} }
</a><a href="#h6-0-207" id="h6-0-207" class="d">-
</a><a href="#h6-0-208" id="h6-0-208" class="d">-  if exists(&#39;g:did_load_filetypes&#39;)
</a><a href="#h6-0-209" id="h6-0-209" class="d">-    filetype off
</a><a href="#h6-0-210" id="h6-0-210" class="d">-  endif
</a><a href="#h6-0-211" id="h6-0-211" class="d">-  for name in g:plugs_order
</a><a href="#h6-0-212" id="h6-0-212" class="d">-    if !has_key(g:plugs, name)
</a><a href="#h6-0-213" id="h6-0-213" class="d">-      continue
</a><a href="#h6-0-214" id="h6-0-214" class="d">-    endif
</a><a href="#h6-0-215" id="h6-0-215" class="d">-    let plug = g:plugs[name]
</a><a href="#h6-0-216" id="h6-0-216" class="d">-    if get(s:loaded, name, 0) || !has_key(plug, &#39;on&#39;) &amp;&amp; !has_key(plug, &#39;for&#39;)
</a><a href="#h6-0-217" id="h6-0-217" class="d">-      let s:loaded[name] = 1
</a><a href="#h6-0-218" id="h6-0-218" class="d">-      continue
</a><a href="#h6-0-219" id="h6-0-219" class="d">-    endif
</a><a href="#h6-0-220" id="h6-0-220" class="d">-
</a><a href="#h6-0-221" id="h6-0-221" class="d">-    if has_key(plug, &#39;on&#39;)
</a><a href="#h6-0-222" id="h6-0-222" class="d">-      let s:triggers[name] = { &#39;map&#39;: [], &#39;cmd&#39;: [] }
</a><a href="#h6-0-223" id="h6-0-223" class="d">-      for cmd in s:to_a(plug.on)
</a><a href="#h6-0-224" id="h6-0-224" class="d">-        if cmd =~? &#39;^&lt;Plug&gt;.\+&#39;
</a><a href="#h6-0-225" id="h6-0-225" class="d">-          if empty(mapcheck(cmd)) &amp;&amp; empty(mapcheck(cmd, &#39;i&#39;))
</a><a href="#h6-0-226" id="h6-0-226" class="d">-            call s:assoc(lod.map, cmd, name)
</a><a href="#h6-0-227" id="h6-0-227" class="d">-          endif
</a><a href="#h6-0-228" id="h6-0-228" class="d">-          call add(s:triggers[name].map, cmd)
</a><a href="#h6-0-229" id="h6-0-229" class="d">-        elseif cmd =~# &#39;^[A-Z]&#39;
</a><a href="#h6-0-230" id="h6-0-230" class="d">-          let cmd = substitute(cmd, &#39;!*$&#39;, &#39;&#39;, &#39;&#39;)
</a><a href="#h6-0-231" id="h6-0-231" class="d">-          if exists(&#39;:&#39;.cmd) != 2
</a><a href="#h6-0-232" id="h6-0-232" class="d">-            call s:assoc(lod.cmd, cmd, name)
</a><a href="#h6-0-233" id="h6-0-233" class="d">-          endif
</a><a href="#h6-0-234" id="h6-0-234" class="d">-          call add(s:triggers[name].cmd, cmd)
</a><a href="#h6-0-235" id="h6-0-235" class="d">-        else
</a><a href="#h6-0-236" id="h6-0-236" class="d">-          call s:err(&#39;Invalid `on` option: &#39;.cmd.
</a><a href="#h6-0-237" id="h6-0-237" class="d">-          \ &#39;. Should start with an uppercase letter or `&lt;Plug&gt;`.&#39;)
</a><a href="#h6-0-238" id="h6-0-238" class="d">-        endif
</a><a href="#h6-0-239" id="h6-0-239" class="d">-      endfor
</a><a href="#h6-0-240" id="h6-0-240" class="d">-    endif
</a><a href="#h6-0-241" id="h6-0-241" class="d">-
</a><a href="#h6-0-242" id="h6-0-242" class="d">-    if has_key(plug, &#39;for&#39;)
</a><a href="#h6-0-243" id="h6-0-243" class="d">-      let types = s:to_a(plug.for)
</a><a href="#h6-0-244" id="h6-0-244" class="d">-      if !empty(types)
</a><a href="#h6-0-245" id="h6-0-245" class="d">-        augroup filetypedetect
</a><a href="#h6-0-246" id="h6-0-246" class="d">-        call s:source(s:rtp(plug), &#39;ftdetect/**/*.vim&#39;, &#39;after/ftdetect/**/*.vim&#39;)
</a><a href="#h6-0-247" id="h6-0-247" class="d">-        augroup END
</a><a href="#h6-0-248" id="h6-0-248" class="d">-      endif
</a><a href="#h6-0-249" id="h6-0-249" class="d">-      for type in types
</a><a href="#h6-0-250" id="h6-0-250" class="d">-        call s:assoc(lod.ft, type, name)
</a><a href="#h6-0-251" id="h6-0-251" class="d">-      endfor
</a><a href="#h6-0-252" id="h6-0-252" class="d">-    endif
</a><a href="#h6-0-253" id="h6-0-253" class="d">-  endfor
</a><a href="#h6-0-254" id="h6-0-254" class="d">-
</a><a href="#h6-0-255" id="h6-0-255" class="d">-  for [cmd, names] in items(lod.cmd)
</a><a href="#h6-0-256" id="h6-0-256" class="d">-    execute printf(
</a><a href="#h6-0-257" id="h6-0-257" class="d">-    \ &#39;command! -nargs=* -range -bang -complete=file %s call s:lod_cmd(%s, &quot;&lt;bang&gt;&quot;, &lt;line1&gt;, &lt;line2&gt;, &lt;q-args&gt;, %s)&#39;,
</a><a href="#h6-0-258" id="h6-0-258" class="d">-    \ cmd, string(cmd), string(names))
</a><a href="#h6-0-259" id="h6-0-259" class="d">-  endfor
</a><a href="#h6-0-260" id="h6-0-260" class="d">-
</a><a href="#h6-0-261" id="h6-0-261" class="d">-  for [map, names] in items(lod.map)
</a><a href="#h6-0-262" id="h6-0-262" class="d">-    for [mode, map_prefix, key_prefix] in
</a><a href="#h6-0-263" id="h6-0-263" class="d">-          \ [[&#39;i&#39;, &#39;&lt;C-O&gt;&#39;, &#39;&#39;], [&#39;n&#39;, &#39;&#39;, &#39;&#39;], [&#39;v&#39;, &#39;&#39;, &#39;gv&#39;], [&#39;o&#39;, &#39;&#39;, &#39;&#39;]]
</a><a href="#h6-0-264" id="h6-0-264" class="d">-      execute printf(
</a><a href="#h6-0-265" id="h6-0-265" class="d">-      \ &#39;%snoremap &lt;silent&gt; %s %s:&lt;C-U&gt;call &lt;SID&gt;lod_map(%s, %s, %s, &quot;%s&quot;)&lt;CR&gt;&#39;,
</a><a href="#h6-0-266" id="h6-0-266" class="d">-      \ mode, map, map_prefix, string(map), string(names), mode != &#39;i&#39;, key_prefix)
</a><a href="#h6-0-267" id="h6-0-267" class="d">-    endfor
</a><a href="#h6-0-268" id="h6-0-268" class="d">-  endfor
</a><a href="#h6-0-269" id="h6-0-269" class="d">-
</a><a href="#h6-0-270" id="h6-0-270" class="d">-  for [ft, names] in items(lod.ft)
</a><a href="#h6-0-271" id="h6-0-271" class="d">-    augroup PlugLOD
</a><a href="#h6-0-272" id="h6-0-272" class="d">-      execute printf(&#39;autocmd FileType %s call &lt;SID&gt;lod_ft(%s, %s)&#39;,
</a><a href="#h6-0-273" id="h6-0-273" class="d">-            \ ft, string(ft), string(names))
</a><a href="#h6-0-274" id="h6-0-274" class="d">-    augroup END
</a><a href="#h6-0-275" id="h6-0-275" class="d">-  endfor
</a><a href="#h6-0-276" id="h6-0-276" class="d">-
</a><a href="#h6-0-277" id="h6-0-277" class="d">-  call s:reorg_rtp()
</a><a href="#h6-0-278" id="h6-0-278" class="d">-  filetype plugin indent on
</a><a href="#h6-0-279" id="h6-0-279" class="d">-  if has(&#39;vim_starting&#39;)
</a><a href="#h6-0-280" id="h6-0-280" class="d">-    if has(&#39;syntax&#39;) &amp;&amp; !exists(&#39;g:syntax_on&#39;)
</a><a href="#h6-0-281" id="h6-0-281" class="d">-      syntax enable
</a><a href="#h6-0-282" id="h6-0-282" class="d">-    end
</a><a href="#h6-0-283" id="h6-0-283" class="d">-  else
</a><a href="#h6-0-284" id="h6-0-284" class="d">-    call s:reload_plugins()
</a><a href="#h6-0-285" id="h6-0-285" class="d">-  endif
</a><a href="#h6-0-286" id="h6-0-286" class="d">-endfunction
</a><a href="#h6-0-287" id="h6-0-287" class="d">-
</a><a href="#h6-0-288" id="h6-0-288" class="d">-function! s:loaded_names()
</a><a href="#h6-0-289" id="h6-0-289" class="d">-  return filter(copy(g:plugs_order), &#39;get(s:loaded, v:val, 0)&#39;)
</a><a href="#h6-0-290" id="h6-0-290" class="d">-endfunction
</a><a href="#h6-0-291" id="h6-0-291" class="d">-
</a><a href="#h6-0-292" id="h6-0-292" class="d">-function! s:load_plugin(spec)
</a><a href="#h6-0-293" id="h6-0-293" class="d">-  call s:source(s:rtp(a:spec), &#39;plugin/**/*.vim&#39;, &#39;after/plugin/**/*.vim&#39;)
</a><a href="#h6-0-294" id="h6-0-294" class="d">-endfunction
</a><a href="#h6-0-295" id="h6-0-295" class="d">-
</a><a href="#h6-0-296" id="h6-0-296" class="d">-function! s:reload_plugins()
</a><a href="#h6-0-297" id="h6-0-297" class="d">-  for name in s:loaded_names()
</a><a href="#h6-0-298" id="h6-0-298" class="d">-    call s:load_plugin(g:plugs[name])
</a><a href="#h6-0-299" id="h6-0-299" class="d">-  endfor
</a><a href="#h6-0-300" id="h6-0-300" class="d">-endfunction
</a><a href="#h6-0-301" id="h6-0-301" class="d">-
</a><a href="#h6-0-302" id="h6-0-302" class="d">-function! s:trim(str)
</a><a href="#h6-0-303" id="h6-0-303" class="d">-  return substitute(a:str, &#39;[\/]\+$&#39;, &#39;&#39;, &#39;&#39;)
</a><a href="#h6-0-304" id="h6-0-304" class="d">-endfunction
</a><a href="#h6-0-305" id="h6-0-305" class="d">-
</a><a href="#h6-0-306" id="h6-0-306" class="d">-function! s:version_requirement(val, min)
</a><a href="#h6-0-307" id="h6-0-307" class="d">-  for idx in range(0, len(a:min) - 1)
</a><a href="#h6-0-308" id="h6-0-308" class="d">-    let v = get(a:val, idx, 0)
</a><a href="#h6-0-309" id="h6-0-309" class="d">-    if     v &lt; a:min[idx] | return 0
</a><a href="#h6-0-310" id="h6-0-310" class="d">-    elseif v &gt; a:min[idx] | return 1
</a><a href="#h6-0-311" id="h6-0-311" class="d">-    endif
</a><a href="#h6-0-312" id="h6-0-312" class="d">-  endfor
</a><a href="#h6-0-313" id="h6-0-313" class="d">-  return 1
</a><a href="#h6-0-314" id="h6-0-314" class="d">-endfunction
</a><a href="#h6-0-315" id="h6-0-315" class="d">-
</a><a href="#h6-0-316" id="h6-0-316" class="d">-function! s:git_version_requirement(...)
</a><a href="#h6-0-317" id="h6-0-317" class="d">-  if !exists(&#39;s:git_version&#39;)
</a><a href="#h6-0-318" id="h6-0-318" class="d">-    let s:git_version = map(split(split(s:system(&#39;git --version&#39;))[2], &#39;\.&#39;), &#39;str2nr(v:val)&#39;)
</a><a href="#h6-0-319" id="h6-0-319" class="d">-  endif
</a><a href="#h6-0-320" id="h6-0-320" class="d">-  return s:version_requirement(s:git_version, a:000)
</a><a href="#h6-0-321" id="h6-0-321" class="d">-endfunction
</a><a href="#h6-0-322" id="h6-0-322" class="d">-
</a><a href="#h6-0-323" id="h6-0-323" class="d">-function! s:progress_opt(base)
</a><a href="#h6-0-324" id="h6-0-324" class="d">-  return a:base &amp;&amp; !s:is_win &amp;&amp;
</a><a href="#h6-0-325" id="h6-0-325" class="d">-        \ s:git_version_requirement(1, 7, 1) ? &#39;--progress&#39; : &#39;&#39;
</a><a href="#h6-0-326" id="h6-0-326" class="d">-endfunction
</a><a href="#h6-0-327" id="h6-0-327" class="d">-
</a><a href="#h6-0-328" id="h6-0-328" class="d">-if s:is_win
</a><a href="#h6-0-329" id="h6-0-329" class="d">-  function! s:rtp(spec)
</a><a href="#h6-0-330" id="h6-0-330" class="d">-    return s:path(a:spec.dir . get(a:spec, &#39;rtp&#39;, &#39;&#39;))
</a><a href="#h6-0-331" id="h6-0-331" class="d">-  endfunction
</a><a href="#h6-0-332" id="h6-0-332" class="d">-
</a><a href="#h6-0-333" id="h6-0-333" class="d">-  function! s:path(path)
</a><a href="#h6-0-334" id="h6-0-334" class="d">-    return s:trim(substitute(a:path, &#39;/&#39;, &#39;\&#39;, &#39;g&#39;))
</a><a href="#h6-0-335" id="h6-0-335" class="d">-  endfunction
</a><a href="#h6-0-336" id="h6-0-336" class="d">-
</a><a href="#h6-0-337" id="h6-0-337" class="d">-  function! s:dirpath(path)
</a><a href="#h6-0-338" id="h6-0-338" class="d">-    return s:path(a:path) . &#39;\&#39;
</a><a href="#h6-0-339" id="h6-0-339" class="d">-  endfunction
</a><a href="#h6-0-340" id="h6-0-340" class="d">-
</a><a href="#h6-0-341" id="h6-0-341" class="d">-  function! s:is_local_plug(repo)
</a><a href="#h6-0-342" id="h6-0-342" class="d">-    return a:repo =~? &#39;^[a-z]:\|^[%~]&#39;
</a><a href="#h6-0-343" id="h6-0-343" class="d">-  endfunction
</a><a href="#h6-0-344" id="h6-0-344" class="d">-else
</a><a href="#h6-0-345" id="h6-0-345" class="d">-  function! s:rtp(spec)
</a><a href="#h6-0-346" id="h6-0-346" class="d">-    return s:dirpath(a:spec.dir . get(a:spec, &#39;rtp&#39;, &#39;&#39;))
</a><a href="#h6-0-347" id="h6-0-347" class="d">-  endfunction
</a><a href="#h6-0-348" id="h6-0-348" class="d">-
</a><a href="#h6-0-349" id="h6-0-349" class="d">-  function! s:path(path)
</a><a href="#h6-0-350" id="h6-0-350" class="d">-    return s:trim(a:path)
</a><a href="#h6-0-351" id="h6-0-351" class="d">-  endfunction
</a><a href="#h6-0-352" id="h6-0-352" class="d">-
</a><a href="#h6-0-353" id="h6-0-353" class="d">-  function! s:dirpath(path)
</a><a href="#h6-0-354" id="h6-0-354" class="d">-    return substitute(a:path, &#39;[/\\]*$&#39;, &#39;/&#39;, &#39;&#39;)
</a><a href="#h6-0-355" id="h6-0-355" class="d">-  endfunction
</a><a href="#h6-0-356" id="h6-0-356" class="d">-
</a><a href="#h6-0-357" id="h6-0-357" class="d">-  function! s:is_local_plug(repo)
</a><a href="#h6-0-358" id="h6-0-358" class="d">-    return a:repo[0] =~ &#39;[/$~]&#39;
</a><a href="#h6-0-359" id="h6-0-359" class="d">-  endfunction
</a><a href="#h6-0-360" id="h6-0-360" class="d">-endif
</a><a href="#h6-0-361" id="h6-0-361" class="d">-
</a><a href="#h6-0-362" id="h6-0-362" class="d">-function! s:err(msg)
</a><a href="#h6-0-363" id="h6-0-363" class="d">-  echohl ErrorMsg
</a><a href="#h6-0-364" id="h6-0-364" class="d">-  echom &#39;[vim-plug] &#39;.a:msg
</a><a href="#h6-0-365" id="h6-0-365" class="d">-  echohl None
</a><a href="#h6-0-366" id="h6-0-366" class="d">-endfunction
</a><a href="#h6-0-367" id="h6-0-367" class="d">-
</a><a href="#h6-0-368" id="h6-0-368" class="d">-function! s:warn(cmd, msg)
</a><a href="#h6-0-369" id="h6-0-369" class="d">-  echohl WarningMsg
</a><a href="#h6-0-370" id="h6-0-370" class="d">-  execute a:cmd &#39;a:msg&#39;
</a><a href="#h6-0-371" id="h6-0-371" class="d">-  echohl None
</a><a href="#h6-0-372" id="h6-0-372" class="d">-endfunction
</a><a href="#h6-0-373" id="h6-0-373" class="d">-
</a><a href="#h6-0-374" id="h6-0-374" class="d">-function! s:esc(path)
</a><a href="#h6-0-375" id="h6-0-375" class="d">-  return escape(a:path, &#39; &#39;)
</a><a href="#h6-0-376" id="h6-0-376" class="d">-endfunction
</a><a href="#h6-0-377" id="h6-0-377" class="d">-
</a><a href="#h6-0-378" id="h6-0-378" class="d">-function! s:escrtp(path)
</a><a href="#h6-0-379" id="h6-0-379" class="d">-  return escape(a:path, &#39; ,&#39;)
</a><a href="#h6-0-380" id="h6-0-380" class="d">-endfunction
</a><a href="#h6-0-381" id="h6-0-381" class="d">-
</a><a href="#h6-0-382" id="h6-0-382" class="d">-function! s:remove_rtp()
</a><a href="#h6-0-383" id="h6-0-383" class="d">-  for name in s:loaded_names()
</a><a href="#h6-0-384" id="h6-0-384" class="d">-    let rtp = s:rtp(g:plugs[name])
</a><a href="#h6-0-385" id="h6-0-385" class="d">-    execute &#39;set rtp-=&#39;.s:escrtp(rtp)
</a><a href="#h6-0-386" id="h6-0-386" class="d">-    let after = globpath(rtp, &#39;after&#39;)
</a><a href="#h6-0-387" id="h6-0-387" class="d">-    if isdirectory(after)
</a><a href="#h6-0-388" id="h6-0-388" class="d">-      execute &#39;set rtp-=&#39;.s:escrtp(after)
</a><a href="#h6-0-389" id="h6-0-389" class="d">-    endif
</a><a href="#h6-0-390" id="h6-0-390" class="d">-  endfor
</a><a href="#h6-0-391" id="h6-0-391" class="d">-endfunction
</a><a href="#h6-0-392" id="h6-0-392" class="d">-
</a><a href="#h6-0-393" id="h6-0-393" class="d">-function! s:reorg_rtp()
</a><a href="#h6-0-394" id="h6-0-394" class="d">-  if !empty(s:first_rtp)
</a><a href="#h6-0-395" id="h6-0-395" class="d">-    execute &#39;set rtp-=&#39;.s:first_rtp
</a><a href="#h6-0-396" id="h6-0-396" class="d">-    execute &#39;set rtp-=&#39;.s:last_rtp
</a><a href="#h6-0-397" id="h6-0-397" class="d">-  endif
</a><a href="#h6-0-398" id="h6-0-398" class="d">-
</a><a href="#h6-0-399" id="h6-0-399" class="d">-  &quot; &amp;rtp is modified from outside
</a><a href="#h6-0-400" id="h6-0-400" class="d">-  if exists(&#39;s:prtp&#39;) &amp;&amp; s:prtp !=# &amp;rtp
</a><a href="#h6-0-401" id="h6-0-401" class="d">-    call s:remove_rtp()
</a><a href="#h6-0-402" id="h6-0-402" class="d">-    unlet! s:middle
</a><a href="#h6-0-403" id="h6-0-403" class="d">-  endif
</a><a href="#h6-0-404" id="h6-0-404" class="d">-
</a><a href="#h6-0-405" id="h6-0-405" class="d">-  let s:middle = get(s:, &#39;middle&#39;, &amp;rtp)
</a><a href="#h6-0-406" id="h6-0-406" class="d">-  let rtps     = map(s:loaded_names(), &#39;s:rtp(g:plugs[v:val])&#39;)
</a><a href="#h6-0-407" id="h6-0-407" class="d">-  let afters   = filter(map(copy(rtps), &#39;globpath(v:val, &quot;after&quot;)&#39;), &#39;!empty(v:val)&#39;)
</a><a href="#h6-0-408" id="h6-0-408" class="d">-  let rtp      = join(map(rtps, &#39;escape(v:val, &quot;,&quot;)&#39;), &#39;,&#39;)
</a><a href="#h6-0-409" id="h6-0-409" class="d">-                 \ . &#39;,&#39;.s:middle.&#39;,&#39;
</a><a href="#h6-0-410" id="h6-0-410" class="d">-                 \ . join(map(afters, &#39;escape(v:val, &quot;,&quot;)&#39;), &#39;,&#39;)
</a><a href="#h6-0-411" id="h6-0-411" class="d">-  let &amp;rtp     = substitute(substitute(rtp, &#39;,,*&#39;, &#39;,&#39;, &#39;g&#39;), &#39;^,\|,$&#39;, &#39;&#39;, &#39;g&#39;)
</a><a href="#h6-0-412" id="h6-0-412" class="d">-  let s:prtp   = &amp;rtp
</a><a href="#h6-0-413" id="h6-0-413" class="d">-
</a><a href="#h6-0-414" id="h6-0-414" class="d">-  if !empty(s:first_rtp)
</a><a href="#h6-0-415" id="h6-0-415" class="d">-    execute &#39;set rtp^=&#39;.s:first_rtp
</a><a href="#h6-0-416" id="h6-0-416" class="d">-    execute &#39;set rtp+=&#39;.s:last_rtp
</a><a href="#h6-0-417" id="h6-0-417" class="d">-  endif
</a><a href="#h6-0-418" id="h6-0-418" class="d">-endfunction
</a><a href="#h6-0-419" id="h6-0-419" class="d">-
</a><a href="#h6-0-420" id="h6-0-420" class="d">-function! s:doautocmd(...)
</a><a href="#h6-0-421" id="h6-0-421" class="d">-  if exists(&#39;#&#39;.join(a:000, &#39;#&#39;))
</a><a href="#h6-0-422" id="h6-0-422" class="d">-    execute &#39;doautocmd&#39; ((v:version &gt; 703 || has(&#39;patch442&#39;)) ? &#39;&lt;nomodeline&gt;&#39; : &#39;&#39;) join(a:000)
</a><a href="#h6-0-423" id="h6-0-423" class="d">-  endif
</a><a href="#h6-0-424" id="h6-0-424" class="d">-endfunction
</a><a href="#h6-0-425" id="h6-0-425" class="d">-
</a><a href="#h6-0-426" id="h6-0-426" class="d">-function! s:dobufread(names)
</a><a href="#h6-0-427" id="h6-0-427" class="d">-  for name in a:names
</a><a href="#h6-0-428" id="h6-0-428" class="d">-    let path = s:rtp(g:plugs[name]).&#39;/**&#39;
</a><a href="#h6-0-429" id="h6-0-429" class="d">-    for dir in [&#39;ftdetect&#39;, &#39;ftplugin&#39;]
</a><a href="#h6-0-430" id="h6-0-430" class="d">-      if len(finddir(dir, path))
</a><a href="#h6-0-431" id="h6-0-431" class="d">-        if exists(&#39;#BufRead&#39;)
</a><a href="#h6-0-432" id="h6-0-432" class="d">-          doautocmd BufRead
</a><a href="#h6-0-433" id="h6-0-433" class="d">-        endif
</a><a href="#h6-0-434" id="h6-0-434" class="d">-        return
</a><a href="#h6-0-435" id="h6-0-435" class="d">-      endif
</a><a href="#h6-0-436" id="h6-0-436" class="d">-    endfor
</a><a href="#h6-0-437" id="h6-0-437" class="d">-  endfor
</a><a href="#h6-0-438" id="h6-0-438" class="d">-endfunction
</a><a href="#h6-0-439" id="h6-0-439" class="d">-
</a><a href="#h6-0-440" id="h6-0-440" class="d">-function! plug#load(...)
</a><a href="#h6-0-441" id="h6-0-441" class="d">-  if a:0 == 0
</a><a href="#h6-0-442" id="h6-0-442" class="d">-    return s:err(&#39;Argument missing: plugin name(s) required&#39;)
</a><a href="#h6-0-443" id="h6-0-443" class="d">-  endif
</a><a href="#h6-0-444" id="h6-0-444" class="d">-  if !exists(&#39;g:plugs&#39;)
</a><a href="#h6-0-445" id="h6-0-445" class="d">-    return s:err(&#39;plug#begin was not called&#39;)
</a><a href="#h6-0-446" id="h6-0-446" class="d">-  endif
</a><a href="#h6-0-447" id="h6-0-447" class="d">-  let names = a:0 == 1 &amp;&amp; type(a:1) == s:TYPE.list ? a:1 : a:000
</a><a href="#h6-0-448" id="h6-0-448" class="d">-  let unknowns = filter(copy(names), &#39;!has_key(g:plugs, v:val)&#39;)
</a><a href="#h6-0-449" id="h6-0-449" class="d">-  if !empty(unknowns)
</a><a href="#h6-0-450" id="h6-0-450" class="d">-    let s = len(unknowns) &gt; 1 ? &#39;s&#39; : &#39;&#39;
</a><a href="#h6-0-451" id="h6-0-451" class="d">-    return s:err(printf(&#39;Unknown plugin%s: %s&#39;, s, join(unknowns, &#39;, &#39;)))
</a><a href="#h6-0-452" id="h6-0-452" class="d">-  end
</a><a href="#h6-0-453" id="h6-0-453" class="d">-  let unloaded = filter(copy(names), &#39;!get(s:loaded, v:val, 0)&#39;)
</a><a href="#h6-0-454" id="h6-0-454" class="d">-  if !empty(unloaded)
</a><a href="#h6-0-455" id="h6-0-455" class="d">-    for name in unloaded
</a><a href="#h6-0-456" id="h6-0-456" class="d">-      call s:lod([name], [&#39;ftdetect&#39;, &#39;after/ftdetect&#39;, &#39;plugin&#39;, &#39;after/plugin&#39;])
</a><a href="#h6-0-457" id="h6-0-457" class="d">-    endfor
</a><a href="#h6-0-458" id="h6-0-458" class="d">-    call s:dobufread(unloaded)
</a><a href="#h6-0-459" id="h6-0-459" class="d">-    return 1
</a><a href="#h6-0-460" id="h6-0-460" class="d">-  end
</a><a href="#h6-0-461" id="h6-0-461" class="d">-  return 0
</a><a href="#h6-0-462" id="h6-0-462" class="d">-endfunction
</a><a href="#h6-0-463" id="h6-0-463" class="d">-
</a><a href="#h6-0-464" id="h6-0-464" class="d">-function! s:remove_triggers(name)
</a><a href="#h6-0-465" id="h6-0-465" class="d">-  if !has_key(s:triggers, a:name)
</a><a href="#h6-0-466" id="h6-0-466" class="d">-    return
</a><a href="#h6-0-467" id="h6-0-467" class="d">-  endif
</a><a href="#h6-0-468" id="h6-0-468" class="d">-  for cmd in s:triggers[a:name].cmd
</a><a href="#h6-0-469" id="h6-0-469" class="d">-    execute &#39;silent! delc&#39; cmd
</a><a href="#h6-0-470" id="h6-0-470" class="d">-  endfor
</a><a href="#h6-0-471" id="h6-0-471" class="d">-  for map in s:triggers[a:name].map
</a><a href="#h6-0-472" id="h6-0-472" class="d">-    execute &#39;silent! unmap&#39; map
</a><a href="#h6-0-473" id="h6-0-473" class="d">-    execute &#39;silent! iunmap&#39; map
</a><a href="#h6-0-474" id="h6-0-474" class="d">-  endfor
</a><a href="#h6-0-475" id="h6-0-475" class="d">-  call remove(s:triggers, a:name)
</a><a href="#h6-0-476" id="h6-0-476" class="d">-endfunction
</a><a href="#h6-0-477" id="h6-0-477" class="d">-
</a><a href="#h6-0-478" id="h6-0-478" class="d">-function! s:lod(names, types, ...)
</a><a href="#h6-0-479" id="h6-0-479" class="d">-  for name in a:names
</a><a href="#h6-0-480" id="h6-0-480" class="d">-    call s:remove_triggers(name)
</a><a href="#h6-0-481" id="h6-0-481" class="d">-    let s:loaded[name] = 1
</a><a href="#h6-0-482" id="h6-0-482" class="d">-  endfor
</a><a href="#h6-0-483" id="h6-0-483" class="d">-  call s:reorg_rtp()
</a><a href="#h6-0-484" id="h6-0-484" class="d">-
</a><a href="#h6-0-485" id="h6-0-485" class="d">-  for name in a:names
</a><a href="#h6-0-486" id="h6-0-486" class="d">-    let rtp = s:rtp(g:plugs[name])
</a><a href="#h6-0-487" id="h6-0-487" class="d">-    for dir in a:types
</a><a href="#h6-0-488" id="h6-0-488" class="d">-      call s:source(rtp, dir.&#39;/**/*.vim&#39;)
</a><a href="#h6-0-489" id="h6-0-489" class="d">-    endfor
</a><a href="#h6-0-490" id="h6-0-490" class="d">-    if a:0
</a><a href="#h6-0-491" id="h6-0-491" class="d">-      if !s:source(rtp, a:1) &amp;&amp; !empty(s:glob(rtp, a:2))
</a><a href="#h6-0-492" id="h6-0-492" class="d">-        execute &#39;runtime&#39; a:1
</a><a href="#h6-0-493" id="h6-0-493" class="d">-      endif
</a><a href="#h6-0-494" id="h6-0-494" class="d">-      call s:source(rtp, a:2)
</a><a href="#h6-0-495" id="h6-0-495" class="d">-    endif
</a><a href="#h6-0-496" id="h6-0-496" class="d">-    call s:doautocmd(&#39;User&#39;, name)
</a><a href="#h6-0-497" id="h6-0-497" class="d">-  endfor
</a><a href="#h6-0-498" id="h6-0-498" class="d">-endfunction
</a><a href="#h6-0-499" id="h6-0-499" class="d">-
</a><a href="#h6-0-500" id="h6-0-500" class="d">-function! s:lod_ft(pat, names)
</a><a href="#h6-0-501" id="h6-0-501" class="d">-  let syn = &#39;syntax/&#39;.a:pat.&#39;.vim&#39;
</a><a href="#h6-0-502" id="h6-0-502" class="d">-  call s:lod(a:names, [&#39;plugin&#39;, &#39;after/plugin&#39;], syn, &#39;after/&#39;.syn)
</a><a href="#h6-0-503" id="h6-0-503" class="d">-  execute &#39;autocmd! PlugLOD FileType&#39; a:pat
</a><a href="#h6-0-504" id="h6-0-504" class="d">-  call s:doautocmd(&#39;filetypeplugin&#39;, &#39;FileType&#39;)
</a><a href="#h6-0-505" id="h6-0-505" class="d">-  call s:doautocmd(&#39;filetypeindent&#39;, &#39;FileType&#39;)
</a><a href="#h6-0-506" id="h6-0-506" class="d">-endfunction
</a><a href="#h6-0-507" id="h6-0-507" class="d">-
</a><a href="#h6-0-508" id="h6-0-508" class="d">-function! s:lod_cmd(cmd, bang, l1, l2, args, names)
</a><a href="#h6-0-509" id="h6-0-509" class="d">-  call s:lod(a:names, [&#39;ftdetect&#39;, &#39;after/ftdetect&#39;, &#39;plugin&#39;, &#39;after/plugin&#39;])
</a><a href="#h6-0-510" id="h6-0-510" class="d">-  call s:dobufread(a:names)
</a><a href="#h6-0-511" id="h6-0-511" class="d">-  execute printf(&#39;%s%s%s %s&#39;, (a:l1 == a:l2 ? &#39;&#39; : (a:l1.&#39;,&#39;.a:l2)), a:cmd, a:bang, a:args)
</a><a href="#h6-0-512" id="h6-0-512" class="d">-endfunction
</a><a href="#h6-0-513" id="h6-0-513" class="d">-
</a><a href="#h6-0-514" id="h6-0-514" class="d">-function! s:lod_map(map, names, with_prefix, prefix)
</a><a href="#h6-0-515" id="h6-0-515" class="d">-  call s:lod(a:names, [&#39;ftdetect&#39;, &#39;after/ftdetect&#39;, &#39;plugin&#39;, &#39;after/plugin&#39;])
</a><a href="#h6-0-516" id="h6-0-516" class="d">-  call s:dobufread(a:names)
</a><a href="#h6-0-517" id="h6-0-517" class="d">-  let extra = &#39;&#39;
</a><a href="#h6-0-518" id="h6-0-518" class="d">-  while 1
</a><a href="#h6-0-519" id="h6-0-519" class="d">-    let c = getchar(0)
</a><a href="#h6-0-520" id="h6-0-520" class="d">-    if c == 0
</a><a href="#h6-0-521" id="h6-0-521" class="d">-      break
</a><a href="#h6-0-522" id="h6-0-522" class="d">-    endif
</a><a href="#h6-0-523" id="h6-0-523" class="d">-    let extra .= nr2char(c)
</a><a href="#h6-0-524" id="h6-0-524" class="d">-  endwhile
</a><a href="#h6-0-525" id="h6-0-525" class="d">-
</a><a href="#h6-0-526" id="h6-0-526" class="d">-  if a:with_prefix
</a><a href="#h6-0-527" id="h6-0-527" class="d">-    let prefix = v:count ? v:count : &#39;&#39;
</a><a href="#h6-0-528" id="h6-0-528" class="d">-    let prefix .= &#39;&quot;&#39;.v:register.a:prefix
</a><a href="#h6-0-529" id="h6-0-529" class="d">-    if mode(1) == &#39;no&#39;
</a><a href="#h6-0-530" id="h6-0-530" class="d">-      if v:operator == &#39;c&#39;
</a><a href="#h6-0-531" id="h6-0-531" class="d">-        let prefix = &quot;\&lt;esc&gt;&quot; . prefix
</a><a href="#h6-0-532" id="h6-0-532" class="d">-      endif
</a><a href="#h6-0-533" id="h6-0-533" class="d">-      let prefix .= v:operator
</a><a href="#h6-0-534" id="h6-0-534" class="d">-    endif
</a><a href="#h6-0-535" id="h6-0-535" class="d">-    call feedkeys(prefix, &#39;n&#39;)
</a><a href="#h6-0-536" id="h6-0-536" class="d">-  endif
</a><a href="#h6-0-537" id="h6-0-537" class="d">-  call feedkeys(substitute(a:map, &#39;^&lt;Plug&gt;&#39;, &quot;\&lt;Plug&gt;&quot;, &#39;&#39;) . extra)
</a><a href="#h6-0-538" id="h6-0-538" class="d">-endfunction
</a><a href="#h6-0-539" id="h6-0-539" class="d">-
</a><a href="#h6-0-540" id="h6-0-540" class="d">-function! plug#(repo, ...)
</a><a href="#h6-0-541" id="h6-0-541" class="d">-  if a:0 &gt; 1
</a><a href="#h6-0-542" id="h6-0-542" class="d">-    return s:err(&#39;Invalid number of arguments (1..2)&#39;)
</a><a href="#h6-0-543" id="h6-0-543" class="d">-  endif
</a><a href="#h6-0-544" id="h6-0-544" class="d">-
</a><a href="#h6-0-545" id="h6-0-545" class="d">-  try
</a><a href="#h6-0-546" id="h6-0-546" class="d">-    let repo = s:trim(a:repo)
</a><a href="#h6-0-547" id="h6-0-547" class="d">-    let opts = a:0 == 1 ? s:parse_options(a:1) : s:base_spec
</a><a href="#h6-0-548" id="h6-0-548" class="d">-    let name = get(opts, &#39;as&#39;, fnamemodify(repo, &#39;:t:s?\.git$??&#39;))
</a><a href="#h6-0-549" id="h6-0-549" class="d">-    let spec = extend(s:infer_properties(name, repo), opts)
</a><a href="#h6-0-550" id="h6-0-550" class="d">-    if !has_key(g:plugs, name)
</a><a href="#h6-0-551" id="h6-0-551" class="d">-      call add(g:plugs_order, name)
</a><a href="#h6-0-552" id="h6-0-552" class="d">-    endif
</a><a href="#h6-0-553" id="h6-0-553" class="d">-    let g:plugs[name] = spec
</a><a href="#h6-0-554" id="h6-0-554" class="d">-    let s:loaded[name] = get(s:loaded, name, 0)
</a><a href="#h6-0-555" id="h6-0-555" class="d">-  catch
</a><a href="#h6-0-556" id="h6-0-556" class="d">-    return s:err(v:exception)
</a><a href="#h6-0-557" id="h6-0-557" class="d">-  endtry
</a><a href="#h6-0-558" id="h6-0-558" class="d">-endfunction
</a><a href="#h6-0-559" id="h6-0-559" class="d">-
</a><a href="#h6-0-560" id="h6-0-560" class="d">-function! s:parse_options(arg)
</a><a href="#h6-0-561" id="h6-0-561" class="d">-  let opts = copy(s:base_spec)
</a><a href="#h6-0-562" id="h6-0-562" class="d">-  let type = type(a:arg)
</a><a href="#h6-0-563" id="h6-0-563" class="d">-  if type == s:TYPE.string
</a><a href="#h6-0-564" id="h6-0-564" class="d">-    let opts.tag = a:arg
</a><a href="#h6-0-565" id="h6-0-565" class="d">-  elseif type == s:TYPE.dict
</a><a href="#h6-0-566" id="h6-0-566" class="d">-    call extend(opts, a:arg)
</a><a href="#h6-0-567" id="h6-0-567" class="d">-    if has_key(opts, &#39;dir&#39;)
</a><a href="#h6-0-568" id="h6-0-568" class="d">-      let opts.dir = s:dirpath(expand(opts.dir))
</a><a href="#h6-0-569" id="h6-0-569" class="d">-    endif
</a><a href="#h6-0-570" id="h6-0-570" class="d">-  else
</a><a href="#h6-0-571" id="h6-0-571" class="d">-    throw &#39;Invalid argument type (expected: string or dictionary)&#39;
</a><a href="#h6-0-572" id="h6-0-572" class="d">-  endif
</a><a href="#h6-0-573" id="h6-0-573" class="d">-  return opts
</a><a href="#h6-0-574" id="h6-0-574" class="d">-endfunction
</a><a href="#h6-0-575" id="h6-0-575" class="d">-
</a><a href="#h6-0-576" id="h6-0-576" class="d">-function! s:infer_properties(name, repo)
</a><a href="#h6-0-577" id="h6-0-577" class="d">-  let repo = a:repo
</a><a href="#h6-0-578" id="h6-0-578" class="d">-  if s:is_local_plug(repo)
</a><a href="#h6-0-579" id="h6-0-579" class="d">-    return { &#39;dir&#39;: s:dirpath(expand(repo)) }
</a><a href="#h6-0-580" id="h6-0-580" class="d">-  else
</a><a href="#h6-0-581" id="h6-0-581" class="d">-    if repo =~ &#39;:&#39;
</a><a href="#h6-0-582" id="h6-0-582" class="d">-      let uri = repo
</a><a href="#h6-0-583" id="h6-0-583" class="d">-    else
</a><a href="#h6-0-584" id="h6-0-584" class="d">-      if repo !~ &#39;/&#39;
</a><a href="#h6-0-585" id="h6-0-585" class="d">-        throw printf(&#39;Invalid argument: %s (implicit `vim-scripts&#39;&#39; expansion is deprecated)&#39;, repo)
</a><a href="#h6-0-586" id="h6-0-586" class="d">-      endif
</a><a href="#h6-0-587" id="h6-0-587" class="d">-      let fmt = get(g:, &#39;plug_url_format&#39;, &#39;https://git::@github.com/%s.git&#39;)
</a><a href="#h6-0-588" id="h6-0-588" class="d">-      let uri = printf(fmt, repo)
</a><a href="#h6-0-589" id="h6-0-589" class="d">-    endif
</a><a href="#h6-0-590" id="h6-0-590" class="d">-    return { &#39;dir&#39;: s:dirpath(g:plug_home.&#39;/&#39;.a:name), &#39;uri&#39;: uri }
</a><a href="#h6-0-591" id="h6-0-591" class="d">-  endif
</a><a href="#h6-0-592" id="h6-0-592" class="d">-endfunction
</a><a href="#h6-0-593" id="h6-0-593" class="d">-
</a><a href="#h6-0-594" id="h6-0-594" class="d">-function! s:install(force, names)
</a><a href="#h6-0-595" id="h6-0-595" class="d">-  call s:update_impl(0, a:force, a:names)
</a><a href="#h6-0-596" id="h6-0-596" class="d">-endfunction
</a><a href="#h6-0-597" id="h6-0-597" class="d">-
</a><a href="#h6-0-598" id="h6-0-598" class="d">-function! s:update(force, names)
</a><a href="#h6-0-599" id="h6-0-599" class="d">-  call s:update_impl(1, a:force, a:names)
</a><a href="#h6-0-600" id="h6-0-600" class="d">-endfunction
</a><a href="#h6-0-601" id="h6-0-601" class="d">-
</a><a href="#h6-0-602" id="h6-0-602" class="d">-function! plug#helptags()
</a><a href="#h6-0-603" id="h6-0-603" class="d">-  if !exists(&#39;g:plugs&#39;)
</a><a href="#h6-0-604" id="h6-0-604" class="d">-    return s:err(&#39;plug#begin was not called&#39;)
</a><a href="#h6-0-605" id="h6-0-605" class="d">-  endif
</a><a href="#h6-0-606" id="h6-0-606" class="d">-  for spec in values(g:plugs)
</a><a href="#h6-0-607" id="h6-0-607" class="d">-    let docd = join([spec.dir, &#39;doc&#39;], &#39;/&#39;)
</a><a href="#h6-0-608" id="h6-0-608" class="d">-    if isdirectory(docd)
</a><a href="#h6-0-609" id="h6-0-609" class="d">-      silent! execute &#39;helptags&#39; s:esc(docd)
</a><a href="#h6-0-610" id="h6-0-610" class="d">-    endif
</a><a href="#h6-0-611" id="h6-0-611" class="d">-  endfor
</a><a href="#h6-0-612" id="h6-0-612" class="d">-  return 1
</a><a href="#h6-0-613" id="h6-0-613" class="d">-endfunction
</a><a href="#h6-0-614" id="h6-0-614" class="d">-
</a><a href="#h6-0-615" id="h6-0-615" class="d">-function! s:syntax()
</a><a href="#h6-0-616" id="h6-0-616" class="d">-  syntax clear
</a><a href="#h6-0-617" id="h6-0-617" class="d">-  syntax region plug1 start=/\%1l/ end=/\%2l/ contains=plugNumber
</a><a href="#h6-0-618" id="h6-0-618" class="d">-  syntax region plug2 start=/\%2l/ end=/\%3l/ contains=plugBracket,plugX
</a><a href="#h6-0-619" id="h6-0-619" class="d">-  syn match plugNumber /[0-9]\+[0-9.]*/ contained
</a><a href="#h6-0-620" id="h6-0-620" class="d">-  syn match plugBracket /[[\]]/ contained
</a><a href="#h6-0-621" id="h6-0-621" class="d">-  syn match plugX /x/ contained
</a><a href="#h6-0-622" id="h6-0-622" class="d">-  syn match plugDash /^-/
</a><a href="#h6-0-623" id="h6-0-623" class="d">-  syn match plugPlus /^+/
</a><a href="#h6-0-624" id="h6-0-624" class="d">-  syn match plugStar /^*/
</a><a href="#h6-0-625" id="h6-0-625" class="d">-  syn match plugMessage /\(^- \)\@&lt;=.*/
</a><a href="#h6-0-626" id="h6-0-626" class="d">-  syn match plugName /\(^- \)\@&lt;=[^ ]*:/
</a><a href="#h6-0-627" id="h6-0-627" class="d">-  syn match plugSha /\%(: \)\@&lt;=[0-9a-f]\{4,}$/
</a><a href="#h6-0-628" id="h6-0-628" class="d">-  syn match plugTag /(tag: [^)]\+)/
</a><a href="#h6-0-629" id="h6-0-629" class="d">-  syn match plugInstall /\(^+ \)\@&lt;=[^:]*/
</a><a href="#h6-0-630" id="h6-0-630" class="d">-  syn match plugUpdate /\(^* \)\@&lt;=[^:]*/
</a><a href="#h6-0-631" id="h6-0-631" class="d">-  syn match plugCommit /^  \X*[0-9a-f]\{7,9} .*/ contains=plugRelDate,plugEdge,plugTag
</a><a href="#h6-0-632" id="h6-0-632" class="d">-  syn match plugEdge /^  \X\+$/
</a><a href="#h6-0-633" id="h6-0-633" class="d">-  syn match plugEdge /^  \X*/ contained nextgroup=plugSha
</a><a href="#h6-0-634" id="h6-0-634" class="d">-  syn match plugSha /[0-9a-f]\{7,9}/ contained
</a><a href="#h6-0-635" id="h6-0-635" class="d">-  syn match plugRelDate /([^)]*)$/ contained
</a><a href="#h6-0-636" id="h6-0-636" class="d">-  syn match plugNotLoaded /(not loaded)$/
</a><a href="#h6-0-637" id="h6-0-637" class="d">-  syn match plugError /^x.*/
</a><a href="#h6-0-638" id="h6-0-638" class="d">-  syn region plugDeleted start=/^\~ .*/ end=/^\ze\S/
</a><a href="#h6-0-639" id="h6-0-639" class="d">-  syn match plugH2 /^.*:\n-\+$/
</a><a href="#h6-0-640" id="h6-0-640" class="d">-  syn keyword Function PlugInstall PlugStatus PlugUpdate PlugClean
</a><a href="#h6-0-641" id="h6-0-641" class="d">-  hi def link plug1       Title
</a><a href="#h6-0-642" id="h6-0-642" class="d">-  hi def link plug2       Repeat
</a><a href="#h6-0-643" id="h6-0-643" class="d">-  hi def link plugH2      Type
</a><a href="#h6-0-644" id="h6-0-644" class="d">-  hi def link plugX       Exception
</a><a href="#h6-0-645" id="h6-0-645" class="d">-  hi def link plugBracket Structure
</a><a href="#h6-0-646" id="h6-0-646" class="d">-  hi def link plugNumber  Number
</a><a href="#h6-0-647" id="h6-0-647" class="d">-
</a><a href="#h6-0-648" id="h6-0-648" class="d">-  hi def link plugDash    Special
</a><a href="#h6-0-649" id="h6-0-649" class="d">-  hi def link plugPlus    Constant
</a><a href="#h6-0-650" id="h6-0-650" class="d">-  hi def link plugStar    Boolean
</a><a href="#h6-0-651" id="h6-0-651" class="d">-
</a><a href="#h6-0-652" id="h6-0-652" class="d">-  hi def link plugMessage Function
</a><a href="#h6-0-653" id="h6-0-653" class="d">-  hi def link plugName    Label
</a><a href="#h6-0-654" id="h6-0-654" class="d">-  hi def link plugInstall Function
</a><a href="#h6-0-655" id="h6-0-655" class="d">-  hi def link plugUpdate  Type
</a><a href="#h6-0-656" id="h6-0-656" class="d">-
</a><a href="#h6-0-657" id="h6-0-657" class="d">-  hi def link plugError   Error
</a><a href="#h6-0-658" id="h6-0-658" class="d">-  hi def link plugDeleted Ignore
</a><a href="#h6-0-659" id="h6-0-659" class="d">-  hi def link plugRelDate Comment
</a><a href="#h6-0-660" id="h6-0-660" class="d">-  hi def link plugEdge    PreProc
</a><a href="#h6-0-661" id="h6-0-661" class="d">-  hi def link plugSha     Identifier
</a><a href="#h6-0-662" id="h6-0-662" class="d">-  hi def link plugTag     Constant
</a><a href="#h6-0-663" id="h6-0-663" class="d">-
</a><a href="#h6-0-664" id="h6-0-664" class="d">-  hi def link plugNotLoaded Comment
</a><a href="#h6-0-665" id="h6-0-665" class="d">-endfunction
</a><a href="#h6-0-666" id="h6-0-666" class="d">-
</a><a href="#h6-0-667" id="h6-0-667" class="d">-function! s:lpad(str, len)
</a><a href="#h6-0-668" id="h6-0-668" class="d">-  return a:str . repeat(&#39; &#39;, a:len - len(a:str))
</a><a href="#h6-0-669" id="h6-0-669" class="d">-endfunction
</a><a href="#h6-0-670" id="h6-0-670" class="d">-
</a><a href="#h6-0-671" id="h6-0-671" class="d">-function! s:lines(msg)
</a><a href="#h6-0-672" id="h6-0-672" class="d">-  return split(a:msg, &quot;[\r\n]&quot;)
</a><a href="#h6-0-673" id="h6-0-673" class="d">-endfunction
</a><a href="#h6-0-674" id="h6-0-674" class="d">-
</a><a href="#h6-0-675" id="h6-0-675" class="d">-function! s:lastline(msg)
</a><a href="#h6-0-676" id="h6-0-676" class="d">-  return get(s:lines(a:msg), -1, &#39;&#39;)
</a><a href="#h6-0-677" id="h6-0-677" class="d">-endfunction
</a><a href="#h6-0-678" id="h6-0-678" class="d">-
</a><a href="#h6-0-679" id="h6-0-679" class="d">-function! s:new_window()
</a><a href="#h6-0-680" id="h6-0-680" class="d">-  execute get(g:, &#39;plug_window&#39;, &#39;vertical topleft new&#39;)
</a><a href="#h6-0-681" id="h6-0-681" class="d">-endfunction
</a><a href="#h6-0-682" id="h6-0-682" class="d">-
</a><a href="#h6-0-683" id="h6-0-683" class="d">-function! s:plug_window_exists()
</a><a href="#h6-0-684" id="h6-0-684" class="d">-  let buflist = tabpagebuflist(s:plug_tab)
</a><a href="#h6-0-685" id="h6-0-685" class="d">-  return !empty(buflist) &amp;&amp; index(buflist, s:plug_buf) &gt;= 0
</a><a href="#h6-0-686" id="h6-0-686" class="d">-endfunction
</a><a href="#h6-0-687" id="h6-0-687" class="d">-
</a><a href="#h6-0-688" id="h6-0-688" class="d">-function! s:switch_in()
</a><a href="#h6-0-689" id="h6-0-689" class="d">-  if !s:plug_window_exists()
</a><a href="#h6-0-690" id="h6-0-690" class="d">-    return 0
</a><a href="#h6-0-691" id="h6-0-691" class="d">-  endif
</a><a href="#h6-0-692" id="h6-0-692" class="d">-
</a><a href="#h6-0-693" id="h6-0-693" class="d">-  if winbufnr(0) != s:plug_buf
</a><a href="#h6-0-694" id="h6-0-694" class="d">-    let s:pos = [tabpagenr(), winnr(), winsaveview()]
</a><a href="#h6-0-695" id="h6-0-695" class="d">-    execute &#39;normal!&#39; s:plug_tab.&#39;gt&#39;
</a><a href="#h6-0-696" id="h6-0-696" class="d">-    let winnr = bufwinnr(s:plug_buf)
</a><a href="#h6-0-697" id="h6-0-697" class="d">-    execute winnr.&#39;wincmd w&#39;
</a><a href="#h6-0-698" id="h6-0-698" class="d">-    call add(s:pos, winsaveview())
</a><a href="#h6-0-699" id="h6-0-699" class="d">-  else
</a><a href="#h6-0-700" id="h6-0-700" class="d">-    let s:pos = [winsaveview()]
</a><a href="#h6-0-701" id="h6-0-701" class="d">-  endif
</a><a href="#h6-0-702" id="h6-0-702" class="d">-
</a><a href="#h6-0-703" id="h6-0-703" class="d">-  setlocal modifiable
</a><a href="#h6-0-704" id="h6-0-704" class="d">-  return 1
</a><a href="#h6-0-705" id="h6-0-705" class="d">-endfunction
</a><a href="#h6-0-706" id="h6-0-706" class="d">-
</a><a href="#h6-0-707" id="h6-0-707" class="d">-function! s:switch_out(...)
</a><a href="#h6-0-708" id="h6-0-708" class="d">-  call winrestview(s:pos[-1])
</a><a href="#h6-0-709" id="h6-0-709" class="d">-  setlocal nomodifiable
</a><a href="#h6-0-710" id="h6-0-710" class="d">-  if a:0 &gt; 0
</a><a href="#h6-0-711" id="h6-0-711" class="d">-    execute a:1
</a><a href="#h6-0-712" id="h6-0-712" class="d">-  endif
</a><a href="#h6-0-713" id="h6-0-713" class="d">-
</a><a href="#h6-0-714" id="h6-0-714" class="d">-  if len(s:pos) &gt; 1
</a><a href="#h6-0-715" id="h6-0-715" class="d">-    execute &#39;normal!&#39; s:pos[0].&#39;gt&#39;
</a><a href="#h6-0-716" id="h6-0-716" class="d">-    execute s:pos[1] &#39;wincmd w&#39;
</a><a href="#h6-0-717" id="h6-0-717" class="d">-    call winrestview(s:pos[2])
</a><a href="#h6-0-718" id="h6-0-718" class="d">-  endif
</a><a href="#h6-0-719" id="h6-0-719" class="d">-endfunction
</a><a href="#h6-0-720" id="h6-0-720" class="d">-
</a><a href="#h6-0-721" id="h6-0-721" class="d">-function! s:finish_bindings()
</a><a href="#h6-0-722" id="h6-0-722" class="d">-  nnoremap &lt;silent&gt; &lt;buffer&gt; R  :call &lt;SID&gt;retry()&lt;cr&gt;
</a><a href="#h6-0-723" id="h6-0-723" class="d">-  nnoremap &lt;silent&gt; &lt;buffer&gt; D  :PlugDiff&lt;cr&gt;
</a><a href="#h6-0-724" id="h6-0-724" class="d">-  nnoremap &lt;silent&gt; &lt;buffer&gt; S  :PlugStatus&lt;cr&gt;
</a><a href="#h6-0-725" id="h6-0-725" class="d">-  nnoremap &lt;silent&gt; &lt;buffer&gt; U  :call &lt;SID&gt;status_update()&lt;cr&gt;
</a><a href="#h6-0-726" id="h6-0-726" class="d">-  xnoremap &lt;silent&gt; &lt;buffer&gt; U  :call &lt;SID&gt;status_update()&lt;cr&gt;
</a><a href="#h6-0-727" id="h6-0-727" class="d">-  nnoremap &lt;silent&gt; &lt;buffer&gt; ]] :silent! call &lt;SID&gt;section(&#39;&#39;)&lt;cr&gt;
</a><a href="#h6-0-728" id="h6-0-728" class="d">-  nnoremap &lt;silent&gt; &lt;buffer&gt; [[ :silent! call &lt;SID&gt;section(&#39;b&#39;)&lt;cr&gt;
</a><a href="#h6-0-729" id="h6-0-729" class="d">-endfunction
</a><a href="#h6-0-730" id="h6-0-730" class="d">-
</a><a href="#h6-0-731" id="h6-0-731" class="d">-function! s:prepare(...)
</a><a href="#h6-0-732" id="h6-0-732" class="d">-  if empty(getcwd())
</a><a href="#h6-0-733" id="h6-0-733" class="d">-    throw &#39;Invalid current working directory. Cannot proceed.&#39;
</a><a href="#h6-0-734" id="h6-0-734" class="d">-  endif
</a><a href="#h6-0-735" id="h6-0-735" class="d">-
</a><a href="#h6-0-736" id="h6-0-736" class="d">-  for evar in [&#39;$GIT_DIR&#39;, &#39;$GIT_WORK_TREE&#39;]
</a><a href="#h6-0-737" id="h6-0-737" class="d">-    if exists(evar)
</a><a href="#h6-0-738" id="h6-0-738" class="d">-      throw evar.&#39; detected. Cannot proceed.&#39;
</a><a href="#h6-0-739" id="h6-0-739" class="d">-    endif
</a><a href="#h6-0-740" id="h6-0-740" class="d">-  endfor
</a><a href="#h6-0-741" id="h6-0-741" class="d">-
</a><a href="#h6-0-742" id="h6-0-742" class="d">-  call s:job_abort()
</a><a href="#h6-0-743" id="h6-0-743" class="d">-  if s:switch_in()
</a><a href="#h6-0-744" id="h6-0-744" class="d">-    if b:plug_preview == 1
</a><a href="#h6-0-745" id="h6-0-745" class="d">-      pc
</a><a href="#h6-0-746" id="h6-0-746" class="d">-    endif
</a><a href="#h6-0-747" id="h6-0-747" class="d">-    enew
</a><a href="#h6-0-748" id="h6-0-748" class="d">-  else
</a><a href="#h6-0-749" id="h6-0-749" class="d">-    call s:new_window()
</a><a href="#h6-0-750" id="h6-0-750" class="d">-  endif
</a><a href="#h6-0-751" id="h6-0-751" class="d">-
</a><a href="#h6-0-752" id="h6-0-752" class="d">-  nnoremap &lt;silent&gt; &lt;buffer&gt; q  :if b:plug_preview==1&lt;bar&gt;pc&lt;bar&gt;endif&lt;bar&gt;bd&lt;cr&gt;
</a><a href="#h6-0-753" id="h6-0-753" class="d">-  if a:0 == 0
</a><a href="#h6-0-754" id="h6-0-754" class="d">-    call s:finish_bindings()
</a><a href="#h6-0-755" id="h6-0-755" class="d">-  endif
</a><a href="#h6-0-756" id="h6-0-756" class="d">-  let b:plug_preview = -1
</a><a href="#h6-0-757" id="h6-0-757" class="d">-  let s:plug_tab = tabpagenr()
</a><a href="#h6-0-758" id="h6-0-758" class="d">-  let s:plug_buf = winbufnr(0)
</a><a href="#h6-0-759" id="h6-0-759" class="d">-  call s:assign_name()
</a><a href="#h6-0-760" id="h6-0-760" class="d">-
</a><a href="#h6-0-761" id="h6-0-761" class="d">-  for k in [&#39;&lt;cr&gt;&#39;, &#39;L&#39;, &#39;o&#39;, &#39;X&#39;, &#39;d&#39;, &#39;dd&#39;]
</a><a href="#h6-0-762" id="h6-0-762" class="d">-    execute &#39;silent! unmap &lt;buffer&gt;&#39; k
</a><a href="#h6-0-763" id="h6-0-763" class="d">-  endfor
</a><a href="#h6-0-764" id="h6-0-764" class="d">-  setlocal buftype=nofile bufhidden=wipe nobuflisted nolist noswapfile nowrap cursorline modifiable nospell
</a><a href="#h6-0-765" id="h6-0-765" class="d">-  setf vim-plug
</a><a href="#h6-0-766" id="h6-0-766" class="d">-  if exists(&#39;g:syntax_on&#39;)
</a><a href="#h6-0-767" id="h6-0-767" class="d">-    call s:syntax()
</a><a href="#h6-0-768" id="h6-0-768" class="d">-  endif
</a><a href="#h6-0-769" id="h6-0-769" class="d">-endfunction
</a><a href="#h6-0-770" id="h6-0-770" class="d">-
</a><a href="#h6-0-771" id="h6-0-771" class="d">-function! s:assign_name()
</a><a href="#h6-0-772" id="h6-0-772" class="d">-  &quot; Assign buffer name
</a><a href="#h6-0-773" id="h6-0-773" class="d">-  let prefix = &#39;[Plugins]&#39;
</a><a href="#h6-0-774" id="h6-0-774" class="d">-  let name   = prefix
</a><a href="#h6-0-775" id="h6-0-775" class="d">-  let idx    = 2
</a><a href="#h6-0-776" id="h6-0-776" class="d">-  while bufexists(name)
</a><a href="#h6-0-777" id="h6-0-777" class="d">-    let name = printf(&#39;%s (%s)&#39;, prefix, idx)
</a><a href="#h6-0-778" id="h6-0-778" class="d">-    let idx = idx + 1
</a><a href="#h6-0-779" id="h6-0-779" class="d">-  endwhile
</a><a href="#h6-0-780" id="h6-0-780" class="d">-  silent! execute &#39;f&#39; fnameescape(name)
</a><a href="#h6-0-781" id="h6-0-781" class="d">-endfunction
</a><a href="#h6-0-782" id="h6-0-782" class="d">-
</a><a href="#h6-0-783" id="h6-0-783" class="d">-function! s:chsh(swap)
</a><a href="#h6-0-784" id="h6-0-784" class="d">-  let prev = [&amp;shell, &amp;shellredir]
</a><a href="#h6-0-785" id="h6-0-785" class="d">-  if !s:is_win &amp;&amp; a:swap
</a><a href="#h6-0-786" id="h6-0-786" class="d">-    set shell=sh shellredir=&gt;%s\ 2&gt;&amp;1
</a><a href="#h6-0-787" id="h6-0-787" class="d">-  endif
</a><a href="#h6-0-788" id="h6-0-788" class="d">-  return prev
</a><a href="#h6-0-789" id="h6-0-789" class="d">-endfunction
</a><a href="#h6-0-790" id="h6-0-790" class="d">-
</a><a href="#h6-0-791" id="h6-0-791" class="d">-function! s:bang(cmd, ...)
</a><a href="#h6-0-792" id="h6-0-792" class="d">-  try
</a><a href="#h6-0-793" id="h6-0-793" class="d">-    let [sh, shrd] = s:chsh(a:0)
</a><a href="#h6-0-794" id="h6-0-794" class="d">-    &quot; FIXME: Escaping is incomplete. We could use shellescape with eval,
</a><a href="#h6-0-795" id="h6-0-795" class="d">-    &quot;        but it won&#39;t work on Windows.
</a><a href="#h6-0-796" id="h6-0-796" class="d">-    let cmd = a:0 ? s:with_cd(a:cmd, a:1) : a:cmd
</a><a href="#h6-0-797" id="h6-0-797" class="d">-    let g:_plug_bang = &#39;!&#39;.escape(cmd, &#39;#!%&#39;)
</a><a href="#h6-0-798" id="h6-0-798" class="d">-    execute &quot;normal! :execute g:_plug_bang\&lt;cr&gt;\&lt;cr&gt;&quot;
</a><a href="#h6-0-799" id="h6-0-799" class="d">-  finally
</a><a href="#h6-0-800" id="h6-0-800" class="d">-    unlet g:_plug_bang
</a><a href="#h6-0-801" id="h6-0-801" class="d">-    let [&amp;shell, &amp;shellredir] = [sh, shrd]
</a><a href="#h6-0-802" id="h6-0-802" class="d">-  endtry
</a><a href="#h6-0-803" id="h6-0-803" class="d">-  return v:shell_error ? &#39;Exit status: &#39; . v:shell_error : &#39;&#39;
</a><a href="#h6-0-804" id="h6-0-804" class="d">-endfunction
</a><a href="#h6-0-805" id="h6-0-805" class="d">-
</a><a href="#h6-0-806" id="h6-0-806" class="d">-function! s:regress_bar()
</a><a href="#h6-0-807" id="h6-0-807" class="d">-  let bar = substitute(getline(2)[1:-2], &#39;.*\zs=&#39;, &#39;x&#39;, &#39;&#39;)
</a><a href="#h6-0-808" id="h6-0-808" class="d">-  call s:progress_bar(2, bar, len(bar))
</a><a href="#h6-0-809" id="h6-0-809" class="d">-endfunction
</a><a href="#h6-0-810" id="h6-0-810" class="d">-
</a><a href="#h6-0-811" id="h6-0-811" class="d">-function! s:is_updated(dir)
</a><a href="#h6-0-812" id="h6-0-812" class="d">-  return !empty(s:system_chomp(&#39;git log --pretty=format:&quot;%h&quot; &quot;HEAD...HEAD@{1}&quot;&#39;, a:dir))
</a><a href="#h6-0-813" id="h6-0-813" class="d">-endfunction
</a><a href="#h6-0-814" id="h6-0-814" class="d">-
</a><a href="#h6-0-815" id="h6-0-815" class="d">-function! s:do(pull, force, todo)
</a><a href="#h6-0-816" id="h6-0-816" class="d">-  for [name, spec] in items(a:todo)
</a><a href="#h6-0-817" id="h6-0-817" class="d">-    if !isdirectory(spec.dir)
</a><a href="#h6-0-818" id="h6-0-818" class="d">-      continue
</a><a href="#h6-0-819" id="h6-0-819" class="d">-    endif
</a><a href="#h6-0-820" id="h6-0-820" class="d">-    let installed = has_key(s:update.new, name)
</a><a href="#h6-0-821" id="h6-0-821" class="d">-    let updated = installed ? 0 :
</a><a href="#h6-0-822" id="h6-0-822" class="d">-      \ (a:pull &amp;&amp; index(s:update.errors, name) &lt; 0 &amp;&amp; s:is_updated(spec.dir))
</a><a href="#h6-0-823" id="h6-0-823" class="d">-    if a:force || installed || updated
</a><a href="#h6-0-824" id="h6-0-824" class="d">-      execute &#39;cd&#39; s:esc(spec.dir)
</a><a href="#h6-0-825" id="h6-0-825" class="d">-      call append(3, &#39;- Post-update hook for &#39;. name .&#39; ... &#39;)
</a><a href="#h6-0-826" id="h6-0-826" class="d">-      let error = &#39;&#39;
</a><a href="#h6-0-827" id="h6-0-827" class="d">-      let type = type(spec.do)
</a><a href="#h6-0-828" id="h6-0-828" class="d">-      if type == s:TYPE.string
</a><a href="#h6-0-829" id="h6-0-829" class="d">-        if spec.do[0] == &#39;:&#39;
</a><a href="#h6-0-830" id="h6-0-830" class="d">-          if !get(s:loaded, name, 0)
</a><a href="#h6-0-831" id="h6-0-831" class="d">-            let s:loaded[name] = 1
</a><a href="#h6-0-832" id="h6-0-832" class="d">-            call s:reorg_rtp()
</a><a href="#h6-0-833" id="h6-0-833" class="d">-          endif
</a><a href="#h6-0-834" id="h6-0-834" class="d">-          call s:load_plugin(spec)
</a><a href="#h6-0-835" id="h6-0-835" class="d">-          try
</a><a href="#h6-0-836" id="h6-0-836" class="d">-            execute spec.do[1:]
</a><a href="#h6-0-837" id="h6-0-837" class="d">-          catch
</a><a href="#h6-0-838" id="h6-0-838" class="d">-            let error = v:exception
</a><a href="#h6-0-839" id="h6-0-839" class="d">-          endtry
</a><a href="#h6-0-840" id="h6-0-840" class="d">-          if !s:plug_window_exists()
</a><a href="#h6-0-841" id="h6-0-841" class="d">-            cd -
</a><a href="#h6-0-842" id="h6-0-842" class="d">-            throw &#39;Warning: vim-plug was terminated by the post-update hook of &#39;.name
</a><a href="#h6-0-843" id="h6-0-843" class="d">-          endif
</a><a href="#h6-0-844" id="h6-0-844" class="d">-        else
</a><a href="#h6-0-845" id="h6-0-845" class="d">-          let error = s:bang(spec.do)
</a><a href="#h6-0-846" id="h6-0-846" class="d">-        endif
</a><a href="#h6-0-847" id="h6-0-847" class="d">-      elseif type == s:TYPE.funcref
</a><a href="#h6-0-848" id="h6-0-848" class="d">-        try
</a><a href="#h6-0-849" id="h6-0-849" class="d">-          let status = installed ? &#39;installed&#39; : (updated ? &#39;updated&#39; : &#39;unchanged&#39;)
</a><a href="#h6-0-850" id="h6-0-850" class="d">-          call spec.do({ &#39;name&#39;: name, &#39;status&#39;: status, &#39;force&#39;: a:force })
</a><a href="#h6-0-851" id="h6-0-851" class="d">-        catch
</a><a href="#h6-0-852" id="h6-0-852" class="d">-          let error = v:exception
</a><a href="#h6-0-853" id="h6-0-853" class="d">-        endtry
</a><a href="#h6-0-854" id="h6-0-854" class="d">-      else
</a><a href="#h6-0-855" id="h6-0-855" class="d">-        let error = &#39;Invalid hook type&#39;
</a><a href="#h6-0-856" id="h6-0-856" class="d">-      endif
</a><a href="#h6-0-857" id="h6-0-857" class="d">-      call s:switch_in()
</a><a href="#h6-0-858" id="h6-0-858" class="d">-      call setline(4, empty(error) ? (getline(4) . &#39;OK&#39;)
</a><a href="#h6-0-859" id="h6-0-859" class="d">-                                 \ : (&#39;x&#39; . getline(4)[1:] . error))
</a><a href="#h6-0-860" id="h6-0-860" class="d">-      if !empty(error)
</a><a href="#h6-0-861" id="h6-0-861" class="d">-        call add(s:update.errors, name)
</a><a href="#h6-0-862" id="h6-0-862" class="d">-        call s:regress_bar()
</a><a href="#h6-0-863" id="h6-0-863" class="d">-      endif
</a><a href="#h6-0-864" id="h6-0-864" class="d">-      cd -
</a><a href="#h6-0-865" id="h6-0-865" class="d">-    endif
</a><a href="#h6-0-866" id="h6-0-866" class="d">-  endfor
</a><a href="#h6-0-867" id="h6-0-867" class="d">-endfunction
</a><a href="#h6-0-868" id="h6-0-868" class="d">-
</a><a href="#h6-0-869" id="h6-0-869" class="d">-function! s:hash_match(a, b)
</a><a href="#h6-0-870" id="h6-0-870" class="d">-  return stridx(a:a, a:b) == 0 || stridx(a:b, a:a) == 0
</a><a href="#h6-0-871" id="h6-0-871" class="d">-endfunction
</a><a href="#h6-0-872" id="h6-0-872" class="d">-
</a><a href="#h6-0-873" id="h6-0-873" class="d">-function! s:checkout(spec)
</a><a href="#h6-0-874" id="h6-0-874" class="d">-  let sha = a:spec.commit
</a><a href="#h6-0-875" id="h6-0-875" class="d">-  let output = s:system(&#39;git rev-parse HEAD&#39;, a:spec.dir)
</a><a href="#h6-0-876" id="h6-0-876" class="d">-  if !v:shell_error &amp;&amp; !s:hash_match(sha, s:lines(output)[0])
</a><a href="#h6-0-877" id="h6-0-877" class="d">-    let output = s:system(
</a><a href="#h6-0-878" id="h6-0-878" class="d">-          \ &#39;git fetch --depth 999999 &amp;&amp; git checkout &#39;.s:esc(sha).&#39; --&#39;, a:spec.dir)
</a><a href="#h6-0-879" id="h6-0-879" class="d">-  endif
</a><a href="#h6-0-880" id="h6-0-880" class="d">-  return output
</a><a href="#h6-0-881" id="h6-0-881" class="d">-endfunction
</a><a href="#h6-0-882" id="h6-0-882" class="d">-
</a><a href="#h6-0-883" id="h6-0-883" class="d">-function! s:finish(pull)
</a><a href="#h6-0-884" id="h6-0-884" class="d">-  let new_frozen = len(filter(keys(s:update.new), &#39;g:plugs[v:val].frozen&#39;))
</a><a href="#h6-0-885" id="h6-0-885" class="d">-  if new_frozen
</a><a href="#h6-0-886" id="h6-0-886" class="d">-    let s = new_frozen &gt; 1 ? &#39;s&#39; : &#39;&#39;
</a><a href="#h6-0-887" id="h6-0-887" class="d">-    call append(3, printf(&#39;- Installed %d frozen plugin%s&#39;, new_frozen, s))
</a><a href="#h6-0-888" id="h6-0-888" class="d">-  endif
</a><a href="#h6-0-889" id="h6-0-889" class="d">-  call append(3, &#39;- Finishing ... &#39;) | 4
</a><a href="#h6-0-890" id="h6-0-890" class="d">-  redraw
</a><a href="#h6-0-891" id="h6-0-891" class="d">-  call plug#helptags()
</a><a href="#h6-0-892" id="h6-0-892" class="d">-  call plug#end()
</a><a href="#h6-0-893" id="h6-0-893" class="d">-  call setline(4, getline(4) . &#39;Done!&#39;)
</a><a href="#h6-0-894" id="h6-0-894" class="d">-  redraw
</a><a href="#h6-0-895" id="h6-0-895" class="d">-  let msgs = []
</a><a href="#h6-0-896" id="h6-0-896" class="d">-  if !empty(s:update.errors)
</a><a href="#h6-0-897" id="h6-0-897" class="d">-    call add(msgs, &quot;Press &#39;R&#39; to retry.&quot;)
</a><a href="#h6-0-898" id="h6-0-898" class="d">-  endif
</a><a href="#h6-0-899" id="h6-0-899" class="d">-  if a:pull &amp;&amp; len(s:update.new) &lt; len(filter(getline(5, &#39;$&#39;),
</a><a href="#h6-0-900" id="h6-0-900" class="d">-                \ &quot;v:val =~ &#39;^- &#39; &amp;&amp; stridx(v:val, &#39;Already up-to-date&#39;) &lt; 0&quot;))
</a><a href="#h6-0-901" id="h6-0-901" class="d">-    call add(msgs, &quot;Press &#39;D&#39; to see the updated changes.&quot;)
</a><a href="#h6-0-902" id="h6-0-902" class="d">-  endif
</a><a href="#h6-0-903" id="h6-0-903" class="d">-  echo join(msgs, &#39; &#39;)
</a><a href="#h6-0-904" id="h6-0-904" class="d">-  call s:finish_bindings()
</a><a href="#h6-0-905" id="h6-0-905" class="d">-endfunction
</a><a href="#h6-0-906" id="h6-0-906" class="d">-
</a><a href="#h6-0-907" id="h6-0-907" class="d">-function! s:retry()
</a><a href="#h6-0-908" id="h6-0-908" class="d">-  if empty(s:update.errors)
</a><a href="#h6-0-909" id="h6-0-909" class="d">-    return
</a><a href="#h6-0-910" id="h6-0-910" class="d">-  endif
</a><a href="#h6-0-911" id="h6-0-911" class="d">-  echo
</a><a href="#h6-0-912" id="h6-0-912" class="d">-  call s:update_impl(s:update.pull, s:update.force,
</a><a href="#h6-0-913" id="h6-0-913" class="d">-        \ extend(copy(s:update.errors), [s:update.threads]))
</a><a href="#h6-0-914" id="h6-0-914" class="d">-endfunction
</a><a href="#h6-0-915" id="h6-0-915" class="d">-
</a><a href="#h6-0-916" id="h6-0-916" class="d">-function! s:is_managed(name)
</a><a href="#h6-0-917" id="h6-0-917" class="d">-  return has_key(g:plugs[a:name], &#39;uri&#39;)
</a><a href="#h6-0-918" id="h6-0-918" class="d">-endfunction
</a><a href="#h6-0-919" id="h6-0-919" class="d">-
</a><a href="#h6-0-920" id="h6-0-920" class="d">-function! s:names(...)
</a><a href="#h6-0-921" id="h6-0-921" class="d">-  return sort(filter(keys(g:plugs), &#39;stridx(v:val, a:1) == 0 &amp;&amp; s:is_managed(v:val)&#39;))
</a><a href="#h6-0-922" id="h6-0-922" class="d">-endfunction
</a><a href="#h6-0-923" id="h6-0-923" class="d">-
</a><a href="#h6-0-924" id="h6-0-924" class="d">-function! s:check_ruby()
</a><a href="#h6-0-925" id="h6-0-925" class="d">-  silent! ruby require &#39;thread&#39;; VIM::command(&quot;let g:plug_ruby = &#39;#{RUBY_VERSION}&#39;&quot;)
</a><a href="#h6-0-926" id="h6-0-926" class="d">-  if !exists(&#39;g:plug_ruby&#39;)
</a><a href="#h6-0-927" id="h6-0-927" class="d">-    redraw!
</a><a href="#h6-0-928" id="h6-0-928" class="d">-    return s:warn(&#39;echom&#39;, &#39;Warning: Ruby interface is broken&#39;)
</a><a href="#h6-0-929" id="h6-0-929" class="d">-  endif
</a><a href="#h6-0-930" id="h6-0-930" class="d">-  let ruby_version = split(g:plug_ruby, &#39;\.&#39;)
</a><a href="#h6-0-931" id="h6-0-931" class="d">-  unlet g:plug_ruby
</a><a href="#h6-0-932" id="h6-0-932" class="d">-  return s:version_requirement(ruby_version, [1, 8, 7])
</a><a href="#h6-0-933" id="h6-0-933" class="d">-endfunction
</a><a href="#h6-0-934" id="h6-0-934" class="d">-
</a><a href="#h6-0-935" id="h6-0-935" class="d">-function! s:update_impl(pull, force, args) abort
</a><a href="#h6-0-936" id="h6-0-936" class="d">-  let sync = index(a:args, &#39;--sync&#39;) &gt;= 0 || has(&#39;vim_starting&#39;)
</a><a href="#h6-0-937" id="h6-0-937" class="d">-  let args = filter(copy(a:args), &#39;v:val != &quot;--sync&quot;&#39;)
</a><a href="#h6-0-938" id="h6-0-938" class="d">-  let threads = (len(args) &gt; 0 &amp;&amp; args[-1] =~ &#39;^[1-9][0-9]*$&#39;) ?
</a><a href="#h6-0-939" id="h6-0-939" class="d">-                  \ remove(args, -1) : get(g:, &#39;plug_threads&#39;, 16)
</a><a href="#h6-0-940" id="h6-0-940" class="d">-
</a><a href="#h6-0-941" id="h6-0-941" class="d">-  let managed = filter(copy(g:plugs), &#39;s:is_managed(v:key)&#39;)
</a><a href="#h6-0-942" id="h6-0-942" class="d">-  let todo = empty(args) ? filter(managed, &#39;!v:val.frozen || !isdirectory(v:val.dir)&#39;) :
</a><a href="#h6-0-943" id="h6-0-943" class="d">-                         \ filter(managed, &#39;index(args, v:key) &gt;= 0&#39;)
</a><a href="#h6-0-944" id="h6-0-944" class="d">-
</a><a href="#h6-0-945" id="h6-0-945" class="d">-  if empty(todo)
</a><a href="#h6-0-946" id="h6-0-946" class="d">-    return s:warn(&#39;echo&#39;, &#39;No plugin to &#39;. (a:pull ? &#39;update&#39; : &#39;install&#39;))
</a><a href="#h6-0-947" id="h6-0-947" class="d">-  endif
</a><a href="#h6-0-948" id="h6-0-948" class="d">-
</a><a href="#h6-0-949" id="h6-0-949" class="d">-  if !s:is_win &amp;&amp; s:git_version_requirement(2, 3)
</a><a href="#h6-0-950" id="h6-0-950" class="d">-    let s:git_terminal_prompt = exists(&#39;$GIT_TERMINAL_PROMPT&#39;) ? $GIT_TERMINAL_PROMPT : &#39;&#39;
</a><a href="#h6-0-951" id="h6-0-951" class="d">-    let $GIT_TERMINAL_PROMPT = 0
</a><a href="#h6-0-952" id="h6-0-952" class="d">-    for plug in values(todo)
</a><a href="#h6-0-953" id="h6-0-953" class="d">-      let plug.uri = substitute(plug.uri,
</a><a href="#h6-0-954" id="h6-0-954" class="d">-            \ &#39;^https://git::@github\.com&#39;, &#39;https://github.com&#39;, &#39;&#39;)
</a><a href="#h6-0-955" id="h6-0-955" class="d">-    endfor
</a><a href="#h6-0-956" id="h6-0-956" class="d">-  endif
</a><a href="#h6-0-957" id="h6-0-957" class="d">-
</a><a href="#h6-0-958" id="h6-0-958" class="d">-  if !isdirectory(g:plug_home)
</a><a href="#h6-0-959" id="h6-0-959" class="d">-    try
</a><a href="#h6-0-960" id="h6-0-960" class="d">-      call mkdir(g:plug_home, &#39;p&#39;)
</a><a href="#h6-0-961" id="h6-0-961" class="d">-    catch
</a><a href="#h6-0-962" id="h6-0-962" class="d">-      return s:err(printf(&#39;Invalid plug directory: %s. &#39;.
</a><a href="#h6-0-963" id="h6-0-963" class="d">-              \ &#39;Try to call plug#begin with a valid directory&#39;, g:plug_home))
</a><a href="#h6-0-964" id="h6-0-964" class="d">-    endtry
</a><a href="#h6-0-965" id="h6-0-965" class="d">-  endif
</a><a href="#h6-0-966" id="h6-0-966" class="d">-
</a><a href="#h6-0-967" id="h6-0-967" class="d">-  if has(&#39;nvim&#39;) &amp;&amp; !exists(&#39;*jobwait&#39;) &amp;&amp; threads &gt; 1
</a><a href="#h6-0-968" id="h6-0-968" class="d">-    call s:warn(&#39;echom&#39;, &#39;[vim-plug] Update Neovim for parallel installer&#39;)
</a><a href="#h6-0-969" id="h6-0-969" class="d">-  endif
</a><a href="#h6-0-970" id="h6-0-970" class="d">-
</a><a href="#h6-0-971" id="h6-0-971" class="d">-  let use_job = s:nvim || s:vim8
</a><a href="#h6-0-972" id="h6-0-972" class="d">-  let python = (has(&#39;python&#39;) || has(&#39;python3&#39;)) &amp;&amp; !use_job
</a><a href="#h6-0-973" id="h6-0-973" class="d">-  let ruby = has(&#39;ruby&#39;) &amp;&amp; !use_job &amp;&amp; (v:version &gt;= 703 || v:version == 702 &amp;&amp; has(&#39;patch374&#39;)) &amp;&amp; !(s:is_win &amp;&amp; has(&#39;gui_running&#39;)) &amp;&amp; threads &gt; 1 &amp;&amp; s:check_ruby()
</a><a href="#h6-0-974" id="h6-0-974" class="d">-
</a><a href="#h6-0-975" id="h6-0-975" class="d">-  let s:update = {
</a><a href="#h6-0-976" id="h6-0-976" class="d">-    \ &#39;start&#39;:   reltime(),
</a><a href="#h6-0-977" id="h6-0-977" class="d">-    \ &#39;all&#39;:     todo,
</a><a href="#h6-0-978" id="h6-0-978" class="d">-    \ &#39;todo&#39;:    copy(todo),
</a><a href="#h6-0-979" id="h6-0-979" class="d">-    \ &#39;errors&#39;:  [],
</a><a href="#h6-0-980" id="h6-0-980" class="d">-    \ &#39;pull&#39;:    a:pull,
</a><a href="#h6-0-981" id="h6-0-981" class="d">-    \ &#39;force&#39;:   a:force,
</a><a href="#h6-0-982" id="h6-0-982" class="d">-    \ &#39;new&#39;:     {},
</a><a href="#h6-0-983" id="h6-0-983" class="d">-    \ &#39;threads&#39;: (python || ruby || use_job) ? min([len(todo), threads]) : 1,
</a><a href="#h6-0-984" id="h6-0-984" class="d">-    \ &#39;bar&#39;:     &#39;&#39;,
</a><a href="#h6-0-985" id="h6-0-985" class="d">-    \ &#39;fin&#39;:     0
</a><a href="#h6-0-986" id="h6-0-986" class="d">-  \ }
</a><a href="#h6-0-987" id="h6-0-987" class="d">-
</a><a href="#h6-0-988" id="h6-0-988" class="d">-  call s:prepare(1)
</a><a href="#h6-0-989" id="h6-0-989" class="d">-  call append(0, [&#39;&#39;, &#39;&#39;])
</a><a href="#h6-0-990" id="h6-0-990" class="d">-  normal! 2G
</a><a href="#h6-0-991" id="h6-0-991" class="d">-  silent! redraw
</a><a href="#h6-0-992" id="h6-0-992" class="d">-
</a><a href="#h6-0-993" id="h6-0-993" class="d">-  let s:clone_opt = get(g:, &#39;plug_shallow&#39;, 1) ?
</a><a href="#h6-0-994" id="h6-0-994" class="d">-        \ &#39;--depth 1&#39; . (s:git_version_requirement(1, 7, 10) ? &#39; --no-single-branch&#39; : &#39;&#39;) : &#39;&#39;
</a><a href="#h6-0-995" id="h6-0-995" class="d">-
</a><a href="#h6-0-996" id="h6-0-996" class="d">-  if has(&#39;win32unix&#39;)
</a><a href="#h6-0-997" id="h6-0-997" class="d">-    let s:clone_opt .= &#39; -c core.eol=lf -c core.autocrlf=input&#39;
</a><a href="#h6-0-998" id="h6-0-998" class="d">-  endif
</a><a href="#h6-0-999" id="h6-0-999" class="d">-
</a><a href="#h6-0-1000" id="h6-0-1000" class="d">-  &quot; Python version requirement (&gt;= 2.7)
</a><a href="#h6-0-1001" id="h6-0-1001" class="d">-  if python &amp;&amp; !has(&#39;python3&#39;) &amp;&amp; !ruby &amp;&amp; !use_job &amp;&amp; s:update.threads &gt; 1
</a><a href="#h6-0-1002" id="h6-0-1002" class="d">-    redir =&gt; pyv
</a><a href="#h6-0-1003" id="h6-0-1003" class="d">-    silent python import platform; print platform.python_version()
</a><a href="#h6-0-1004" id="h6-0-1004" class="d">-    redir END
</a><a href="#h6-0-1005" id="h6-0-1005" class="d">-    let python = s:version_requirement(
</a><a href="#h6-0-1006" id="h6-0-1006" class="d">-          \ map(split(split(pyv)[0], &#39;\.&#39;), &#39;str2nr(v:val)&#39;), [2, 6])
</a><a href="#h6-0-1007" id="h6-0-1007" class="d">-  endif
</a><a href="#h6-0-1008" id="h6-0-1008" class="d">-
</a><a href="#h6-0-1009" id="h6-0-1009" class="d">-  if (python || ruby) &amp;&amp; s:update.threads &gt; 1
</a><a href="#h6-0-1010" id="h6-0-1010" class="d">-    try
</a><a href="#h6-0-1011" id="h6-0-1011" class="d">-      let imd = &amp;imd
</a><a href="#h6-0-1012" id="h6-0-1012" class="d">-      if s:mac_gui
</a><a href="#h6-0-1013" id="h6-0-1013" class="d">-        set noimd
</a><a href="#h6-0-1014" id="h6-0-1014" class="d">-      endif
</a><a href="#h6-0-1015" id="h6-0-1015" class="d">-      if ruby
</a><a href="#h6-0-1016" id="h6-0-1016" class="d">-        call s:update_ruby()
</a><a href="#h6-0-1017" id="h6-0-1017" class="d">-      else
</a><a href="#h6-0-1018" id="h6-0-1018" class="d">-        call s:update_python()
</a><a href="#h6-0-1019" id="h6-0-1019" class="d">-      endif
</a><a href="#h6-0-1020" id="h6-0-1020" class="d">-    catch
</a><a href="#h6-0-1021" id="h6-0-1021" class="d">-      let lines = getline(4, &#39;$&#39;)
</a><a href="#h6-0-1022" id="h6-0-1022" class="d">-      let printed = {}
</a><a href="#h6-0-1023" id="h6-0-1023" class="d">-      silent! 4,$d _
</a><a href="#h6-0-1024" id="h6-0-1024" class="d">-      for line in lines
</a><a href="#h6-0-1025" id="h6-0-1025" class="d">-        let name = s:extract_name(line, &#39;.&#39;, &#39;&#39;)
</a><a href="#h6-0-1026" id="h6-0-1026" class="d">-        if empty(name) || !has_key(printed, name)
</a><a href="#h6-0-1027" id="h6-0-1027" class="d">-          call append(&#39;$&#39;, line)
</a><a href="#h6-0-1028" id="h6-0-1028" class="d">-          if !empty(name)
</a><a href="#h6-0-1029" id="h6-0-1029" class="d">-            let printed[name] = 1
</a><a href="#h6-0-1030" id="h6-0-1030" class="d">-            if line[0] == &#39;x&#39; &amp;&amp; index(s:update.errors, name) &lt; 0
</a><a href="#h6-0-1031" id="h6-0-1031" class="d">-              call add(s:update.errors, name)
</a><a href="#h6-0-1032" id="h6-0-1032" class="d">-            end
</a><a href="#h6-0-1033" id="h6-0-1033" class="d">-          endif
</a><a href="#h6-0-1034" id="h6-0-1034" class="d">-        endif
</a><a href="#h6-0-1035" id="h6-0-1035" class="d">-      endfor
</a><a href="#h6-0-1036" id="h6-0-1036" class="d">-    finally
</a><a href="#h6-0-1037" id="h6-0-1037" class="d">-      let &amp;imd = imd
</a><a href="#h6-0-1038" id="h6-0-1038" class="d">-      call s:update_finish()
</a><a href="#h6-0-1039" id="h6-0-1039" class="d">-    endtry
</a><a href="#h6-0-1040" id="h6-0-1040" class="d">-  else
</a><a href="#h6-0-1041" id="h6-0-1041" class="d">-    call s:update_vim()
</a><a href="#h6-0-1042" id="h6-0-1042" class="d">-    while use_job &amp;&amp; sync
</a><a href="#h6-0-1043" id="h6-0-1043" class="d">-      sleep 100m
</a><a href="#h6-0-1044" id="h6-0-1044" class="d">-      if s:update.fin
</a><a href="#h6-0-1045" id="h6-0-1045" class="d">-        break
</a><a href="#h6-0-1046" id="h6-0-1046" class="d">-      endif
</a><a href="#h6-0-1047" id="h6-0-1047" class="d">-    endwhile
</a><a href="#h6-0-1048" id="h6-0-1048" class="d">-  endif
</a><a href="#h6-0-1049" id="h6-0-1049" class="d">-endfunction
</a><a href="#h6-0-1050" id="h6-0-1050" class="d">-
</a><a href="#h6-0-1051" id="h6-0-1051" class="d">-function! s:log4(name, msg)
</a><a href="#h6-0-1052" id="h6-0-1052" class="d">-  call setline(4, printf(&#39;- %s (%s)&#39;, a:msg, a:name))
</a><a href="#h6-0-1053" id="h6-0-1053" class="d">-  redraw
</a><a href="#h6-0-1054" id="h6-0-1054" class="d">-endfunction
</a><a href="#h6-0-1055" id="h6-0-1055" class="d">-
</a><a href="#h6-0-1056" id="h6-0-1056" class="d">-function! s:update_finish()
</a><a href="#h6-0-1057" id="h6-0-1057" class="d">-  if exists(&#39;s:git_terminal_prompt&#39;)
</a><a href="#h6-0-1058" id="h6-0-1058" class="d">-    let $GIT_TERMINAL_PROMPT = s:git_terminal_prompt
</a><a href="#h6-0-1059" id="h6-0-1059" class="d">-  endif
</a><a href="#h6-0-1060" id="h6-0-1060" class="d">-  if s:switch_in()
</a><a href="#h6-0-1061" id="h6-0-1061" class="d">-    call append(3, &#39;- Updating ...&#39;) | 4
</a><a href="#h6-0-1062" id="h6-0-1062" class="d">-    for [name, spec] in items(filter(copy(s:update.all), &#39;index(s:update.errors, v:key) &lt; 0 &amp;&amp; (s:update.force || s:update.pull || has_key(s:update.new, v:key))&#39;))
</a><a href="#h6-0-1063" id="h6-0-1063" class="d">-      let [pos, _] = s:logpos(name)
</a><a href="#h6-0-1064" id="h6-0-1064" class="d">-      if !pos
</a><a href="#h6-0-1065" id="h6-0-1065" class="d">-        continue
</a><a href="#h6-0-1066" id="h6-0-1066" class="d">-      endif
</a><a href="#h6-0-1067" id="h6-0-1067" class="d">-      if has_key(spec, &#39;commit&#39;)
</a><a href="#h6-0-1068" id="h6-0-1068" class="d">-        call s:log4(name, &#39;Checking out &#39;.spec.commit)
</a><a href="#h6-0-1069" id="h6-0-1069" class="d">-        let out = s:checkout(spec)
</a><a href="#h6-0-1070" id="h6-0-1070" class="d">-      elseif has_key(spec, &#39;tag&#39;)
</a><a href="#h6-0-1071" id="h6-0-1071" class="d">-        let tag = spec.tag
</a><a href="#h6-0-1072" id="h6-0-1072" class="d">-        if tag =~ &#39;\*&#39;
</a><a href="#h6-0-1073" id="h6-0-1073" class="d">-          let tags = s:lines(s:system(&#39;git tag --list &#39;.s:shellesc(tag).&#39; --sort -version:refname 2&gt;&amp;1&#39;, spec.dir))
</a><a href="#h6-0-1074" id="h6-0-1074" class="d">-          if !v:shell_error &amp;&amp; !empty(tags)
</a><a href="#h6-0-1075" id="h6-0-1075" class="d">-            let tag = tags[0]
</a><a href="#h6-0-1076" id="h6-0-1076" class="d">-            call s:log4(name, printf(&#39;Latest tag for %s -&gt; %s&#39;, spec.tag, tag))
</a><a href="#h6-0-1077" id="h6-0-1077" class="d">-            call append(3, &#39;&#39;)
</a><a href="#h6-0-1078" id="h6-0-1078" class="d">-          endif
</a><a href="#h6-0-1079" id="h6-0-1079" class="d">-        endif
</a><a href="#h6-0-1080" id="h6-0-1080" class="d">-        call s:log4(name, &#39;Checking out &#39;.tag)
</a><a href="#h6-0-1081" id="h6-0-1081" class="d">-        let out = s:system(&#39;git checkout -q &#39;.s:esc(tag).&#39; -- 2&gt;&amp;1&#39;, spec.dir)
</a><a href="#h6-0-1082" id="h6-0-1082" class="d">-      else
</a><a href="#h6-0-1083" id="h6-0-1083" class="d">-        let branch = s:esc(get(spec, &#39;branch&#39;, &#39;master&#39;))
</a><a href="#h6-0-1084" id="h6-0-1084" class="d">-        call s:log4(name, &#39;Merging origin/&#39;.branch)
</a><a href="#h6-0-1085" id="h6-0-1085" class="d">-        let out = s:system(&#39;git checkout -q &#39;.branch.&#39; -- 2&gt;&amp;1&#39;
</a><a href="#h6-0-1086" id="h6-0-1086" class="d">-              \. (has_key(s:update.new, name) ? &#39;&#39; : (&#39;&amp;&amp; git merge --ff-only origin/&#39;.branch.&#39; 2&gt;&amp;1&#39;)), spec.dir)
</a><a href="#h6-0-1087" id="h6-0-1087" class="d">-      endif
</a><a href="#h6-0-1088" id="h6-0-1088" class="d">-      if !v:shell_error &amp;&amp; filereadable(spec.dir.&#39;/.gitmodules&#39;) &amp;&amp;
</a><a href="#h6-0-1089" id="h6-0-1089" class="d">-            \ (s:update.force || has_key(s:update.new, name) || s:is_updated(spec.dir))
</a><a href="#h6-0-1090" id="h6-0-1090" class="d">-        call s:log4(name, &#39;Updating submodules. This may take a while.&#39;)
</a><a href="#h6-0-1091" id="h6-0-1091" class="d">-        let out .= s:bang(&#39;git submodule update --init --recursive 2&gt;&amp;1&#39;, spec.dir)
</a><a href="#h6-0-1092" id="h6-0-1092" class="d">-      endif
</a><a href="#h6-0-1093" id="h6-0-1093" class="d">-      let msg = s:format_message(v:shell_error ? &#39;x&#39;: &#39;-&#39;, name, out)
</a><a href="#h6-0-1094" id="h6-0-1094" class="d">-      if v:shell_error
</a><a href="#h6-0-1095" id="h6-0-1095" class="d">-        call add(s:update.errors, name)
</a><a href="#h6-0-1096" id="h6-0-1096" class="d">-        call s:regress_bar()
</a><a href="#h6-0-1097" id="h6-0-1097" class="d">-        silent execute pos &#39;d _&#39;
</a><a href="#h6-0-1098" id="h6-0-1098" class="d">-        call append(4, msg) | 4
</a><a href="#h6-0-1099" id="h6-0-1099" class="d">-      elseif !empty(out)
</a><a href="#h6-0-1100" id="h6-0-1100" class="d">-        call setline(pos, msg[0])
</a><a href="#h6-0-1101" id="h6-0-1101" class="d">-      endif
</a><a href="#h6-0-1102" id="h6-0-1102" class="d">-      redraw
</a><a href="#h6-0-1103" id="h6-0-1103" class="d">-    endfor
</a><a href="#h6-0-1104" id="h6-0-1104" class="d">-    silent 4 d _
</a><a href="#h6-0-1105" id="h6-0-1105" class="d">-    try
</a><a href="#h6-0-1106" id="h6-0-1106" class="d">-      call s:do(s:update.pull, s:update.force, filter(copy(s:update.all), &#39;index(s:update.errors, v:key) &lt; 0 &amp;&amp; has_key(v:val, &quot;do&quot;)&#39;))
</a><a href="#h6-0-1107" id="h6-0-1107" class="d">-    catch
</a><a href="#h6-0-1108" id="h6-0-1108" class="d">-      call s:warn(&#39;echom&#39;, v:exception)
</a><a href="#h6-0-1109" id="h6-0-1109" class="d">-      call s:warn(&#39;echo&#39;, &#39;&#39;)
</a><a href="#h6-0-1110" id="h6-0-1110" class="d">-      return
</a><a href="#h6-0-1111" id="h6-0-1111" class="d">-    endtry
</a><a href="#h6-0-1112" id="h6-0-1112" class="d">-    call s:finish(s:update.pull)
</a><a href="#h6-0-1113" id="h6-0-1113" class="d">-    call setline(1, &#39;Updated. Elapsed time: &#39; . split(reltimestr(reltime(s:update.start)))[0] . &#39; sec.&#39;)
</a><a href="#h6-0-1114" id="h6-0-1114" class="d">-    call s:switch_out(&#39;normal! gg&#39;)
</a><a href="#h6-0-1115" id="h6-0-1115" class="d">-  endif
</a><a href="#h6-0-1116" id="h6-0-1116" class="d">-endfunction
</a><a href="#h6-0-1117" id="h6-0-1117" class="d">-
</a><a href="#h6-0-1118" id="h6-0-1118" class="d">-function! s:job_abort()
</a><a href="#h6-0-1119" id="h6-0-1119" class="d">-  if (!s:nvim &amp;&amp; !s:vim8) || !exists(&#39;s:jobs&#39;)
</a><a href="#h6-0-1120" id="h6-0-1120" class="d">-    return
</a><a href="#h6-0-1121" id="h6-0-1121" class="d">-  endif
</a><a href="#h6-0-1122" id="h6-0-1122" class="d">-
</a><a href="#h6-0-1123" id="h6-0-1123" class="d">-  for [name, j] in items(s:jobs)
</a><a href="#h6-0-1124" id="h6-0-1124" class="d">-    if s:nvim
</a><a href="#h6-0-1125" id="h6-0-1125" class="d">-      silent! call jobstop(j.jobid)
</a><a href="#h6-0-1126" id="h6-0-1126" class="d">-    elseif s:vim8
</a><a href="#h6-0-1127" id="h6-0-1127" class="d">-      silent! call job_stop(j.jobid)
</a><a href="#h6-0-1128" id="h6-0-1128" class="d">-    endif
</a><a href="#h6-0-1129" id="h6-0-1129" class="d">-    if j.new
</a><a href="#h6-0-1130" id="h6-0-1130" class="d">-      call s:system(&#39;rm -rf &#39; . s:shellesc(g:plugs[name].dir))
</a><a href="#h6-0-1131" id="h6-0-1131" class="d">-    endif
</a><a href="#h6-0-1132" id="h6-0-1132" class="d">-  endfor
</a><a href="#h6-0-1133" id="h6-0-1133" class="d">-  let s:jobs = {}
</a><a href="#h6-0-1134" id="h6-0-1134" class="d">-endfunction
</a><a href="#h6-0-1135" id="h6-0-1135" class="d">-
</a><a href="#h6-0-1136" id="h6-0-1136" class="d">-function! s:last_non_empty_line(lines)
</a><a href="#h6-0-1137" id="h6-0-1137" class="d">-  let len = len(a:lines)
</a><a href="#h6-0-1138" id="h6-0-1138" class="d">-  for idx in range(len)
</a><a href="#h6-0-1139" id="h6-0-1139" class="d">-    let line = a:lines[len-idx-1]
</a><a href="#h6-0-1140" id="h6-0-1140" class="d">-    if !empty(line)
</a><a href="#h6-0-1141" id="h6-0-1141" class="d">-      return line
</a><a href="#h6-0-1142" id="h6-0-1142" class="d">-    endif
</a><a href="#h6-0-1143" id="h6-0-1143" class="d">-  endfor
</a><a href="#h6-0-1144" id="h6-0-1144" class="d">-  return &#39;&#39;
</a><a href="#h6-0-1145" id="h6-0-1145" class="d">-endfunction
</a><a href="#h6-0-1146" id="h6-0-1146" class="d">-
</a><a href="#h6-0-1147" id="h6-0-1147" class="d">-function! s:job_out_cb(self, data) abort
</a><a href="#h6-0-1148" id="h6-0-1148" class="d">-  let self = a:self
</a><a href="#h6-0-1149" id="h6-0-1149" class="d">-  let data = remove(self.lines, -1) . a:data
</a><a href="#h6-0-1150" id="h6-0-1150" class="d">-  let lines = map(split(data, &quot;\n&quot;, 1), &#39;split(v:val, &quot;\r&quot;, 1)[-1]&#39;)
</a><a href="#h6-0-1151" id="h6-0-1151" class="d">-  call extend(self.lines, lines)
</a><a href="#h6-0-1152" id="h6-0-1152" class="d">-  &quot; To reduce the number of buffer updates
</a><a href="#h6-0-1153" id="h6-0-1153" class="d">-  let self.tick = get(self, &#39;tick&#39;, -1) + 1
</a><a href="#h6-0-1154" id="h6-0-1154" class="d">-  if !self.running || self.tick % len(s:jobs) == 0
</a><a href="#h6-0-1155" id="h6-0-1155" class="d">-    let bullet = self.running ? (self.new ? &#39;+&#39; : &#39;*&#39;) : (self.error ? &#39;x&#39; : &#39;-&#39;)
</a><a href="#h6-0-1156" id="h6-0-1156" class="d">-    let result = self.error ? join(self.lines, &quot;\n&quot;) : s:last_non_empty_line(self.lines)
</a><a href="#h6-0-1157" id="h6-0-1157" class="d">-    call s:log(bullet, self.name, result)
</a><a href="#h6-0-1158" id="h6-0-1158" class="d">-  endif
</a><a href="#h6-0-1159" id="h6-0-1159" class="d">-endfunction
</a><a href="#h6-0-1160" id="h6-0-1160" class="d">-
</a><a href="#h6-0-1161" id="h6-0-1161" class="d">-function! s:job_exit_cb(self, data) abort
</a><a href="#h6-0-1162" id="h6-0-1162" class="d">-  let a:self.running = 0
</a><a href="#h6-0-1163" id="h6-0-1163" class="d">-  let a:self.error = a:data != 0
</a><a href="#h6-0-1164" id="h6-0-1164" class="d">-  call s:reap(a:self.name)
</a><a href="#h6-0-1165" id="h6-0-1165" class="d">-  call s:tick()
</a><a href="#h6-0-1166" id="h6-0-1166" class="d">-endfunction
</a><a href="#h6-0-1167" id="h6-0-1167" class="d">-
</a><a href="#h6-0-1168" id="h6-0-1168" class="d">-function! s:job_cb(fn, job, ch, data)
</a><a href="#h6-0-1169" id="h6-0-1169" class="d">-  if !s:plug_window_exists() &quot; plug window closed
</a><a href="#h6-0-1170" id="h6-0-1170" class="d">-    return s:job_abort()
</a><a href="#h6-0-1171" id="h6-0-1171" class="d">-  endif
</a><a href="#h6-0-1172" id="h6-0-1172" class="d">-  call call(a:fn, [a:job, a:data])
</a><a href="#h6-0-1173" id="h6-0-1173" class="d">-endfunction
</a><a href="#h6-0-1174" id="h6-0-1174" class="d">-
</a><a href="#h6-0-1175" id="h6-0-1175" class="d">-function! s:nvim_cb(job_id, data, event) dict abort
</a><a href="#h6-0-1176" id="h6-0-1176" class="d">-  return a:event == &#39;stdout&#39; ?
</a><a href="#h6-0-1177" id="h6-0-1177" class="d">-    \ s:job_cb(&#39;s:job_out_cb&#39;,  self, 0, join(a:data, &quot;\n&quot;)) :
</a><a href="#h6-0-1178" id="h6-0-1178" class="d">-    \ s:job_cb(&#39;s:job_exit_cb&#39;, self, 0, a:data)
</a><a href="#h6-0-1179" id="h6-0-1179" class="d">-endfunction
</a><a href="#h6-0-1180" id="h6-0-1180" class="d">-
</a><a href="#h6-0-1181" id="h6-0-1181" class="d">-function! s:spawn(name, cmd, opts)
</a><a href="#h6-0-1182" id="h6-0-1182" class="d">-  let job = { &#39;name&#39;: a:name, &#39;running&#39;: 1, &#39;error&#39;: 0, &#39;lines&#39;: [&#39;&#39;],
</a><a href="#h6-0-1183" id="h6-0-1183" class="d">-            \ &#39;new&#39;: get(a:opts, &#39;new&#39;, 0) }
</a><a href="#h6-0-1184" id="h6-0-1184" class="d">-  let s:jobs[a:name] = job
</a><a href="#h6-0-1185" id="h6-0-1185" class="d">-  let argv = add(s:is_win ? [&#39;cmd&#39;, &#39;/c&#39;] : [&#39;sh&#39;, &#39;-c&#39;],
</a><a href="#h6-0-1186" id="h6-0-1186" class="d">-               \ has_key(a:opts, &#39;dir&#39;) ? s:with_cd(a:cmd, a:opts.dir) : a:cmd)
</a><a href="#h6-0-1187" id="h6-0-1187" class="d">-
</a><a href="#h6-0-1188" id="h6-0-1188" class="d">-  if s:nvim
</a><a href="#h6-0-1189" id="h6-0-1189" class="d">-    call extend(job, {
</a><a href="#h6-0-1190" id="h6-0-1190" class="d">-    \ &#39;on_stdout&#39;: function(&#39;s:nvim_cb&#39;),
</a><a href="#h6-0-1191" id="h6-0-1191" class="d">-    \ &#39;on_exit&#39;:   function(&#39;s:nvim_cb&#39;),
</a><a href="#h6-0-1192" id="h6-0-1192" class="d">-    \ })
</a><a href="#h6-0-1193" id="h6-0-1193" class="d">-    let jid = jobstart(argv, job)
</a><a href="#h6-0-1194" id="h6-0-1194" class="d">-    if jid &gt; 0
</a><a href="#h6-0-1195" id="h6-0-1195" class="d">-      let job.jobid = jid
</a><a href="#h6-0-1196" id="h6-0-1196" class="d">-    else
</a><a href="#h6-0-1197" id="h6-0-1197" class="d">-      let job.running = 0
</a><a href="#h6-0-1198" id="h6-0-1198" class="d">-      let job.error   = 1
</a><a href="#h6-0-1199" id="h6-0-1199" class="d">-      let job.lines   = [jid &lt; 0 ? argv[0].&#39; is not executable&#39; :
</a><a href="#h6-0-1200" id="h6-0-1200" class="d">-            \ &#39;Invalid arguments (or job table is full)&#39;]
</a><a href="#h6-0-1201" id="h6-0-1201" class="d">-    endif
</a><a href="#h6-0-1202" id="h6-0-1202" class="d">-  elseif s:vim8
</a><a href="#h6-0-1203" id="h6-0-1203" class="d">-    let jid = job_start(s:is_win ? join(argv, &#39; &#39;) : argv, {
</a><a href="#h6-0-1204" id="h6-0-1204" class="d">-    \ &#39;out_cb&#39;:   function(&#39;s:job_cb&#39;, [&#39;s:job_out_cb&#39;,  job]),
</a><a href="#h6-0-1205" id="h6-0-1205" class="d">-    \ &#39;exit_cb&#39;:  function(&#39;s:job_cb&#39;, [&#39;s:job_exit_cb&#39;, job]),
</a><a href="#h6-0-1206" id="h6-0-1206" class="d">-    \ &#39;out_mode&#39;: &#39;raw&#39;
</a><a href="#h6-0-1207" id="h6-0-1207" class="d">-    \})
</a><a href="#h6-0-1208" id="h6-0-1208" class="d">-    if job_status(jid) == &#39;run&#39;
</a><a href="#h6-0-1209" id="h6-0-1209" class="d">-      let job.jobid = jid
</a><a href="#h6-0-1210" id="h6-0-1210" class="d">-    else
</a><a href="#h6-0-1211" id="h6-0-1211" class="d">-      let job.running = 0
</a><a href="#h6-0-1212" id="h6-0-1212" class="d">-      let job.error   = 1
</a><a href="#h6-0-1213" id="h6-0-1213" class="d">-      let job.lines   = [&#39;Failed to start job&#39;]
</a><a href="#h6-0-1214" id="h6-0-1214" class="d">-    endif
</a><a href="#h6-0-1215" id="h6-0-1215" class="d">-  else
</a><a href="#h6-0-1216" id="h6-0-1216" class="d">-    let params = has_key(a:opts, &#39;dir&#39;) ? [a:cmd, a:opts.dir] : [a:cmd]
</a><a href="#h6-0-1217" id="h6-0-1217" class="d">-    let job.lines = s:lines(call(&#39;s:system&#39;, params))
</a><a href="#h6-0-1218" id="h6-0-1218" class="d">-    let job.error = v:shell_error != 0
</a><a href="#h6-0-1219" id="h6-0-1219" class="d">-    let job.running = 0
</a><a href="#h6-0-1220" id="h6-0-1220" class="d">-  endif
</a><a href="#h6-0-1221" id="h6-0-1221" class="d">-endfunction
</a><a href="#h6-0-1222" id="h6-0-1222" class="d">-
</a><a href="#h6-0-1223" id="h6-0-1223" class="d">-function! s:reap(name)
</a><a href="#h6-0-1224" id="h6-0-1224" class="d">-  let job = s:jobs[a:name]
</a><a href="#h6-0-1225" id="h6-0-1225" class="d">-  if job.error
</a><a href="#h6-0-1226" id="h6-0-1226" class="d">-    call add(s:update.errors, a:name)
</a><a href="#h6-0-1227" id="h6-0-1227" class="d">-  elseif get(job, &#39;new&#39;, 0)
</a><a href="#h6-0-1228" id="h6-0-1228" class="d">-    let s:update.new[a:name] = 1
</a><a href="#h6-0-1229" id="h6-0-1229" class="d">-  endif
</a><a href="#h6-0-1230" id="h6-0-1230" class="d">-  let s:update.bar .= job.error ? &#39;x&#39; : &#39;=&#39;
</a><a href="#h6-0-1231" id="h6-0-1231" class="d">-
</a><a href="#h6-0-1232" id="h6-0-1232" class="d">-  let bullet = job.error ? &#39;x&#39; : &#39;-&#39;
</a><a href="#h6-0-1233" id="h6-0-1233" class="d">-  let result = job.error ? join(job.lines, &quot;\n&quot;) : s:last_non_empty_line(job.lines)
</a><a href="#h6-0-1234" id="h6-0-1234" class="d">-  call s:log(bullet, a:name, empty(result) ? &#39;OK&#39; : result)
</a><a href="#h6-0-1235" id="h6-0-1235" class="d">-  call s:bar()
</a><a href="#h6-0-1236" id="h6-0-1236" class="d">-
</a><a href="#h6-0-1237" id="h6-0-1237" class="d">-  call remove(s:jobs, a:name)
</a><a href="#h6-0-1238" id="h6-0-1238" class="d">-endfunction
</a><a href="#h6-0-1239" id="h6-0-1239" class="d">-
</a><a href="#h6-0-1240" id="h6-0-1240" class="d">-function! s:bar()
</a><a href="#h6-0-1241" id="h6-0-1241" class="d">-  if s:switch_in()
</a><a href="#h6-0-1242" id="h6-0-1242" class="d">-    let total = len(s:update.all)
</a><a href="#h6-0-1243" id="h6-0-1243" class="d">-    call setline(1, (s:update.pull ? &#39;Updating&#39; : &#39;Installing&#39;).
</a><a href="#h6-0-1244" id="h6-0-1244" class="d">-          \ &#39; plugins (&#39;.len(s:update.bar).&#39;/&#39;.total.&#39;)&#39;)
</a><a href="#h6-0-1245" id="h6-0-1245" class="d">-    call s:progress_bar(2, s:update.bar, total)
</a><a href="#h6-0-1246" id="h6-0-1246" class="d">-    call s:switch_out()
</a><a href="#h6-0-1247" id="h6-0-1247" class="d">-  endif
</a><a href="#h6-0-1248" id="h6-0-1248" class="d">-endfunction
</a><a href="#h6-0-1249" id="h6-0-1249" class="d">-
</a><a href="#h6-0-1250" id="h6-0-1250" class="d">-function! s:logpos(name)
</a><a href="#h6-0-1251" id="h6-0-1251" class="d">-  for i in range(4, line(&#39;$&#39;))
</a><a href="#h6-0-1252" id="h6-0-1252" class="d">-    if getline(i) =~# &#39;^[-+x*] &#39;.a:name.&#39;:&#39;
</a><a href="#h6-0-1253" id="h6-0-1253" class="d">-      for j in range(i + 1, line(&#39;$&#39;))
</a><a href="#h6-0-1254" id="h6-0-1254" class="d">-        if getline(j) !~ &#39;^ &#39;
</a><a href="#h6-0-1255" id="h6-0-1255" class="d">-          return [i, j - 1]
</a><a href="#h6-0-1256" id="h6-0-1256" class="d">-        endif
</a><a href="#h6-0-1257" id="h6-0-1257" class="d">-      endfor
</a><a href="#h6-0-1258" id="h6-0-1258" class="d">-      return [i, i]
</a><a href="#h6-0-1259" id="h6-0-1259" class="d">-    endif
</a><a href="#h6-0-1260" id="h6-0-1260" class="d">-  endfor
</a><a href="#h6-0-1261" id="h6-0-1261" class="d">-  return [0, 0]
</a><a href="#h6-0-1262" id="h6-0-1262" class="d">-endfunction
</a><a href="#h6-0-1263" id="h6-0-1263" class="d">-
</a><a href="#h6-0-1264" id="h6-0-1264" class="d">-function! s:log(bullet, name, lines)
</a><a href="#h6-0-1265" id="h6-0-1265" class="d">-  if s:switch_in()
</a><a href="#h6-0-1266" id="h6-0-1266" class="d">-    let [b, e] = s:logpos(a:name)
</a><a href="#h6-0-1267" id="h6-0-1267" class="d">-    if b &gt; 0
</a><a href="#h6-0-1268" id="h6-0-1268" class="d">-      silent execute printf(&#39;%d,%d d _&#39;, b, e)
</a><a href="#h6-0-1269" id="h6-0-1269" class="d">-      if b &gt; winheight(&#39;.&#39;)
</a><a href="#h6-0-1270" id="h6-0-1270" class="d">-        let b = 4
</a><a href="#h6-0-1271" id="h6-0-1271" class="d">-      endif
</a><a href="#h6-0-1272" id="h6-0-1272" class="d">-    else
</a><a href="#h6-0-1273" id="h6-0-1273" class="d">-      let b = 4
</a><a href="#h6-0-1274" id="h6-0-1274" class="d">-    endif
</a><a href="#h6-0-1275" id="h6-0-1275" class="d">-    &quot; FIXME For some reason, nomodifiable is set after :d in vim8
</a><a href="#h6-0-1276" id="h6-0-1276" class="d">-    setlocal modifiable
</a><a href="#h6-0-1277" id="h6-0-1277" class="d">-    call append(b - 1, s:format_message(a:bullet, a:name, a:lines))
</a><a href="#h6-0-1278" id="h6-0-1278" class="d">-    call s:switch_out()
</a><a href="#h6-0-1279" id="h6-0-1279" class="d">-  endif
</a><a href="#h6-0-1280" id="h6-0-1280" class="d">-endfunction
</a><a href="#h6-0-1281" id="h6-0-1281" class="d">-
</a><a href="#h6-0-1282" id="h6-0-1282" class="d">-function! s:update_vim()
</a><a href="#h6-0-1283" id="h6-0-1283" class="d">-  let s:jobs = {}
</a><a href="#h6-0-1284" id="h6-0-1284" class="d">-
</a><a href="#h6-0-1285" id="h6-0-1285" class="d">-  call s:bar()
</a><a href="#h6-0-1286" id="h6-0-1286" class="d">-  call s:tick()
</a><a href="#h6-0-1287" id="h6-0-1287" class="d">-endfunction
</a><a href="#h6-0-1288" id="h6-0-1288" class="d">-
</a><a href="#h6-0-1289" id="h6-0-1289" class="d">-function! s:tick()
</a><a href="#h6-0-1290" id="h6-0-1290" class="d">-  let pull = s:update.pull
</a><a href="#h6-0-1291" id="h6-0-1291" class="d">-  let prog = s:progress_opt(s:nvim || s:vim8)
</a><a href="#h6-0-1292" id="h6-0-1292" class="d">-while 1 &quot; Without TCO, Vim stack is bound to explode
</a><a href="#h6-0-1293" id="h6-0-1293" class="d">-  if empty(s:update.todo)
</a><a href="#h6-0-1294" id="h6-0-1294" class="d">-    if empty(s:jobs) &amp;&amp; !s:update.fin
</a><a href="#h6-0-1295" id="h6-0-1295" class="d">-      call s:update_finish()
</a><a href="#h6-0-1296" id="h6-0-1296" class="d">-      let s:update.fin = 1
</a><a href="#h6-0-1297" id="h6-0-1297" class="d">-    endif
</a><a href="#h6-0-1298" id="h6-0-1298" class="d">-    return
</a><a href="#h6-0-1299" id="h6-0-1299" class="d">-  endif
</a><a href="#h6-0-1300" id="h6-0-1300" class="d">-
</a><a href="#h6-0-1301" id="h6-0-1301" class="d">-  let name = keys(s:update.todo)[0]
</a><a href="#h6-0-1302" id="h6-0-1302" class="d">-  let spec = remove(s:update.todo, name)
</a><a href="#h6-0-1303" id="h6-0-1303" class="d">-  let new  = !isdirectory(spec.dir)
</a><a href="#h6-0-1304" id="h6-0-1304" class="d">-
</a><a href="#h6-0-1305" id="h6-0-1305" class="d">-  call s:log(new ? &#39;+&#39; : &#39;*&#39;, name, pull ? &#39;Updating ...&#39; : &#39;Installing ...&#39;)
</a><a href="#h6-0-1306" id="h6-0-1306" class="d">-  redraw
</a><a href="#h6-0-1307" id="h6-0-1307" class="d">-
</a><a href="#h6-0-1308" id="h6-0-1308" class="d">-  let has_tag = has_key(spec, &#39;tag&#39;)
</a><a href="#h6-0-1309" id="h6-0-1309" class="d">-  if !new
</a><a href="#h6-0-1310" id="h6-0-1310" class="d">-    let [error, _] = s:git_validate(spec, 0)
</a><a href="#h6-0-1311" id="h6-0-1311" class="d">-    if empty(error)
</a><a href="#h6-0-1312" id="h6-0-1312" class="d">-      if pull
</a><a href="#h6-0-1313" id="h6-0-1313" class="d">-        let fetch_opt = (has_tag &amp;&amp; !empty(globpath(spec.dir, &#39;.git/shallow&#39;))) ? &#39;--depth 99999999&#39; : &#39;&#39;
</a><a href="#h6-0-1314" id="h6-0-1314" class="d">-        call s:spawn(name, printf(&#39;git fetch %s %s 2&gt;&amp;1&#39;, fetch_opt, prog), { &#39;dir&#39;: spec.dir })
</a><a href="#h6-0-1315" id="h6-0-1315" class="d">-      else
</a><a href="#h6-0-1316" id="h6-0-1316" class="d">-        let s:jobs[name] = { &#39;running&#39;: 0, &#39;lines&#39;: [&#39;Already installed&#39;], &#39;error&#39;: 0 }
</a><a href="#h6-0-1317" id="h6-0-1317" class="d">-      endif
</a><a href="#h6-0-1318" id="h6-0-1318" class="d">-    else
</a><a href="#h6-0-1319" id="h6-0-1319" class="d">-      let s:jobs[name] = { &#39;running&#39;: 0, &#39;lines&#39;: s:lines(error), &#39;error&#39;: 1 }
</a><a href="#h6-0-1320" id="h6-0-1320" class="d">-    endif
</a><a href="#h6-0-1321" id="h6-0-1321" class="d">-  else
</a><a href="#h6-0-1322" id="h6-0-1322" class="d">-    call s:spawn(name,
</a><a href="#h6-0-1323" id="h6-0-1323" class="d">-          \ printf(&#39;git clone %s %s %s %s 2&gt;&amp;1&#39;,
</a><a href="#h6-0-1324" id="h6-0-1324" class="d">-          \ has_tag ? &#39;&#39; : s:clone_opt,
</a><a href="#h6-0-1325" id="h6-0-1325" class="d">-          \ prog,
</a><a href="#h6-0-1326" id="h6-0-1326" class="d">-          \ s:shellesc(spec.uri),
</a><a href="#h6-0-1327" id="h6-0-1327" class="d">-          \ s:shellesc(s:trim(spec.dir))), { &#39;new&#39;: 1 })
</a><a href="#h6-0-1328" id="h6-0-1328" class="d">-  endif
</a><a href="#h6-0-1329" id="h6-0-1329" class="d">-
</a><a href="#h6-0-1330" id="h6-0-1330" class="d">-  if !s:jobs[name].running
</a><a href="#h6-0-1331" id="h6-0-1331" class="d">-    call s:reap(name)
</a><a href="#h6-0-1332" id="h6-0-1332" class="d">-  endif
</a><a href="#h6-0-1333" id="h6-0-1333" class="d">-  if len(s:jobs) &gt;= s:update.threads
</a><a href="#h6-0-1334" id="h6-0-1334" class="d">-    break
</a><a href="#h6-0-1335" id="h6-0-1335" class="d">-  endif
</a><a href="#h6-0-1336" id="h6-0-1336" class="d">-endwhile
</a><a href="#h6-0-1337" id="h6-0-1337" class="d">-endfunction
</a><a href="#h6-0-1338" id="h6-0-1338" class="d">-
</a><a href="#h6-0-1339" id="h6-0-1339" class="d">-function! s:update_python()
</a><a href="#h6-0-1340" id="h6-0-1340" class="d">-let py_exe = has(&#39;python&#39;) ? &#39;python&#39; : &#39;python3&#39;
</a><a href="#h6-0-1341" id="h6-0-1341" class="d">-execute py_exe &quot;&lt;&lt; EOF&quot;
</a><a href="#h6-0-1342" id="h6-0-1342" class="d">-import datetime
</a><a href="#h6-0-1343" id="h6-0-1343" class="d">-import functools
</a><a href="#h6-0-1344" id="h6-0-1344" class="d">-import os
</a><a href="#h6-0-1345" id="h6-0-1345" class="d">-try:
</a><a href="#h6-0-1346" id="h6-0-1346" class="d">-  import queue
</a><a href="#h6-0-1347" id="h6-0-1347" class="d">-except ImportError:
</a><a href="#h6-0-1348" id="h6-0-1348" class="d">-  import Queue as queue
</a><a href="#h6-0-1349" id="h6-0-1349" class="d">-import random
</a><a href="#h6-0-1350" id="h6-0-1350" class="d">-import re
</a><a href="#h6-0-1351" id="h6-0-1351" class="d">-import shutil
</a><a href="#h6-0-1352" id="h6-0-1352" class="d">-import signal
</a><a href="#h6-0-1353" id="h6-0-1353" class="d">-import subprocess
</a><a href="#h6-0-1354" id="h6-0-1354" class="d">-import tempfile
</a><a href="#h6-0-1355" id="h6-0-1355" class="d">-import threading as thr
</a><a href="#h6-0-1356" id="h6-0-1356" class="d">-import time
</a><a href="#h6-0-1357" id="h6-0-1357" class="d">-import traceback
</a><a href="#h6-0-1358" id="h6-0-1358" class="d">-import vim
</a><a href="#h6-0-1359" id="h6-0-1359" class="d">-
</a><a href="#h6-0-1360" id="h6-0-1360" class="d">-G_NVIM = vim.eval(&quot;has(&#39;nvim&#39;)&quot;) == &#39;1&#39;
</a><a href="#h6-0-1361" id="h6-0-1361" class="d">-G_PULL = vim.eval(&#39;s:update.pull&#39;) == &#39;1&#39;
</a><a href="#h6-0-1362" id="h6-0-1362" class="d">-G_RETRIES = int(vim.eval(&#39;get(g:, &quot;plug_retries&quot;, 2)&#39;)) + 1
</a><a href="#h6-0-1363" id="h6-0-1363" class="d">-G_TIMEOUT = int(vim.eval(&#39;get(g:, &quot;plug_timeout&quot;, 60)&#39;))
</a><a href="#h6-0-1364" id="h6-0-1364" class="d">-G_CLONE_OPT = vim.eval(&#39;s:clone_opt&#39;)
</a><a href="#h6-0-1365" id="h6-0-1365" class="d">-G_PROGRESS = vim.eval(&#39;s:progress_opt(1)&#39;)
</a><a href="#h6-0-1366" id="h6-0-1366" class="d">-G_LOG_PROB = 1.0 / int(vim.eval(&#39;s:update.threads&#39;))
</a><a href="#h6-0-1367" id="h6-0-1367" class="d">-G_STOP = thr.Event()
</a><a href="#h6-0-1368" id="h6-0-1368" class="d">-G_IS_WIN = vim.eval(&#39;s:is_win&#39;) == &#39;1&#39;
</a><a href="#h6-0-1369" id="h6-0-1369" class="d">-
</a><a href="#h6-0-1370" id="h6-0-1370" class="d">-class PlugError(Exception):
</a><a href="#h6-0-1371" id="h6-0-1371" class="d">-  def __init__(self, msg):
</a><a href="#h6-0-1372" id="h6-0-1372" class="d">-    self.msg = msg
</a><a href="#h6-0-1373" id="h6-0-1373" class="d">-class CmdTimedOut(PlugError):
</a><a href="#h6-0-1374" id="h6-0-1374" class="d">-  pass
</a><a href="#h6-0-1375" id="h6-0-1375" class="d">-class CmdFailed(PlugError):
</a><a href="#h6-0-1376" id="h6-0-1376" class="d">-  pass
</a><a href="#h6-0-1377" id="h6-0-1377" class="d">-class InvalidURI(PlugError):
</a><a href="#h6-0-1378" id="h6-0-1378" class="d">-  pass
</a><a href="#h6-0-1379" id="h6-0-1379" class="d">-class Action(object):
</a><a href="#h6-0-1380" id="h6-0-1380" class="d">-  INSTALL, UPDATE, ERROR, DONE = [&#39;+&#39;, &#39;*&#39;, &#39;x&#39;, &#39;-&#39;]
</a><a href="#h6-0-1381" id="h6-0-1381" class="d">-
</a><a href="#h6-0-1382" id="h6-0-1382" class="d">-class Buffer(object):
</a><a href="#h6-0-1383" id="h6-0-1383" class="d">-  def __init__(self, lock, num_plugs, is_pull):
</a><a href="#h6-0-1384" id="h6-0-1384" class="d">-    self.bar = &#39;&#39;
</a><a href="#h6-0-1385" id="h6-0-1385" class="d">-    self.event = &#39;Updating&#39; if is_pull else &#39;Installing&#39;
</a><a href="#h6-0-1386" id="h6-0-1386" class="d">-    self.lock = lock
</a><a href="#h6-0-1387" id="h6-0-1387" class="d">-    self.maxy = int(vim.eval(&#39;winheight(&quot;.&quot;)&#39;))
</a><a href="#h6-0-1388" id="h6-0-1388" class="d">-    self.num_plugs = num_plugs
</a><a href="#h6-0-1389" id="h6-0-1389" class="d">-
</a><a href="#h6-0-1390" id="h6-0-1390" class="d">-  def __where(self, name):
</a><a href="#h6-0-1391" id="h6-0-1391" class="d">-    &quot;&quot;&quot; Find first line with name in current buffer. Return line num. &quot;&quot;&quot;
</a><a href="#h6-0-1392" id="h6-0-1392" class="d">-    found, lnum = False, 0
</a><a href="#h6-0-1393" id="h6-0-1393" class="d">-    matcher = re.compile(&#39;^[-+x*] {0}:&#39;.format(name))
</a><a href="#h6-0-1394" id="h6-0-1394" class="d">-    for line in vim.current.buffer:
</a><a href="#h6-0-1395" id="h6-0-1395" class="d">-      if matcher.search(line) is not None:
</a><a href="#h6-0-1396" id="h6-0-1396" class="d">-        found = True
</a><a href="#h6-0-1397" id="h6-0-1397" class="d">-        break
</a><a href="#h6-0-1398" id="h6-0-1398" class="d">-      lnum += 1
</a><a href="#h6-0-1399" id="h6-0-1399" class="d">-
</a><a href="#h6-0-1400" id="h6-0-1400" class="d">-    if not found:
</a><a href="#h6-0-1401" id="h6-0-1401" class="d">-      lnum = -1
</a><a href="#h6-0-1402" id="h6-0-1402" class="d">-    return lnum
</a><a href="#h6-0-1403" id="h6-0-1403" class="d">-
</a><a href="#h6-0-1404" id="h6-0-1404" class="d">-  def header(self):
</a><a href="#h6-0-1405" id="h6-0-1405" class="d">-    curbuf = vim.current.buffer
</a><a href="#h6-0-1406" id="h6-0-1406" class="d">-    curbuf[0] = self.event + &#39; plugins ({0}/{1})&#39;.format(len(self.bar), self.num_plugs)
</a><a href="#h6-0-1407" id="h6-0-1407" class="d">-
</a><a href="#h6-0-1408" id="h6-0-1408" class="d">-    num_spaces = self.num_plugs - len(self.bar)
</a><a href="#h6-0-1409" id="h6-0-1409" class="d">-    curbuf[1] = &#39;[{0}{1}]&#39;.format(self.bar, num_spaces * &#39; &#39;)
</a><a href="#h6-0-1410" id="h6-0-1410" class="d">-
</a><a href="#h6-0-1411" id="h6-0-1411" class="d">-    with self.lock:
</a><a href="#h6-0-1412" id="h6-0-1412" class="d">-      vim.command(&#39;normal! 2G&#39;)
</a><a href="#h6-0-1413" id="h6-0-1413" class="d">-      vim.command(&#39;redraw&#39;)
</a><a href="#h6-0-1414" id="h6-0-1414" class="d">-
</a><a href="#h6-0-1415" id="h6-0-1415" class="d">-  def write(self, action, name, lines):
</a><a href="#h6-0-1416" id="h6-0-1416" class="d">-    first, rest = lines[0], lines[1:]
</a><a href="#h6-0-1417" id="h6-0-1417" class="d">-    msg = [&#39;{0} {1}{2}{3}&#39;.format(action, name, &#39;: &#39; if first else &#39;&#39;, first)]
</a><a href="#h6-0-1418" id="h6-0-1418" class="d">-    msg.extend([&#39;    &#39; + line for line in rest])
</a><a href="#h6-0-1419" id="h6-0-1419" class="d">-
</a><a href="#h6-0-1420" id="h6-0-1420" class="d">-    try:
</a><a href="#h6-0-1421" id="h6-0-1421" class="d">-      if action == Action.ERROR:
</a><a href="#h6-0-1422" id="h6-0-1422" class="d">-        self.bar += &#39;x&#39;
</a><a href="#h6-0-1423" id="h6-0-1423" class="d">-        vim.command(&quot;call add(s:update.errors, &#39;{0}&#39;)&quot;.format(name))
</a><a href="#h6-0-1424" id="h6-0-1424" class="d">-      elif action == Action.DONE:
</a><a href="#h6-0-1425" id="h6-0-1425" class="d">-        self.bar += &#39;=&#39;
</a><a href="#h6-0-1426" id="h6-0-1426" class="d">-
</a><a href="#h6-0-1427" id="h6-0-1427" class="d">-      curbuf = vim.current.buffer
</a><a href="#h6-0-1428" id="h6-0-1428" class="d">-      lnum = self.__where(name)
</a><a href="#h6-0-1429" id="h6-0-1429" class="d">-      if lnum != -1: # Found matching line num
</a><a href="#h6-0-1430" id="h6-0-1430" class="d">-        del curbuf[lnum]
</a><a href="#h6-0-1431" id="h6-0-1431" class="d">-        if lnum &gt; self.maxy and action in set([Action.INSTALL, Action.UPDATE]):
</a><a href="#h6-0-1432" id="h6-0-1432" class="d">-          lnum = 3
</a><a href="#h6-0-1433" id="h6-0-1433" class="d">-      else:
</a><a href="#h6-0-1434" id="h6-0-1434" class="d">-        lnum = 3
</a><a href="#h6-0-1435" id="h6-0-1435" class="d">-      curbuf.append(msg, lnum)
</a><a href="#h6-0-1436" id="h6-0-1436" class="d">-
</a><a href="#h6-0-1437" id="h6-0-1437" class="d">-      self.header()
</a><a href="#h6-0-1438" id="h6-0-1438" class="d">-    except vim.error:
</a><a href="#h6-0-1439" id="h6-0-1439" class="d">-      pass
</a><a href="#h6-0-1440" id="h6-0-1440" class="d">-
</a><a href="#h6-0-1441" id="h6-0-1441" class="d">-class Command(object):
</a><a href="#h6-0-1442" id="h6-0-1442" class="d">-  CD = &#39;cd /d&#39; if G_IS_WIN else &#39;cd&#39;
</a><a href="#h6-0-1443" id="h6-0-1443" class="d">-
</a><a href="#h6-0-1444" id="h6-0-1444" class="d">-  def __init__(self, cmd, cmd_dir=None, timeout=60, cb=None, clean=None):
</a><a href="#h6-0-1445" id="h6-0-1445" class="d">-    self.cmd = cmd
</a><a href="#h6-0-1446" id="h6-0-1446" class="d">-    if cmd_dir:
</a><a href="#h6-0-1447" id="h6-0-1447" class="d">-      self.cmd = &#39;{0} {1} &amp;&amp; {2}&#39;.format(Command.CD, cmd_dir, self.cmd)
</a><a href="#h6-0-1448" id="h6-0-1448" class="d">-    self.timeout = timeout
</a><a href="#h6-0-1449" id="h6-0-1449" class="d">-    self.callback = cb if cb else (lambda msg: None)
</a><a href="#h6-0-1450" id="h6-0-1450" class="d">-    self.clean = clean if clean else (lambda: None)
</a><a href="#h6-0-1451" id="h6-0-1451" class="d">-    self.proc = None
</a><a href="#h6-0-1452" id="h6-0-1452" class="d">-
</a><a href="#h6-0-1453" id="h6-0-1453" class="d">-  @property
</a><a href="#h6-0-1454" id="h6-0-1454" class="d">-  def alive(self):
</a><a href="#h6-0-1455" id="h6-0-1455" class="d">-    &quot;&quot;&quot; Returns true only if command still running. &quot;&quot;&quot;
</a><a href="#h6-0-1456" id="h6-0-1456" class="d">-    return self.proc and self.proc.poll() is None
</a><a href="#h6-0-1457" id="h6-0-1457" class="d">-
</a><a href="#h6-0-1458" id="h6-0-1458" class="d">-  def execute(self, ntries=3):
</a><a href="#h6-0-1459" id="h6-0-1459" class="d">-    &quot;&quot;&quot; Execute the command with ntries if CmdTimedOut.
</a><a href="#h6-0-1460" id="h6-0-1460" class="d">-        Returns the output of the command if no Exception.
</a><a href="#h6-0-1461" id="h6-0-1461" class="d">-    &quot;&quot;&quot;
</a><a href="#h6-0-1462" id="h6-0-1462" class="d">-    attempt, finished, limit = 0, False, self.timeout
</a><a href="#h6-0-1463" id="h6-0-1463" class="d">-
</a><a href="#h6-0-1464" id="h6-0-1464" class="d">-    while not finished:
</a><a href="#h6-0-1465" id="h6-0-1465" class="d">-      try:
</a><a href="#h6-0-1466" id="h6-0-1466" class="d">-        attempt += 1
</a><a href="#h6-0-1467" id="h6-0-1467" class="d">-        result = self.try_command()
</a><a href="#h6-0-1468" id="h6-0-1468" class="d">-        finished = True
</a><a href="#h6-0-1469" id="h6-0-1469" class="d">-        return result
</a><a href="#h6-0-1470" id="h6-0-1470" class="d">-      except CmdTimedOut:
</a><a href="#h6-0-1471" id="h6-0-1471" class="d">-        if attempt != ntries:
</a><a href="#h6-0-1472" id="h6-0-1472" class="d">-          self.notify_retry()
</a><a href="#h6-0-1473" id="h6-0-1473" class="d">-          self.timeout += limit
</a><a href="#h6-0-1474" id="h6-0-1474" class="d">-        else:
</a><a href="#h6-0-1475" id="h6-0-1475" class="d">-          raise
</a><a href="#h6-0-1476" id="h6-0-1476" class="d">-
</a><a href="#h6-0-1477" id="h6-0-1477" class="d">-  def notify_retry(self):
</a><a href="#h6-0-1478" id="h6-0-1478" class="d">-    &quot;&quot;&quot; Retry required for command, notify user. &quot;&quot;&quot;
</a><a href="#h6-0-1479" id="h6-0-1479" class="d">-    for count in range(3, 0, -1):
</a><a href="#h6-0-1480" id="h6-0-1480" class="d">-      if G_STOP.is_set():
</a><a href="#h6-0-1481" id="h6-0-1481" class="d">-        raise KeyboardInterrupt
</a><a href="#h6-0-1482" id="h6-0-1482" class="d">-      msg = &#39;Timeout. Will retry in {0} second{1} ...&#39;.format(
</a><a href="#h6-0-1483" id="h6-0-1483" class="d">-            count, &#39;s&#39; if count != 1 else &#39;&#39;)
</a><a href="#h6-0-1484" id="h6-0-1484" class="d">-      self.callback([msg])
</a><a href="#h6-0-1485" id="h6-0-1485" class="d">-      time.sleep(1)
</a><a href="#h6-0-1486" id="h6-0-1486" class="d">-    self.callback([&#39;Retrying ...&#39;])
</a><a href="#h6-0-1487" id="h6-0-1487" class="d">-
</a><a href="#h6-0-1488" id="h6-0-1488" class="d">-  def try_command(self):
</a><a href="#h6-0-1489" id="h6-0-1489" class="d">-    &quot;&quot;&quot; Execute a cmd &amp; poll for callback. Returns list of output.
</a><a href="#h6-0-1490" id="h6-0-1490" class="d">-        Raises CmdFailed   -&gt; return code for Popen isn&#39;t 0
</a><a href="#h6-0-1491" id="h6-0-1491" class="d">-        Raises CmdTimedOut -&gt; command exceeded timeout without new output
</a><a href="#h6-0-1492" id="h6-0-1492" class="d">-    &quot;&quot;&quot;
</a><a href="#h6-0-1493" id="h6-0-1493" class="d">-    first_line = True
</a><a href="#h6-0-1494" id="h6-0-1494" class="d">-
</a><a href="#h6-0-1495" id="h6-0-1495" class="d">-    try:
</a><a href="#h6-0-1496" id="h6-0-1496" class="d">-      tfile = tempfile.NamedTemporaryFile(mode=&#39;w+b&#39;)
</a><a href="#h6-0-1497" id="h6-0-1497" class="d">-      preexec_fn = not G_IS_WIN and os.setsid or None
</a><a href="#h6-0-1498" id="h6-0-1498" class="d">-      self.proc = subprocess.Popen(self.cmd, stdout=tfile,
</a><a href="#h6-0-1499" id="h6-0-1499" class="d">-                                   stderr=subprocess.STDOUT,
</a><a href="#h6-0-1500" id="h6-0-1500" class="d">-                                   stdin=subprocess.PIPE, shell=True,
</a><a href="#h6-0-1501" id="h6-0-1501" class="d">-                                   preexec_fn=preexec_fn)
</a><a href="#h6-0-1502" id="h6-0-1502" class="d">-      thrd = thr.Thread(target=(lambda proc: proc.wait()), args=(self.proc,))
</a><a href="#h6-0-1503" id="h6-0-1503" class="d">-      thrd.start()
</a><a href="#h6-0-1504" id="h6-0-1504" class="d">-
</a><a href="#h6-0-1505" id="h6-0-1505" class="d">-      thread_not_started = True
</a><a href="#h6-0-1506" id="h6-0-1506" class="d">-      while thread_not_started:
</a><a href="#h6-0-1507" id="h6-0-1507" class="d">-        try:
</a><a href="#h6-0-1508" id="h6-0-1508" class="d">-          thrd.join(0.1)
</a><a href="#h6-0-1509" id="h6-0-1509" class="d">-          thread_not_started = False
</a><a href="#h6-0-1510" id="h6-0-1510" class="d">-        except RuntimeError:
</a><a href="#h6-0-1511" id="h6-0-1511" class="d">-          pass
</a><a href="#h6-0-1512" id="h6-0-1512" class="d">-
</a><a href="#h6-0-1513" id="h6-0-1513" class="d">-      while self.alive:
</a><a href="#h6-0-1514" id="h6-0-1514" class="d">-        if G_STOP.is_set():
</a><a href="#h6-0-1515" id="h6-0-1515" class="d">-          raise KeyboardInterrupt
</a><a href="#h6-0-1516" id="h6-0-1516" class="d">-
</a><a href="#h6-0-1517" id="h6-0-1517" class="d">-        if first_line or random.random() &lt; G_LOG_PROB:
</a><a href="#h6-0-1518" id="h6-0-1518" class="d">-          first_line = False
</a><a href="#h6-0-1519" id="h6-0-1519" class="d">-          line = &#39;&#39; if G_IS_WIN else nonblock_read(tfile.name)
</a><a href="#h6-0-1520" id="h6-0-1520" class="d">-          if line:
</a><a href="#h6-0-1521" id="h6-0-1521" class="d">-            self.callback([line])
</a><a href="#h6-0-1522" id="h6-0-1522" class="d">-
</a><a href="#h6-0-1523" id="h6-0-1523" class="d">-        time_diff = time.time() - os.path.getmtime(tfile.name)
</a><a href="#h6-0-1524" id="h6-0-1524" class="d">-        if time_diff &gt; self.timeout:
</a><a href="#h6-0-1525" id="h6-0-1525" class="d">-          raise CmdTimedOut([&#39;Timeout!&#39;])
</a><a href="#h6-0-1526" id="h6-0-1526" class="d">-
</a><a href="#h6-0-1527" id="h6-0-1527" class="d">-        thrd.join(0.5)
</a><a href="#h6-0-1528" id="h6-0-1528" class="d">-
</a><a href="#h6-0-1529" id="h6-0-1529" class="d">-      tfile.seek(0)
</a><a href="#h6-0-1530" id="h6-0-1530" class="d">-      result = [line.decode(&#39;utf-8&#39;, &#39;replace&#39;).rstrip() for line in tfile]
</a><a href="#h6-0-1531" id="h6-0-1531" class="d">-
</a><a href="#h6-0-1532" id="h6-0-1532" class="d">-      if self.proc.returncode != 0:
</a><a href="#h6-0-1533" id="h6-0-1533" class="d">-        raise CmdFailed([&#39;&#39;] + result)
</a><a href="#h6-0-1534" id="h6-0-1534" class="d">-
</a><a href="#h6-0-1535" id="h6-0-1535" class="d">-      return result
</a><a href="#h6-0-1536" id="h6-0-1536" class="d">-    except:
</a><a href="#h6-0-1537" id="h6-0-1537" class="d">-      self.terminate()
</a><a href="#h6-0-1538" id="h6-0-1538" class="d">-      raise
</a><a href="#h6-0-1539" id="h6-0-1539" class="d">-
</a><a href="#h6-0-1540" id="h6-0-1540" class="d">-  def terminate(self):
</a><a href="#h6-0-1541" id="h6-0-1541" class="d">-    &quot;&quot;&quot; Terminate process and cleanup. &quot;&quot;&quot;
</a><a href="#h6-0-1542" id="h6-0-1542" class="d">-    if self.alive:
</a><a href="#h6-0-1543" id="h6-0-1543" class="d">-      if G_IS_WIN:
</a><a href="#h6-0-1544" id="h6-0-1544" class="d">-        os.kill(self.proc.pid, signal.SIGINT)
</a><a href="#h6-0-1545" id="h6-0-1545" class="d">-      else:
</a><a href="#h6-0-1546" id="h6-0-1546" class="d">-        os.killpg(self.proc.pid, signal.SIGTERM)
</a><a href="#h6-0-1547" id="h6-0-1547" class="d">-    self.clean()
</a><a href="#h6-0-1548" id="h6-0-1548" class="d">-
</a><a href="#h6-0-1549" id="h6-0-1549" class="d">-class Plugin(object):
</a><a href="#h6-0-1550" id="h6-0-1550" class="d">-  def __init__(self, name, args, buf_q, lock):
</a><a href="#h6-0-1551" id="h6-0-1551" class="d">-    self.name = name
</a><a href="#h6-0-1552" id="h6-0-1552" class="d">-    self.args = args
</a><a href="#h6-0-1553" id="h6-0-1553" class="d">-    self.buf_q = buf_q
</a><a href="#h6-0-1554" id="h6-0-1554" class="d">-    self.lock = lock
</a><a href="#h6-0-1555" id="h6-0-1555" class="d">-    self.tag = args.get(&#39;tag&#39;, 0)
</a><a href="#h6-0-1556" id="h6-0-1556" class="d">-
</a><a href="#h6-0-1557" id="h6-0-1557" class="d">-  def manage(self):
</a><a href="#h6-0-1558" id="h6-0-1558" class="d">-    try:
</a><a href="#h6-0-1559" id="h6-0-1559" class="d">-      if os.path.exists(self.args[&#39;dir&#39;]):
</a><a href="#h6-0-1560" id="h6-0-1560" class="d">-        self.update()
</a><a href="#h6-0-1561" id="h6-0-1561" class="d">-      else:
</a><a href="#h6-0-1562" id="h6-0-1562" class="d">-        self.install()
</a><a href="#h6-0-1563" id="h6-0-1563" class="d">-        with self.lock:
</a><a href="#h6-0-1564" id="h6-0-1564" class="d">-          thread_vim_command(&quot;let s:update.new[&#39;{0}&#39;] = 1&quot;.format(self.name))
</a><a href="#h6-0-1565" id="h6-0-1565" class="d">-    except PlugError as exc:
</a><a href="#h6-0-1566" id="h6-0-1566" class="d">-      self.write(Action.ERROR, self.name, exc.msg)
</a><a href="#h6-0-1567" id="h6-0-1567" class="d">-    except KeyboardInterrupt:
</a><a href="#h6-0-1568" id="h6-0-1568" class="d">-      G_STOP.set()
</a><a href="#h6-0-1569" id="h6-0-1569" class="d">-      self.write(Action.ERROR, self.name, [&#39;Interrupted!&#39;])
</a><a href="#h6-0-1570" id="h6-0-1570" class="d">-    except:
</a><a href="#h6-0-1571" id="h6-0-1571" class="d">-      # Any exception except those above print stack trace
</a><a href="#h6-0-1572" id="h6-0-1572" class="d">-      msg = &#39;Trace:\n{0}&#39;.format(traceback.format_exc().rstrip())
</a><a href="#h6-0-1573" id="h6-0-1573" class="d">-      self.write(Action.ERROR, self.name, msg.split(&#39;\n&#39;))
</a><a href="#h6-0-1574" id="h6-0-1574" class="d">-      raise
</a><a href="#h6-0-1575" id="h6-0-1575" class="d">-
</a><a href="#h6-0-1576" id="h6-0-1576" class="d">-  def install(self):
</a><a href="#h6-0-1577" id="h6-0-1577" class="d">-    target = self.args[&#39;dir&#39;]
</a><a href="#h6-0-1578" id="h6-0-1578" class="d">-    if target[-1] == &#39;\\&#39;:
</a><a href="#h6-0-1579" id="h6-0-1579" class="d">-      target = target[0:-1]
</a><a href="#h6-0-1580" id="h6-0-1580" class="d">-
</a><a href="#h6-0-1581" id="h6-0-1581" class="d">-    def clean(target):
</a><a href="#h6-0-1582" id="h6-0-1582" class="d">-      def _clean():
</a><a href="#h6-0-1583" id="h6-0-1583" class="d">-        try:
</a><a href="#h6-0-1584" id="h6-0-1584" class="d">-          shutil.rmtree(target)
</a><a href="#h6-0-1585" id="h6-0-1585" class="d">-        except OSError:
</a><a href="#h6-0-1586" id="h6-0-1586" class="d">-          pass
</a><a href="#h6-0-1587" id="h6-0-1587" class="d">-      return _clean
</a><a href="#h6-0-1588" id="h6-0-1588" class="d">-
</a><a href="#h6-0-1589" id="h6-0-1589" class="d">-    self.write(Action.INSTALL, self.name, [&#39;Installing ...&#39;])
</a><a href="#h6-0-1590" id="h6-0-1590" class="d">-    callback = functools.partial(self.write, Action.INSTALL, self.name)
</a><a href="#h6-0-1591" id="h6-0-1591" class="d">-    cmd = &#39;git clone {0} {1} {2} {3} 2&gt;&amp;1&#39;.format(
</a><a href="#h6-0-1592" id="h6-0-1592" class="d">-          &#39;&#39; if self.tag else G_CLONE_OPT, G_PROGRESS, self.args[&#39;uri&#39;],
</a><a href="#h6-0-1593" id="h6-0-1593" class="d">-          esc(target))
</a><a href="#h6-0-1594" id="h6-0-1594" class="d">-    com = Command(cmd, None, G_TIMEOUT, callback, clean(target))
</a><a href="#h6-0-1595" id="h6-0-1595" class="d">-    result = com.execute(G_RETRIES)
</a><a href="#h6-0-1596" id="h6-0-1596" class="d">-    self.write(Action.DONE, self.name, result[-1:])
</a><a href="#h6-0-1597" id="h6-0-1597" class="d">-
</a><a href="#h6-0-1598" id="h6-0-1598" class="d">-  def repo_uri(self):
</a><a href="#h6-0-1599" id="h6-0-1599" class="d">-    cmd = &#39;git rev-parse --abbrev-ref HEAD 2&gt;&amp;1 &amp;&amp; git config -f .git/config remote.origin.url&#39;
</a><a href="#h6-0-1600" id="h6-0-1600" class="d">-    command = Command(cmd, self.args[&#39;dir&#39;], G_TIMEOUT,)
</a><a href="#h6-0-1601" id="h6-0-1601" class="d">-    result = command.execute(G_RETRIES)
</a><a href="#h6-0-1602" id="h6-0-1602" class="d">-    return result[-1]
</a><a href="#h6-0-1603" id="h6-0-1603" class="d">-
</a><a href="#h6-0-1604" id="h6-0-1604" class="d">-  def update(self):
</a><a href="#h6-0-1605" id="h6-0-1605" class="d">-    actual_uri = self.repo_uri()
</a><a href="#h6-0-1606" id="h6-0-1606" class="d">-    expect_uri = self.args[&#39;uri&#39;]
</a><a href="#h6-0-1607" id="h6-0-1607" class="d">-    regex = re.compile(r&#39;^(?:\w+://)?(?:[^@/]*@)?([^:/]*(?::[0-9]*)?)[:/](.*?)(?:\.git)?/?$&#39;)
</a><a href="#h6-0-1608" id="h6-0-1608" class="d">-    ma = regex.match(actual_uri)
</a><a href="#h6-0-1609" id="h6-0-1609" class="d">-    mb = regex.match(expect_uri)
</a><a href="#h6-0-1610" id="h6-0-1610" class="d">-    if ma is None or mb is None or ma.groups() != mb.groups():
</a><a href="#h6-0-1611" id="h6-0-1611" class="d">-      msg = [&#39;&#39;,
</a><a href="#h6-0-1612" id="h6-0-1612" class="d">-             &#39;Invalid URI: {0}&#39;.format(actual_uri),
</a><a href="#h6-0-1613" id="h6-0-1613" class="d">-             &#39;Expected     {0}&#39;.format(expect_uri),
</a><a href="#h6-0-1614" id="h6-0-1614" class="d">-             &#39;PlugClean required.&#39;]
</a><a href="#h6-0-1615" id="h6-0-1615" class="d">-      raise InvalidURI(msg)
</a><a href="#h6-0-1616" id="h6-0-1616" class="d">-
</a><a href="#h6-0-1617" id="h6-0-1617" class="d">-    if G_PULL:
</a><a href="#h6-0-1618" id="h6-0-1618" class="d">-      self.write(Action.UPDATE, self.name, [&#39;Updating ...&#39;])
</a><a href="#h6-0-1619" id="h6-0-1619" class="d">-      callback = functools.partial(self.write, Action.UPDATE, self.name)
</a><a href="#h6-0-1620" id="h6-0-1620" class="d">-      fetch_opt = &#39;--depth 99999999&#39; if self.tag and os.path.isfile(os.path.join(self.args[&#39;dir&#39;], &#39;.git/shallow&#39;)) else &#39;&#39;
</a><a href="#h6-0-1621" id="h6-0-1621" class="d">-      cmd = &#39;git fetch {0} {1} 2&gt;&amp;1&#39;.format(fetch_opt, G_PROGRESS)
</a><a href="#h6-0-1622" id="h6-0-1622" class="d">-      com = Command(cmd, self.args[&#39;dir&#39;], G_TIMEOUT, callback)
</a><a href="#h6-0-1623" id="h6-0-1623" class="d">-      result = com.execute(G_RETRIES)
</a><a href="#h6-0-1624" id="h6-0-1624" class="d">-      self.write(Action.DONE, self.name, result[-1:])
</a><a href="#h6-0-1625" id="h6-0-1625" class="d">-    else:
</a><a href="#h6-0-1626" id="h6-0-1626" class="d">-      self.write(Action.DONE, self.name, [&#39;Already installed&#39;])
</a><a href="#h6-0-1627" id="h6-0-1627" class="d">-
</a><a href="#h6-0-1628" id="h6-0-1628" class="d">-  def write(self, action, name, msg):
</a><a href="#h6-0-1629" id="h6-0-1629" class="d">-    self.buf_q.put((action, name, msg))
</a><a href="#h6-0-1630" id="h6-0-1630" class="d">-
</a><a href="#h6-0-1631" id="h6-0-1631" class="d">-class PlugThread(thr.Thread):
</a><a href="#h6-0-1632" id="h6-0-1632" class="d">-  def __init__(self, tname, args):
</a><a href="#h6-0-1633" id="h6-0-1633" class="d">-    super(PlugThread, self).__init__()
</a><a href="#h6-0-1634" id="h6-0-1634" class="d">-    self.tname = tname
</a><a href="#h6-0-1635" id="h6-0-1635" class="d">-    self.args = args
</a><a href="#h6-0-1636" id="h6-0-1636" class="d">-
</a><a href="#h6-0-1637" id="h6-0-1637" class="d">-  def run(self):
</a><a href="#h6-0-1638" id="h6-0-1638" class="d">-    thr.current_thread().name = self.tname
</a><a href="#h6-0-1639" id="h6-0-1639" class="d">-    buf_q, work_q, lock = self.args
</a><a href="#h6-0-1640" id="h6-0-1640" class="d">-
</a><a href="#h6-0-1641" id="h6-0-1641" class="d">-    try:
</a><a href="#h6-0-1642" id="h6-0-1642" class="d">-      while not G_STOP.is_set():
</a><a href="#h6-0-1643" id="h6-0-1643" class="d">-        name, args = work_q.get_nowait()
</a><a href="#h6-0-1644" id="h6-0-1644" class="d">-        plug = Plugin(name, args, buf_q, lock)
</a><a href="#h6-0-1645" id="h6-0-1645" class="d">-        plug.manage()
</a><a href="#h6-0-1646" id="h6-0-1646" class="d">-        work_q.task_done()
</a><a href="#h6-0-1647" id="h6-0-1647" class="d">-    except queue.Empty:
</a><a href="#h6-0-1648" id="h6-0-1648" class="d">-      pass
</a><a href="#h6-0-1649" id="h6-0-1649" class="d">-
</a><a href="#h6-0-1650" id="h6-0-1650" class="d">-class RefreshThread(thr.Thread):
</a><a href="#h6-0-1651" id="h6-0-1651" class="d">-  def __init__(self, lock):
</a><a href="#h6-0-1652" id="h6-0-1652" class="d">-    super(RefreshThread, self).__init__()
</a><a href="#h6-0-1653" id="h6-0-1653" class="d">-    self.lock = lock
</a><a href="#h6-0-1654" id="h6-0-1654" class="d">-    self.running = True
</a><a href="#h6-0-1655" id="h6-0-1655" class="d">-
</a><a href="#h6-0-1656" id="h6-0-1656" class="d">-  def run(self):
</a><a href="#h6-0-1657" id="h6-0-1657" class="d">-    while self.running:
</a><a href="#h6-0-1658" id="h6-0-1658" class="d">-      with self.lock:
</a><a href="#h6-0-1659" id="h6-0-1659" class="d">-        thread_vim_command(&#39;noautocmd normal! a&#39;)
</a><a href="#h6-0-1660" id="h6-0-1660" class="d">-      time.sleep(0.33)
</a><a href="#h6-0-1661" id="h6-0-1661" class="d">-
</a><a href="#h6-0-1662" id="h6-0-1662" class="d">-  def stop(self):
</a><a href="#h6-0-1663" id="h6-0-1663" class="d">-    self.running = False
</a><a href="#h6-0-1664" id="h6-0-1664" class="d">-
</a><a href="#h6-0-1665" id="h6-0-1665" class="d">-if G_NVIM:
</a><a href="#h6-0-1666" id="h6-0-1666" class="d">-  def thread_vim_command(cmd):
</a><a href="#h6-0-1667" id="h6-0-1667" class="d">-    vim.session.threadsafe_call(lambda: vim.command(cmd))
</a><a href="#h6-0-1668" id="h6-0-1668" class="d">-else:
</a><a href="#h6-0-1669" id="h6-0-1669" class="d">-  def thread_vim_command(cmd):
</a><a href="#h6-0-1670" id="h6-0-1670" class="d">-    vim.command(cmd)
</a><a href="#h6-0-1671" id="h6-0-1671" class="d">-
</a><a href="#h6-0-1672" id="h6-0-1672" class="d">-def esc(name):
</a><a href="#h6-0-1673" id="h6-0-1673" class="d">-  return &#39;&quot;&#39; + name.replace(&#39;&quot;&#39;, &#39;\&quot;&#39;) + &#39;&quot;&#39;
</a><a href="#h6-0-1674" id="h6-0-1674" class="d">-
</a><a href="#h6-0-1675" id="h6-0-1675" class="d">-def nonblock_read(fname):
</a><a href="#h6-0-1676" id="h6-0-1676" class="d">-  &quot;&quot;&quot; Read a file with nonblock flag. Return the last line. &quot;&quot;&quot;
</a><a href="#h6-0-1677" id="h6-0-1677" class="d">-  fread = os.open(fname, os.O_RDONLY | os.O_NONBLOCK)
</a><a href="#h6-0-1678" id="h6-0-1678" class="d">-  buf = os.read(fread, 100000).decode(&#39;utf-8&#39;, &#39;replace&#39;)
</a><a href="#h6-0-1679" id="h6-0-1679" class="d">-  os.close(fread)
</a><a href="#h6-0-1680" id="h6-0-1680" class="d">-
</a><a href="#h6-0-1681" id="h6-0-1681" class="d">-  line = buf.rstrip(&#39;\r\n&#39;)
</a><a href="#h6-0-1682" id="h6-0-1682" class="d">-  left = max(line.rfind(&#39;\r&#39;), line.rfind(&#39;\n&#39;))
</a><a href="#h6-0-1683" id="h6-0-1683" class="d">-  if left != -1:
</a><a href="#h6-0-1684" id="h6-0-1684" class="d">-    left += 1
</a><a href="#h6-0-1685" id="h6-0-1685" class="d">-    line = line[left:]
</a><a href="#h6-0-1686" id="h6-0-1686" class="d">-
</a><a href="#h6-0-1687" id="h6-0-1687" class="d">-  return line
</a><a href="#h6-0-1688" id="h6-0-1688" class="d">-
</a><a href="#h6-0-1689" id="h6-0-1689" class="d">-def main():
</a><a href="#h6-0-1690" id="h6-0-1690" class="d">-  thr.current_thread().name = &#39;main&#39;
</a><a href="#h6-0-1691" id="h6-0-1691" class="d">-  nthreads = int(vim.eval(&#39;s:update.threads&#39;))
</a><a href="#h6-0-1692" id="h6-0-1692" class="d">-  plugs = vim.eval(&#39;s:update.todo&#39;)
</a><a href="#h6-0-1693" id="h6-0-1693" class="d">-  mac_gui = vim.eval(&#39;s:mac_gui&#39;) == &#39;1&#39;
</a><a href="#h6-0-1694" id="h6-0-1694" class="d">-
</a><a href="#h6-0-1695" id="h6-0-1695" class="d">-  lock = thr.Lock()
</a><a href="#h6-0-1696" id="h6-0-1696" class="d">-  buf = Buffer(lock, len(plugs), G_PULL)
</a><a href="#h6-0-1697" id="h6-0-1697" class="d">-  buf_q, work_q = queue.Queue(), queue.Queue()
</a><a href="#h6-0-1698" id="h6-0-1698" class="d">-  for work in plugs.items():
</a><a href="#h6-0-1699" id="h6-0-1699" class="d">-    work_q.put(work)
</a><a href="#h6-0-1700" id="h6-0-1700" class="d">-
</a><a href="#h6-0-1701" id="h6-0-1701" class="d">-  start_cnt = thr.active_count()
</a><a href="#h6-0-1702" id="h6-0-1702" class="d">-  for num in range(nthreads):
</a><a href="#h6-0-1703" id="h6-0-1703" class="d">-    tname = &#39;PlugT-{0:02}&#39;.format(num)
</a><a href="#h6-0-1704" id="h6-0-1704" class="d">-    thread = PlugThread(tname, (buf_q, work_q, lock))
</a><a href="#h6-0-1705" id="h6-0-1705" class="d">-    thread.start()
</a><a href="#h6-0-1706" id="h6-0-1706" class="d">-  if mac_gui:
</a><a href="#h6-0-1707" id="h6-0-1707" class="d">-    rthread = RefreshThread(lock)
</a><a href="#h6-0-1708" id="h6-0-1708" class="d">-    rthread.start()
</a><a href="#h6-0-1709" id="h6-0-1709" class="d">-
</a><a href="#h6-0-1710" id="h6-0-1710" class="d">-  while not buf_q.empty() or thr.active_count() != start_cnt:
</a><a href="#h6-0-1711" id="h6-0-1711" class="d">-    try:
</a><a href="#h6-0-1712" id="h6-0-1712" class="d">-      action, name, msg = buf_q.get(True, 0.25)
</a><a href="#h6-0-1713" id="h6-0-1713" class="d">-      buf.write(action, name, [&#39;OK&#39;] if not msg else msg)
</a><a href="#h6-0-1714" id="h6-0-1714" class="d">-      buf_q.task_done()
</a><a href="#h6-0-1715" id="h6-0-1715" class="d">-    except queue.Empty:
</a><a href="#h6-0-1716" id="h6-0-1716" class="d">-      pass
</a><a href="#h6-0-1717" id="h6-0-1717" class="d">-    except KeyboardInterrupt:
</a><a href="#h6-0-1718" id="h6-0-1718" class="d">-      G_STOP.set()
</a><a href="#h6-0-1719" id="h6-0-1719" class="d">-
</a><a href="#h6-0-1720" id="h6-0-1720" class="d">-  if mac_gui:
</a><a href="#h6-0-1721" id="h6-0-1721" class="d">-    rthread.stop()
</a><a href="#h6-0-1722" id="h6-0-1722" class="d">-    rthread.join()
</a><a href="#h6-0-1723" id="h6-0-1723" class="d">-
</a><a href="#h6-0-1724" id="h6-0-1724" class="d">-main()
</a><a href="#h6-0-1725" id="h6-0-1725" class="d">-EOF
</a><a href="#h6-0-1726" id="h6-0-1726" class="d">-endfunction
</a><a href="#h6-0-1727" id="h6-0-1727" class="d">-
</a><a href="#h6-0-1728" id="h6-0-1728" class="d">-function! s:update_ruby()
</a><a href="#h6-0-1729" id="h6-0-1729" class="d">-  ruby &lt;&lt; EOF
</a><a href="#h6-0-1730" id="h6-0-1730" class="d">-  module PlugStream
</a><a href="#h6-0-1731" id="h6-0-1731" class="d">-    SEP = [&quot;\r&quot;, &quot;\n&quot;, nil]
</a><a href="#h6-0-1732" id="h6-0-1732" class="d">-    def get_line
</a><a href="#h6-0-1733" id="h6-0-1733" class="d">-      buffer = &#39;&#39;
</a><a href="#h6-0-1734" id="h6-0-1734" class="d">-      loop do
</a><a href="#h6-0-1735" id="h6-0-1735" class="d">-        char = readchar rescue return
</a><a href="#h6-0-1736" id="h6-0-1736" class="d">-        if SEP.include? char.chr
</a><a href="#h6-0-1737" id="h6-0-1737" class="d">-          buffer &lt;&lt; $/
</a><a href="#h6-0-1738" id="h6-0-1738" class="d">-          break
</a><a href="#h6-0-1739" id="h6-0-1739" class="d">-        else
</a><a href="#h6-0-1740" id="h6-0-1740" class="d">-          buffer &lt;&lt; char
</a><a href="#h6-0-1741" id="h6-0-1741" class="d">-        end
</a><a href="#h6-0-1742" id="h6-0-1742" class="d">-      end
</a><a href="#h6-0-1743" id="h6-0-1743" class="d">-      buffer
</a><a href="#h6-0-1744" id="h6-0-1744" class="d">-    end
</a><a href="#h6-0-1745" id="h6-0-1745" class="d">-  end unless defined?(PlugStream)
</a><a href="#h6-0-1746" id="h6-0-1746" class="d">-
</a><a href="#h6-0-1747" id="h6-0-1747" class="d">-  def esc arg
</a><a href="#h6-0-1748" id="h6-0-1748" class="d">-    %[&quot;#{arg.gsub(&#39;&quot;&#39;, &#39;\&quot;&#39;)}&quot;]
</a><a href="#h6-0-1749" id="h6-0-1749" class="d">-  end
</a><a href="#h6-0-1750" id="h6-0-1750" class="d">-
</a><a href="#h6-0-1751" id="h6-0-1751" class="d">-  def killall pid
</a><a href="#h6-0-1752" id="h6-0-1752" class="d">-    pids = [pid]
</a><a href="#h6-0-1753" id="h6-0-1753" class="d">-    if /mswin|mingw|bccwin/ =~ RUBY_PLATFORM
</a><a href="#h6-0-1754" id="h6-0-1754" class="d">-      pids.each { |pid| Process.kill &#39;INT&#39;, pid.to_i rescue nil }
</a><a href="#h6-0-1755" id="h6-0-1755" class="d">-    else
</a><a href="#h6-0-1756" id="h6-0-1756" class="d">-      unless `which pgrep 2&gt; /dev/null`.empty?
</a><a href="#h6-0-1757" id="h6-0-1757" class="d">-        children = pids
</a><a href="#h6-0-1758" id="h6-0-1758" class="d">-        until children.empty?
</a><a href="#h6-0-1759" id="h6-0-1759" class="d">-          children = children.map { |pid|
</a><a href="#h6-0-1760" id="h6-0-1760" class="d">-            `pgrep -P #{pid}`.lines.map { |l| l.chomp }
</a><a href="#h6-0-1761" id="h6-0-1761" class="d">-          }.flatten
</a><a href="#h6-0-1762" id="h6-0-1762" class="d">-          pids += children
</a><a href="#h6-0-1763" id="h6-0-1763" class="d">-        end
</a><a href="#h6-0-1764" id="h6-0-1764" class="d">-      end
</a><a href="#h6-0-1765" id="h6-0-1765" class="d">-      pids.each { |pid| Process.kill &#39;TERM&#39;, pid.to_i rescue nil }
</a><a href="#h6-0-1766" id="h6-0-1766" class="d">-    end
</a><a href="#h6-0-1767" id="h6-0-1767" class="d">-  end
</a><a href="#h6-0-1768" id="h6-0-1768" class="d">-
</a><a href="#h6-0-1769" id="h6-0-1769" class="d">-  def compare_git_uri a, b
</a><a href="#h6-0-1770" id="h6-0-1770" class="d">-    regex = %r{^(?:\w+://)?(?:[^@/]*@)?([^:/]*(?::[0-9]*)?)[:/](.*?)(?:\.git)?/?$}
</a><a href="#h6-0-1771" id="h6-0-1771" class="d">-    regex.match(a).to_a.drop(1) == regex.match(b).to_a.drop(1)
</a><a href="#h6-0-1772" id="h6-0-1772" class="d">-  end
</a><a href="#h6-0-1773" id="h6-0-1773" class="d">-
</a><a href="#h6-0-1774" id="h6-0-1774" class="d">-  require &#39;thread&#39;
</a><a href="#h6-0-1775" id="h6-0-1775" class="d">-  require &#39;fileutils&#39;
</a><a href="#h6-0-1776" id="h6-0-1776" class="d">-  require &#39;timeout&#39;
</a><a href="#h6-0-1777" id="h6-0-1777" class="d">-  running = true
</a><a href="#h6-0-1778" id="h6-0-1778" class="d">-  iswin = VIM::evaluate(&#39;s:is_win&#39;).to_i == 1
</a><a href="#h6-0-1779" id="h6-0-1779" class="d">-  pull  = VIM::evaluate(&#39;s:update.pull&#39;).to_i == 1
</a><a href="#h6-0-1780" id="h6-0-1780" class="d">-  base  = VIM::evaluate(&#39;g:plug_home&#39;)
</a><a href="#h6-0-1781" id="h6-0-1781" class="d">-  all   = VIM::evaluate(&#39;s:update.todo&#39;)
</a><a href="#h6-0-1782" id="h6-0-1782" class="d">-  limit = VIM::evaluate(&#39;get(g:, &quot;plug_timeout&quot;, 60)&#39;)
</a><a href="#h6-0-1783" id="h6-0-1783" class="d">-  tries = VIM::evaluate(&#39;get(g:, &quot;plug_retries&quot;, 2)&#39;) + 1
</a><a href="#h6-0-1784" id="h6-0-1784" class="d">-  nthr  = VIM::evaluate(&#39;s:update.threads&#39;).to_i
</a><a href="#h6-0-1785" id="h6-0-1785" class="d">-  maxy  = VIM::evaluate(&#39;winheight(&quot;.&quot;)&#39;).to_i
</a><a href="#h6-0-1786" id="h6-0-1786" class="d">-  vim7  = VIM::evaluate(&#39;v:version&#39;).to_i &lt;= 703 &amp;&amp; RUBY_PLATFORM =~ /darwin/
</a><a href="#h6-0-1787" id="h6-0-1787" class="d">-  cd    = iswin ? &#39;cd /d&#39; : &#39;cd&#39;
</a><a href="#h6-0-1788" id="h6-0-1788" class="d">-  tot   = VIM::evaluate(&#39;len(s:update.todo)&#39;) || 0
</a><a href="#h6-0-1789" id="h6-0-1789" class="d">-  bar   = &#39;&#39;
</a><a href="#h6-0-1790" id="h6-0-1790" class="d">-  skip  = &#39;Already installed&#39;
</a><a href="#h6-0-1791" id="h6-0-1791" class="d">-  mtx   = Mutex.new
</a><a href="#h6-0-1792" id="h6-0-1792" class="d">-  take1 = proc { mtx.synchronize { running &amp;&amp; all.shift } }
</a><a href="#h6-0-1793" id="h6-0-1793" class="d">-  logh  = proc {
</a><a href="#h6-0-1794" id="h6-0-1794" class="d">-    cnt = bar.length
</a><a href="#h6-0-1795" id="h6-0-1795" class="d">-    $curbuf[1] = &quot;#{pull ? &#39;Updating&#39; : &#39;Installing&#39;} plugins (#{cnt}/#{tot})&quot;
</a><a href="#h6-0-1796" id="h6-0-1796" class="d">-    $curbuf[2] = &#39;[&#39; + bar.ljust(tot) + &#39;]&#39;
</a><a href="#h6-0-1797" id="h6-0-1797" class="d">-    VIM::command(&#39;normal! 2G&#39;)
</a><a href="#h6-0-1798" id="h6-0-1798" class="d">-    VIM::command(&#39;redraw&#39;)
</a><a href="#h6-0-1799" id="h6-0-1799" class="d">-  }
</a><a href="#h6-0-1800" id="h6-0-1800" class="d">-  where = proc { |name| (1..($curbuf.length)).find { |l| $curbuf[l] =~ /^[-+x*] #{name}:/ } }
</a><a href="#h6-0-1801" id="h6-0-1801" class="d">-  log   = proc { |name, result, type|
</a><a href="#h6-0-1802" id="h6-0-1802" class="d">-    mtx.synchronize do
</a><a href="#h6-0-1803" id="h6-0-1803" class="d">-      ing  = ![true, false].include?(type)
</a><a href="#h6-0-1804" id="h6-0-1804" class="d">-      bar += type ? &#39;=&#39; : &#39;x&#39; unless ing
</a><a href="#h6-0-1805" id="h6-0-1805" class="d">-      b = case type
</a><a href="#h6-0-1806" id="h6-0-1806" class="d">-          when :install  then &#39;+&#39; when :update then &#39;*&#39;
</a><a href="#h6-0-1807" id="h6-0-1807" class="d">-          when true, nil then &#39;-&#39; else
</a><a href="#h6-0-1808" id="h6-0-1808" class="d">-            VIM::command(&quot;call add(s:update.errors, &#39;#{name}&#39;)&quot;)
</a><a href="#h6-0-1809" id="h6-0-1809" class="d">-            &#39;x&#39;
</a><a href="#h6-0-1810" id="h6-0-1810" class="d">-          end
</a><a href="#h6-0-1811" id="h6-0-1811" class="d">-      result =
</a><a href="#h6-0-1812" id="h6-0-1812" class="d">-        if type || type.nil?
</a><a href="#h6-0-1813" id="h6-0-1813" class="d">-          [&quot;#{b} #{name}: #{result.lines.to_a.last || &#39;OK&#39;}&quot;]
</a><a href="#h6-0-1814" id="h6-0-1814" class="d">-        elsif result =~ /^Interrupted|^Timeout/
</a><a href="#h6-0-1815" id="h6-0-1815" class="d">-          [&quot;#{b} #{name}: #{result}&quot;]
</a><a href="#h6-0-1816" id="h6-0-1816" class="d">-        else
</a><a href="#h6-0-1817" id="h6-0-1817" class="d">-          [&quot;#{b} #{name}&quot;] + result.lines.map { |l| &quot;    &quot; &lt;&lt; l }
</a><a href="#h6-0-1818" id="h6-0-1818" class="d">-        end
</a><a href="#h6-0-1819" id="h6-0-1819" class="d">-      if lnum = where.call(name)
</a><a href="#h6-0-1820" id="h6-0-1820" class="d">-        $curbuf.delete lnum
</a><a href="#h6-0-1821" id="h6-0-1821" class="d">-        lnum = 4 if ing &amp;&amp; lnum &gt; maxy
</a><a href="#h6-0-1822" id="h6-0-1822" class="d">-      end
</a><a href="#h6-0-1823" id="h6-0-1823" class="d">-      result.each_with_index do |line, offset|
</a><a href="#h6-0-1824" id="h6-0-1824" class="d">-        $curbuf.append((lnum || 4) - 1 + offset, line.gsub(/\e\[./, &#39;&#39;).chomp)
</a><a href="#h6-0-1825" id="h6-0-1825" class="d">-      end
</a><a href="#h6-0-1826" id="h6-0-1826" class="d">-      logh.call
</a><a href="#h6-0-1827" id="h6-0-1827" class="d">-    end
</a><a href="#h6-0-1828" id="h6-0-1828" class="d">-  }
</a><a href="#h6-0-1829" id="h6-0-1829" class="d">-  bt = proc { |cmd, name, type, cleanup|
</a><a href="#h6-0-1830" id="h6-0-1830" class="d">-    tried = timeout = 0
</a><a href="#h6-0-1831" id="h6-0-1831" class="d">-    begin
</a><a href="#h6-0-1832" id="h6-0-1832" class="d">-      tried += 1
</a><a href="#h6-0-1833" id="h6-0-1833" class="d">-      timeout += limit
</a><a href="#h6-0-1834" id="h6-0-1834" class="d">-      fd = nil
</a><a href="#h6-0-1835" id="h6-0-1835" class="d">-      data = &#39;&#39;
</a><a href="#h6-0-1836" id="h6-0-1836" class="d">-      if iswin
</a><a href="#h6-0-1837" id="h6-0-1837" class="d">-        Timeout::timeout(timeout) do
</a><a href="#h6-0-1838" id="h6-0-1838" class="d">-          tmp = VIM::evaluate(&#39;tempname()&#39;)
</a><a href="#h6-0-1839" id="h6-0-1839" class="d">-          system(&quot;(#{cmd}) &gt; #{tmp}&quot;)
</a><a href="#h6-0-1840" id="h6-0-1840" class="d">-          data = File.read(tmp).chomp
</a><a href="#h6-0-1841" id="h6-0-1841" class="d">-          File.unlink tmp rescue nil
</a><a href="#h6-0-1842" id="h6-0-1842" class="d">-        end
</a><a href="#h6-0-1843" id="h6-0-1843" class="d">-      else
</a><a href="#h6-0-1844" id="h6-0-1844" class="d">-        fd = IO.popen(cmd).extend(PlugStream)
</a><a href="#h6-0-1845" id="h6-0-1845" class="d">-        first_line = true
</a><a href="#h6-0-1846" id="h6-0-1846" class="d">-        log_prob = 1.0 / nthr
</a><a href="#h6-0-1847" id="h6-0-1847" class="d">-        while line = Timeout::timeout(timeout) { fd.get_line }
</a><a href="#h6-0-1848" id="h6-0-1848" class="d">-          data &lt;&lt; line
</a><a href="#h6-0-1849" id="h6-0-1849" class="d">-          log.call name, line.chomp, type if name &amp;&amp; (first_line || rand &lt; log_prob)
</a><a href="#h6-0-1850" id="h6-0-1850" class="d">-          first_line = false
</a><a href="#h6-0-1851" id="h6-0-1851" class="d">-        end
</a><a href="#h6-0-1852" id="h6-0-1852" class="d">-        fd.close
</a><a href="#h6-0-1853" id="h6-0-1853" class="d">-      end
</a><a href="#h6-0-1854" id="h6-0-1854" class="d">-      [$? == 0, data.chomp]
</a><a href="#h6-0-1855" id="h6-0-1855" class="d">-    rescue Timeout::Error, Interrupt =&gt; e
</a><a href="#h6-0-1856" id="h6-0-1856" class="d">-      if fd &amp;&amp; !fd.closed?
</a><a href="#h6-0-1857" id="h6-0-1857" class="d">-        killall fd.pid
</a><a href="#h6-0-1858" id="h6-0-1858" class="d">-        fd.close
</a><a href="#h6-0-1859" id="h6-0-1859" class="d">-      end
</a><a href="#h6-0-1860" id="h6-0-1860" class="d">-      cleanup.call if cleanup
</a><a href="#h6-0-1861" id="h6-0-1861" class="d">-      if e.is_a?(Timeout::Error) &amp;&amp; tried &lt; tries
</a><a href="#h6-0-1862" id="h6-0-1862" class="d">-        3.downto(1) do |countdown|
</a><a href="#h6-0-1863" id="h6-0-1863" class="d">-          s = countdown &gt; 1 ? &#39;s&#39; : &#39;&#39;
</a><a href="#h6-0-1864" id="h6-0-1864" class="d">-          log.call name, &quot;Timeout. Will retry in #{countdown} second#{s} ...&quot;, type
</a><a href="#h6-0-1865" id="h6-0-1865" class="d">-          sleep 1
</a><a href="#h6-0-1866" id="h6-0-1866" class="d">-        end
</a><a href="#h6-0-1867" id="h6-0-1867" class="d">-        log.call name, &#39;Retrying ...&#39;, type
</a><a href="#h6-0-1868" id="h6-0-1868" class="d">-        retry
</a><a href="#h6-0-1869" id="h6-0-1869" class="d">-      end
</a><a href="#h6-0-1870" id="h6-0-1870" class="d">-      [false, e.is_a?(Interrupt) ? &quot;Interrupted!&quot; : &quot;Timeout!&quot;]
</a><a href="#h6-0-1871" id="h6-0-1871" class="d">-    end
</a><a href="#h6-0-1872" id="h6-0-1872" class="d">-  }
</a><a href="#h6-0-1873" id="h6-0-1873" class="d">-  main = Thread.current
</a><a href="#h6-0-1874" id="h6-0-1874" class="d">-  threads = []
</a><a href="#h6-0-1875" id="h6-0-1875" class="d">-  watcher = Thread.new {
</a><a href="#h6-0-1876" id="h6-0-1876" class="d">-    if vim7
</a><a href="#h6-0-1877" id="h6-0-1877" class="d">-      while VIM::evaluate(&#39;getchar(1)&#39;)
</a><a href="#h6-0-1878" id="h6-0-1878" class="d">-        sleep 0.1
</a><a href="#h6-0-1879" id="h6-0-1879" class="d">-      end
</a><a href="#h6-0-1880" id="h6-0-1880" class="d">-    else
</a><a href="#h6-0-1881" id="h6-0-1881" class="d">-      require &#39;io/console&#39; # &gt;= Ruby 1.9
</a><a href="#h6-0-1882" id="h6-0-1882" class="d">-      nil until IO.console.getch == 3.chr
</a><a href="#h6-0-1883" id="h6-0-1883" class="d">-    end
</a><a href="#h6-0-1884" id="h6-0-1884" class="d">-    mtx.synchronize do
</a><a href="#h6-0-1885" id="h6-0-1885" class="d">-      running = false
</a><a href="#h6-0-1886" id="h6-0-1886" class="d">-      threads.each { |t| t.raise Interrupt } unless vim7
</a><a href="#h6-0-1887" id="h6-0-1887" class="d">-    end
</a><a href="#h6-0-1888" id="h6-0-1888" class="d">-    threads.each { |t| t.join rescue nil }
</a><a href="#h6-0-1889" id="h6-0-1889" class="d">-    main.kill
</a><a href="#h6-0-1890" id="h6-0-1890" class="d">-  }
</a><a href="#h6-0-1891" id="h6-0-1891" class="d">-  refresh = Thread.new {
</a><a href="#h6-0-1892" id="h6-0-1892" class="d">-    while true
</a><a href="#h6-0-1893" id="h6-0-1893" class="d">-      mtx.synchronize do
</a><a href="#h6-0-1894" id="h6-0-1894" class="d">-        break unless running
</a><a href="#h6-0-1895" id="h6-0-1895" class="d">-        VIM::command(&#39;noautocmd normal! a&#39;)
</a><a href="#h6-0-1896" id="h6-0-1896" class="d">-      end
</a><a href="#h6-0-1897" id="h6-0-1897" class="d">-      sleep 0.2
</a><a href="#h6-0-1898" id="h6-0-1898" class="d">-    end
</a><a href="#h6-0-1899" id="h6-0-1899" class="d">-  } if VIM::evaluate(&#39;s:mac_gui&#39;) == 1
</a><a href="#h6-0-1900" id="h6-0-1900" class="d">-
</a><a href="#h6-0-1901" id="h6-0-1901" class="d">-  clone_opt = VIM::evaluate(&#39;s:clone_opt&#39;)
</a><a href="#h6-0-1902" id="h6-0-1902" class="d">-  progress = VIM::evaluate(&#39;s:progress_opt(1)&#39;)
</a><a href="#h6-0-1903" id="h6-0-1903" class="d">-  nthr.times do
</a><a href="#h6-0-1904" id="h6-0-1904" class="d">-    mtx.synchronize do
</a><a href="#h6-0-1905" id="h6-0-1905" class="d">-      threads &lt;&lt; Thread.new {
</a><a href="#h6-0-1906" id="h6-0-1906" class="d">-        while pair = take1.call
</a><a href="#h6-0-1907" id="h6-0-1907" class="d">-          name = pair.first
</a><a href="#h6-0-1908" id="h6-0-1908" class="d">-          dir, uri, tag = pair.last.values_at *%w[dir uri tag]
</a><a href="#h6-0-1909" id="h6-0-1909" class="d">-          exists = File.directory? dir
</a><a href="#h6-0-1910" id="h6-0-1910" class="d">-          ok, result =
</a><a href="#h6-0-1911" id="h6-0-1911" class="d">-            if exists
</a><a href="#h6-0-1912" id="h6-0-1912" class="d">-              chdir = &quot;#{cd} #{iswin ? dir : esc(dir)}&quot;
</a><a href="#h6-0-1913" id="h6-0-1913" class="d">-              ret, data = bt.call &quot;#{chdir} &amp;&amp; git rev-parse --abbrev-ref HEAD 2&gt;&amp;1 &amp;&amp; git config -f .git/config remote.origin.url&quot;, nil, nil, nil
</a><a href="#h6-0-1914" id="h6-0-1914" class="d">-              current_uri = data.lines.to_a.last
</a><a href="#h6-0-1915" id="h6-0-1915" class="d">-              if !ret
</a><a href="#h6-0-1916" id="h6-0-1916" class="d">-                if data =~ /^Interrupted|^Timeout/
</a><a href="#h6-0-1917" id="h6-0-1917" class="d">-                  [false, data]
</a><a href="#h6-0-1918" id="h6-0-1918" class="d">-                else
</a><a href="#h6-0-1919" id="h6-0-1919" class="d">-                  [false, [data.chomp, &quot;PlugClean required.&quot;].join($/)]
</a><a href="#h6-0-1920" id="h6-0-1920" class="d">-                end
</a><a href="#h6-0-1921" id="h6-0-1921" class="d">-              elsif !compare_git_uri(current_uri, uri)
</a><a href="#h6-0-1922" id="h6-0-1922" class="d">-                [false, [&quot;Invalid URI: #{current_uri}&quot;,
</a><a href="#h6-0-1923" id="h6-0-1923" class="d">-                         &quot;Expected:    #{uri}&quot;,
</a><a href="#h6-0-1924" id="h6-0-1924" class="d">-                         &quot;PlugClean required.&quot;].join($/)]
</a><a href="#h6-0-1925" id="h6-0-1925" class="d">-              else
</a><a href="#h6-0-1926" id="h6-0-1926" class="d">-                if pull
</a><a href="#h6-0-1927" id="h6-0-1927" class="d">-                  log.call name, &#39;Updating ...&#39;, :update
</a><a href="#h6-0-1928" id="h6-0-1928" class="d">-                  fetch_opt = (tag &amp;&amp; File.exist?(File.join(dir, &#39;.git/shallow&#39;))) ? &#39;--depth 99999999&#39; : &#39;&#39;
</a><a href="#h6-0-1929" id="h6-0-1929" class="d">-                  bt.call &quot;#{chdir} &amp;&amp; git fetch #{fetch_opt} #{progress} 2&gt;&amp;1&quot;, name, :update, nil
</a><a href="#h6-0-1930" id="h6-0-1930" class="d">-                else
</a><a href="#h6-0-1931" id="h6-0-1931" class="d">-                  [true, skip]
</a><a href="#h6-0-1932" id="h6-0-1932" class="d">-                end
</a><a href="#h6-0-1933" id="h6-0-1933" class="d">-              end
</a><a href="#h6-0-1934" id="h6-0-1934" class="d">-            else
</a><a href="#h6-0-1935" id="h6-0-1935" class="d">-              d = esc dir.sub(%r{[\\/]+$}, &#39;&#39;)
</a><a href="#h6-0-1936" id="h6-0-1936" class="d">-              log.call name, &#39;Installing ...&#39;, :install
</a><a href="#h6-0-1937" id="h6-0-1937" class="d">-              bt.call &quot;git clone #{clone_opt unless tag} #{progress} #{uri} #{d} 2&gt;&amp;1&quot;, name, :install, proc {
</a><a href="#h6-0-1938" id="h6-0-1938" class="d">-                FileUtils.rm_rf dir
</a><a href="#h6-0-1939" id="h6-0-1939" class="d">-              }
</a><a href="#h6-0-1940" id="h6-0-1940" class="d">-            end
</a><a href="#h6-0-1941" id="h6-0-1941" class="d">-          mtx.synchronize { VIM::command(&quot;let s:update.new[&#39;#{name}&#39;] = 1&quot;) } if !exists &amp;&amp; ok
</a><a href="#h6-0-1942" id="h6-0-1942" class="d">-          log.call name, result, ok
</a><a href="#h6-0-1943" id="h6-0-1943" class="d">-        end
</a><a href="#h6-0-1944" id="h6-0-1944" class="d">-      } if running
</a><a href="#h6-0-1945" id="h6-0-1945" class="d">-    end
</a><a href="#h6-0-1946" id="h6-0-1946" class="d">-  end
</a><a href="#h6-0-1947" id="h6-0-1947" class="d">-  threads.each { |t| t.join rescue nil }
</a><a href="#h6-0-1948" id="h6-0-1948" class="d">-  logh.call
</a><a href="#h6-0-1949" id="h6-0-1949" class="d">-  refresh.kill if refresh
</a><a href="#h6-0-1950" id="h6-0-1950" class="d">-  watcher.kill
</a><a href="#h6-0-1951" id="h6-0-1951" class="d">-EOF
</a><a href="#h6-0-1952" id="h6-0-1952" class="d">-endfunction
</a><a href="#h6-0-1953" id="h6-0-1953" class="d">-
</a><a href="#h6-0-1954" id="h6-0-1954" class="d">-function! s:shellesc(arg)
</a><a href="#h6-0-1955" id="h6-0-1955" class="d">-  return &#39;&quot;&#39;.escape(a:arg, &#39;&quot;&#39;).&#39;&quot;&#39;
</a><a href="#h6-0-1956" id="h6-0-1956" class="d">-endfunction
</a><a href="#h6-0-1957" id="h6-0-1957" class="d">-
</a><a href="#h6-0-1958" id="h6-0-1958" class="d">-function! s:glob_dir(path)
</a><a href="#h6-0-1959" id="h6-0-1959" class="d">-  return map(filter(s:glob(a:path, &#39;**&#39;), &#39;isdirectory(v:val)&#39;), &#39;s:dirpath(v:val)&#39;)
</a><a href="#h6-0-1960" id="h6-0-1960" class="d">-endfunction
</a><a href="#h6-0-1961" id="h6-0-1961" class="d">-
</a><a href="#h6-0-1962" id="h6-0-1962" class="d">-function! s:progress_bar(line, bar, total)
</a><a href="#h6-0-1963" id="h6-0-1963" class="d">-  call setline(a:line, &#39;[&#39; . s:lpad(a:bar, a:total) . &#39;]&#39;)
</a><a href="#h6-0-1964" id="h6-0-1964" class="d">-endfunction
</a><a href="#h6-0-1965" id="h6-0-1965" class="d">-
</a><a href="#h6-0-1966" id="h6-0-1966" class="d">-function! s:compare_git_uri(a, b)
</a><a href="#h6-0-1967" id="h6-0-1967" class="d">-  &quot; See `git help clone&#39;
</a><a href="#h6-0-1968" id="h6-0-1968" class="d">-  &quot; https:// [user@] github.com[:port] / junegunn/vim-plug [.git]
</a><a href="#h6-0-1969" id="h6-0-1969" class="d">-  &quot;          [git@]  github.com[:port] : junegunn/vim-plug [.git]
</a><a href="#h6-0-1970" id="h6-0-1970" class="d">-  &quot; file://                            / junegunn/vim-plug        [/]
</a><a href="#h6-0-1971" id="h6-0-1971" class="d">-  &quot;                                    / junegunn/vim-plug        [/]
</a><a href="#h6-0-1972" id="h6-0-1972" class="d">-  let pat = &#39;^\%(\w\+://\)\=&#39;.&#39;\%([^@/]*@\)\=&#39;.&#39;\([^:/]*\%(:[0-9]*\)\=\)&#39;.&#39;[:/]&#39;.&#39;\(.\{-}\)&#39;.&#39;\%(\.git\)\=/\?$&#39;
</a><a href="#h6-0-1973" id="h6-0-1973" class="d">-  let ma = matchlist(a:a, pat)
</a><a href="#h6-0-1974" id="h6-0-1974" class="d">-  let mb = matchlist(a:b, pat)
</a><a href="#h6-0-1975" id="h6-0-1975" class="d">-  return ma[1:2] ==# mb[1:2]
</a><a href="#h6-0-1976" id="h6-0-1976" class="d">-endfunction
</a><a href="#h6-0-1977" id="h6-0-1977" class="d">-
</a><a href="#h6-0-1978" id="h6-0-1978" class="d">-function! s:format_message(bullet, name, message)
</a><a href="#h6-0-1979" id="h6-0-1979" class="d">-  if a:bullet != &#39;x&#39;
</a><a href="#h6-0-1980" id="h6-0-1980" class="d">-    return [printf(&#39;%s %s: %s&#39;, a:bullet, a:name, s:lastline(a:message))]
</a><a href="#h6-0-1981" id="h6-0-1981" class="d">-  else
</a><a href="#h6-0-1982" id="h6-0-1982" class="d">-    let lines = map(s:lines(a:message), &#39;&quot;    &quot;.v:val&#39;)
</a><a href="#h6-0-1983" id="h6-0-1983" class="d">-    return extend([printf(&#39;x %s:&#39;, a:name)], lines)
</a><a href="#h6-0-1984" id="h6-0-1984" class="d">-  endif
</a><a href="#h6-0-1985" id="h6-0-1985" class="d">-endfunction
</a><a href="#h6-0-1986" id="h6-0-1986" class="d">-
</a><a href="#h6-0-1987" id="h6-0-1987" class="d">-function! s:with_cd(cmd, dir)
</a><a href="#h6-0-1988" id="h6-0-1988" class="d">-  return printf(&#39;cd%s %s &amp;&amp; %s&#39;, s:is_win ? &#39; /d&#39; : &#39;&#39;, s:shellesc(a:dir), a:cmd)
</a><a href="#h6-0-1989" id="h6-0-1989" class="d">-endfunction
</a><a href="#h6-0-1990" id="h6-0-1990" class="d">-
</a><a href="#h6-0-1991" id="h6-0-1991" class="d">-function! s:system(cmd, ...)
</a><a href="#h6-0-1992" id="h6-0-1992" class="d">-  try
</a><a href="#h6-0-1993" id="h6-0-1993" class="d">-    let [sh, shrd] = s:chsh(1)
</a><a href="#h6-0-1994" id="h6-0-1994" class="d">-    let cmd = a:0 &gt; 0 ? s:with_cd(a:cmd, a:1) : a:cmd
</a><a href="#h6-0-1995" id="h6-0-1995" class="d">-    return system(s:is_win ? &#39;(&#39;.cmd.&#39;)&#39; : cmd)
</a><a href="#h6-0-1996" id="h6-0-1996" class="d">-  finally
</a><a href="#h6-0-1997" id="h6-0-1997" class="d">-    let [&amp;shell, &amp;shellredir] = [sh, shrd]
</a><a href="#h6-0-1998" id="h6-0-1998" class="d">-  endtry
</a><a href="#h6-0-1999" id="h6-0-1999" class="d">-endfunction
</a><a href="#h6-0-2000" id="h6-0-2000" class="d">-
</a><a href="#h6-0-2001" id="h6-0-2001" class="d">-function! s:system_chomp(...)
</a><a href="#h6-0-2002" id="h6-0-2002" class="d">-  let ret = call(&#39;s:system&#39;, a:000)
</a><a href="#h6-0-2003" id="h6-0-2003" class="d">-  return v:shell_error ? &#39;&#39; : substitute(ret, &#39;\n$&#39;, &#39;&#39;, &#39;&#39;)
</a><a href="#h6-0-2004" id="h6-0-2004" class="d">-endfunction
</a><a href="#h6-0-2005" id="h6-0-2005" class="d">-
</a><a href="#h6-0-2006" id="h6-0-2006" class="d">-function! s:git_validate(spec, check_branch)
</a><a href="#h6-0-2007" id="h6-0-2007" class="d">-  let err = &#39;&#39;
</a><a href="#h6-0-2008" id="h6-0-2008" class="d">-  if isdirectory(a:spec.dir)
</a><a href="#h6-0-2009" id="h6-0-2009" class="d">-    let result = s:lines(s:system(&#39;git rev-parse --abbrev-ref HEAD 2&gt;&amp;1 &amp;&amp; git config -f .git/config remote.origin.url&#39;, a:spec.dir))
</a><a href="#h6-0-2010" id="h6-0-2010" class="d">-    let remote = result[-1]
</a><a href="#h6-0-2011" id="h6-0-2011" class="d">-    if v:shell_error
</a><a href="#h6-0-2012" id="h6-0-2012" class="d">-      let err = join([remote, &#39;PlugClean required.&#39;], &quot;\n&quot;)
</a><a href="#h6-0-2013" id="h6-0-2013" class="d">-    elseif !s:compare_git_uri(remote, a:spec.uri)
</a><a href="#h6-0-2014" id="h6-0-2014" class="d">-      let err = join([&#39;Invalid URI: &#39;.remote,
</a><a href="#h6-0-2015" id="h6-0-2015" class="d">-                    \ &#39;Expected:    &#39;.a:spec.uri,
</a><a href="#h6-0-2016" id="h6-0-2016" class="d">-                    \ &#39;PlugClean required.&#39;], &quot;\n&quot;)
</a><a href="#h6-0-2017" id="h6-0-2017" class="d">-    elseif a:check_branch &amp;&amp; has_key(a:spec, &#39;commit&#39;)
</a><a href="#h6-0-2018" id="h6-0-2018" class="d">-      let result = s:lines(s:system(&#39;git rev-parse HEAD 2&gt;&amp;1&#39;, a:spec.dir))
</a><a href="#h6-0-2019" id="h6-0-2019" class="d">-      let sha = result[-1]
</a><a href="#h6-0-2020" id="h6-0-2020" class="d">-      if v:shell_error
</a><a href="#h6-0-2021" id="h6-0-2021" class="d">-        let err = join(add(result, &#39;PlugClean required.&#39;), &quot;\n&quot;)
</a><a href="#h6-0-2022" id="h6-0-2022" class="d">-      elseif !s:hash_match(sha, a:spec.commit)
</a><a href="#h6-0-2023" id="h6-0-2023" class="d">-        let err = join([printf(&#39;Invalid HEAD (expected: %s, actual: %s)&#39;,
</a><a href="#h6-0-2024" id="h6-0-2024" class="d">-                              \ a:spec.commit[:6], sha[:6]),
</a><a href="#h6-0-2025" id="h6-0-2025" class="d">-                      \ &#39;PlugUpdate required.&#39;], &quot;\n&quot;)
</a><a href="#h6-0-2026" id="h6-0-2026" class="d">-      endif
</a><a href="#h6-0-2027" id="h6-0-2027" class="d">-    elseif a:check_branch
</a><a href="#h6-0-2028" id="h6-0-2028" class="d">-      let branch = result[0]
</a><a href="#h6-0-2029" id="h6-0-2029" class="d">-      &quot; Check tag
</a><a href="#h6-0-2030" id="h6-0-2030" class="d">-      if has_key(a:spec, &#39;tag&#39;)
</a><a href="#h6-0-2031" id="h6-0-2031" class="d">-        let tag = s:system_chomp(&#39;git describe --exact-match --tags HEAD 2&gt;&amp;1&#39;, a:spec.dir)
</a><a href="#h6-0-2032" id="h6-0-2032" class="d">-        if a:spec.tag !=# tag &amp;&amp; a:spec.tag !~ &#39;\*&#39;
</a><a href="#h6-0-2033" id="h6-0-2033" class="d">-          let err = printf(&#39;Invalid tag: %s (expected: %s). Try PlugUpdate.&#39;,
</a><a href="#h6-0-2034" id="h6-0-2034" class="d">-                \ (empty(tag) ? &#39;N/A&#39; : tag), a:spec.tag)
</a><a href="#h6-0-2035" id="h6-0-2035" class="d">-        endif
</a><a href="#h6-0-2036" id="h6-0-2036" class="d">-      &quot; Check branch
</a><a href="#h6-0-2037" id="h6-0-2037" class="d">-      elseif a:spec.branch !=# branch
</a><a href="#h6-0-2038" id="h6-0-2038" class="d">-        let err = printf(&#39;Invalid branch: %s (expected: %s). Try PlugUpdate.&#39;,
</a><a href="#h6-0-2039" id="h6-0-2039" class="d">-              \ branch, a:spec.branch)
</a><a href="#h6-0-2040" id="h6-0-2040" class="d">-      endif
</a><a href="#h6-0-2041" id="h6-0-2041" class="d">-      if empty(err)
</a><a href="#h6-0-2042" id="h6-0-2042" class="d">-        let [ahead, behind] = split(s:lastline(s:system(printf(
</a><a href="#h6-0-2043" id="h6-0-2043" class="d">-              \ &#39;git rev-list --count --left-right HEAD...origin/%s&#39;,
</a><a href="#h6-0-2044" id="h6-0-2044" class="d">-              \ a:spec.branch), a:spec.dir)), &#39;\t&#39;)
</a><a href="#h6-0-2045" id="h6-0-2045" class="d">-        if !v:shell_error &amp;&amp; ahead
</a><a href="#h6-0-2046" id="h6-0-2046" class="d">-          if behind
</a><a href="#h6-0-2047" id="h6-0-2047" class="d">-            &quot; Only mention PlugClean if diverged, otherwise it&#39;s likely to be
</a><a href="#h6-0-2048" id="h6-0-2048" class="d">-            &quot; pushable (and probably not that messed up).
</a><a href="#h6-0-2049" id="h6-0-2049" class="d">-            let err = printf(
</a><a href="#h6-0-2050" id="h6-0-2050" class="d">-                  \ &quot;Diverged from origin/%s (%d commit(s) ahead and %d commit(s) behind!\n&quot;
</a><a href="#h6-0-2051" id="h6-0-2051" class="d">-                  \ .&#39;Backup local changes and run PlugClean and PlugUpdate to reinstall it.&#39;, a:spec.branch, ahead, behind)
</a><a href="#h6-0-2052" id="h6-0-2052" class="d">-          else
</a><a href="#h6-0-2053" id="h6-0-2053" class="d">-            let err = printf(&quot;Ahead of origin/%s by %d commit(s).\n&quot;
</a><a href="#h6-0-2054" id="h6-0-2054" class="d">-                  \ .&#39;Cannot update until local changes are pushed.&#39;,
</a><a href="#h6-0-2055" id="h6-0-2055" class="d">-                  \ a:spec.branch, ahead)
</a><a href="#h6-0-2056" id="h6-0-2056" class="d">-          endif
</a><a href="#h6-0-2057" id="h6-0-2057" class="d">-        endif
</a><a href="#h6-0-2058" id="h6-0-2058" class="d">-      endif
</a><a href="#h6-0-2059" id="h6-0-2059" class="d">-    endif
</a><a href="#h6-0-2060" id="h6-0-2060" class="d">-  else
</a><a href="#h6-0-2061" id="h6-0-2061" class="d">-    let err = &#39;Not found&#39;
</a><a href="#h6-0-2062" id="h6-0-2062" class="d">-  endif
</a><a href="#h6-0-2063" id="h6-0-2063" class="d">-  return [err, err =~# &#39;PlugClean&#39;]
</a><a href="#h6-0-2064" id="h6-0-2064" class="d">-endfunction
</a><a href="#h6-0-2065" id="h6-0-2065" class="d">-
</a><a href="#h6-0-2066" id="h6-0-2066" class="d">-function! s:rm_rf(dir)
</a><a href="#h6-0-2067" id="h6-0-2067" class="d">-  if isdirectory(a:dir)
</a><a href="#h6-0-2068" id="h6-0-2068" class="d">-    call s:system((s:is_win ? &#39;rmdir /S /Q &#39; : &#39;rm -rf &#39;) . s:shellesc(a:dir))
</a><a href="#h6-0-2069" id="h6-0-2069" class="d">-  endif
</a><a href="#h6-0-2070" id="h6-0-2070" class="d">-endfunction
</a><a href="#h6-0-2071" id="h6-0-2071" class="d">-
</a><a href="#h6-0-2072" id="h6-0-2072" class="d">-function! s:clean(force)
</a><a href="#h6-0-2073" id="h6-0-2073" class="d">-  call s:prepare()
</a><a href="#h6-0-2074" id="h6-0-2074" class="d">-  call append(0, &#39;Searching for invalid plugins in &#39;.g:plug_home)
</a><a href="#h6-0-2075" id="h6-0-2075" class="d">-  call append(1, &#39;&#39;)
</a><a href="#h6-0-2076" id="h6-0-2076" class="d">-
</a><a href="#h6-0-2077" id="h6-0-2077" class="d">-  &quot; List of valid directories
</a><a href="#h6-0-2078" id="h6-0-2078" class="d">-  let dirs = []
</a><a href="#h6-0-2079" id="h6-0-2079" class="d">-  let errs = {}
</a><a href="#h6-0-2080" id="h6-0-2080" class="d">-  let [cnt, total] = [0, len(g:plugs)]
</a><a href="#h6-0-2081" id="h6-0-2081" class="d">-  for [name, spec] in items(g:plugs)
</a><a href="#h6-0-2082" id="h6-0-2082" class="d">-    if !s:is_managed(name)
</a><a href="#h6-0-2083" id="h6-0-2083" class="d">-      call add(dirs, spec.dir)
</a><a href="#h6-0-2084" id="h6-0-2084" class="d">-    else
</a><a href="#h6-0-2085" id="h6-0-2085" class="d">-      let [err, clean] = s:git_validate(spec, 1)
</a><a href="#h6-0-2086" id="h6-0-2086" class="d">-      if clean
</a><a href="#h6-0-2087" id="h6-0-2087" class="d">-        let errs[spec.dir] = s:lines(err)[0]
</a><a href="#h6-0-2088" id="h6-0-2088" class="d">-      else
</a><a href="#h6-0-2089" id="h6-0-2089" class="d">-        call add(dirs, spec.dir)
</a><a href="#h6-0-2090" id="h6-0-2090" class="d">-      endif
</a><a href="#h6-0-2091" id="h6-0-2091" class="d">-    endif
</a><a href="#h6-0-2092" id="h6-0-2092" class="d">-    let cnt += 1
</a><a href="#h6-0-2093" id="h6-0-2093" class="d">-    call s:progress_bar(2, repeat(&#39;=&#39;, cnt), total)
</a><a href="#h6-0-2094" id="h6-0-2094" class="d">-    normal! 2G
</a><a href="#h6-0-2095" id="h6-0-2095" class="d">-    redraw
</a><a href="#h6-0-2096" id="h6-0-2096" class="d">-  endfor
</a><a href="#h6-0-2097" id="h6-0-2097" class="d">-
</a><a href="#h6-0-2098" id="h6-0-2098" class="d">-  let allowed = {}
</a><a href="#h6-0-2099" id="h6-0-2099" class="d">-  for dir in dirs
</a><a href="#h6-0-2100" id="h6-0-2100" class="d">-    let allowed[s:dirpath(fnamemodify(dir, &#39;:h:h&#39;))] = 1
</a><a href="#h6-0-2101" id="h6-0-2101" class="d">-    let allowed[dir] = 1
</a><a href="#h6-0-2102" id="h6-0-2102" class="d">-    for child in s:glob_dir(dir)
</a><a href="#h6-0-2103" id="h6-0-2103" class="d">-      let allowed[child] = 1
</a><a href="#h6-0-2104" id="h6-0-2104" class="d">-    endfor
</a><a href="#h6-0-2105" id="h6-0-2105" class="d">-  endfor
</a><a href="#h6-0-2106" id="h6-0-2106" class="d">-
</a><a href="#h6-0-2107" id="h6-0-2107" class="d">-  let todo = []
</a><a href="#h6-0-2108" id="h6-0-2108" class="d">-  let found = sort(s:glob_dir(g:plug_home))
</a><a href="#h6-0-2109" id="h6-0-2109" class="d">-  while !empty(found)
</a><a href="#h6-0-2110" id="h6-0-2110" class="d">-    let f = remove(found, 0)
</a><a href="#h6-0-2111" id="h6-0-2111" class="d">-    if !has_key(allowed, f) &amp;&amp; isdirectory(f)
</a><a href="#h6-0-2112" id="h6-0-2112" class="d">-      call add(todo, f)
</a><a href="#h6-0-2113" id="h6-0-2113" class="d">-      call append(line(&#39;$&#39;), &#39;- &#39; . f)
</a><a href="#h6-0-2114" id="h6-0-2114" class="d">-      if has_key(errs, f)
</a><a href="#h6-0-2115" id="h6-0-2115" class="d">-        call append(line(&#39;$&#39;), &#39;    &#39; . errs[f])
</a><a href="#h6-0-2116" id="h6-0-2116" class="d">-      endif
</a><a href="#h6-0-2117" id="h6-0-2117" class="d">-      let found = filter(found, &#39;stridx(v:val, f) != 0&#39;)
</a><a href="#h6-0-2118" id="h6-0-2118" class="d">-    end
</a><a href="#h6-0-2119" id="h6-0-2119" class="d">-  endwhile
</a><a href="#h6-0-2120" id="h6-0-2120" class="d">-
</a><a href="#h6-0-2121" id="h6-0-2121" class="d">-  4
</a><a href="#h6-0-2122" id="h6-0-2122" class="d">-  redraw
</a><a href="#h6-0-2123" id="h6-0-2123" class="d">-  if empty(todo)
</a><a href="#h6-0-2124" id="h6-0-2124" class="d">-    call append(line(&#39;$&#39;), &#39;Already clean.&#39;)
</a><a href="#h6-0-2125" id="h6-0-2125" class="d">-  else
</a><a href="#h6-0-2126" id="h6-0-2126" class="d">-    let s:clean_count = 0
</a><a href="#h6-0-2127" id="h6-0-2127" class="d">-    call append(3, [&#39;Directories to delete:&#39;, &#39;&#39;])
</a><a href="#h6-0-2128" id="h6-0-2128" class="d">-    redraw!
</a><a href="#h6-0-2129" id="h6-0-2129" class="d">-    if a:force || s:ask_no_interrupt(&#39;Delete all directories?&#39;)
</a><a href="#h6-0-2130" id="h6-0-2130" class="d">-      call s:delete([6, line(&#39;$&#39;)], 1)
</a><a href="#h6-0-2131" id="h6-0-2131" class="d">-    else
</a><a href="#h6-0-2132" id="h6-0-2132" class="d">-      call setline(4, &#39;Cancelled.&#39;)
</a><a href="#h6-0-2133" id="h6-0-2133" class="d">-      nnoremap &lt;silent&gt; &lt;buffer&gt; d :set opfunc=&lt;sid&gt;delete_op&lt;cr&gt;g@
</a><a href="#h6-0-2134" id="h6-0-2134" class="d">-      nmap     &lt;silent&gt; &lt;buffer&gt; dd d_
</a><a href="#h6-0-2135" id="h6-0-2135" class="d">-      xnoremap &lt;silent&gt; &lt;buffer&gt; d :&lt;c-u&gt;call &lt;sid&gt;delete_op(visualmode(), 1)&lt;cr&gt;
</a><a href="#h6-0-2136" id="h6-0-2136" class="d">-      echo &#39;Delete the lines (d{motion}) to delete the corresponding directories&#39;
</a><a href="#h6-0-2137" id="h6-0-2137" class="d">-    endif
</a><a href="#h6-0-2138" id="h6-0-2138" class="d">-  endif
</a><a href="#h6-0-2139" id="h6-0-2139" class="d">-  4
</a><a href="#h6-0-2140" id="h6-0-2140" class="d">-  setlocal nomodifiable
</a><a href="#h6-0-2141" id="h6-0-2141" class="d">-endfunction
</a><a href="#h6-0-2142" id="h6-0-2142" class="d">-
</a><a href="#h6-0-2143" id="h6-0-2143" class="d">-function! s:delete_op(type, ...)
</a><a href="#h6-0-2144" id="h6-0-2144" class="d">-  call s:delete(a:0 ? [line(&quot;&#39;&lt;&quot;), line(&quot;&#39;&gt;&quot;)] : [line(&quot;&#39;[&quot;), line(&quot;&#39;]&quot;)], 0)
</a><a href="#h6-0-2145" id="h6-0-2145" class="d">-endfunction
</a><a href="#h6-0-2146" id="h6-0-2146" class="d">-
</a><a href="#h6-0-2147" id="h6-0-2147" class="d">-function! s:delete(range, force)
</a><a href="#h6-0-2148" id="h6-0-2148" class="d">-  let [l1, l2] = a:range
</a><a href="#h6-0-2149" id="h6-0-2149" class="d">-  let force = a:force
</a><a href="#h6-0-2150" id="h6-0-2150" class="d">-  while l1 &lt;= l2
</a><a href="#h6-0-2151" id="h6-0-2151" class="d">-    let line = getline(l1)
</a><a href="#h6-0-2152" id="h6-0-2152" class="d">-    if line =~ &#39;^- &#39; &amp;&amp; isdirectory(line[2:])
</a><a href="#h6-0-2153" id="h6-0-2153" class="d">-      execute l1
</a><a href="#h6-0-2154" id="h6-0-2154" class="d">-      redraw!
</a><a href="#h6-0-2155" id="h6-0-2155" class="d">-      let answer = force ? 1 : s:ask(&#39;Delete &#39;.line[2:].&#39;?&#39;, 1)
</a><a href="#h6-0-2156" id="h6-0-2156" class="d">-      let force = force || answer &gt; 1
</a><a href="#h6-0-2157" id="h6-0-2157" class="d">-      if answer
</a><a href="#h6-0-2158" id="h6-0-2158" class="d">-        call s:rm_rf(line[2:])
</a><a href="#h6-0-2159" id="h6-0-2159" class="d">-        setlocal modifiable
</a><a href="#h6-0-2160" id="h6-0-2160" class="d">-        call setline(l1, &#39;~&#39;.line[1:])
</a><a href="#h6-0-2161" id="h6-0-2161" class="d">-        let s:clean_count += 1
</a><a href="#h6-0-2162" id="h6-0-2162" class="d">-        call setline(4, printf(&#39;Removed %d directories.&#39;, s:clean_count))
</a><a href="#h6-0-2163" id="h6-0-2163" class="d">-        setlocal nomodifiable
</a><a href="#h6-0-2164" id="h6-0-2164" class="d">-      endif
</a><a href="#h6-0-2165" id="h6-0-2165" class="d">-    endif
</a><a href="#h6-0-2166" id="h6-0-2166" class="d">-    let l1 += 1
</a><a href="#h6-0-2167" id="h6-0-2167" class="d">-  endwhile
</a><a href="#h6-0-2168" id="h6-0-2168" class="d">-endfunction
</a><a href="#h6-0-2169" id="h6-0-2169" class="d">-
</a><a href="#h6-0-2170" id="h6-0-2170" class="d">-function! s:upgrade()
</a><a href="#h6-0-2171" id="h6-0-2171" class="d">-  echo &#39;Downloading the latest version of vim-plug&#39;
</a><a href="#h6-0-2172" id="h6-0-2172" class="d">-  redraw
</a><a href="#h6-0-2173" id="h6-0-2173" class="d">-  let tmp = tempname()
</a><a href="#h6-0-2174" id="h6-0-2174" class="d">-  let new = tmp . &#39;/plug.vim&#39;
</a><a href="#h6-0-2175" id="h6-0-2175" class="d">-
</a><a href="#h6-0-2176" id="h6-0-2176" class="d">-  try
</a><a href="#h6-0-2177" id="h6-0-2177" class="d">-    let out = s:system(printf(&#39;git clone --depth 1 %s %s&#39;, s:plug_src, tmp))
</a><a href="#h6-0-2178" id="h6-0-2178" class="d">-    if v:shell_error
</a><a href="#h6-0-2179" id="h6-0-2179" class="d">-      return s:err(&#39;Error upgrading vim-plug: &#39;. out)
</a><a href="#h6-0-2180" id="h6-0-2180" class="d">-    endif
</a><a href="#h6-0-2181" id="h6-0-2181" class="d">-
</a><a href="#h6-0-2182" id="h6-0-2182" class="d">-    if readfile(s:me) ==# readfile(new)
</a><a href="#h6-0-2183" id="h6-0-2183" class="d">-      echo &#39;vim-plug is already up-to-date&#39;
</a><a href="#h6-0-2184" id="h6-0-2184" class="d">-      return 0
</a><a href="#h6-0-2185" id="h6-0-2185" class="d">-    else
</a><a href="#h6-0-2186" id="h6-0-2186" class="d">-      call rename(s:me, s:me . &#39;.old&#39;)
</a><a href="#h6-0-2187" id="h6-0-2187" class="d">-      call rename(new, s:me)
</a><a href="#h6-0-2188" id="h6-0-2188" class="d">-      unlet g:loaded_plug
</a><a href="#h6-0-2189" id="h6-0-2189" class="d">-      echo &#39;vim-plug has been upgraded&#39;
</a><a href="#h6-0-2190" id="h6-0-2190" class="d">-      return 1
</a><a href="#h6-0-2191" id="h6-0-2191" class="d">-    endif
</a><a href="#h6-0-2192" id="h6-0-2192" class="d">-  finally
</a><a href="#h6-0-2193" id="h6-0-2193" class="d">-    silent! call s:rm_rf(tmp)
</a><a href="#h6-0-2194" id="h6-0-2194" class="d">-  endtry
</a><a href="#h6-0-2195" id="h6-0-2195" class="d">-endfunction
</a><a href="#h6-0-2196" id="h6-0-2196" class="d">-
</a><a href="#h6-0-2197" id="h6-0-2197" class="d">-function! s:upgrade_specs()
</a><a href="#h6-0-2198" id="h6-0-2198" class="d">-  for spec in values(g:plugs)
</a><a href="#h6-0-2199" id="h6-0-2199" class="d">-    let spec.frozen = get(spec, &#39;frozen&#39;, 0)
</a><a href="#h6-0-2200" id="h6-0-2200" class="d">-  endfor
</a><a href="#h6-0-2201" id="h6-0-2201" class="d">-endfunction
</a><a href="#h6-0-2202" id="h6-0-2202" class="d">-
</a><a href="#h6-0-2203" id="h6-0-2203" class="d">-function! s:status()
</a><a href="#h6-0-2204" id="h6-0-2204" class="d">-  call s:prepare()
</a><a href="#h6-0-2205" id="h6-0-2205" class="d">-  call append(0, &#39;Checking plugins&#39;)
</a><a href="#h6-0-2206" id="h6-0-2206" class="d">-  call append(1, &#39;&#39;)
</a><a href="#h6-0-2207" id="h6-0-2207" class="d">-
</a><a href="#h6-0-2208" id="h6-0-2208" class="d">-  let ecnt = 0
</a><a href="#h6-0-2209" id="h6-0-2209" class="d">-  let unloaded = 0
</a><a href="#h6-0-2210" id="h6-0-2210" class="d">-  let [cnt, total] = [0, len(g:plugs)]
</a><a href="#h6-0-2211" id="h6-0-2211" class="d">-  for [name, spec] in items(g:plugs)
</a><a href="#h6-0-2212" id="h6-0-2212" class="d">-    if has_key(spec, &#39;uri&#39;)
</a><a href="#h6-0-2213" id="h6-0-2213" class="d">-      if isdirectory(spec.dir)
</a><a href="#h6-0-2214" id="h6-0-2214" class="d">-        let [err, _] = s:git_validate(spec, 1)
</a><a href="#h6-0-2215" id="h6-0-2215" class="d">-        let [valid, msg] = [empty(err), empty(err) ? &#39;OK&#39; : err]
</a><a href="#h6-0-2216" id="h6-0-2216" class="d">-      else
</a><a href="#h6-0-2217" id="h6-0-2217" class="d">-        let [valid, msg] = [0, &#39;Not found. Try PlugInstall.&#39;]
</a><a href="#h6-0-2218" id="h6-0-2218" class="d">-      endif
</a><a href="#h6-0-2219" id="h6-0-2219" class="d">-    else
</a><a href="#h6-0-2220" id="h6-0-2220" class="d">-      if isdirectory(spec.dir)
</a><a href="#h6-0-2221" id="h6-0-2221" class="d">-        let [valid, msg] = [1, &#39;OK&#39;]
</a><a href="#h6-0-2222" id="h6-0-2222" class="d">-      else
</a><a href="#h6-0-2223" id="h6-0-2223" class="d">-        let [valid, msg] = [0, &#39;Not found.&#39;]
</a><a href="#h6-0-2224" id="h6-0-2224" class="d">-      endif
</a><a href="#h6-0-2225" id="h6-0-2225" class="d">-    endif
</a><a href="#h6-0-2226" id="h6-0-2226" class="d">-    let cnt += 1
</a><a href="#h6-0-2227" id="h6-0-2227" class="d">-    let ecnt += !valid
</a><a href="#h6-0-2228" id="h6-0-2228" class="d">-    &quot; `s:loaded` entry can be missing if PlugUpgraded
</a><a href="#h6-0-2229" id="h6-0-2229" class="d">-    if valid &amp;&amp; get(s:loaded, name, -1) == 0
</a><a href="#h6-0-2230" id="h6-0-2230" class="d">-      let unloaded = 1
</a><a href="#h6-0-2231" id="h6-0-2231" class="d">-      let msg .= &#39; (not loaded)&#39;
</a><a href="#h6-0-2232" id="h6-0-2232" class="d">-    endif
</a><a href="#h6-0-2233" id="h6-0-2233" class="d">-    call s:progress_bar(2, repeat(&#39;=&#39;, cnt), total)
</a><a href="#h6-0-2234" id="h6-0-2234" class="d">-    call append(3, s:format_message(valid ? &#39;-&#39; : &#39;x&#39;, name, msg))
</a><a href="#h6-0-2235" id="h6-0-2235" class="d">-    normal! 2G
</a><a href="#h6-0-2236" id="h6-0-2236" class="d">-    redraw
</a><a href="#h6-0-2237" id="h6-0-2237" class="d">-  endfor
</a><a href="#h6-0-2238" id="h6-0-2238" class="d">-  call setline(1, &#39;Finished. &#39;.ecnt.&#39; error(s).&#39;)
</a><a href="#h6-0-2239" id="h6-0-2239" class="d">-  normal! gg
</a><a href="#h6-0-2240" id="h6-0-2240" class="d">-  setlocal nomodifiable
</a><a href="#h6-0-2241" id="h6-0-2241" class="d">-  if unloaded
</a><a href="#h6-0-2242" id="h6-0-2242" class="d">-    echo &quot;Press &#39;L&#39; on each line to load plugin, or &#39;U&#39; to update&quot;
</a><a href="#h6-0-2243" id="h6-0-2243" class="d">-    nnoremap &lt;silent&gt; &lt;buffer&gt; L :call &lt;SID&gt;status_load(line(&#39;.&#39;))&lt;cr&gt;
</a><a href="#h6-0-2244" id="h6-0-2244" class="d">-    xnoremap &lt;silent&gt; &lt;buffer&gt; L :call &lt;SID&gt;status_load(line(&#39;.&#39;))&lt;cr&gt;
</a><a href="#h6-0-2245" id="h6-0-2245" class="d">-  end
</a><a href="#h6-0-2246" id="h6-0-2246" class="d">-endfunction
</a><a href="#h6-0-2247" id="h6-0-2247" class="d">-
</a><a href="#h6-0-2248" id="h6-0-2248" class="d">-function! s:extract_name(str, prefix, suffix)
</a><a href="#h6-0-2249" id="h6-0-2249" class="d">-  return matchstr(a:str, &#39;^&#39;.a:prefix.&#39; \zs[^:]\+\ze:.*&#39;.a:suffix.&#39;$&#39;)
</a><a href="#h6-0-2250" id="h6-0-2250" class="d">-endfunction
</a><a href="#h6-0-2251" id="h6-0-2251" class="d">-
</a><a href="#h6-0-2252" id="h6-0-2252" class="d">-function! s:status_load(lnum)
</a><a href="#h6-0-2253" id="h6-0-2253" class="d">-  let line = getline(a:lnum)
</a><a href="#h6-0-2254" id="h6-0-2254" class="d">-  let name = s:extract_name(line, &#39;-&#39;, &#39;(not loaded)&#39;)
</a><a href="#h6-0-2255" id="h6-0-2255" class="d">-  if !empty(name)
</a><a href="#h6-0-2256" id="h6-0-2256" class="d">-    call plug#load(name)
</a><a href="#h6-0-2257" id="h6-0-2257" class="d">-    setlocal modifiable
</a><a href="#h6-0-2258" id="h6-0-2258" class="d">-    call setline(a:lnum, substitute(line, &#39; (not loaded)$&#39;, &#39;&#39;, &#39;&#39;))
</a><a href="#h6-0-2259" id="h6-0-2259" class="d">-    setlocal nomodifiable
</a><a href="#h6-0-2260" id="h6-0-2260" class="d">-  endif
</a><a href="#h6-0-2261" id="h6-0-2261" class="d">-endfunction
</a><a href="#h6-0-2262" id="h6-0-2262" class="d">-
</a><a href="#h6-0-2263" id="h6-0-2263" class="d">-function! s:status_update() range
</a><a href="#h6-0-2264" id="h6-0-2264" class="d">-  let lines = getline(a:firstline, a:lastline)
</a><a href="#h6-0-2265" id="h6-0-2265" class="d">-  let names = filter(map(lines, &#39;s:extract_name(v:val, &quot;[x-]&quot;, &quot;&quot;)&#39;), &#39;!empty(v:val)&#39;)
</a><a href="#h6-0-2266" id="h6-0-2266" class="d">-  if !empty(names)
</a><a href="#h6-0-2267" id="h6-0-2267" class="d">-    echo
</a><a href="#h6-0-2268" id="h6-0-2268" class="d">-    execute &#39;PlugUpdate&#39; join(names)
</a><a href="#h6-0-2269" id="h6-0-2269" class="d">-  endif
</a><a href="#h6-0-2270" id="h6-0-2270" class="d">-endfunction
</a><a href="#h6-0-2271" id="h6-0-2271" class="d">-
</a><a href="#h6-0-2272" id="h6-0-2272" class="d">-function! s:is_preview_window_open()
</a><a href="#h6-0-2273" id="h6-0-2273" class="d">-  silent! wincmd P
</a><a href="#h6-0-2274" id="h6-0-2274" class="d">-  if &amp;previewwindow
</a><a href="#h6-0-2275" id="h6-0-2275" class="d">-    wincmd p
</a><a href="#h6-0-2276" id="h6-0-2276" class="d">-    return 1
</a><a href="#h6-0-2277" id="h6-0-2277" class="d">-  endif
</a><a href="#h6-0-2278" id="h6-0-2278" class="d">-endfunction
</a><a href="#h6-0-2279" id="h6-0-2279" class="d">-
</a><a href="#h6-0-2280" id="h6-0-2280" class="d">-function! s:find_name(lnum)
</a><a href="#h6-0-2281" id="h6-0-2281" class="d">-  for lnum in reverse(range(1, a:lnum))
</a><a href="#h6-0-2282" id="h6-0-2282" class="d">-    let line = getline(lnum)
</a><a href="#h6-0-2283" id="h6-0-2283" class="d">-    if empty(line)
</a><a href="#h6-0-2284" id="h6-0-2284" class="d">-      return &#39;&#39;
</a><a href="#h6-0-2285" id="h6-0-2285" class="d">-    endif
</a><a href="#h6-0-2286" id="h6-0-2286" class="d">-    let name = s:extract_name(line, &#39;-&#39;, &#39;&#39;)
</a><a href="#h6-0-2287" id="h6-0-2287" class="d">-    if !empty(name)
</a><a href="#h6-0-2288" id="h6-0-2288" class="d">-      return name
</a><a href="#h6-0-2289" id="h6-0-2289" class="d">-    endif
</a><a href="#h6-0-2290" id="h6-0-2290" class="d">-  endfor
</a><a href="#h6-0-2291" id="h6-0-2291" class="d">-  return &#39;&#39;
</a><a href="#h6-0-2292" id="h6-0-2292" class="d">-endfunction
</a><a href="#h6-0-2293" id="h6-0-2293" class="d">-
</a><a href="#h6-0-2294" id="h6-0-2294" class="d">-function! s:preview_commit()
</a><a href="#h6-0-2295" id="h6-0-2295" class="d">-  if b:plug_preview &lt; 0
</a><a href="#h6-0-2296" id="h6-0-2296" class="d">-    let b:plug_preview = !s:is_preview_window_open()
</a><a href="#h6-0-2297" id="h6-0-2297" class="d">-  endif
</a><a href="#h6-0-2298" id="h6-0-2298" class="d">-
</a><a href="#h6-0-2299" id="h6-0-2299" class="d">-  let sha = matchstr(getline(&#39;.&#39;), &#39;^  \X*\zs[0-9a-f]\{7,9}&#39;)
</a><a href="#h6-0-2300" id="h6-0-2300" class="d">-  if empty(sha)
</a><a href="#h6-0-2301" id="h6-0-2301" class="d">-    return
</a><a href="#h6-0-2302" id="h6-0-2302" class="d">-  endif
</a><a href="#h6-0-2303" id="h6-0-2303" class="d">-
</a><a href="#h6-0-2304" id="h6-0-2304" class="d">-  let name = s:find_name(line(&#39;.&#39;))
</a><a href="#h6-0-2305" id="h6-0-2305" class="d">-  if empty(name) || !has_key(g:plugs, name) || !isdirectory(g:plugs[name].dir)
</a><a href="#h6-0-2306" id="h6-0-2306" class="d">-    return
</a><a href="#h6-0-2307" id="h6-0-2307" class="d">-  endif
</a><a href="#h6-0-2308" id="h6-0-2308" class="d">-
</a><a href="#h6-0-2309" id="h6-0-2309" class="d">-  if exists(&#39;g:plug_pwindow&#39;) &amp;&amp; !s:is_preview_window_open()
</a><a href="#h6-0-2310" id="h6-0-2310" class="d">-    execute g:plug_pwindow
</a><a href="#h6-0-2311" id="h6-0-2311" class="d">-    execute &#39;e&#39; sha
</a><a href="#h6-0-2312" id="h6-0-2312" class="d">-  else
</a><a href="#h6-0-2313" id="h6-0-2313" class="d">-    execute &#39;pedit&#39; sha
</a><a href="#h6-0-2314" id="h6-0-2314" class="d">-    wincmd P
</a><a href="#h6-0-2315" id="h6-0-2315" class="d">-  endif
</a><a href="#h6-0-2316" id="h6-0-2316" class="d">-  setlocal previewwindow filetype=git buftype=nofile nobuflisted modifiable
</a><a href="#h6-0-2317" id="h6-0-2317" class="d">-  try
</a><a href="#h6-0-2318" id="h6-0-2318" class="d">-    let [sh, shrd] = s:chsh(1)
</a><a href="#h6-0-2319" id="h6-0-2319" class="d">-    execute &#39;silent %!cd&#39; s:shellesc(g:plugs[name].dir) &#39;&amp;&amp; git show --no-color --pretty=medium&#39; sha
</a><a href="#h6-0-2320" id="h6-0-2320" class="d">-  finally
</a><a href="#h6-0-2321" id="h6-0-2321" class="d">-    let [&amp;shell, &amp;shellredir] = [sh, shrd]
</a><a href="#h6-0-2322" id="h6-0-2322" class="d">-  endtry
</a><a href="#h6-0-2323" id="h6-0-2323" class="d">-  setlocal nomodifiable
</a><a href="#h6-0-2324" id="h6-0-2324" class="d">-  nnoremap &lt;silent&gt; &lt;buffer&gt; q :q&lt;cr&gt;
</a><a href="#h6-0-2325" id="h6-0-2325" class="d">-  wincmd p
</a><a href="#h6-0-2326" id="h6-0-2326" class="d">-endfunction
</a><a href="#h6-0-2327" id="h6-0-2327" class="d">-
</a><a href="#h6-0-2328" id="h6-0-2328" class="d">-function! s:section(flags)
</a><a href="#h6-0-2329" id="h6-0-2329" class="d">-  call search(&#39;\(^[x-] \)\@&lt;=[^:]\+:&#39;, a:flags)
</a><a href="#h6-0-2330" id="h6-0-2330" class="d">-endfunction
</a><a href="#h6-0-2331" id="h6-0-2331" class="d">-
</a><a href="#h6-0-2332" id="h6-0-2332" class="d">-function! s:format_git_log(line)
</a><a href="#h6-0-2333" id="h6-0-2333" class="d">-  let indent = &#39;  &#39;
</a><a href="#h6-0-2334" id="h6-0-2334" class="d">-  let tokens = split(a:line, nr2char(1))
</a><a href="#h6-0-2335" id="h6-0-2335" class="d">-  if len(tokens) != 5
</a><a href="#h6-0-2336" id="h6-0-2336" class="d">-    return indent.substitute(a:line, &#39;\s*$&#39;, &#39;&#39;, &#39;&#39;)
</a><a href="#h6-0-2337" id="h6-0-2337" class="d">-  endif
</a><a href="#h6-0-2338" id="h6-0-2338" class="d">-  let [graph, sha, refs, subject, date] = tokens
</a><a href="#h6-0-2339" id="h6-0-2339" class="d">-  let tag = matchstr(refs, &#39;tag: [^,)]\+&#39;)
</a><a href="#h6-0-2340" id="h6-0-2340" class="d">-  let tag = empty(tag) ? &#39; &#39; : &#39; (&#39;.tag.&#39;) &#39;
</a><a href="#h6-0-2341" id="h6-0-2341" class="d">-  return printf(&#39;%s%s%s%s%s (%s)&#39;, indent, graph, sha, tag, subject, date)
</a><a href="#h6-0-2342" id="h6-0-2342" class="d">-endfunction
</a><a href="#h6-0-2343" id="h6-0-2343" class="d">-
</a><a href="#h6-0-2344" id="h6-0-2344" class="d">-function! s:append_ul(lnum, text)
</a><a href="#h6-0-2345" id="h6-0-2345" class="d">-  call append(a:lnum, [&#39;&#39;, a:text, repeat(&#39;-&#39;, len(a:text))])
</a><a href="#h6-0-2346" id="h6-0-2346" class="d">-endfunction
</a><a href="#h6-0-2347" id="h6-0-2347" class="d">-
</a><a href="#h6-0-2348" id="h6-0-2348" class="d">-function! s:diff()
</a><a href="#h6-0-2349" id="h6-0-2349" class="d">-  call s:prepare()
</a><a href="#h6-0-2350" id="h6-0-2350" class="d">-  call append(0, [&#39;Collecting changes ...&#39;, &#39;&#39;])
</a><a href="#h6-0-2351" id="h6-0-2351" class="d">-  let cnts = [0, 0]
</a><a href="#h6-0-2352" id="h6-0-2352" class="d">-  let bar = &#39;&#39;
</a><a href="#h6-0-2353" id="h6-0-2353" class="d">-  let total = filter(copy(g:plugs), &#39;s:is_managed(v:key) &amp;&amp; isdirectory(v:val.dir)&#39;)
</a><a href="#h6-0-2354" id="h6-0-2354" class="d">-  call s:progress_bar(2, bar, len(total))
</a><a href="#h6-0-2355" id="h6-0-2355" class="d">-  for origin in [1, 0]
</a><a href="#h6-0-2356" id="h6-0-2356" class="d">-    let plugs = reverse(sort(items(filter(copy(total), (origin ? &#39;&#39; : &#39;!&#39;).&#39;(has_key(v:val, &quot;commit&quot;) || has_key(v:val, &quot;tag&quot;))&#39;))))
</a><a href="#h6-0-2357" id="h6-0-2357" class="d">-    if empty(plugs)
</a><a href="#h6-0-2358" id="h6-0-2358" class="d">-      continue
</a><a href="#h6-0-2359" id="h6-0-2359" class="d">-    endif
</a><a href="#h6-0-2360" id="h6-0-2360" class="d">-    call s:append_ul(2, origin ? &#39;Pending updates:&#39; : &#39;Last update:&#39;)
</a><a href="#h6-0-2361" id="h6-0-2361" class="d">-    for [k, v] in plugs
</a><a href="#h6-0-2362" id="h6-0-2362" class="d">-      let range = origin ? &#39;..origin/&#39;.v.branch : &#39;HEAD@{1}..&#39;
</a><a href="#h6-0-2363" id="h6-0-2363" class="d">-      let diff = s:system_chomp(&#39;git log --graph --color=never --pretty=format:&quot;%x01%h%x01%d%x01%s%x01%cr&quot; &#39;.s:shellesc(range), v.dir)
</a><a href="#h6-0-2364" id="h6-0-2364" class="d">-      if !empty(diff)
</a><a href="#h6-0-2365" id="h6-0-2365" class="d">-        let ref = has_key(v, &#39;tag&#39;) ? (&#39; (tag: &#39;.v.tag.&#39;)&#39;) : has_key(v, &#39;commit&#39;) ? (&#39; &#39;.v.commit) : &#39;&#39;
</a><a href="#h6-0-2366" id="h6-0-2366" class="d">-        call append(5, extend([&#39;&#39;, &#39;- &#39;.k.&#39;:&#39;.ref], map(s:lines(diff), &#39;s:format_git_log(v:val)&#39;)))
</a><a href="#h6-0-2367" id="h6-0-2367" class="d">-        let cnts[origin] += 1
</a><a href="#h6-0-2368" id="h6-0-2368" class="d">-      endif
</a><a href="#h6-0-2369" id="h6-0-2369" class="d">-      let bar .= &#39;=&#39;
</a><a href="#h6-0-2370" id="h6-0-2370" class="d">-      call s:progress_bar(2, bar, len(total))
</a><a href="#h6-0-2371" id="h6-0-2371" class="d">-      normal! 2G
</a><a href="#h6-0-2372" id="h6-0-2372" class="d">-      redraw
</a><a href="#h6-0-2373" id="h6-0-2373" class="d">-    endfor
</a><a href="#h6-0-2374" id="h6-0-2374" class="d">-    if !cnts[origin]
</a><a href="#h6-0-2375" id="h6-0-2375" class="d">-      call append(5, [&#39;&#39;, &#39;N/A&#39;])
</a><a href="#h6-0-2376" id="h6-0-2376" class="d">-    endif
</a><a href="#h6-0-2377" id="h6-0-2377" class="d">-  endfor
</a><a href="#h6-0-2378" id="h6-0-2378" class="d">-  call setline(1, printf(&#39;%d plugin(s) updated.&#39;, cnts[0])
</a><a href="#h6-0-2379" id="h6-0-2379" class="d">-        \ . (cnts[1] ? printf(&#39; %d plugin(s) have pending updates.&#39;, cnts[1]) : &#39;&#39;))
</a><a href="#h6-0-2380" id="h6-0-2380" class="d">-
</a><a href="#h6-0-2381" id="h6-0-2381" class="d">-  if cnts[0] || cnts[1]
</a><a href="#h6-0-2382" id="h6-0-2382" class="d">-    nnoremap &lt;silent&gt; &lt;buffer&gt; &lt;cr&gt; :silent! call &lt;SID&gt;preview_commit()&lt;cr&gt;
</a><a href="#h6-0-2383" id="h6-0-2383" class="d">-    nnoremap &lt;silent&gt; &lt;buffer&gt; o    :silent! call &lt;SID&gt;preview_commit()&lt;cr&gt;
</a><a href="#h6-0-2384" id="h6-0-2384" class="d">-  endif
</a><a href="#h6-0-2385" id="h6-0-2385" class="d">-  if cnts[0]
</a><a href="#h6-0-2386" id="h6-0-2386" class="d">-    nnoremap &lt;silent&gt; &lt;buffer&gt; X :call &lt;SID&gt;revert()&lt;cr&gt;
</a><a href="#h6-0-2387" id="h6-0-2387" class="d">-    echo &quot;Press &#39;X&#39; on each block to revert the update&quot;
</a><a href="#h6-0-2388" id="h6-0-2388" class="d">-  endif
</a><a href="#h6-0-2389" id="h6-0-2389" class="d">-  normal! gg
</a><a href="#h6-0-2390" id="h6-0-2390" class="d">-  setlocal nomodifiable
</a><a href="#h6-0-2391" id="h6-0-2391" class="d">-endfunction
</a><a href="#h6-0-2392" id="h6-0-2392" class="d">-
</a><a href="#h6-0-2393" id="h6-0-2393" class="d">-function! s:revert()
</a><a href="#h6-0-2394" id="h6-0-2394" class="d">-  if search(&#39;^Pending updates&#39;, &#39;bnW&#39;)
</a><a href="#h6-0-2395" id="h6-0-2395" class="d">-    return
</a><a href="#h6-0-2396" id="h6-0-2396" class="d">-  endif
</a><a href="#h6-0-2397" id="h6-0-2397" class="d">-
</a><a href="#h6-0-2398" id="h6-0-2398" class="d">-  let name = s:find_name(line(&#39;.&#39;))
</a><a href="#h6-0-2399" id="h6-0-2399" class="d">-  if empty(name) || !has_key(g:plugs, name) ||
</a><a href="#h6-0-2400" id="h6-0-2400" class="d">-    \ input(printf(&#39;Revert the update of %s? (y/N) &#39;, name)) !~? &#39;^y&#39;
</a><a href="#h6-0-2401" id="h6-0-2401" class="d">-    return
</a><a href="#h6-0-2402" id="h6-0-2402" class="d">-  endif
</a><a href="#h6-0-2403" id="h6-0-2403" class="d">-
</a><a href="#h6-0-2404" id="h6-0-2404" class="d">-  call s:system(&#39;git reset --hard HEAD@{1} &amp;&amp; git checkout &#39;.s:esc(g:plugs[name].branch).&#39; --&#39;, g:plugs[name].dir)
</a><a href="#h6-0-2405" id="h6-0-2405" class="d">-  setlocal modifiable
</a><a href="#h6-0-2406" id="h6-0-2406" class="d">-  normal! &quot;_dap
</a><a href="#h6-0-2407" id="h6-0-2407" class="d">-  setlocal nomodifiable
</a><a href="#h6-0-2408" id="h6-0-2408" class="d">-  echo &#39;Reverted&#39;
</a><a href="#h6-0-2409" id="h6-0-2409" class="d">-endfunction
</a><a href="#h6-0-2410" id="h6-0-2410" class="d">-
</a><a href="#h6-0-2411" id="h6-0-2411" class="d">-function! s:snapshot(force, ...) abort
</a><a href="#h6-0-2412" id="h6-0-2412" class="d">-  call s:prepare()
</a><a href="#h6-0-2413" id="h6-0-2413" class="d">-  setf vim
</a><a href="#h6-0-2414" id="h6-0-2414" class="d">-  call append(0, [&#39;&quot; Generated by vim-plug&#39;,
</a><a href="#h6-0-2415" id="h6-0-2415" class="d">-                \ &#39;&quot; &#39;.strftime(&quot;%c&quot;),
</a><a href="#h6-0-2416" id="h6-0-2416" class="d">-                \ &#39;&quot; :source this file in vim to restore the snapshot&#39;,
</a><a href="#h6-0-2417" id="h6-0-2417" class="d">-                \ &#39;&quot; or execute: vim -S snapshot.vim&#39;,
</a><a href="#h6-0-2418" id="h6-0-2418" class="d">-                \ &#39;&#39;, &#39;&#39;, &#39;PlugUpdate!&#39;])
</a><a href="#h6-0-2419" id="h6-0-2419" class="d">-  1
</a><a href="#h6-0-2420" id="h6-0-2420" class="d">-  let anchor = line(&#39;$&#39;) - 3
</a><a href="#h6-0-2421" id="h6-0-2421" class="d">-  let names = sort(keys(filter(copy(g:plugs),
</a><a href="#h6-0-2422" id="h6-0-2422" class="d">-        \&#39;has_key(v:val, &quot;uri&quot;) &amp;&amp; !has_key(v:val, &quot;commit&quot;) &amp;&amp; isdirectory(v:val.dir)&#39;)))
</a><a href="#h6-0-2423" id="h6-0-2423" class="d">-  for name in reverse(names)
</a><a href="#h6-0-2424" id="h6-0-2424" class="d">-    let sha = s:system_chomp(&#39;git rev-parse --short HEAD&#39;, g:plugs[name].dir)
</a><a href="#h6-0-2425" id="h6-0-2425" class="d">-    if !empty(sha)
</a><a href="#h6-0-2426" id="h6-0-2426" class="d">-      call append(anchor, printf(&quot;silent! let g:plugs[&#39;%s&#39;].commit = &#39;%s&#39;&quot;, name, sha))
</a><a href="#h6-0-2427" id="h6-0-2427" class="d">-      redraw
</a><a href="#h6-0-2428" id="h6-0-2428" class="d">-    endif
</a><a href="#h6-0-2429" id="h6-0-2429" class="d">-  endfor
</a><a href="#h6-0-2430" id="h6-0-2430" class="d">-
</a><a href="#h6-0-2431" id="h6-0-2431" class="d">-  if a:0 &gt; 0
</a><a href="#h6-0-2432" id="h6-0-2432" class="d">-    let fn = expand(a:1)
</a><a href="#h6-0-2433" id="h6-0-2433" class="d">-    if filereadable(fn) &amp;&amp; !(a:force || s:ask(a:1.&#39; already exists. Overwrite?&#39;))
</a><a href="#h6-0-2434" id="h6-0-2434" class="d">-      return
</a><a href="#h6-0-2435" id="h6-0-2435" class="d">-    endif
</a><a href="#h6-0-2436" id="h6-0-2436" class="d">-    call writefile(getline(1, &#39;$&#39;), fn)
</a><a href="#h6-0-2437" id="h6-0-2437" class="d">-    echo &#39;Saved as &#39;.a:1
</a><a href="#h6-0-2438" id="h6-0-2438" class="d">-    silent execute &#39;e&#39; s:esc(fn)
</a><a href="#h6-0-2439" id="h6-0-2439" class="d">-    setf vim
</a><a href="#h6-0-2440" id="h6-0-2440" class="d">-  endif
</a><a href="#h6-0-2441" id="h6-0-2441" class="d">-endfunction
</a><a href="#h6-0-2442" id="h6-0-2442" class="d">-
</a><a href="#h6-0-2443" id="h6-0-2443" class="d">-function! s:split_rtp()
</a><a href="#h6-0-2444" id="h6-0-2444" class="d">-  return split(&amp;rtp, &#39;\\\@&lt;!,&#39;)
</a><a href="#h6-0-2445" id="h6-0-2445" class="d">-endfunction
</a><a href="#h6-0-2446" id="h6-0-2446" class="d">-
</a><a href="#h6-0-2447" id="h6-0-2447" class="d">-let s:first_rtp = s:escrtp(get(s:split_rtp(), 0, &#39;&#39;))
</a><a href="#h6-0-2448" id="h6-0-2448" class="d">-let s:last_rtp  = s:escrtp(get(s:split_rtp(), -1, &#39;&#39;))
</a><a href="#h6-0-2449" id="h6-0-2449" class="d">-
</a><a href="#h6-0-2450" id="h6-0-2450" class="d">-if exists(&#39;g:plugs&#39;)
</a><a href="#h6-0-2451" id="h6-0-2451" class="d">-  let g:plugs_order = get(g:, &#39;plugs_order&#39;, keys(g:plugs))
</a><a href="#h6-0-2452" id="h6-0-2452" class="d">-  call s:upgrade_specs()
</a><a href="#h6-0-2453" id="h6-0-2453" class="d">-  call s:define_commands()
</a><a href="#h6-0-2454" id="h6-0-2454" class="d">-endif
</a><a href="#h6-0-2455" id="h6-0-2455" class="d">-
</a><a href="#h6-0-2456" id="h6-0-2456" class="d">-let &amp;cpo = s:cpo_save
</a><a href="#h6-0-2457" id="h6-0-2457" class="d">-unlet s:cpo_save
</a><b>diff --git a/<a id="h7" href="../file/.vimrc.html">.vimrc</a> b/<a href="../file/.vimrc.html">.vimrc</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -1,25 +0,0 @@
</a><a href="#h7-0-0" id="h7-0-0" class="d">-&quot;        _
</a><a href="#h7-0-1" id="h7-0-1" class="d">-&quot; __   _(_)_ __ ___  _ __ ___
</a><a href="#h7-0-2" id="h7-0-2" class="d">-&quot; \ \ / / | &#39;_ ` _ \| &#39;__/ __|
</a><a href="#h7-0-3" id="h7-0-3" class="d">-&quot;  \ V /| | | | | | | | | (__
</a><a href="#h7-0-4" id="h7-0-4" class="d">-&quot;   \_/ |_|_| |_| |_|_|  \___|
</a><a href="#h7-0-5" id="h7-0-5" class="d">-
</a><a href="#h7-0-6" id="h7-0-6" class="d">-let mapleader =&quot; &quot;
</a><a href="#h7-0-7" id="h7-0-7" class="d">-
</a><a href="#h7-0-8" id="h7-0-8" class="d">-call plug#begin(&#39;~/.vim/plugged&#39;)
</a><a href="#h7-0-9" id="h7-0-9" class="d">-Plug &#39;junegunn/goyo.vim&#39;
</a><a href="#h7-0-10" id="h7-0-10" class="d">-call plug#end()
</a><a href="#h7-0-11" id="h7-0-11" class="d">-
</a><a href="#h7-0-12" id="h7-0-12" class="d">-&quot; Some basics:
</a><a href="#h7-0-13" id="h7-0-13" class="d">-	set nocompatible
</a><a href="#h7-0-14" id="h7-0-14" class="d">-	set encoding=utf-8
</a><a href="#h7-0-15" id="h7-0-15" class="d">-
</a><a href="#h7-0-16" id="h7-0-16" class="d">-&quot; Splits open at the bottom and right, which is non-retarded, unlike vim defaults.
</a><a href="#h7-0-17" id="h7-0-17" class="d">-	set splitbelow
</a><a href="#h7-0-18" id="h7-0-18" class="d">-	set splitright
</a><a href="#h7-0-19" id="h7-0-19" class="d">-
</a><a href="#h7-0-20" id="h7-0-20" class="d">-&quot; Compile document
</a><a href="#h7-0-21" id="h7-0-21" class="d">-	map &lt;leader&gt;c :!compiler &lt;c-r&gt;%&lt;CR&gt;
</a><a href="#h7-0-22" id="h7-0-22" class="d">-
</a><a href="#h7-0-23" id="h7-0-23" class="d">-&quot; Open corresponding .pdf
</a><a href="#h7-0-24" id="h7-0-24" class="d">-	map &lt;leader&gt;p :!open &lt;c-r&gt;%&lt;CR&gt;&lt;CR&gt;
</a><b>diff --git a/<a id="h8" href="../file/.zshenv.html">.zshenv</a> b/<a href="../file/.zshenv.html">.zshenv</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -1,50 +0,0 @@
</a><a href="#h8-0-0" id="h8-0-0" class="d">-export PATH=$PATH:/usr/local/bin
</a><a href="#h8-0-1" id="h8-0-1" class="d">-
</a><a href="#h8-0-2" id="h8-0-2" class="d">-## ZSH Config
</a><a href="#h8-0-3" id="h8-0-3" class="d">-export ZDOTDIR=$HOME
</a><a href="#h8-0-4" id="h8-0-4" class="d">-export ZSHDDIR=$HOME/.config/zsh
</a><a href="#h8-0-5" id="h8-0-5" class="d">-export ZSH=$HOME/.config/oh-my-zsh
</a><a href="#h8-0-6" id="h8-0-6" class="d">-export SHELL_SESSION_HISTORY=0
</a><a href="#h8-0-7" id="h8-0-7" class="d">-
</a><a href="#h8-0-8" id="h8-0-8" class="d">-export HISTSIZE=1000
</a><a href="#h8-0-9" id="h8-0-9" class="d">-export SAVEHIST=1000
</a><a href="#h8-0-10" id="h8-0-10" class="d">-export HISTFILE=~/.history
</a><a href="#h8-0-11" id="h8-0-11" class="d">-
</a><a href="#h8-0-12" id="h8-0-12" class="d">-export ZSH_THEME=&quot;evan&quot;
</a><a href="#h8-0-13" id="h8-0-13" class="d">-export DISABLE_LS_COLORS=&quot;false&quot;
</a><a href="#h8-0-14" id="h8-0-14" class="d">-export DISABLE_AUTO_TITLE=&quot;true&quot;
</a><a href="#h8-0-15" id="h8-0-15" class="d">-
</a><a href="#h8-0-16" id="h8-0-16" class="d">-## User configuration
</a><a href="#h8-0-17" id="h8-0-17" class="d">-export SHELL=/bin/zsh
</a><a href="#h8-0-18" id="h8-0-18" class="d">-export MANPATH=/usr/local/share/man:$MANPATH
</a><a href="#h8-0-19" id="h8-0-19" class="d">-
</a><a href="#h8-0-20" id="h8-0-20" class="d">-## Homebrew
</a><a href="#h8-0-21" id="h8-0-21" class="d">-export HOMEBREW_GITHUB_API_TOKEN=&quot;30e5da2b006d5f92e5474ff17c7eefe5cad20ee9&quot;
</a><a href="#h8-0-22" id="h8-0-22" class="d">-export PATH=&quot;/usr/local/sbin:$PATH&quot;
</a><a href="#h8-0-23" id="h8-0-23" class="d">-
</a><a href="#h8-0-24" id="h8-0-24" class="d">-## Haskel
</a><a href="#h8-0-25" id="h8-0-25" class="d">-export PATH=$PATH:$HOME/Library/Haskell/bin
</a><a href="#h8-0-26" id="h8-0-26" class="d">-
</a><a href="#h8-0-27" id="h8-0-27" class="d">-## Go
</a><a href="#h8-0-28" id="h8-0-28" class="d">-export GOROOT=/usr/local/go
</a><a href="#h8-0-29" id="h8-0-29" class="d">-export GOPATH=$HOME/prog/go
</a><a href="#h8-0-30" id="h8-0-30" class="d">-export PATH=$PATH:$GOPATH/bin
</a><a href="#h8-0-31" id="h8-0-31" class="d">-export CORE=$GOPATH/src/gitlab.com/redeam/core
</a><a href="#h8-0-32" id="h8-0-32" class="d">-
</a><a href="#h8-0-33" id="h8-0-33" class="d">-## Docker
</a><a href="#h8-0-34" id="h8-0-34" class="d">-export DOCKER_HIDE_LEGACY_COMMANDS=1
</a><a href="#h8-0-35" id="h8-0-35" class="d">-
</a><a href="#h8-0-36" id="h8-0-36" class="d">-## Rust
</a><a href="#h8-0-37" id="h8-0-37" class="d">-export PATH=$PATH:$HOME/.cargo/bin
</a><a href="#h8-0-38" id="h8-0-38" class="d">-
</a><a href="#h8-0-39" id="h8-0-39" class="d">-## fzf
</a><a href="#h8-0-40" id="h8-0-40" class="d">-export FZF_DEFAULT_OPTS=&#39;--height 40% --exact&#39;
</a><a href="#h8-0-41" id="h8-0-41" class="d">-export FZF_CTRL_T_OPTS=&quot;--preview &#39;(highlight -O ansi -l {} 2&gt; /dev/null || cat {} || tree -C {}) 2&gt; /dev/null | head -200&#39;&quot;
</a><a href="#h8-0-42" id="h8-0-42" class="d">-export FZF_CTRL_R_OPTS=&#39;--sort --exact&#39;
</a><a href="#h8-0-43" id="h8-0-43" class="d">-
</a><a href="#h8-0-44" id="h8-0-44" class="d">-## Google Cloud SDK
</a><a href="#h8-0-45" id="h8-0-45" class="d">-export PATH=&quot;/usr/local/opt/texinfo/bin:$PATH&quot;
</a><a href="#h8-0-46" id="h8-0-46" class="d">-export PATH=&quot;/usr/local/opt/gpg-agent/bin:$PATH&quot;
</a><a href="#h8-0-47" id="h8-0-47" class="d">-
</a><a href="#h8-0-48" id="h8-0-48" class="d">-## Misc
</a><a href="#h8-0-49" id="h8-0-49" class="d">-export PATH=&quot;$HOME/.scripts:$PATH&quot;
</a><b>diff --git a/<a id="h9" href="../file/.zshrc.html">.zshrc</a> b/<a href="../file/.zshrc.html">.zshrc</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -1,77 +0,0 @@
</a><a href="#h9-0-0" id="h9-0-0" class="d">-plugins=(git osx brew)
</a><a href="#h9-0-1" id="h9-0-1" class="d">-echo -e &quot;\033]; \007&quot;
</a><a href="#h9-0-2" id="h9-0-2" class="d">-source ~/.oh-my-zsh/oh-my-zsh.sh
</a><a href="#h9-0-3" id="h9-0-3" class="d">-
</a><a href="#h9-0-4" id="h9-0-4" class="d">-## Alias
</a><a href="#h9-0-5" id="h9-0-5" class="d">-alias ls=&quot;ls -F&quot;
</a><a href="#h9-0-6" id="h9-0-6" class="d">-alias ll=&quot;ls -lh&quot;
</a><a href="#h9-0-7" id="h9-0-7" class="d">-alias emacs=&quot;TERM=xterm-256color emacs&quot;
</a><a href="#h9-0-8" id="h9-0-8" class="d">-alias q=&quot;exit&quot;
</a><a href="#h9-0-9" id="h9-0-9" class="d">-alias neo=&quot;clear &amp;&amp; neofetch&quot;
</a><a href="#h9-0-10" id="h9-0-10" class="d">-alias notify=&#39;terminal-notifier -title &quot;Terminal&quot; -message &quot;Done with taks&quot;&#39;
</a><a href="#h9-0-11" id="h9-0-11" class="d">-alias weather=&quot;curl wttr.in/\~Boulder+Colorado&quot;
</a><a href="#h9-0-12" id="h9-0-12" class="d">-alias f=&quot;fzf --preview=\&quot;head -$LINES {}\&quot;&quot;
</a><a href="#h9-0-13" id="h9-0-13" class="d">-alias fz=&quot;vim \$(f)&quot;
</a><a href="#h9-0-14" id="h9-0-14" class="d">-alias vi=vim
</a><a href="#h9-0-15" id="h9-0-15" class="d">-alias yt=&quot;youtube-dl&quot;
</a><a href="#h9-0-16" id="h9-0-16" class="d">-
</a><a href="#h9-0-17" id="h9-0-17" class="d">-# Kubernetes
</a><a href="#h9-0-18" id="h9-0-18" class="d">-alias kc=&quot;kubectl --kubeconfig=$HOME/cluster.config&quot;
</a><a href="#h9-0-19" id="h9-0-19" class="d">-alias helm=&quot;helm --kubeconfig=$HOME/cluster.config&quot;
</a><a href="#h9-0-20" id="h9-0-20" class="d">-alias c=&quot;cd $CORE&quot;
</a><a href="#h9-0-21" id="h9-0-21" class="d">-
</a><a href="#h9-0-22" id="h9-0-22" class="d">-## Kubernetes
</a><a href="#h9-0-23" id="h9-0-23" class="d">-function gdep {
</a><a href="#h9-0-24" id="h9-0-24" class="d">-    godepgraph -o gitlab.com/redeam -s gitlab.com/redeam/core/$1 | dot -Tpng -o /tmp/dep.png
</a><a href="#h9-0-25" id="h9-0-25" class="d">-    open /tmp/dep.png
</a><a href="#h9-0-26" id="h9-0-26" class="d">-}
</a><a href="#h9-0-27" id="h9-0-27" class="d">-
</a><a href="#h9-0-28" id="h9-0-28" class="d">-function gp {
</a><a href="#h9-0-29" id="h9-0-29" class="d">-  kubectl --kubeconfig=$HOME/cluster.config get pods | egrep -o  &quot;$1.*Running&quot; | egrep -o &quot;$1[^ ]*&quot; | head -1
</a><a href="#h9-0-30" id="h9-0-30" class="d">-}
</a><a href="#h9-0-31" id="h9-0-31" class="d">-
</a><a href="#h9-0-32" id="h9-0-32" class="d">-function kcforward {
</a><a href="#h9-0-33" id="h9-0-33" class="d">-  POD=`gp $1`
</a><a href="#h9-0-34" id="h9-0-34" class="d">-  kubectl --kubeconfig=$HOME/cluster.config port-forward $POD $2:8001
</a><a href="#h9-0-35" id="h9-0-35" class="d">-}
</a><a href="#h9-0-36" id="h9-0-36" class="d">-
</a><a href="#h9-0-37" id="h9-0-37" class="d">-alias kt=&quot;ktail --kubeconfig=$HOME/cluster.config -t &#39;
</a><a href="#h9-0-38" id="h9-0-38" class="d">-$BOLD$LIGHT_CYAN{{ .Container.Name }}$NONE $DIM{{ .Pod.Name }}$NONE $YELLOW{{ if .Timestamp }}{{ .Timestamp.Format \&quot;2006-01-02T15:04:05.999999999Z07:00\&quot; }}{{ end }}$NONE
</a><a href="#h9-0-39" id="h9-0-39" class="d">-{{ .Message }} &#39;&quot;
</a><a href="#h9-0-40" id="h9-0-40" class="d">-
</a><a href="#h9-0-41" id="h9-0-41" class="d">-# repeat history
</a><a href="#h9-0-42" id="h9-0-42" class="d">-function fh {
</a><a href="#h9-0-43" id="h9-0-43" class="d">-  print -z $( ([ -n &quot;$ZSH_NAME&quot; ] &amp;&amp; fc -l 1 || history) | fzf +s --tac | sed &#39;s/ *[0-9]* *//&#39;)
</a><a href="#h9-0-44" id="h9-0-44" class="d">-}
</a><a href="#h9-0-45" id="h9-0-45" class="d">-
</a><a href="#h9-0-46" id="h9-0-46" class="d">-function fhc {
</a><a href="#h9-0-47" id="h9-0-47" class="d">-  echo -n $( ([ -n &quot;$ZSH_NAME&quot; ] &amp;&amp; fc -l 1 || history) | fzf +s --tac | sed &#39;s/ *[0-9]* *//&#39;) | pbcopy
</a><a href="#h9-0-48" id="h9-0-48" class="d">-}
</a><a href="#h9-0-49" id="h9-0-49" class="d">-
</a><a href="#h9-0-50" id="h9-0-50" class="d">-# coloured manuals
</a><a href="#h9-0-51" id="h9-0-51" class="d">-man() {
</a><a href="#h9-0-52" id="h9-0-52" class="d">-  env \
</a><a href="#h9-0-53" id="h9-0-53" class="d">-    LESS_TERMCAP_mb=$(printf &quot;\e[1;31m&quot;) \
</a><a href="#h9-0-54" id="h9-0-54" class="d">-    LESS_TERMCAP_md=$(printf &quot;\e[1;31m&quot;) \
</a><a href="#h9-0-55" id="h9-0-55" class="d">-    LESS_TERMCAP_me=$(printf &quot;\e[0m&quot;) \
</a><a href="#h9-0-56" id="h9-0-56" class="d">-    LESS_TERMCAP_se=$(printf &quot;\e[0m&quot;) \
</a><a href="#h9-0-57" id="h9-0-57" class="d">-    LESS_TERMCAP_so=$(printf &quot;\e[1;44;33m&quot;) \
</a><a href="#h9-0-58" id="h9-0-58" class="d">-    LESS_TERMCAP_ue=$(printf &quot;\e[0m&quot;) \
</a><a href="#h9-0-59" id="h9-0-59" class="d">-    LESS_TERMCAP_us=$(printf &quot;\e[1;32m&quot;) \
</a><a href="#h9-0-60" id="h9-0-60" class="d">-    man &quot;$@&quot;
</a><a href="#h9-0-61" id="h9-0-61" class="d">-}
</a><a href="#h9-0-62" id="h9-0-62" class="d">-
</a><a href="#h9-0-63" id="h9-0-63" class="d">-autoload -U +X bashcompinit &amp;&amp; bashcompinit
</a><a href="#h9-0-64" id="h9-0-64" class="d">-
</a><a href="#h9-0-65" id="h9-0-65" class="d">-~/.vim/plugged/gruvbox/gruvbox_256palette_osx.sh
</a><a href="#h9-0-66" id="h9-0-66" class="d">-
</a><a href="#h9-0-67" id="h9-0-67" class="d">-# if [ -z $TMUX ]
</a><a href="#h9-0-68" id="h9-0-68" class="d">-# then
</a><a href="#h9-0-69" id="h9-0-69" class="d">-#         tmux ls &amp;&amp; read tmux_session &amp;&amp; tmux attach -t ${tmux_session:-default} || tmux new -s ${tmux_session:-default}
</a><a href="#h9-0-70" id="h9-0-70" class="d">-# fi
</a><a href="#h9-0-71" id="h9-0-71" class="d">-
</a><a href="#h9-0-72" id="h9-0-72" class="d">-# The next line updates PATH for the Google Cloud SDK.
</a><a href="#h9-0-73" id="h9-0-73" class="d">-if [ -f &#39;/Users/markfeller/Downloads/google-cloud-sdk/path.zsh.inc&#39; ]; then source &#39;/Users/markfeller/Downloads/google-cloud-sdk/path.zsh.inc&#39;; fi
</a><a href="#h9-0-74" id="h9-0-74" class="d">-
</a><a href="#h9-0-75" id="h9-0-75" class="d">-# The next line enables shell command completion for gcloud.
</a><a href="#h9-0-76" id="h9-0-76" class="d">-if [ -f &#39;/Users/markfeller/Downloads/google-cloud-sdk/completion.zsh.inc&#39; ]; then source &#39;/Users/markfeller/Downloads/google-cloud-sdk/completion.zsh.inc&#39;; fi
</a><b>diff --git a/<a id="h10" href="../file/README.html">README</a> b/<a href="../file/README.html">README</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -1,3 +1,32 @@
</a><a href="#h10-0-0" id="h10-0-0" class="i">+Install
</a><a href="#h10-0-1" id="h10-0-1" class="i">+
</a><a href="#h10-0-2" id="h10-0-2" class="i">+$ stow dots
</a><a href="#h10-0-3" id="h10-0-3" class="i">+
</a> Manual install
 - fd
 - alacritty
<a href="#h10-0-7" id="h10-0-7" class="i">+
</a><a href="#h10-0-8" id="h10-0-8" class="i">+Useful Programs
</a><a href="#h10-0-9" id="h10-0-9" class="i">+- bat
</a><a href="#h10-0-10" id="h10-0-10" class="i">+- emacs
</a><a href="#h10-0-11" id="h10-0-11" class="i">+- fd
</a><a href="#h10-0-12" id="h10-0-12" class="i">+- ffmpeg
</a><a href="#h10-0-13" id="h10-0-13" class="i">+- fontconfig
</a><a href="#h10-0-14" id="h10-0-14" class="i">+- freetype
</a><a href="#h10-0-15" id="h10-0-15" class="i">+- fzf
</a><a href="#h10-0-16" id="h10-0-16" class="i">+- gpg-agent
</a><a href="#h10-0-17" id="h10-0-17" class="i">+- graphviz
</a><a href="#h10-0-18" id="h10-0-18" class="i">+- htop
</a><a href="#h10-0-19" id="h10-0-19" class="i">+- mpc
</a><a href="#h10-0-20" id="h10-0-20" class="i">+- mpd
</a><a href="#h10-0-21" id="h10-0-21" class="i">+- ncmpcpp
</a><a href="#h10-0-22" id="h10-0-22" class="i">+- ncurses
</a><a href="#h10-0-23" id="h10-0-23" class="i">+- neofetch
</a><a href="#h10-0-24" id="h10-0-24" class="i">+- openssl
</a><a href="#h10-0-25" id="h10-0-25" class="i">+- ranger
</a><a href="#h10-0-26" id="h10-0-26" class="i">+- readline
</a><a href="#h10-0-27" id="h10-0-27" class="i">+- ripgrep
</a><a href="#h10-0-28" id="h10-0-28" class="i">+- tmux
</a><a href="#h10-0-29" id="h10-0-29" class="i">+- vim
</a><a href="#h10-0-30" id="h10-0-30" class="i">+- wget
</a><a href="#h10-0-31" id="h10-0-31" class="i">+- youtube-dl
</a><b>diff --git a/<a id="h11" href="../file/dots/.bin/alacritty.html">dots/.bin/alacritty</a> b/<a href="../file/dots/.bin/alacritty.html">dots/.bin/alacritty</a></b>
Binary files differ.
<b>diff --git a/<a id="h12" href="../file/dots/.bin/lock.html">dots/.bin/lock</a> b/<a href="../file/dots/.bin/lock.html">dots/.bin/lock</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -0,0 +1,13 @@
</a><a href="#h12-0-0" id="h12-0-0" class="i">+#!/bin/bash
</a><a href="#h12-0-1" id="h12-0-1" class="i">+
</a><a href="#h12-0-2" id="h12-0-2" class="i">+PICTURE=/tmp/i3lock.png
</a><a href="#h12-0-3" id="h12-0-3" class="i">+SCREENSHOT=&quot;scrot $PICTURE&quot;
</a><a href="#h12-0-4" id="h12-0-4" class="i">+
</a><a href="#h12-0-5" id="h12-0-5" class="i">+BLUR=&quot;0x8&quot;
</a><a href="#h12-0-6" id="h12-0-6" class="i">+
</a><a href="#h12-0-7" id="h12-0-7" class="i">+$SCREENSHOT
</a><a href="#h12-0-8" id="h12-0-8" class="i">+convert $PICTURE -blur $BLUR $PICTURE
</a><a href="#h12-0-9" id="h12-0-9" class="i">+i3lock -i $PICTURE
</a><a href="#h12-0-10" id="h12-0-10" class="i">+rm $PICTURE
</a><a href="#h12-0-11" id="h12-0-11" class="i">+
</a><a href="#h12-0-12" id="h12-0-12" class="i">+#i3lock -c 282828
</a><b>diff --git a/<a id="h13" href="../file/dots/.bin/settings.html">dots/.bin/settings</a> b/<a href="../file/dots/.bin/settings.html">dots/.bin/settings</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -0,0 +1,2 @@
</a><a href="#h13-0-0" id="h13-0-0" class="i">+#!/bin/bash
</a><a href="#h13-0-1" id="h13-0-1" class="i">+env XDG_CURRENT_DESKTOP=GNOME gnome-control-center
</a><b>diff --git a/<a id="h14" href="../file/dots/.config/alacritty/alacritty.yml.html">dots/.config/alacritty/alacritty.yml</a> b/<a href="../file/dots/.config/alacritty/alacritty.yml.html">dots/.config/alacritty/alacritty.yml</a></b>
<a href="#h14-0" id="h14-0" class="h">@@ -0,0 +1,460 @@
</a><a href="#h14-0-0" id="h14-0-0" class="i">+# Configuration for Alacritty, the GPU enhanced terminal emulator
</a><a href="#h14-0-1" id="h14-0-1" class="i">+
</a><a href="#h14-0-2" id="h14-0-2" class="i">+# Any items in the `env` entry below will be added as
</a><a href="#h14-0-3" id="h14-0-3" class="i">+# environment variables. Some entries may override variables
</a><a href="#h14-0-4" id="h14-0-4" class="i">+# set by alacritty it self.
</a><a href="#h14-0-5" id="h14-0-5" class="i">+env:
</a><a href="#h14-0-6" id="h14-0-6" class="i">+  # TERM env customization.
</a><a href="#h14-0-7" id="h14-0-7" class="i">+  #
</a><a href="#h14-0-8" id="h14-0-8" class="i">+  # If this property is not set, alacritty will set it to xterm-256color.
</a><a href="#h14-0-9" id="h14-0-9" class="i">+  #
</a><a href="#h14-0-10" id="h14-0-10" class="i">+  # Note that some xterm terminfo databases don&#39;t declare support for italics.
</a><a href="#h14-0-11" id="h14-0-11" class="i">+  # You can verify this by checking for the presence of `smso` and `sitm` in
</a><a href="#h14-0-12" id="h14-0-12" class="i">+  # `infocmp xterm-256color`.
</a><a href="#h14-0-13" id="h14-0-13" class="i">+  TERM: xterm-256color
</a><a href="#h14-0-14" id="h14-0-14" class="i">+
</a><a href="#h14-0-15" id="h14-0-15" class="i">+window:
</a><a href="#h14-0-16" id="h14-0-16" class="i">+  # Window dimensions in character columns and lines
</a><a href="#h14-0-17" id="h14-0-17" class="i">+  # (changes require restart)
</a><a href="#h14-0-18" id="h14-0-18" class="i">+  dimensions:
</a><a href="#h14-0-19" id="h14-0-19" class="i">+    columns: 160
</a><a href="#h14-0-20" id="h14-0-20" class="i">+    lines: 50
</a><a href="#h14-0-21" id="h14-0-21" class="i">+
</a><a href="#h14-0-22" id="h14-0-22" class="i">+  # Adds this many blank pixels of padding around the window
</a><a href="#h14-0-23" id="h14-0-23" class="i">+  # Units are physical pixels; this is not DPI aware.
</a><a href="#h14-0-24" id="h14-0-24" class="i">+  # (change requires restart)
</a><a href="#h14-0-25" id="h14-0-25" class="i">+  padding:
</a><a href="#h14-0-26" id="h14-0-26" class="i">+    x: 10
</a><a href="#h14-0-27" id="h14-0-27" class="i">+    y: 10
</a><a href="#h14-0-28" id="h14-0-28" class="i">+
</a><a href="#h14-0-29" id="h14-0-29" class="i">+  # Window decorations
</a><a href="#h14-0-30" id="h14-0-30" class="i">+  # Setting this to false will result in window without borders and title bar.
</a><a href="#h14-0-31" id="h14-0-31" class="i">+  # decorations: transparent
</a><a href="#h14-0-32" id="h14-0-32" class="i">+
</a><a href="#h14-0-33" id="h14-0-33" class="i">+# Display tabs using this many cells (changes require restart)
</a><a href="#h14-0-34" id="h14-0-34" class="i">+tabspaces: 8
</a><a href="#h14-0-35" id="h14-0-35" class="i">+
</a><a href="#h14-0-36" id="h14-0-36" class="i">+# When true, bold text is drawn using the bright variant of colors.
</a><a href="#h14-0-37" id="h14-0-37" class="i">+draw_bold_text_with_bright_colors: true
</a><a href="#h14-0-38" id="h14-0-38" class="i">+
</a><a href="#h14-0-39" id="h14-0-39" class="i">+# Font configuration (changes require restart)
</a><a href="#h14-0-40" id="h14-0-40" class="i">+font:
</a><a href="#h14-0-41" id="h14-0-41" class="i">+  # The normal (roman) font face to use.
</a><a href="#h14-0-42" id="h14-0-42" class="i">+  normal:
</a><a href="#h14-0-43" id="h14-0-43" class="i">+    family: Fira Mono
</a><a href="#h14-0-44" id="h14-0-44" class="i">+    # Style can be specified to pick a specific face.
</a><a href="#h14-0-45" id="h14-0-45" class="i">+    # style: Regular
</a><a href="#h14-0-46" id="h14-0-46" class="i">+
</a><a href="#h14-0-47" id="h14-0-47" class="i">+  # The bold font face
</a><a href="#h14-0-48" id="h14-0-48" class="i">+  bold:
</a><a href="#h14-0-49" id="h14-0-49" class="i">+    family: Fira Mono
</a><a href="#h14-0-50" id="h14-0-50" class="i">+    # Style can be specified to pick a specific face.
</a><a href="#h14-0-51" id="h14-0-51" class="i">+    # style: Bold
</a><a href="#h14-0-52" id="h14-0-52" class="i">+
</a><a href="#h14-0-53" id="h14-0-53" class="i">+  # The italic font face
</a><a href="#h14-0-54" id="h14-0-54" class="i">+  italic:
</a><a href="#h14-0-55" id="h14-0-55" class="i">+    family: Fira Mono
</a><a href="#h14-0-56" id="h14-0-56" class="i">+    # Style can be specified to pick a specific face.
</a><a href="#h14-0-57" id="h14-0-57" class="i">+    # style: Italic
</a><a href="#h14-0-58" id="h14-0-58" class="i">+
</a><a href="#h14-0-59" id="h14-0-59" class="i">+  # Point size of the font
</a><a href="#h14-0-60" id="h14-0-60" class="i">+  size: 7
</a><a href="#h14-0-61" id="h14-0-61" class="i">+
</a><a href="#h14-0-62" id="h14-0-62" class="i">+  # Offset is the extra space around each character. offset.y can be thought of
</a><a href="#h14-0-63" id="h14-0-63" class="i">+  # as modifying the linespacing, and offset.x as modifying the letter spacing.
</a><a href="#h14-0-64" id="h14-0-64" class="i">+  offset:
</a><a href="#h14-0-65" id="h14-0-65" class="i">+    x: 0
</a><a href="#h14-0-66" id="h14-0-66" class="i">+    y: 0
</a><a href="#h14-0-67" id="h14-0-67" class="i">+
</a><a href="#h14-0-68" id="h14-0-68" class="i">+  # Glyph offset determines the locations of the glyphs within their cells with
</a><a href="#h14-0-69" id="h14-0-69" class="i">+  # the default being at the bottom. Increase the x offset to move the glyph to
</a><a href="#h14-0-70" id="h14-0-70" class="i">+  # the right, increase the y offset to move the glyph upward.
</a><a href="#h14-0-71" id="h14-0-71" class="i">+  glyph_offset:
</a><a href="#h14-0-72" id="h14-0-72" class="i">+    x: 0
</a><a href="#h14-0-73" id="h14-0-73" class="i">+    y: 0
</a><a href="#h14-0-74" id="h14-0-74" class="i">+
</a><a href="#h14-0-75" id="h14-0-75" class="i">+  # OS X only: use thin stroke font rendering. Thin strokes are suitable
</a><a href="#h14-0-76" id="h14-0-76" class="i">+  # for retina displays, but for non-retina you probably want this set to
</a><a href="#h14-0-77" id="h14-0-77" class="i">+  # false.
</a><a href="#h14-0-78" id="h14-0-78" class="i">+  use_thin_strokes: false
</a><a href="#h14-0-79" id="h14-0-79" class="i">+
</a><a href="#h14-0-80" id="h14-0-80" class="i">+# Should display the render timer
</a><a href="#h14-0-81" id="h14-0-81" class="i">+render_timer: false
</a><a href="#h14-0-82" id="h14-0-82" class="i">+
</a><a href="#h14-0-83" id="h14-0-83" class="i">+# Use custom cursor colors. If true, display the cursor in the cursor.foreground
</a><a href="#h14-0-84" id="h14-0-84" class="i">+# and cursor.background colors, otherwise invert the colors of the cursor.
</a><a href="#h14-0-85" id="h14-0-85" class="i">+#custom_cursor_colors: false
</a><a href="#h14-0-86" id="h14-0-86" class="i">+
</a><a href="#h14-0-87" id="h14-0-87" class="i">+# Colors (Tomorrow Night Bright)
</a><a href="#h14-0-88" id="h14-0-88" class="i">+colors:
</a><a href="#h14-0-89" id="h14-0-89" class="i">+  # Default colors
</a><a href="#h14-0-90" id="h14-0-90" class="i">+  primary:
</a><a href="#h14-0-91" id="h14-0-91" class="i">+    background: &#39;#1d2021&#39;
</a><a href="#h14-0-92" id="h14-0-92" class="i">+    foreground: &#39;#ebdbb2&#39;
</a><a href="#h14-0-93" id="h14-0-93" class="i">+
</a><a href="#h14-0-94" id="h14-0-94" class="i">+  # Colors the cursor will use if `custom_cursor_colors` is true
</a><a href="#h14-0-95" id="h14-0-95" class="i">+  cursor:
</a><a href="#h14-0-96" id="h14-0-96" class="i">+    text: &#39;#282828&#39;
</a><a href="#h14-0-97" id="h14-0-97" class="i">+    cursor: &#39;#ebdbb2&#39;
</a><a href="#h14-0-98" id="h14-0-98" class="i">+
</a><a href="#h14-0-99" id="h14-0-99" class="i">+  # Normal colors
</a><a href="#h14-0-100" id="h14-0-100" class="i">+  normal:
</a><a href="#h14-0-101" id="h14-0-101" class="i">+    black:   &#39;#282828&#39;
</a><a href="#h14-0-102" id="h14-0-102" class="i">+    red:     &#39;#cc241d&#39;
</a><a href="#h14-0-103" id="h14-0-103" class="i">+    green:   &#39;#98971a&#39;
</a><a href="#h14-0-104" id="h14-0-104" class="i">+    yellow:  &#39;#d79921&#39;
</a><a href="#h14-0-105" id="h14-0-105" class="i">+    blue:    &#39;#458588&#39;
</a><a href="#h14-0-106" id="h14-0-106" class="i">+    magenta: &#39;#b16286&#39;
</a><a href="#h14-0-107" id="h14-0-107" class="i">+    cyan:    &#39;#689d6a&#39;
</a><a href="#h14-0-108" id="h14-0-108" class="i">+    white:   &#39;#a89984&#39;
</a><a href="#h14-0-109" id="h14-0-109" class="i">+
</a><a href="#h14-0-110" id="h14-0-110" class="i">+  # Bright colors
</a><a href="#h14-0-111" id="h14-0-111" class="i">+  bright:
</a><a href="#h14-0-112" id="h14-0-112" class="i">+    black:   &#39;#928374&#39;
</a><a href="#h14-0-113" id="h14-0-113" class="i">+    red:     &#39;#fb4934&#39;
</a><a href="#h14-0-114" id="h14-0-114" class="i">+    green:   &#39;#b8bb26&#39;
</a><a href="#h14-0-115" id="h14-0-115" class="i">+    yellow:  &#39;#fabd2f&#39;
</a><a href="#h14-0-116" id="h14-0-116" class="i">+    blue:    &#39;#83a598&#39;
</a><a href="#h14-0-117" id="h14-0-117" class="i">+    magenta: &#39;#d3869b&#39;
</a><a href="#h14-0-118" id="h14-0-118" class="i">+    cyan:    &#39;#8ec07c&#39;
</a><a href="#h14-0-119" id="h14-0-119" class="i">+    white:   &#39;#ebdbb2&#39;
</a><a href="#h14-0-120" id="h14-0-120" class="i">+
</a><a href="#h14-0-121" id="h14-0-121" class="i">+  # # Dim colors (Optional)
</a><a href="#h14-0-122" id="h14-0-122" class="i">+  # dim:
</a><a href="#h14-0-123" id="h14-0-123" class="i">+  #   black:   &#39;0x333333&#39;
</a><a href="#h14-0-124" id="h14-0-124" class="i">+  #   red:     &#39;0xf2777a&#39;
</a><a href="#h14-0-125" id="h14-0-125" class="i">+  #   green:   &#39;0x99cc99&#39;
</a><a href="#h14-0-126" id="h14-0-126" class="i">+  #   yellow:  &#39;0xffcc66&#39;
</a><a href="#h14-0-127" id="h14-0-127" class="i">+  #   blue:    &#39;0x6699cc&#39;
</a><a href="#h14-0-128" id="h14-0-128" class="i">+  #   magenta: &#39;0xcc99cc&#39;
</a><a href="#h14-0-129" id="h14-0-129" class="i">+  #   cyan:    &#39;0x66cccc&#39;
</a><a href="#h14-0-130" id="h14-0-130" class="i">+  #   white:   &#39;0xdddddd&#39;
</a><a href="#h14-0-131" id="h14-0-131" class="i">+
</a><a href="#h14-0-132" id="h14-0-132" class="i">+
</a><a href="#h14-0-133" id="h14-0-133" class="i">+# Visual Bell
</a><a href="#h14-0-134" id="h14-0-134" class="i">+#
</a><a href="#h14-0-135" id="h14-0-135" class="i">+# Any time the BEL code is received, Alacritty &quot;rings&quot; the visual bell. Once
</a><a href="#h14-0-136" id="h14-0-136" class="i">+# rung, the terminal background will be set to white and transition back to the
</a><a href="#h14-0-137" id="h14-0-137" class="i">+# default background color. You can control the rate of this transition by
</a><a href="#h14-0-138" id="h14-0-138" class="i">+# setting the `duration` property (represented in milliseconds). You can also
</a><a href="#h14-0-139" id="h14-0-139" class="i">+# configure the transition function by setting the `animation` property.
</a><a href="#h14-0-140" id="h14-0-140" class="i">+#
</a><a href="#h14-0-141" id="h14-0-141" class="i">+# Possible values for `animation`
</a><a href="#h14-0-142" id="h14-0-142" class="i">+# `Ease`
</a><a href="#h14-0-143" id="h14-0-143" class="i">+# `EaseOut`
</a><a href="#h14-0-144" id="h14-0-144" class="i">+# `EaseOutSine`
</a><a href="#h14-0-145" id="h14-0-145" class="i">+# `EaseOutQuad`
</a><a href="#h14-0-146" id="h14-0-146" class="i">+# `EaseOutCubic`
</a><a href="#h14-0-147" id="h14-0-147" class="i">+# `EaseOutQuart`
</a><a href="#h14-0-148" id="h14-0-148" class="i">+# `EaseOutQuint`
</a><a href="#h14-0-149" id="h14-0-149" class="i">+# `EaseOutExpo`
</a><a href="#h14-0-150" id="h14-0-150" class="i">+# `EaseOutCirc`
</a><a href="#h14-0-151" id="h14-0-151" class="i">+# `Linear`
</a><a href="#h14-0-152" id="h14-0-152" class="i">+#
</a><a href="#h14-0-153" id="h14-0-153" class="i">+# To completely disable the visual bell, set its duration to 0.
</a><a href="#h14-0-154" id="h14-0-154" class="i">+#
</a><a href="#h14-0-155" id="h14-0-155" class="i">+visual_bell:
</a><a href="#h14-0-156" id="h14-0-156" class="i">+  animation: EaseOutExpo
</a><a href="#h14-0-157" id="h14-0-157" class="i">+  duration: 0
</a><a href="#h14-0-158" id="h14-0-158" class="i">+
</a><a href="#h14-0-159" id="h14-0-159" class="i">+# Background opacity
</a><a href="#h14-0-160" id="h14-0-160" class="i">+background_opacity: 1.0
</a><a href="#h14-0-161" id="h14-0-161" class="i">+
</a><a href="#h14-0-162" id="h14-0-162" class="i">+# Mouse bindings
</a><a href="#h14-0-163" id="h14-0-163" class="i">+#
</a><a href="#h14-0-164" id="h14-0-164" class="i">+# Currently doesn&#39;t support modifiers. Both the `mouse` and `action` fields must
</a><a href="#h14-0-165" id="h14-0-165" class="i">+# be specified.
</a><a href="#h14-0-166" id="h14-0-166" class="i">+#
</a><a href="#h14-0-167" id="h14-0-167" class="i">+# Values for `mouse`:
</a><a href="#h14-0-168" id="h14-0-168" class="i">+# - Middle
</a><a href="#h14-0-169" id="h14-0-169" class="i">+# - Left
</a><a href="#h14-0-170" id="h14-0-170" class="i">+# - Right
</a><a href="#h14-0-171" id="h14-0-171" class="i">+# - Numeric identifier such as `5`
</a><a href="#h14-0-172" id="h14-0-172" class="i">+#
</a><a href="#h14-0-173" id="h14-0-173" class="i">+# Values for `action`:
</a><a href="#h14-0-174" id="h14-0-174" class="i">+# - Paste
</a><a href="#h14-0-175" id="h14-0-175" class="i">+# - PasteSelection
</a><a href="#h14-0-176" id="h14-0-176" class="i">+# - Copy (TODO)
</a><a href="#h14-0-177" id="h14-0-177" class="i">+mouse_bindings:
</a><a href="#h14-0-178" id="h14-0-178" class="i">+  - { mouse: Middle, action: PasteSelection }
</a><a href="#h14-0-179" id="h14-0-179" class="i">+
</a><a href="#h14-0-180" id="h14-0-180" class="i">+mouse:
</a><a href="#h14-0-181" id="h14-0-181" class="i">+  # Click settings
</a><a href="#h14-0-182" id="h14-0-182" class="i">+  #
</a><a href="#h14-0-183" id="h14-0-183" class="i">+  # The `double_click` and `triple_click` settings control the time
</a><a href="#h14-0-184" id="h14-0-184" class="i">+  # alacritty should wait for accepting multiple clicks as one double
</a><a href="#h14-0-185" id="h14-0-185" class="i">+  # or triple click.
</a><a href="#h14-0-186" id="h14-0-186" class="i">+  double_click: { threshold: 300 }
</a><a href="#h14-0-187" id="h14-0-187" class="i">+  triple_click: { threshold: 300 }
</a><a href="#h14-0-188" id="h14-0-188" class="i">+
</a><a href="#h14-0-189" id="h14-0-189" class="i">+  # If this is `true`, the cursor is temporarily hidden when typing.
</a><a href="#h14-0-190" id="h14-0-190" class="i">+  hide_when_typing: true
</a><a href="#h14-0-191" id="h14-0-191" class="i">+
</a><a href="#h14-0-192" id="h14-0-192" class="i">+  # Faux Scrollback
</a><a href="#h14-0-193" id="h14-0-193" class="i">+  #
</a><a href="#h14-0-194" id="h14-0-194" class="i">+  # The `faux_scrollback_lines` setting controls the number
</a><a href="#h14-0-195" id="h14-0-195" class="i">+  # of lines the terminal should scroll when the alternate
</a><a href="#h14-0-196" id="h14-0-196" class="i">+  # screen buffer is active. This is used to allow mouse
</a><a href="#h14-0-197" id="h14-0-197" class="i">+  # scrolling for applications like `man`.
</a><a href="#h14-0-198" id="h14-0-198" class="i">+  #
</a><a href="#h14-0-199" id="h14-0-199" class="i">+  # To disable this completely, set `faux_scrollback_lines` to 0.
</a><a href="#h14-0-200" id="h14-0-200" class="i">+  # faux_scrollback_lines: 1
</a><a href="#h14-0-201" id="h14-0-201" class="i">+
</a><a href="#h14-0-202" id="h14-0-202" class="i">+selection:
</a><a href="#h14-0-203" id="h14-0-203" class="i">+  semantic_escape_chars: &quot;,│`|:\&quot;&#39; ()[]{}&lt;&gt;&quot;
</a><a href="#h14-0-204" id="h14-0-204" class="i">+
</a><a href="#h14-0-205" id="h14-0-205" class="i">+dynamic_title: true
</a><a href="#h14-0-206" id="h14-0-206" class="i">+
</a><a href="#h14-0-207" id="h14-0-207" class="i">+#hide_cursor_when_typing: true
</a><a href="#h14-0-208" id="h14-0-208" class="i">+
</a><a href="#h14-0-209" id="h14-0-209" class="i">+# Style of the cursor
</a><a href="#h14-0-210" id="h14-0-210" class="i">+#
</a><a href="#h14-0-211" id="h14-0-211" class="i">+# Values for &#39;cursor_style&#39;:
</a><a href="#h14-0-212" id="h14-0-212" class="i">+# - Block
</a><a href="#h14-0-213" id="h14-0-213" class="i">+# - Underline
</a><a href="#h14-0-214" id="h14-0-214" class="i">+# - Beam
</a><a href="#h14-0-215" id="h14-0-215" class="i">+#cursor_style: Block
</a><a href="#h14-0-216" id="h14-0-216" class="i">+
</a><a href="#h14-0-217" id="h14-0-217" class="i">+# Live config reload (changes require restart)
</a><a href="#h14-0-218" id="h14-0-218" class="i">+live_config_reload: true
</a><a href="#h14-0-219" id="h14-0-219" class="i">+
</a><a href="#h14-0-220" id="h14-0-220" class="i">+# Shell
</a><a href="#h14-0-221" id="h14-0-221" class="i">+#
</a><a href="#h14-0-222" id="h14-0-222" class="i">+# You can set shell.program to the path of your favorite shell, e.g. /bin/fish.
</a><a href="#h14-0-223" id="h14-0-223" class="i">+# Entries in shell.args are passed unmodified as arguments to the shell.
</a><a href="#h14-0-224" id="h14-0-224" class="i">+#
</a><a href="#h14-0-225" id="h14-0-225" class="i">+shell:
</a><a href="#h14-0-226" id="h14-0-226" class="i">+  program: /bin/zsh
</a><a href="#h14-0-227" id="h14-0-227" class="i">+#   args:
</a><a href="#h14-0-228" id="h14-0-228" class="i">+#     - --login
</a><a href="#h14-0-229" id="h14-0-229" class="i">+
</a><a href="#h14-0-230" id="h14-0-230" class="i">+# Key bindings
</a><a href="#h14-0-231" id="h14-0-231" class="i">+#
</a><a href="#h14-0-232" id="h14-0-232" class="i">+# Each binding is defined as an object with some properties. Most of the
</a><a href="#h14-0-233" id="h14-0-233" class="i">+# properties are optional. All of the alphabetical keys should have a letter for
</a><a href="#h14-0-234" id="h14-0-234" class="i">+# the `key` value such as `V`. Function keys are probably what you would expect
</a><a href="#h14-0-235" id="h14-0-235" class="i">+# as well (F1, F2, ..). The number keys above the main keyboard are encoded as
</a><a href="#h14-0-236" id="h14-0-236" class="i">+# `Key1`, `Key2`, etc. Keys on the number pad are encoded `Number1`, `Number2`,
</a><a href="#h14-0-237" id="h14-0-237" class="i">+# etc.  These all match the glutin::VirtualKeyCode variants.
</a><a href="#h14-0-238" id="h14-0-238" class="i">+#
</a><a href="#h14-0-239" id="h14-0-239" class="i">+# A list with all available `key` names can be found here:
</a><a href="#h14-0-240" id="h14-0-240" class="i">+# https://docs.rs/glutin/*/glutin/enum.VirtualKeyCode.html#variants
</a><a href="#h14-0-241" id="h14-0-241" class="i">+#
</a><a href="#h14-0-242" id="h14-0-242" class="i">+# Possible values for `mods`
</a><a href="#h14-0-243" id="h14-0-243" class="i">+# `Command`, `Super` refer to the super/command/windows key
</a><a href="#h14-0-244" id="h14-0-244" class="i">+# `Control` for the control key
</a><a href="#h14-0-245" id="h14-0-245" class="i">+# `Shift` for the Shift key
</a><a href="#h14-0-246" id="h14-0-246" class="i">+# `Alt` and `Option` refer to alt/option
</a><a href="#h14-0-247" id="h14-0-247" class="i">+#
</a><a href="#h14-0-248" id="h14-0-248" class="i">+# mods may be combined with a `|`. For example, requiring control and shift
</a><a href="#h14-0-249" id="h14-0-249" class="i">+# looks like:
</a><a href="#h14-0-250" id="h14-0-250" class="i">+#
</a><a href="#h14-0-251" id="h14-0-251" class="i">+# mods: Control|Shift
</a><a href="#h14-0-252" id="h14-0-252" class="i">+#
</a><a href="#h14-0-253" id="h14-0-253" class="i">+# The parser is currently quite sensitive to whitespace and capitalization -
</a><a href="#h14-0-254" id="h14-0-254" class="i">+# capitalization must match exactly, and piped items must not have whitespace
</a><a href="#h14-0-255" id="h14-0-255" class="i">+# around them.
</a><a href="#h14-0-256" id="h14-0-256" class="i">+#
</a><a href="#h14-0-257" id="h14-0-257" class="i">+# Either an `action`, `chars`, or `command` field must be present.
</a><a href="#h14-0-258" id="h14-0-258" class="i">+#   `action` must be one of `Paste`, `PasteSelection`, `Copy`, or `Quit`.
</a><a href="#h14-0-259" id="h14-0-259" class="i">+#   `chars` writes the specified string every time that binding is activated.
</a><a href="#h14-0-260" id="h14-0-260" class="i">+#     These should generally be escape sequences, but they can be configured to
</a><a href="#h14-0-261" id="h14-0-261" class="i">+#     send arbitrary strings of bytes.
</a><a href="#h14-0-262" id="h14-0-262" class="i">+#   `command` must be a map containing a `program` string, and `args` array of
</a><a href="#h14-0-263" id="h14-0-263" class="i">+#     strings. For example:
</a><a href="#h14-0-264" id="h14-0-264" class="i">+#     - { ... , command: { program: &quot;alacritty&quot;, args: [&quot;-e&quot;, &quot;vttest&quot;] } }
</a><a href="#h14-0-265" id="h14-0-265" class="i">+key_bindings:
</a><a href="#h14-0-266" id="h14-0-266" class="i">+  - { key: V,        mods: Control|Shift, action: Paste                        }
</a><a href="#h14-0-267" id="h14-0-267" class="i">+  - { key: C,        mods: Control|Shift, action: Copy                         }
</a><a href="#h14-0-268" id="h14-0-268" class="i">+  - { key: Q,        mods: Command, action: Quit                         }
</a><a href="#h14-0-269" id="h14-0-269" class="i">+  - { key: W,        mods: Command, action: Quit                         }
</a><a href="#h14-0-270" id="h14-0-270" class="i">+  - { key: Home,                    chars: &quot;\x1bOH&quot;,   mode: AppCursor   }
</a><a href="#h14-0-271" id="h14-0-271" class="i">+  - { key: Home,                    chars: &quot;\x1b[H&quot;,   mode: ~AppCursor  }
</a><a href="#h14-0-272" id="h14-0-272" class="i">+  - { key: End,                     chars: &quot;\x1bOF&quot;,   mode: AppCursor   }
</a><a href="#h14-0-273" id="h14-0-273" class="i">+  - { key: End,                     chars: &quot;\x1b[F&quot;,   mode: ~AppCursor  }
</a><a href="#h14-0-274" id="h14-0-274" class="i">+  - { key: Key0,     mods: Command, action: ResetFontSize                }
</a><a href="#h14-0-275" id="h14-0-275" class="i">+  - { key: Equals,   mods: Command, action: IncreaseFontSize             }
</a><a href="#h14-0-276" id="h14-0-276" class="i">+  - { key: Minus,    mods: Command, action: DecreaseFontSize             }
</a><a href="#h14-0-277" id="h14-0-277" class="i">+  - { key: PageUp,   mods: Shift,   chars: &quot;\x1b[5;2~&quot;                   }
</a><a href="#h14-0-278" id="h14-0-278" class="i">+  - { key: PageUp,   mods: Control, chars: &quot;\x1b[5;5~&quot;                   }
</a><a href="#h14-0-279" id="h14-0-279" class="i">+  - { key: PageUp,                  chars: &quot;\x1b[5~&quot;                     }
</a><a href="#h14-0-280" id="h14-0-280" class="i">+  - { key: PageDown, mods: Shift,   chars: &quot;\x1b[6;2~&quot;                   }
</a><a href="#h14-0-281" id="h14-0-281" class="i">+  - { key: PageDown, mods: Control, chars: &quot;\x1b[6;5~&quot;                   }
</a><a href="#h14-0-282" id="h14-0-282" class="i">+  - { key: PageDown,                chars: &quot;\x1b[6~&quot;                     }
</a><a href="#h14-0-283" id="h14-0-283" class="i">+  - { key: Tab,      mods: Shift,   chars: &quot;\x1b[Z&quot;                      }
</a><a href="#h14-0-284" id="h14-0-284" class="i">+  - { key: Back,                    chars: &quot;\x7f&quot;                        }
</a><a href="#h14-0-285" id="h14-0-285" class="i">+  - { key: Back,     mods: Alt,     chars: &quot;\x1b\x7f&quot;                    }
</a><a href="#h14-0-286" id="h14-0-286" class="i">+  - { key: Insert,                  chars: &quot;\x1b[2~&quot;                     }
</a><a href="#h14-0-287" id="h14-0-287" class="i">+  - { key: Delete,                  chars: &quot;\x1b[3~&quot;                     }
</a><a href="#h14-0-288" id="h14-0-288" class="i">+  - { key: Left,     mods: Shift,   chars: &quot;\x1b[1;2D&quot;                   }
</a><a href="#h14-0-289" id="h14-0-289" class="i">+  - { key: Left,     mods: Control, chars: &quot;\x1b[1;5D&quot;                   }
</a><a href="#h14-0-290" id="h14-0-290" class="i">+  - { key: Left,     mods: Alt,     chars: &quot;\x1b[1;3D&quot;                   }
</a><a href="#h14-0-291" id="h14-0-291" class="i">+  - { key: Left,                    chars: &quot;\x1b[D&quot;,   mode: ~AppCursor  }
</a><a href="#h14-0-292" id="h14-0-292" class="i">+  - { key: Left,                    chars: &quot;\x1bOD&quot;,   mode: AppCursor   }
</a><a href="#h14-0-293" id="h14-0-293" class="i">+  - { key: Right,    mods: Shift,   chars: &quot;\x1b[1;2C&quot;                   }
</a><a href="#h14-0-294" id="h14-0-294" class="i">+  - { key: Right,    mods: Control, chars: &quot;\x1b[1;5C&quot;                   }
</a><a href="#h14-0-295" id="h14-0-295" class="i">+  - { key: Right,    mods: Alt,     chars: &quot;\x1b[1;3C&quot;                   }
</a><a href="#h14-0-296" id="h14-0-296" class="i">+  - { key: Right,                   chars: &quot;\x1b[C&quot;,   mode: ~AppCursor  }
</a><a href="#h14-0-297" id="h14-0-297" class="i">+  - { key: Right,                   chars: &quot;\x1bOC&quot;,   mode: AppCursor   }
</a><a href="#h14-0-298" id="h14-0-298" class="i">+  - { key: Up,       mods: Shift,   chars: &quot;\x1b[1;2A&quot;                   }
</a><a href="#h14-0-299" id="h14-0-299" class="i">+  - { key: Up,       mods: Control, chars: &quot;\x1b[1;5A&quot;                   }
</a><a href="#h14-0-300" id="h14-0-300" class="i">+  - { key: Up,       mods: Alt,     chars: &quot;\x1b[1;3A&quot;                   }
</a><a href="#h14-0-301" id="h14-0-301" class="i">+  - { key: Up,                      chars: &quot;\x1b[A&quot;,   mode: ~AppCursor  }
</a><a href="#h14-0-302" id="h14-0-302" class="i">+  - { key: Up,                      chars: &quot;\x1bOA&quot;,   mode: AppCursor   }
</a><a href="#h14-0-303" id="h14-0-303" class="i">+  - { key: Down,     mods: Shift,   chars: &quot;\x1b[1;2B&quot;                   }
</a><a href="#h14-0-304" id="h14-0-304" class="i">+  - { key: Down,     mods: Control, chars: &quot;\x1b[1;5B&quot;                   }
</a><a href="#h14-0-305" id="h14-0-305" class="i">+  - { key: Down,     mods: Alt,     chars: &quot;\x1b[1;3B&quot;                   }
</a><a href="#h14-0-306" id="h14-0-306" class="i">+  - { key: Down,                    chars: &quot;\x1b[B&quot;,   mode: ~AppCursor  }
</a><a href="#h14-0-307" id="h14-0-307" class="i">+  - { key: Down,                    chars: &quot;\x1bOB&quot;,   mode: AppCursor   }
</a><a href="#h14-0-308" id="h14-0-308" class="i">+  - { key: F1,                      chars: &quot;\x1bOP&quot;                      }
</a><a href="#h14-0-309" id="h14-0-309" class="i">+  - { key: F2,                      chars: &quot;\x1bOQ&quot;                      }
</a><a href="#h14-0-310" id="h14-0-310" class="i">+  - { key: F3,                      chars: &quot;\x1bOR&quot;                      }
</a><a href="#h14-0-311" id="h14-0-311" class="i">+  - { key: F4,                      chars: &quot;\x1bOS&quot;                      }
</a><a href="#h14-0-312" id="h14-0-312" class="i">+  - { key: F5,                      chars: &quot;\x1b[15~&quot;                    }
</a><a href="#h14-0-313" id="h14-0-313" class="i">+  - { key: F6,                      chars: &quot;\x1b[17~&quot;                    }
</a><a href="#h14-0-314" id="h14-0-314" class="i">+  - { key: F7,                      chars: &quot;\x1b[18~&quot;                    }
</a><a href="#h14-0-315" id="h14-0-315" class="i">+  - { key: F8,                      chars: &quot;\x1b[19~&quot;                    }
</a><a href="#h14-0-316" id="h14-0-316" class="i">+  - { key: F9,                      chars: &quot;\x1b[20~&quot;                    }
</a><a href="#h14-0-317" id="h14-0-317" class="i">+  - { key: F10,                     chars: &quot;\x1b[21~&quot;                    }
</a><a href="#h14-0-318" id="h14-0-318" class="i">+  - { key: F11,                     chars: &quot;\x1b[23~&quot;                    }
</a><a href="#h14-0-319" id="h14-0-319" class="i">+  - { key: F12,                     chars: &quot;\x1b[24~&quot;                    }
</a><a href="#h14-0-320" id="h14-0-320" class="i">+  - { key: F1,       mods: Shift,   chars: &quot;\x1b[1;2P&quot;                   }
</a><a href="#h14-0-321" id="h14-0-321" class="i">+  - { key: F2,       mods: Shift,   chars: &quot;\x1b[1;2Q&quot;                   }
</a><a href="#h14-0-322" id="h14-0-322" class="i">+  - { key: F3,       mods: Shift,   chars: &quot;\x1b[1;2R&quot;                   }
</a><a href="#h14-0-323" id="h14-0-323" class="i">+  - { key: F4,       mods: Shift,   chars: &quot;\x1b[1;2S&quot;                   }
</a><a href="#h14-0-324" id="h14-0-324" class="i">+  - { key: F5,       mods: Shift,   chars: &quot;\x1b[15;2~&quot;                  }
</a><a href="#h14-0-325" id="h14-0-325" class="i">+  - { key: F6,       mods: Shift,   chars: &quot;\x1b[17;2~&quot;                  }
</a><a href="#h14-0-326" id="h14-0-326" class="i">+  - { key: F7,       mods: Shift,   chars: &quot;\x1b[18;2~&quot;                  }
</a><a href="#h14-0-327" id="h14-0-327" class="i">+  - { key: F8,       mods: Shift,   chars: &quot;\x1b[19;2~&quot;                  }
</a><a href="#h14-0-328" id="h14-0-328" class="i">+  - { key: F9,       mods: Shift,   chars: &quot;\x1b[20;2~&quot;                  }
</a><a href="#h14-0-329" id="h14-0-329" class="i">+  - { key: F10,      mods: Shift,   chars: &quot;\x1b[21;2~&quot;                  }
</a><a href="#h14-0-330" id="h14-0-330" class="i">+  - { key: F11,      mods: Shift,   chars: &quot;\x1b[23;2~&quot;                  }
</a><a href="#h14-0-331" id="h14-0-331" class="i">+  - { key: F12,      mods: Shift,   chars: &quot;\x1b[24;2~&quot;                  }
</a><a href="#h14-0-332" id="h14-0-332" class="i">+  - { key: F1,       mods: Control, chars: &quot;\x1b[1;5P&quot;                   }
</a><a href="#h14-0-333" id="h14-0-333" class="i">+  - { key: F2,       mods: Control, chars: &quot;\x1b[1;5Q&quot;                   }
</a><a href="#h14-0-334" id="h14-0-334" class="i">+  - { key: F3,       mods: Control, chars: &quot;\x1b[1;5R&quot;                   }
</a><a href="#h14-0-335" id="h14-0-335" class="i">+  - { key: F4,       mods: Control, chars: &quot;\x1b[1;5S&quot;                   }
</a><a href="#h14-0-336" id="h14-0-336" class="i">+  - { key: F5,       mods: Control, chars: &quot;\x1b[15;5~&quot;                  }
</a><a href="#h14-0-337" id="h14-0-337" class="i">+  - { key: F6,       mods: Control, chars: &quot;\x1b[17;5~&quot;                  }
</a><a href="#h14-0-338" id="h14-0-338" class="i">+  - { key: F7,       mods: Control, chars: &quot;\x1b[18;5~&quot;                  }
</a><a href="#h14-0-339" id="h14-0-339" class="i">+  - { key: F8,       mods: Control, chars: &quot;\x1b[19;5~&quot;                  }
</a><a href="#h14-0-340" id="h14-0-340" class="i">+  - { key: F9,       mods: Control, chars: &quot;\x1b[20;5~&quot;                  }
</a><a href="#h14-0-341" id="h14-0-341" class="i">+  - { key: F10,      mods: Control, chars: &quot;\x1b[21;5~&quot;                  }
</a><a href="#h14-0-342" id="h14-0-342" class="i">+  - { key: F11,      mods: Control, chars: &quot;\x1b[23;5~&quot;                  }
</a><a href="#h14-0-343" id="h14-0-343" class="i">+  - { key: F12,      mods: Control, chars: &quot;\x1b[24;5~&quot;                  }
</a><a href="#h14-0-344" id="h14-0-344" class="i">+  - { key: F1,       mods: Alt,     chars: &quot;\x1b[1;6P&quot;                   }
</a><a href="#h14-0-345" id="h14-0-345" class="i">+  - { key: F2,       mods: Alt,     chars: &quot;\x1b[1;6Q&quot;                   }
</a><a href="#h14-0-346" id="h14-0-346" class="i">+  - { key: F3,       mods: Alt,     chars: &quot;\x1b[1;6R&quot;                   }
</a><a href="#h14-0-347" id="h14-0-347" class="i">+  - { key: F4,       mods: Alt,     chars: &quot;\x1b[1;6S&quot;                   }
</a><a href="#h14-0-348" id="h14-0-348" class="i">+  - { key: F5,       mods: Alt,     chars: &quot;\x1b[15;6~&quot;                  }
</a><a href="#h14-0-349" id="h14-0-349" class="i">+  - { key: F6,       mods: Alt,     chars: &quot;\x1b[17;6~&quot;                  }
</a><a href="#h14-0-350" id="h14-0-350" class="i">+  - { key: F7,       mods: Alt,     chars: &quot;\x1b[18;6~&quot;                  }
</a><a href="#h14-0-351" id="h14-0-351" class="i">+  - { key: F8,       mods: Alt,     chars: &quot;\x1b[19;6~&quot;                  }
</a><a href="#h14-0-352" id="h14-0-352" class="i">+  - { key: F9,       mods: Alt,     chars: &quot;\x1b[20;6~&quot;                  }
</a><a href="#h14-0-353" id="h14-0-353" class="i">+  - { key: F10,      mods: Alt,     chars: &quot;\x1b[21;6~&quot;                  }
</a><a href="#h14-0-354" id="h14-0-354" class="i">+  - { key: F11,      mods: Alt,     chars: &quot;\x1b[23;6~&quot;                  }
</a><a href="#h14-0-355" id="h14-0-355" class="i">+  - { key: F12,      mods: Alt,     chars: &quot;\x1b[24;6~&quot;                  }
</a><a href="#h14-0-356" id="h14-0-356" class="i">+  - { key: F1,       mods: Command, chars: &quot;\x1b[1;3P&quot;                   }
</a><a href="#h14-0-357" id="h14-0-357" class="i">+  - { key: F2,       mods: Command, chars: &quot;\x1b[1;3Q&quot;                   }
</a><a href="#h14-0-358" id="h14-0-358" class="i">+  - { key: F3,       mods: Command, chars: &quot;\x1b[1;3R&quot;                   }
</a><a href="#h14-0-359" id="h14-0-359" class="i">+  - { key: F4,       mods: Command, chars: &quot;\x1b[1;3S&quot;                   }
</a><a href="#h14-0-360" id="h14-0-360" class="i">+  - { key: F5,       mods: Command, chars: &quot;\x1b[15;3~&quot;                  }
</a><a href="#h14-0-361" id="h14-0-361" class="i">+  - { key: F6,       mods: Command, chars: &quot;\x1b[17;3~&quot;                  }
</a><a href="#h14-0-362" id="h14-0-362" class="i">+  - { key: F7,       mods: Command, chars: &quot;\x1b[18;3~&quot;                  }
</a><a href="#h14-0-363" id="h14-0-363" class="i">+  - { key: F8,       mods: Command, chars: &quot;\x1b[19;3~&quot;                  }
</a><a href="#h14-0-364" id="h14-0-364" class="i">+  - { key: F9,       mods: Command, chars: &quot;\x1b[20;3~&quot;                  }
</a><a href="#h14-0-365" id="h14-0-365" class="i">+  - { key: F10,      mods: Command, chars: &quot;\x1b[21;3~&quot;                  }
</a><a href="#h14-0-366" id="h14-0-366" class="i">+  - { key: F11,      mods: Command, chars: &quot;\x1b[23;3~&quot;                  }
</a><a href="#h14-0-367" id="h14-0-367" class="i">+  - { key: F12,      mods: Command, chars: &quot;\x1b[24;3~&quot;                  }
</a><a href="#h14-0-368" id="h14-0-368" class="i">+
</a><a href="#h14-0-369" id="h14-0-369" class="i">+  # Alt key
</a><a href="#h14-0-370" id="h14-0-370" class="i">+  - { key: A,         mods: Alt,       chars: &quot;\x1ba&quot;                       }
</a><a href="#h14-0-371" id="h14-0-371" class="i">+  - { key: B,         mods: Alt,       chars: &quot;\x1bb&quot;                       }
</a><a href="#h14-0-372" id="h14-0-372" class="i">+  - { key: C,         mods: Alt,       chars: &quot;\x1bc&quot;                       }
</a><a href="#h14-0-373" id="h14-0-373" class="i">+  - { key: D,         mods: Alt,       chars: &quot;\x1bd&quot;                       }
</a><a href="#h14-0-374" id="h14-0-374" class="i">+  - { key: E,         mods: Alt,       chars: &quot;\x1be&quot;                       }
</a><a href="#h14-0-375" id="h14-0-375" class="i">+  - { key: F,         mods: Alt,       chars: &quot;\x1bf&quot;                       }
</a><a href="#h14-0-376" id="h14-0-376" class="i">+  - { key: G,         mods: Alt,       chars: &quot;\x1bg&quot;                       }
</a><a href="#h14-0-377" id="h14-0-377" class="i">+  - { key: H,         mods: Alt,       chars: &quot;\x1bh&quot;                       }
</a><a href="#h14-0-378" id="h14-0-378" class="i">+  - { key: I,         mods: Alt,       chars: &quot;\x1bi&quot;                       }
</a><a href="#h14-0-379" id="h14-0-379" class="i">+  - { key: J,         mods: Alt,       chars: &quot;\x1bj&quot;                       }
</a><a href="#h14-0-380" id="h14-0-380" class="i">+  - { key: K,         mods: Alt,       chars: &quot;\x1bk&quot;                       }
</a><a href="#h14-0-381" id="h14-0-381" class="i">+  - { key: L,         mods: Alt,       chars: &quot;\x1bl&quot;                       }
</a><a href="#h14-0-382" id="h14-0-382" class="i">+  - { key: M,         mods: Alt,       chars: &quot;\x1bm&quot;                       }
</a><a href="#h14-0-383" id="h14-0-383" class="i">+  - { key: N,         mods: Alt,       chars: &quot;\x1bn&quot;                       }
</a><a href="#h14-0-384" id="h14-0-384" class="i">+  - { key: O,         mods: Alt,       chars: &quot;\x1bo&quot;                       }
</a><a href="#h14-0-385" id="h14-0-385" class="i">+  - { key: P,         mods: Alt,       chars: &quot;\x1bp&quot;                       }
</a><a href="#h14-0-386" id="h14-0-386" class="i">+  - { key: Q,         mods: Alt,       chars: &quot;\x1bq&quot;                       }
</a><a href="#h14-0-387" id="h14-0-387" class="i">+  - { key: R,         mods: Alt,       chars: &quot;\x1br&quot;                       }
</a><a href="#h14-0-388" id="h14-0-388" class="i">+  - { key: S,         mods: Alt,       chars: &quot;\x1bs&quot;                       }
</a><a href="#h14-0-389" id="h14-0-389" class="i">+  - { key: T,         mods: Alt,       chars: &quot;\x1bt&quot;                       }
</a><a href="#h14-0-390" id="h14-0-390" class="i">+  - { key: U,         mods: Alt,       chars: &quot;\x1bu&quot;                       }
</a><a href="#h14-0-391" id="h14-0-391" class="i">+  - { key: V,         mods: Alt,       chars: &quot;\x1bv&quot;                       }
</a><a href="#h14-0-392" id="h14-0-392" class="i">+  - { key: W,         mods: Alt,       chars: &quot;\x1bw&quot;                       }
</a><a href="#h14-0-393" id="h14-0-393" class="i">+  - { key: X,         mods: Alt,       chars: &quot;\x1bx&quot;                       }
</a><a href="#h14-0-394" id="h14-0-394" class="i">+  - { key: Y,         mods: Alt,       chars: &quot;\x1by&quot;                       }
</a><a href="#h14-0-395" id="h14-0-395" class="i">+  - { key: Z,         mods: Alt,       chars: &quot;\x1bz&quot;                       }
</a><a href="#h14-0-396" id="h14-0-396" class="i">+  - { key: A,         mods: Alt|Shift, chars: &quot;\x1bA&quot;                       }
</a><a href="#h14-0-397" id="h14-0-397" class="i">+  - { key: B,         mods: Alt|Shift, chars: &quot;\x1bB&quot;                       }
</a><a href="#h14-0-398" id="h14-0-398" class="i">+  - { key: C,         mods: Alt|Shift, chars: &quot;\x1bC&quot;                       }
</a><a href="#h14-0-399" id="h14-0-399" class="i">+  - { key: D,         mods: Alt|Shift, chars: &quot;\x1bD&quot;                       }
</a><a href="#h14-0-400" id="h14-0-400" class="i">+  - { key: E,         mods: Alt|Shift, chars: &quot;\x1bE&quot;                       }
</a><a href="#h14-0-401" id="h14-0-401" class="i">+  - { key: F,         mods: Alt|Shift, chars: &quot;\x1bF&quot;                       }
</a><a href="#h14-0-402" id="h14-0-402" class="i">+  - { key: G,         mods: Alt|Shift, chars: &quot;\x1bG&quot;                       }
</a><a href="#h14-0-403" id="h14-0-403" class="i">+  - { key: H,         mods: Alt|Shift, chars: &quot;\x1bH&quot;                       }
</a><a href="#h14-0-404" id="h14-0-404" class="i">+  - { key: I,         mods: Alt|Shift, chars: &quot;\x1bI&quot;                       }
</a><a href="#h14-0-405" id="h14-0-405" class="i">+  - { key: J,         mods: Alt|Shift, chars: &quot;\x1bJ&quot;                       }
</a><a href="#h14-0-406" id="h14-0-406" class="i">+  - { key: K,         mods: Alt|Shift, chars: &quot;\x1bK&quot;                       }
</a><a href="#h14-0-407" id="h14-0-407" class="i">+  - { key: L,         mods: Alt|Shift, chars: &quot;\x1bL&quot;                       }
</a><a href="#h14-0-408" id="h14-0-408" class="i">+  - { key: M,         mods: Alt|Shift, chars: &quot;\x1bM&quot;                       }
</a><a href="#h14-0-409" id="h14-0-409" class="i">+  - { key: N,         mods: Alt|Shift, chars: &quot;\x1bN&quot;                       }
</a><a href="#h14-0-410" id="h14-0-410" class="i">+  - { key: O,         mods: Alt|Shift, chars: &quot;\x1bO&quot;                       }
</a><a href="#h14-0-411" id="h14-0-411" class="i">+  - { key: P,         mods: Alt|Shift, chars: &quot;\x1bP&quot;                       }
</a><a href="#h14-0-412" id="h14-0-412" class="i">+  - { key: Q,         mods: Alt|Shift, chars: &quot;\x1bQ&quot;                       }
</a><a href="#h14-0-413" id="h14-0-413" class="i">+  - { key: R,         mods: Alt|Shift, chars: &quot;\x1bR&quot;                       }
</a><a href="#h14-0-414" id="h14-0-414" class="i">+  - { key: S,         mods: Alt|Shift, chars: &quot;\x1bS&quot;                       }
</a><a href="#h14-0-415" id="h14-0-415" class="i">+  - { key: T,         mods: Alt|Shift, chars: &quot;\x1bT&quot;                       }
</a><a href="#h14-0-416" id="h14-0-416" class="i">+  - { key: U,         mods: Alt|Shift, chars: &quot;\x1bU&quot;                       }
</a><a href="#h14-0-417" id="h14-0-417" class="i">+  - { key: V,         mods: Alt|Shift, chars: &quot;\x1bV&quot;                       }
</a><a href="#h14-0-418" id="h14-0-418" class="i">+  - { key: W,         mods: Alt|Shift, chars: &quot;\x1bW&quot;                       }
</a><a href="#h14-0-419" id="h14-0-419" class="i">+  - { key: X,         mods: Alt|Shift, chars: &quot;\x1bX&quot;                       }
</a><a href="#h14-0-420" id="h14-0-420" class="i">+  - { key: Y,         mods: Alt|Shift, chars: &quot;\x1bY&quot;                       }
</a><a href="#h14-0-421" id="h14-0-421" class="i">+  - { key: Z,         mods: Alt|Shift, chars: &quot;\x1bZ&quot;                       }
</a><a href="#h14-0-422" id="h14-0-422" class="i">+  - { key: Key1,      mods: Alt,       chars: &quot;\x1b1&quot;                       }
</a><a href="#h14-0-423" id="h14-0-423" class="i">+  - { key: Key2,      mods: Alt,       chars: &quot;\x1b2&quot;                       }
</a><a href="#h14-0-424" id="h14-0-424" class="i">+  - { key: Key3,      mods: Alt,       chars: &quot;\x1b3&quot;                       }
</a><a href="#h14-0-425" id="h14-0-425" class="i">+  - { key: Key4,      mods: Alt,       chars: &quot;\x1b4&quot;                       }
</a><a href="#h14-0-426" id="h14-0-426" class="i">+  - { key: Key5,      mods: Alt,       chars: &quot;\x1b5&quot;                       }
</a><a href="#h14-0-427" id="h14-0-427" class="i">+  - { key: Key6,      mods: Alt,       chars: &quot;\x1b6&quot;                       }
</a><a href="#h14-0-428" id="h14-0-428" class="i">+  - { key: Key7,      mods: Alt,       chars: &quot;\x1b7&quot;                       }
</a><a href="#h14-0-429" id="h14-0-429" class="i">+  - { key: Key8,      mods: Alt,       chars: &quot;\x1b8&quot;                       }
</a><a href="#h14-0-430" id="h14-0-430" class="i">+  - { key: Key9,      mods: Alt,       chars: &quot;\x1b9&quot;                       }
</a><a href="#h14-0-431" id="h14-0-431" class="i">+  - { key: Key0,      mods: Alt,       chars: &quot;\x1b0&quot;                       }
</a><a href="#h14-0-432" id="h14-0-432" class="i">+  - { key: Space,     mods: Control,   chars: &quot;\x00&quot;                        } # Ctrl + Space
</a><a href="#h14-0-433" id="h14-0-433" class="i">+  - { key: Grave,     mods: Alt,       chars: &quot;\x1b`&quot;                       } # Alt + `
</a><a href="#h14-0-434" id="h14-0-434" class="i">+  - { key: Grave,     mods: Alt|Shift, chars: &quot;\x1b~&quot;                       } # Alt + ~
</a><a href="#h14-0-435" id="h14-0-435" class="i">+  - { key: Period,    mods: Alt,       chars: &quot;\x1b.&quot;                       } # Alt + .
</a><a href="#h14-0-436" id="h14-0-436" class="i">+  - { key: Key8,      mods: Alt|Shift, chars: &quot;\x1b*&quot;                       } # Alt + *
</a><a href="#h14-0-437" id="h14-0-437" class="i">+  - { key: Key3,      mods: Alt|Shift, chars: &quot;\x1b#&quot;                       } # Alt + #
</a><a href="#h14-0-438" id="h14-0-438" class="i">+  - { key: Period,    mods: Alt|Shift, chars: &quot;\x1b&gt;&quot;                       } # Alt + &gt;
</a><a href="#h14-0-439" id="h14-0-439" class="i">+  - { key: Comma,     mods: Alt|Shift, chars: &quot;\x1b&lt;&quot;                       } # Alt + &lt;
</a><a href="#h14-0-440" id="h14-0-440" class="i">+  - { key: Minus,     mods: Alt|Shift, chars: &quot;\x1b_&quot;                       } # Alt + _
</a><a href="#h14-0-441" id="h14-0-441" class="i">+  - { key: Key5,      mods: Alt|Shift, chars: &quot;\x1b%&quot;                       } # Alt + %
</a><a href="#h14-0-442" id="h14-0-442" class="i">+  - { key: Key6,      mods: Alt|Shift, chars: &quot;\x1b^&quot;                       } # Alt + ^
</a><a href="#h14-0-443" id="h14-0-443" class="i">+  - { key: Backslash, mods: Alt,       chars: &quot;\x1b\\&quot;                      } # Alt + \
</a><a href="#h14-0-444" id="h14-0-444" class="i">+  - { key: Backslash, mods: Alt|Shift, chars: &quot;\x1b|&quot;                       } # Alt + |
</a><a href="#h14-0-445" id="h14-0-445" class="i">+
</a><a href="#h14-0-446" id="h14-0-446" class="i">+  - { key: Period,   mods: Alt,       chars: &quot;\x1b.&quot;                       }
</a><a href="#h14-0-447" id="h14-0-447" class="i">+  - { key: Key8,     mods: Alt|Shift, chars: &quot;\x1b*&quot;                       }
</a><a href="#h14-0-448" id="h14-0-448" class="i">+  - { key: Key3,     mods: Alt|Shift, chars: &quot;\x1b#&quot;                       }
</a><a href="#h14-0-449" id="h14-0-449" class="i">+
</a><a href="#h14-0-450" id="h14-0-450" class="i">+  - { key: Key1,     mods: Alt,     chars: &quot;\x1b1&quot;                       }
</a><a href="#h14-0-451" id="h14-0-451" class="i">+  - { key: Key2,     mods: Alt,     chars: &quot;\x1b2&quot;                       }
</a><a href="#h14-0-452" id="h14-0-452" class="i">+  - { key: Key3,     mods: Alt,     chars: &quot;\x1b3&quot;                       }
</a><a href="#h14-0-453" id="h14-0-453" class="i">+  - { key: Key4,     mods: Alt,     chars: &quot;\x1b4&quot;                       }
</a><a href="#h14-0-454" id="h14-0-454" class="i">+  - { key: Key5,     mods: Alt,     chars: &quot;\x1b5&quot;                       }
</a><a href="#h14-0-455" id="h14-0-455" class="i">+  - { key: Key6,     mods: Alt,     chars: &quot;\x1b6&quot;                       }
</a><a href="#h14-0-456" id="h14-0-456" class="i">+  - { key: Key7,     mods: Alt,     chars: &quot;\x1b7&quot;                       }
</a><a href="#h14-0-457" id="h14-0-457" class="i">+  - { key: Key8,     mods: Alt,     chars: &quot;\x1b8&quot;                       }
</a><a href="#h14-0-458" id="h14-0-458" class="i">+  - { key: Key9,     mods: Alt,     chars: &quot;\x1b9&quot;                       }
</a><a href="#h14-0-459" id="h14-0-459" class="i">+  - { key: Key0,     mods: Alt,     chars: &quot;\x1b0&quot;                       }
</a><b>diff --git a/<a id="h15" href="../file/.config/htop/htoprc.html">.config/htop/htoprc</a> b/<a href="../file/dots/.config/htop/htoprc.html">dots/.config/htop/htoprc</a></b>
<b>diff --git a/<a id="h16" href="../file/dots/.config/i3/config.html">dots/.config/i3/config</a> b/<a href="../file/dots/.config/i3/config.html">dots/.config/i3/config</a></b>
<a href="#h16-0" id="h16-0" class="h">@@ -0,0 +1,223 @@
</a><a href="#h16-0-0" id="h16-0-0" class="i">+# This file has been auto-generated by i3-config-wizard(1).
</a><a href="#h16-0-1" id="h16-0-1" class="i">+# It will not be overwritten, so edit it as you like.
</a><a href="#h16-0-2" id="h16-0-2" class="i">+#
</a><a href="#h16-0-3" id="h16-0-3" class="i">+# Should you change your keyboard layout some time, delete
</a><a href="#h16-0-4" id="h16-0-4" class="i">+# this file and re-run i3-config-wizard(1).
</a><a href="#h16-0-5" id="h16-0-5" class="i">+#
</a><a href="#h16-0-6" id="h16-0-6" class="i">+
</a><a href="#h16-0-7" id="h16-0-7" class="i">+# i3 config file (v4)
</a><a href="#h16-0-8" id="h16-0-8" class="i">+#
</a><a href="#h16-0-9" id="h16-0-9" class="i">+# Please see https://i3wm.org/docs/userguide.html for a complete reference!
</a><a href="#h16-0-10" id="h16-0-10" class="i">+
</a><a href="#h16-0-11" id="h16-0-11" class="i">+set $mod Mod4
</a><a href="#h16-0-12" id="h16-0-12" class="i">+
</a><a href="#h16-0-13" id="h16-0-13" class="i">+# Font for window titles. Will also be used by the bar unless a different font
</a><a href="#h16-0-14" id="h16-0-14" class="i">+# is used in the bar {} block below.
</a><a href="#h16-0-15" id="h16-0-15" class="i">+font pango:monospace 8
</a><a href="#h16-0-16" id="h16-0-16" class="i">+
</a><a href="#h16-0-17" id="h16-0-17" class="i">+# This font is widely installed, provides lots of unicode glyphs, right-to-left
</a><a href="#h16-0-18" id="h16-0-18" class="i">+# text rendering and scalability on retina/hidpi displays (thanks to pango).
</a><a href="#h16-0-19" id="h16-0-19" class="i">+#font pango:DejaVu Sans Mono 8
</a><a href="#h16-0-20" id="h16-0-20" class="i">+
</a><a href="#h16-0-21" id="h16-0-21" class="i">+# Before i3 v4.8, we used to recommend this one as the default:
</a><a href="#h16-0-22" id="h16-0-22" class="i">+# font -misc-fixed-medium-r-normal--13-120-75-75-C-70-iso10646-1
</a><a href="#h16-0-23" id="h16-0-23" class="i">+# The font above is very space-efficient, that is, it looks good, sharp and
</a><a href="#h16-0-24" id="h16-0-24" class="i">+# clear in small sizes. However, its unicode glyph coverage is limited, the old
</a><a href="#h16-0-25" id="h16-0-25" class="i">+# X core fonts rendering does not support right-to-left and this being a bitmap
</a><a href="#h16-0-26" id="h16-0-26" class="i">+# font, it doesn’t scale on retina/hidpi displays.
</a><a href="#h16-0-27" id="h16-0-27" class="i">+
</a><a href="#h16-0-28" id="h16-0-28" class="i">+# Use Mouse+$mod to drag floating windows to their wanted position
</a><a href="#h16-0-29" id="h16-0-29" class="i">+floating_modifier $mod
</a><a href="#h16-0-30" id="h16-0-30" class="i">+
</a><a href="#h16-0-31" id="h16-0-31" class="i">+# start a terminal
</a><a href="#h16-0-32" id="h16-0-32" class="i">+bindsym $mod+Return exec alacritty
</a><a href="#h16-0-33" id="h16-0-33" class="i">+
</a><a href="#h16-0-34" id="h16-0-34" class="i">+# kill focused window
</a><a href="#h16-0-35" id="h16-0-35" class="i">+bindsym $mod+Shift+q kill
</a><a href="#h16-0-36" id="h16-0-36" class="i">+
</a><a href="#h16-0-37" id="h16-0-37" class="i">+# start dmenu (a program launcher)
</a><a href="#h16-0-38" id="h16-0-38" class="i">+bindsym $mod+d exec rofi -show drun
</a><a href="#h16-0-39" id="h16-0-39" class="i">+# There also is the (new) i3-dmenu-desktop which only displays applications
</a><a href="#h16-0-40" id="h16-0-40" class="i">+# shipping a .desktop file. It is a wrapper around dmenu, so you need that
</a><a href="#h16-0-41" id="h16-0-41" class="i">+# installed.
</a><a href="#h16-0-42" id="h16-0-42" class="i">+# bindsym $mod+d exec --no-startup-id i3-dmenu-desktop
</a><a href="#h16-0-43" id="h16-0-43" class="i">+
</a><a href="#h16-0-44" id="h16-0-44" class="i">+# change focus
</a><a href="#h16-0-45" id="h16-0-45" class="i">+bindsym $mod+h focus left
</a><a href="#h16-0-46" id="h16-0-46" class="i">+bindsym $mod+j focus down
</a><a href="#h16-0-47" id="h16-0-47" class="i">+bindsym $mod+k focus up
</a><a href="#h16-0-48" id="h16-0-48" class="i">+bindsym $mod+l focus right
</a><a href="#h16-0-49" id="h16-0-49" class="i">+
</a><a href="#h16-0-50" id="h16-0-50" class="i">+# alternatively, you can use the cursor keys:
</a><a href="#h16-0-51" id="h16-0-51" class="i">+bindsym $mod+Left focus left
</a><a href="#h16-0-52" id="h16-0-52" class="i">+bindsym $mod+Down focus down
</a><a href="#h16-0-53" id="h16-0-53" class="i">+bindsym $mod+Up focus up
</a><a href="#h16-0-54" id="h16-0-54" class="i">+bindsym $mod+Right focus right
</a><a href="#h16-0-55" id="h16-0-55" class="i">+
</a><a href="#h16-0-56" id="h16-0-56" class="i">+# Pulse Audio controls
</a><a href="#h16-0-57" id="h16-0-57" class="i">+bindsym $mod+u exec --no-startup-id pulseaudio-ctl up 5
</a><a href="#h16-0-58" id="h16-0-58" class="i">+bindsym $mod+i exec --no-startup-id pulseaudio-ctl down 5
</a><a href="#h16-0-59" id="h16-0-59" class="i">+bindsym $mod+o exec --no-startup-id pulseaudio-ctl mute
</a><a href="#h16-0-60" id="h16-0-60" class="i">+bindsym $mod+p exec --no-startup-id pulseaudio-ctl
</a><a href="#h16-0-61" id="h16-0-61" class="i">+
</a><a href="#h16-0-62" id="h16-0-62" class="i">+# lock screen
</a><a href="#h16-0-63" id="h16-0-63" class="i">+bindsym $mod+Escape exec --no-startup-id lock
</a><a href="#h16-0-64" id="h16-0-64" class="i">+
</a><a href="#h16-0-65" id="h16-0-65" class="i">+# move focused window
</a><a href="#h16-0-66" id="h16-0-66" class="i">+bindsym $mod+Shift+h move left
</a><a href="#h16-0-67" id="h16-0-67" class="i">+bindsym $mod+Shift+j move down
</a><a href="#h16-0-68" id="h16-0-68" class="i">+bindsym $mod+Shift+k move up
</a><a href="#h16-0-69" id="h16-0-69" class="i">+bindsym $mod+Shift+l move right
</a><a href="#h16-0-70" id="h16-0-70" class="i">+
</a><a href="#h16-0-71" id="h16-0-71" class="i">+# alternatively, you can use the cursor keys:
</a><a href="#h16-0-72" id="h16-0-72" class="i">+bindsym $mod+Shift+Left move left
</a><a href="#h16-0-73" id="h16-0-73" class="i">+bindsym $mod+Shift+Down move down
</a><a href="#h16-0-74" id="h16-0-74" class="i">+bindsym $mod+Shift+Up move up
</a><a href="#h16-0-75" id="h16-0-75" class="i">+bindsym $mod+Shift+Right move right
</a><a href="#h16-0-76" id="h16-0-76" class="i">+
</a><a href="#h16-0-77" id="h16-0-77" class="i">+# split in horizontal orientation
</a><a href="#h16-0-78" id="h16-0-78" class="i">+bindsym $mod+t split h
</a><a href="#h16-0-79" id="h16-0-79" class="i">+
</a><a href="#h16-0-80" id="h16-0-80" class="i">+# split in vertical orientation
</a><a href="#h16-0-81" id="h16-0-81" class="i">+bindsym $mod+v split v
</a><a href="#h16-0-82" id="h16-0-82" class="i">+
</a><a href="#h16-0-83" id="h16-0-83" class="i">+# enter fullscreen mode for the focused container
</a><a href="#h16-0-84" id="h16-0-84" class="i">+bindsym $mod+f fullscreen toggle
</a><a href="#h16-0-85" id="h16-0-85" class="i">+
</a><a href="#h16-0-86" id="h16-0-86" class="i">+# change container layout (stacked, tabbed, toggle split)
</a><a href="#h16-0-87" id="h16-0-87" class="i">+bindsym $mod+s layout stacking
</a><a href="#h16-0-88" id="h16-0-88" class="i">+bindsym $mod+w layout tabbed
</a><a href="#h16-0-89" id="h16-0-89" class="i">+bindsym $mod+e layout toggle split
</a><a href="#h16-0-90" id="h16-0-90" class="i">+
</a><a href="#h16-0-91" id="h16-0-91" class="i">+# toggle tiling / floating
</a><a href="#h16-0-92" id="h16-0-92" class="i">+bindsym $mod+Shift+space floating toggle
</a><a href="#h16-0-93" id="h16-0-93" class="i">+
</a><a href="#h16-0-94" id="h16-0-94" class="i">+# change focus between tiling / floating windows
</a><a href="#h16-0-95" id="h16-0-95" class="i">+bindsym $mod+space focus mode_toggle
</a><a href="#h16-0-96" id="h16-0-96" class="i">+
</a><a href="#h16-0-97" id="h16-0-97" class="i">+# focus the parent container
</a><a href="#h16-0-98" id="h16-0-98" class="i">+bindsym $mod+a focus parent
</a><a href="#h16-0-99" id="h16-0-99" class="i">+
</a><a href="#h16-0-100" id="h16-0-100" class="i">+# focus the child container
</a><a href="#h16-0-101" id="h16-0-101" class="i">+#bindsym $mod+d focus child
</a><a href="#h16-0-102" id="h16-0-102" class="i">+
</a><a href="#h16-0-103" id="h16-0-103" class="i">+# Define names for default workspaces for which we configure key bindings later on.
</a><a href="#h16-0-104" id="h16-0-104" class="i">+# We use variables to avoid repeating the names in multiple places.
</a><a href="#h16-0-105" id="h16-0-105" class="i">+set $ws1 &quot;1&quot;
</a><a href="#h16-0-106" id="h16-0-106" class="i">+set $ws2 &quot;2&quot;
</a><a href="#h16-0-107" id="h16-0-107" class="i">+set $ws3 &quot;3&quot;
</a><a href="#h16-0-108" id="h16-0-108" class="i">+set $ws4 &quot;4&quot;
</a><a href="#h16-0-109" id="h16-0-109" class="i">+set $ws5 &quot;5&quot;
</a><a href="#h16-0-110" id="h16-0-110" class="i">+set $ws6 &quot;6&quot;
</a><a href="#h16-0-111" id="h16-0-111" class="i">+set $ws7 &quot;7&quot;
</a><a href="#h16-0-112" id="h16-0-112" class="i">+set $ws8 &quot;8&quot;
</a><a href="#h16-0-113" id="h16-0-113" class="i">+set $ws9 &quot;9&quot;
</a><a href="#h16-0-114" id="h16-0-114" class="i">+set $ws10 &quot;10&quot;
</a><a href="#h16-0-115" id="h16-0-115" class="i">+
</a><a href="#h16-0-116" id="h16-0-116" class="i">+# switch to workspace
</a><a href="#h16-0-117" id="h16-0-117" class="i">+bindsym $mod+1 workspace $ws1
</a><a href="#h16-0-118" id="h16-0-118" class="i">+bindsym $mod+2 workspace $ws2
</a><a href="#h16-0-119" id="h16-0-119" class="i">+bindsym $mod+3 workspace $ws3
</a><a href="#h16-0-120" id="h16-0-120" class="i">+bindsym $mod+4 workspace $ws4
</a><a href="#h16-0-121" id="h16-0-121" class="i">+bindsym $mod+5 workspace $ws5
</a><a href="#h16-0-122" id="h16-0-122" class="i">+bindsym $mod+6 workspace $ws6
</a><a href="#h16-0-123" id="h16-0-123" class="i">+bindsym $mod+7 workspace $ws7
</a><a href="#h16-0-124" id="h16-0-124" class="i">+bindsym $mod+8 workspace $ws8
</a><a href="#h16-0-125" id="h16-0-125" class="i">+bindsym $mod+9 workspace $ws9
</a><a href="#h16-0-126" id="h16-0-126" class="i">+bindsym $mod+0 workspace $ws10
</a><a href="#h16-0-127" id="h16-0-127" class="i">+
</a><a href="#h16-0-128" id="h16-0-128" class="i">+# move focused container to workspace
</a><a href="#h16-0-129" id="h16-0-129" class="i">+bindsym $mod+Shift+1 move container to workspace $ws1
</a><a href="#h16-0-130" id="h16-0-130" class="i">+bindsym $mod+Shift+2 move container to workspace $ws2
</a><a href="#h16-0-131" id="h16-0-131" class="i">+bindsym $mod+Shift+3 move container to workspace $ws3
</a><a href="#h16-0-132" id="h16-0-132" class="i">+bindsym $mod+Shift+4 move container to workspace $ws4
</a><a href="#h16-0-133" id="h16-0-133" class="i">+bindsym $mod+Shift+5 move container to workspace $ws5
</a><a href="#h16-0-134" id="h16-0-134" class="i">+bindsym $mod+Shift+6 move container to workspace $ws6
</a><a href="#h16-0-135" id="h16-0-135" class="i">+bindsym $mod+Shift+7 move container to workspace $ws7
</a><a href="#h16-0-136" id="h16-0-136" class="i">+bindsym $mod+Shift+8 move container to workspace $ws8
</a><a href="#h16-0-137" id="h16-0-137" class="i">+bindsym $mod+Shift+9 move container to workspace $ws9
</a><a href="#h16-0-138" id="h16-0-138" class="i">+bindsym $mod+Shift+0 move container to workspace $ws10
</a><a href="#h16-0-139" id="h16-0-139" class="i">+
</a><a href="#h16-0-140" id="h16-0-140" class="i">+# reload the configuration file
</a><a href="#h16-0-141" id="h16-0-141" class="i">+bindsym $mod+Shift+c reload
</a><a href="#h16-0-142" id="h16-0-142" class="i">+# restart i3 inplace (preserves your layout/session, can be used to upgrade i3)
</a><a href="#h16-0-143" id="h16-0-143" class="i">+bindsym $mod+Shift+r restart
</a><a href="#h16-0-144" id="h16-0-144" class="i">+# exit i3 (logs you out of your X session)
</a><a href="#h16-0-145" id="h16-0-145" class="i">+bindsym $mod+Shift+e exec &quot;i3-nagbar -t warning -m &#39;You pressed the exit shortcut. Do you really want to exit i3? This will end your X session.&#39; -b &#39;Yes, exit i3&#39; &#39;i3-msg exit&#39;&quot;
</a><a href="#h16-0-146" id="h16-0-146" class="i">+
</a><a href="#h16-0-147" id="h16-0-147" class="i">+# resize window (you can also use the mouse for that)
</a><a href="#h16-0-148" id="h16-0-148" class="i">+mode &quot;resize&quot; {
</a><a href="#h16-0-149" id="h16-0-149" class="i">+        bindsym j resize shrink width 10 px or 10 ppt
</a><a href="#h16-0-150" id="h16-0-150" class="i">+        bindsym k resize grow height 10 px or 10 ppt
</a><a href="#h16-0-151" id="h16-0-151" class="i">+        bindsym l resize shrink height 10 px or 10 ppt
</a><a href="#h16-0-152" id="h16-0-152" class="i">+        bindsym semicolon resize grow width 10 px or 10 ppt
</a><a href="#h16-0-153" id="h16-0-153" class="i">+
</a><a href="#h16-0-154" id="h16-0-154" class="i">+        bindsym Left resize shrink width 10 px or 10 ppt
</a><a href="#h16-0-155" id="h16-0-155" class="i">+        bindsym Down resize grow height 10 px or 10 ppt
</a><a href="#h16-0-156" id="h16-0-156" class="i">+        bindsym Up resize shrink height 10 px or 10 ppt
</a><a href="#h16-0-157" id="h16-0-157" class="i">+        bindsym Right resize grow width 10 px or 10 ppt
</a><a href="#h16-0-158" id="h16-0-158" class="i">+
</a><a href="#h16-0-159" id="h16-0-159" class="i">+        bindsym Return mode &quot;default&quot;
</a><a href="#h16-0-160" id="h16-0-160" class="i">+        bindsym Escape mode &quot;default&quot;
</a><a href="#h16-0-161" id="h16-0-161" class="i">+        bindsym $mod+r mode &quot;default&quot;
</a><a href="#h16-0-162" id="h16-0-162" class="i">+}
</a><a href="#h16-0-163" id="h16-0-163" class="i">+
</a><a href="#h16-0-164" id="h16-0-164" class="i">+bindsym $mod+r mode &quot;resize&quot;
</a><a href="#h16-0-165" id="h16-0-165" class="i">+
</a><a href="#h16-0-166" id="h16-0-166" class="i">+#######
</a><a href="#h16-0-167" id="h16-0-167" class="i">+#THEME#
</a><a href="#h16-0-168" id="h16-0-168" class="i">+#######
</a><a href="#h16-0-169" id="h16-0-169" class="i">+
</a><a href="#h16-0-170" id="h16-0-170" class="i">+# set primary gruvbox colorscheme colors
</a><a href="#h16-0-171" id="h16-0-171" class="i">+set $bg #282828
</a><a href="#h16-0-172" id="h16-0-172" class="i">+set $red #cc241d
</a><a href="#h16-0-173" id="h16-0-173" class="i">+set $green #98971a
</a><a href="#h16-0-174" id="h16-0-174" class="i">+set $yellow #d79921
</a><a href="#h16-0-175" id="h16-0-175" class="i">+set $blue #458588
</a><a href="#h16-0-176" id="h16-0-176" class="i">+set $purple #b16286
</a><a href="#h16-0-177" id="h16-0-177" class="i">+set $aqua #689d68
</a><a href="#h16-0-178" id="h16-0-178" class="i">+set $gray #a89984
</a><a href="#h16-0-179" id="h16-0-179" class="i">+set $darkgray #1d2021
</a><a href="#h16-0-180" id="h16-0-180" class="i">+
</a><a href="#h16-0-181" id="h16-0-181" class="i">+# font used by i3 for titles and bars
</a><a href="#h16-0-182" id="h16-0-182" class="i">+font pango:Fira Mono 6
</a><a href="#h16-0-183" id="h16-0-183" class="i">+
</a><a href="#h16-0-184" id="h16-0-184" class="i">+# Start i3bar to display a workspace bar (plus the system information i3status
</a><a href="#h16-0-185" id="h16-0-185" class="i">+# finds out, if available)
</a><a href="#h16-0-186" id="h16-0-186" class="i">+bar {
</a><a href="#h16-0-187" id="h16-0-187" class="i">+        status_command i3status
</a><a href="#h16-0-188" id="h16-0-188" class="i">+	mode           hide
</a><a href="#h16-0-189" id="h16-0-189" class="i">+	colors {
</a><a href="#h16-0-190" id="h16-0-190" class="i">+		background $bg
</a><a href="#h16-0-191" id="h16-0-191" class="i">+		statusline $yellow
</a><a href="#h16-0-192" id="h16-0-192" class="i">+		# workspaces section            
</a><a href="#h16-0-193" id="h16-0-193" class="i">+		#                    border  backgr. text
</a><a href="#h16-0-194" id="h16-0-194" class="i">+		focused_workspace    $aqua     $aqua     $darkgray
</a><a href="#h16-0-195" id="h16-0-195" class="i">+		inactive_workspace   $darkgray $darkgray $yellow
</a><a href="#h16-0-196" id="h16-0-196" class="i">+		active_workspace     $darkgray $darkgray $yellow
</a><a href="#h16-0-197" id="h16-0-197" class="i">+		urgent_workspace     $red      $red      $bg
</a><a href="#h16-0-198" id="h16-0-198" class="i">+	}
</a><a href="#h16-0-199" id="h16-0-199" class="i">+}
</a><a href="#h16-0-200" id="h16-0-200" class="i">+
</a><a href="#h16-0-201" id="h16-0-201" class="i">+
</a><a href="#h16-0-202" id="h16-0-202" class="i">+# green gruvbox
</a><a href="#h16-0-203" id="h16-0-203" class="i">+# class                 border|backgr|text|indicator|child_border
</a><a href="#h16-0-204" id="h16-0-204" class="i">+#client.focused          $green $green $darkgray $purple $darkgray
</a><a href="#h16-0-205" id="h16-0-205" class="i">+#client.focused_inactive $darkgray $darkgray $yellow $purple $darkgray
</a><a href="#h16-0-206" id="h16-0-206" class="i">+#client.unfocused        $darkgray $darkgray $yellow $purple $darkgray
</a><a href="#h16-0-207" id="h16-0-207" class="i">+#client.urgent           $red $red $white $red $red
</a><a href="#h16-0-208" id="h16-0-208" class="i">+
</a><a href="#h16-0-209" id="h16-0-209" class="i">+# blue gruvbox
</a><a href="#h16-0-210" id="h16-0-210" class="i">+# class                 border    backgr    text      indicator child_border
</a><a href="#h16-0-211" id="h16-0-211" class="i">+client.focused          $blue 	  $blue     $darkgray $bg       $bg
</a><a href="#h16-0-212" id="h16-0-212" class="i">+client.focused_inactive $darkgrey $darkgray $yellow   $bg       $darkgray
</a><a href="#h16-0-213" id="h16-0-213" class="i">+client.unfocused        $darkgray $darkgray $yellow   $bg       $darkgray
</a><a href="#h16-0-214" id="h16-0-214" class="i">+client.urgent           $red      $red      $white    $red      $red
</a><a href="#h16-0-215" id="h16-0-215" class="i">+
</a><a href="#h16-0-216" id="h16-0-216" class="i">+new_window pixel 5
</a><a href="#h16-0-217" id="h16-0-217" class="i">+
</a><a href="#h16-0-218" id="h16-0-218" class="i">+exec xrandr --dpi 296
</a><a href="#h16-0-219" id="h16-0-219" class="i">+exec /usr/libexec/gnome-settings-daemon
</a><a href="#h16-0-220" id="h16-0-220" class="i">+exec xsetroot -solid &quot;#1d2021&quot;
</a><a href="#h16-0-221" id="h16-0-221" class="i">+exec xinput set-prop 12 288 1    # Tap to Click
</a><a href="#h16-0-222" id="h16-0-222" class="i">+exec xinput set-prop 12 290 1    # Natural Scrolling
</a><b>diff --git a/<a id="h17" href="../file/dots/.config/i3status/config.html">dots/.config/i3status/config</a> b/<a href="../file/dots/.config/i3status/config.html">dots/.config/i3status/config</a></b>
<a href="#h17-0" id="h17-0" class="h">@@ -0,0 +1,45 @@
</a><a href="#h17-0-0" id="h17-0-0" class="i">+# i3status configuration file.
</a><a href="#h17-0-1" id="h17-0-1" class="i">+# see &quot;man i3status&quot; for documentation.
</a><a href="#h17-0-2" id="h17-0-2" class="i">+
</a><a href="#h17-0-3" id="h17-0-3" class="i">+# It is important that this file is edited as UTF-8.
</a><a href="#h17-0-4" id="h17-0-4" class="i">+# The following line should contain a sharp s:
</a><a href="#h17-0-5" id="h17-0-5" class="i">+# ß
</a><a href="#h17-0-6" id="h17-0-6" class="i">+# If the above line is not correctly displayed, fix your editor first!
</a><a href="#h17-0-7" id="h17-0-7" class="i">+
</a><a href="#h17-0-8" id="h17-0-8" class="i">+general {
</a><a href="#h17-0-9" id="h17-0-9" class="i">+  output_format = &quot;i3bar&quot;
</a><a href="#h17-0-10" id="h17-0-10" class="i">+  colors = true
</a><a href="#h17-0-11" id="h17-0-11" class="i">+  color_good = &quot;#00FF00&quot;
</a><a href="#h17-0-12" id="h17-0-12" class="i">+  color_degraded = &quot;#FFFF00&quot;
</a><a href="#h17-0-13" id="h17-0-13" class="i">+  color_bad = &quot;#FF0000&quot;
</a><a href="#h17-0-14" id="h17-0-14" class="i">+}
</a><a href="#h17-0-15" id="h17-0-15" class="i">+
</a><a href="#h17-0-16" id="h17-0-16" class="i">+order += &quot;battery all&quot;
</a><a href="#h17-0-17" id="h17-0-17" class="i">+order += &quot;tztime local&quot;
</a><a href="#h17-0-18" id="h17-0-18" class="i">+
</a><a href="#h17-0-19" id="h17-0-19" class="i">+wireless _first_ {
</a><a href="#h17-0-20" id="h17-0-20" class="i">+        format_up = &quot;W: (%quality at %essid) %ip&quot;
</a><a href="#h17-0-21" id="h17-0-21" class="i">+        format_down = &quot;W: down&quot;
</a><a href="#h17-0-22" id="h17-0-22" class="i">+}
</a><a href="#h17-0-23" id="h17-0-23" class="i">+
</a><a href="#h17-0-24" id="h17-0-24" class="i">+ethernet _first_ {
</a><a href="#h17-0-25" id="h17-0-25" class="i">+        # if you use %speed, i3status requires root privileges
</a><a href="#h17-0-26" id="h17-0-26" class="i">+        format_up = &quot;E: %ip (%speed)&quot;
</a><a href="#h17-0-27" id="h17-0-27" class="i">+        format_down = &quot;E: down&quot;
</a><a href="#h17-0-28" id="h17-0-28" class="i">+}
</a><a href="#h17-0-29" id="h17-0-29" class="i">+
</a><a href="#h17-0-30" id="h17-0-30" class="i">+battery all {
</a><a href="#h17-0-31" id="h17-0-31" class="i">+        format = &quot;%status %percentage %remaining&quot;
</a><a href="#h17-0-32" id="h17-0-32" class="i">+}
</a><a href="#h17-0-33" id="h17-0-33" class="i">+
</a><a href="#h17-0-34" id="h17-0-34" class="i">+tztime local {
</a><a href="#h17-0-35" id="h17-0-35" class="i">+        format = &quot;%Y-%m-%d %H:%M:%S&quot;
</a><a href="#h17-0-36" id="h17-0-36" class="i">+}
</a><a href="#h17-0-37" id="h17-0-37" class="i">+
</a><a href="#h17-0-38" id="h17-0-38" class="i">+load {
</a><a href="#h17-0-39" id="h17-0-39" class="i">+        format = &quot;%1min&quot;
</a><a href="#h17-0-40" id="h17-0-40" class="i">+}
</a><a href="#h17-0-41" id="h17-0-41" class="i">+
</a><a href="#h17-0-42" id="h17-0-42" class="i">+disk &quot;/&quot; {
</a><a href="#h17-0-43" id="h17-0-43" class="i">+        format = &quot;%avail&quot;
</a><a href="#h17-0-44" id="h17-0-44" class="i">+}
</a><b>diff --git a/<a id="h18" href="../file/.config/mpd/mpd.conf.html">.config/mpd/mpd.conf</a> b/<a href="../file/dots/.config/mpd/mpd.conf.html">dots/.config/mpd/mpd.conf</a></b>
<b>diff --git a/<a id="h19" href="../file/.config/ncmpcpp/bindings.html">.config/ncmpcpp/bindings</a> b/<a href="../file/dots/.config/ncmpcpp/bindings.html">dots/.config/ncmpcpp/bindings</a></b>
<b>diff --git a/<a id="h20" href="../file/.config/ncmpcpp/config.html">.config/ncmpcpp/config</a> b/<a href="../file/dots/.config/ncmpcpp/config.html">dots/.config/ncmpcpp/config</a></b>
<b>diff --git a/<a id="h21" href="../file/.config/neofetch/config.conf.html">.config/neofetch/config.conf</a> b/<a href="../file/dots/.config/neofetch/config.conf.html">dots/.config/neofetch/config.conf</a></b>
<b>diff --git a/<a id="h22" href="../file/.config/notmuch/config.html">.config/notmuch/config</a> b/<a href="../file/dots/.config/notmuch/config.html">dots/.config/notmuch/config</a></b>
<b>diff --git a/<a id="h23" href="../file/.config/zsh/.zcompdump.html">.config/zsh/.zcompdump</a> b/<a href="../file/dots/.config/zsh/.zcompdump.html">dots/.config/zsh/.zcompdump</a></b>
<b>diff --git a/<a id="h24" href="../file/.config/zsh/.zsh-update.html">.config/zsh/.zsh-update</a> b/<a href="../file/dots/.config/zsh/.zsh-update.html">dots/.config/zsh/.zsh-update</a></b>
<b>diff --git a/<a id="h25" href="../file/.config/zsh/oh-my-zsh.sh.html">.config/zsh/oh-my-zsh.sh</a> b/<a href="../file/dots/.config/zsh/oh-my-zsh.sh.html">dots/.config/zsh/oh-my-zsh.sh</a></b>
<b>diff --git a/<a id="h26" href="../file/.tmux.conf.html">.tmux.conf</a> b/<a href="../file/dots/.tmux.conf.html">dots/.tmux.conf</a></b>
<b>diff --git a/<a id="h27" href="../file/dots/.vim/autoload/plug.vim.html">dots/.vim/autoload/plug.vim</a> b/<a href="../file/dots/.vim/autoload/plug.vim.html">dots/.vim/autoload/plug.vim</a></b>
<a href="#h27-0" id="h27-0" class="h">@@ -0,0 +1,2526 @@
</a><a href="#h27-0-0" id="h27-0-0" class="i">+&quot; vim-plug: Vim plugin manager
</a><a href="#h27-0-1" id="h27-0-1" class="i">+&quot; ============================
</a><a href="#h27-0-2" id="h27-0-2" class="i">+&quot;
</a><a href="#h27-0-3" id="h27-0-3" class="i">+&quot; Download plug.vim and put it in ~/.vim/autoload
</a><a href="#h27-0-4" id="h27-0-4" class="i">+&quot;
</a><a href="#h27-0-5" id="h27-0-5" class="i">+&quot;   curl -fLo ~/.vim/autoload/plug.vim --create-dirs \
</a><a href="#h27-0-6" id="h27-0-6" class="i">+&quot;     https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
</a><a href="#h27-0-7" id="h27-0-7" class="i">+&quot;
</a><a href="#h27-0-8" id="h27-0-8" class="i">+&quot; Edit your .vimrc
</a><a href="#h27-0-9" id="h27-0-9" class="i">+&quot;
</a><a href="#h27-0-10" id="h27-0-10" class="i">+&quot;   call plug#begin(&#39;~/.vim/plugged&#39;)
</a><a href="#h27-0-11" id="h27-0-11" class="i">+&quot;
</a><a href="#h27-0-12" id="h27-0-12" class="i">+&quot;   &quot; Make sure you use single quotes
</a><a href="#h27-0-13" id="h27-0-13" class="i">+&quot;
</a><a href="#h27-0-14" id="h27-0-14" class="i">+&quot;   &quot; Shorthand notation; fetches https://github.com/junegunn/vim-easy-align
</a><a href="#h27-0-15" id="h27-0-15" class="i">+&quot;   Plug &#39;junegunn/vim-easy-align&#39;
</a><a href="#h27-0-16" id="h27-0-16" class="i">+&quot;
</a><a href="#h27-0-17" id="h27-0-17" class="i">+&quot;   &quot; Any valid git URL is allowed
</a><a href="#h27-0-18" id="h27-0-18" class="i">+&quot;   Plug &#39;https://github.com/junegunn/vim-github-dashboard.git&#39;
</a><a href="#h27-0-19" id="h27-0-19" class="i">+&quot;
</a><a href="#h27-0-20" id="h27-0-20" class="i">+&quot;   &quot; Multiple Plug commands can be written in a single line using | separators
</a><a href="#h27-0-21" id="h27-0-21" class="i">+&quot;   Plug &#39;SirVer/ultisnips&#39; | Plug &#39;honza/vim-snippets&#39;
</a><a href="#h27-0-22" id="h27-0-22" class="i">+&quot;
</a><a href="#h27-0-23" id="h27-0-23" class="i">+&quot;   &quot; On-demand loading
</a><a href="#h27-0-24" id="h27-0-24" class="i">+&quot;   Plug &#39;scrooloose/nerdtree&#39;, { &#39;on&#39;:  &#39;NERDTreeToggle&#39; }
</a><a href="#h27-0-25" id="h27-0-25" class="i">+&quot;   Plug &#39;tpope/vim-fireplace&#39;, { &#39;for&#39;: &#39;clojure&#39; }
</a><a href="#h27-0-26" id="h27-0-26" class="i">+&quot;
</a><a href="#h27-0-27" id="h27-0-27" class="i">+&quot;   &quot; Using a non-master branch
</a><a href="#h27-0-28" id="h27-0-28" class="i">+&quot;   Plug &#39;rdnetto/YCM-Generator&#39;, { &#39;branch&#39;: &#39;stable&#39; }
</a><a href="#h27-0-29" id="h27-0-29" class="i">+&quot;
</a><a href="#h27-0-30" id="h27-0-30" class="i">+&quot;   &quot; Using a tagged release; wildcard allowed (requires git 1.9.2 or above)
</a><a href="#h27-0-31" id="h27-0-31" class="i">+&quot;   Plug &#39;fatih/vim-go&#39;, { &#39;tag&#39;: &#39;*&#39; }
</a><a href="#h27-0-32" id="h27-0-32" class="i">+&quot;
</a><a href="#h27-0-33" id="h27-0-33" class="i">+&quot;   &quot; Plugin options
</a><a href="#h27-0-34" id="h27-0-34" class="i">+&quot;   Plug &#39;nsf/gocode&#39;, { &#39;tag&#39;: &#39;v.20150303&#39;, &#39;rtp&#39;: &#39;vim&#39; }
</a><a href="#h27-0-35" id="h27-0-35" class="i">+&quot;
</a><a href="#h27-0-36" id="h27-0-36" class="i">+&quot;   &quot; Plugin outside ~/.vim/plugged with post-update hook
</a><a href="#h27-0-37" id="h27-0-37" class="i">+&quot;   Plug &#39;junegunn/fzf&#39;, { &#39;dir&#39;: &#39;~/.fzf&#39;, &#39;do&#39;: &#39;./install --all&#39; }
</a><a href="#h27-0-38" id="h27-0-38" class="i">+&quot;
</a><a href="#h27-0-39" id="h27-0-39" class="i">+&quot;   &quot; Unmanaged plugin (manually installed and updated)
</a><a href="#h27-0-40" id="h27-0-40" class="i">+&quot;   Plug &#39;~/my-prototype-plugin&#39;
</a><a href="#h27-0-41" id="h27-0-41" class="i">+&quot;
</a><a href="#h27-0-42" id="h27-0-42" class="i">+&quot;   &quot; Initialize plugin system
</a><a href="#h27-0-43" id="h27-0-43" class="i">+&quot;   call plug#end()
</a><a href="#h27-0-44" id="h27-0-44" class="i">+&quot;
</a><a href="#h27-0-45" id="h27-0-45" class="i">+&quot; Then reload .vimrc and :PlugInstall to install plugins.
</a><a href="#h27-0-46" id="h27-0-46" class="i">+&quot;
</a><a href="#h27-0-47" id="h27-0-47" class="i">+&quot; Plug options:
</a><a href="#h27-0-48" id="h27-0-48" class="i">+&quot;
</a><a href="#h27-0-49" id="h27-0-49" class="i">+&quot;| Option                  | Description                                      |
</a><a href="#h27-0-50" id="h27-0-50" class="i">+&quot;| ----------------------- | ------------------------------------------------ |
</a><a href="#h27-0-51" id="h27-0-51" class="i">+&quot;| `branch`/`tag`/`commit` | Branch/tag/commit of the repository to use       |
</a><a href="#h27-0-52" id="h27-0-52" class="i">+&quot;| `rtp`                   | Subdirectory that contains Vim plugin            |
</a><a href="#h27-0-53" id="h27-0-53" class="i">+&quot;| `dir`                   | Custom directory for the plugin                  |
</a><a href="#h27-0-54" id="h27-0-54" class="i">+&quot;| `as`                    | Use different name for the plugin                |
</a><a href="#h27-0-55" id="h27-0-55" class="i">+&quot;| `do`                    | Post-update hook (string or funcref)             |
</a><a href="#h27-0-56" id="h27-0-56" class="i">+&quot;| `on`                    | On-demand loading: Commands or `&lt;Plug&gt;`-mappings |
</a><a href="#h27-0-57" id="h27-0-57" class="i">+&quot;| `for`                   | On-demand loading: File types                    |
</a><a href="#h27-0-58" id="h27-0-58" class="i">+&quot;| `frozen`                | Do not update unless explicitly specified        |
</a><a href="#h27-0-59" id="h27-0-59" class="i">+&quot;
</a><a href="#h27-0-60" id="h27-0-60" class="i">+&quot; More information: https://github.com/junegunn/vim-plug
</a><a href="#h27-0-61" id="h27-0-61" class="i">+&quot;
</a><a href="#h27-0-62" id="h27-0-62" class="i">+&quot;
</a><a href="#h27-0-63" id="h27-0-63" class="i">+&quot; Copyright (c) 2017 Junegunn Choi
</a><a href="#h27-0-64" id="h27-0-64" class="i">+&quot;
</a><a href="#h27-0-65" id="h27-0-65" class="i">+&quot; MIT License
</a><a href="#h27-0-66" id="h27-0-66" class="i">+&quot;
</a><a href="#h27-0-67" id="h27-0-67" class="i">+&quot; Permission is hereby granted, free of charge, to any person obtaining
</a><a href="#h27-0-68" id="h27-0-68" class="i">+&quot; a copy of this software and associated documentation files (the
</a><a href="#h27-0-69" id="h27-0-69" class="i">+&quot; &quot;Software&quot;), to deal in the Software without restriction, including
</a><a href="#h27-0-70" id="h27-0-70" class="i">+&quot; without limitation the rights to use, copy, modify, merge, publish,
</a><a href="#h27-0-71" id="h27-0-71" class="i">+&quot; distribute, sublicense, and/or sell copies of the Software, and to
</a><a href="#h27-0-72" id="h27-0-72" class="i">+&quot; permit persons to whom the Software is furnished to do so, subject to
</a><a href="#h27-0-73" id="h27-0-73" class="i">+&quot; the following conditions:
</a><a href="#h27-0-74" id="h27-0-74" class="i">+&quot;
</a><a href="#h27-0-75" id="h27-0-75" class="i">+&quot; The above copyright notice and this permission notice shall be
</a><a href="#h27-0-76" id="h27-0-76" class="i">+&quot; included in all copies or substantial portions of the Software.
</a><a href="#h27-0-77" id="h27-0-77" class="i">+&quot;
</a><a href="#h27-0-78" id="h27-0-78" class="i">+&quot; THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
</a><a href="#h27-0-79" id="h27-0-79" class="i">+&quot; EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
</a><a href="#h27-0-80" id="h27-0-80" class="i">+&quot; MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
</a><a href="#h27-0-81" id="h27-0-81" class="i">+&quot; NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
</a><a href="#h27-0-82" id="h27-0-82" class="i">+&quot; LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
</a><a href="#h27-0-83" id="h27-0-83" class="i">+&quot; OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
</a><a href="#h27-0-84" id="h27-0-84" class="i">+&quot; WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
</a><a href="#h27-0-85" id="h27-0-85" class="i">+
</a><a href="#h27-0-86" id="h27-0-86" class="i">+if exists(&#39;g:loaded_plug&#39;)
</a><a href="#h27-0-87" id="h27-0-87" class="i">+  finish
</a><a href="#h27-0-88" id="h27-0-88" class="i">+endif
</a><a href="#h27-0-89" id="h27-0-89" class="i">+let g:loaded_plug = 1
</a><a href="#h27-0-90" id="h27-0-90" class="i">+
</a><a href="#h27-0-91" id="h27-0-91" class="i">+let s:cpo_save = &amp;cpo
</a><a href="#h27-0-92" id="h27-0-92" class="i">+set cpo&amp;vim
</a><a href="#h27-0-93" id="h27-0-93" class="i">+
</a><a href="#h27-0-94" id="h27-0-94" class="i">+let s:plug_src = &#39;https://github.com/junegunn/vim-plug.git&#39;
</a><a href="#h27-0-95" id="h27-0-95" class="i">+let s:plug_tab = get(s:, &#39;plug_tab&#39;, -1)
</a><a href="#h27-0-96" id="h27-0-96" class="i">+let s:plug_buf = get(s:, &#39;plug_buf&#39;, -1)
</a><a href="#h27-0-97" id="h27-0-97" class="i">+let s:mac_gui = has(&#39;gui_macvim&#39;) &amp;&amp; has(&#39;gui_running&#39;)
</a><a href="#h27-0-98" id="h27-0-98" class="i">+let s:is_win = has(&#39;win32&#39;)
</a><a href="#h27-0-99" id="h27-0-99" class="i">+let s:nvim = has(&#39;nvim-0.2&#39;) || (has(&#39;nvim&#39;) &amp;&amp; exists(&#39;*jobwait&#39;) &amp;&amp; !s:is_win)
</a><a href="#h27-0-100" id="h27-0-100" class="i">+let s:vim8 = has(&#39;patch-8.0.0039&#39;) &amp;&amp; exists(&#39;*job_start&#39;)
</a><a href="#h27-0-101" id="h27-0-101" class="i">+let s:me = resolve(expand(&#39;&lt;sfile&gt;:p&#39;))
</a><a href="#h27-0-102" id="h27-0-102" class="i">+let s:base_spec = { &#39;branch&#39;: &#39;master&#39;, &#39;frozen&#39;: 0 }
</a><a href="#h27-0-103" id="h27-0-103" class="i">+let s:TYPE = {
</a><a href="#h27-0-104" id="h27-0-104" class="i">+\   &#39;string&#39;:  type(&#39;&#39;),
</a><a href="#h27-0-105" id="h27-0-105" class="i">+\   &#39;list&#39;:    type([]),
</a><a href="#h27-0-106" id="h27-0-106" class="i">+\   &#39;dict&#39;:    type({}),
</a><a href="#h27-0-107" id="h27-0-107" class="i">+\   &#39;funcref&#39;: type(function(&#39;call&#39;))
</a><a href="#h27-0-108" id="h27-0-108" class="i">+\ }
</a><a href="#h27-0-109" id="h27-0-109" class="i">+let s:loaded = get(s:, &#39;loaded&#39;, {})
</a><a href="#h27-0-110" id="h27-0-110" class="i">+let s:triggers = get(s:, &#39;triggers&#39;, {})
</a><a href="#h27-0-111" id="h27-0-111" class="i">+
</a><a href="#h27-0-112" id="h27-0-112" class="i">+function! plug#begin(...)
</a><a href="#h27-0-113" id="h27-0-113" class="i">+  if a:0 &gt; 0
</a><a href="#h27-0-114" id="h27-0-114" class="i">+    let s:plug_home_org = a:1
</a><a href="#h27-0-115" id="h27-0-115" class="i">+    let home = s:path(fnamemodify(expand(a:1), &#39;:p&#39;))
</a><a href="#h27-0-116" id="h27-0-116" class="i">+  elseif exists(&#39;g:plug_home&#39;)
</a><a href="#h27-0-117" id="h27-0-117" class="i">+    let home = s:path(g:plug_home)
</a><a href="#h27-0-118" id="h27-0-118" class="i">+  elseif !empty(&amp;rtp)
</a><a href="#h27-0-119" id="h27-0-119" class="i">+    let home = s:path(split(&amp;rtp, &#39;,&#39;)[0]) . &#39;/plugged&#39;
</a><a href="#h27-0-120" id="h27-0-120" class="i">+  else
</a><a href="#h27-0-121" id="h27-0-121" class="i">+    return s:err(&#39;Unable to determine plug home. Try calling plug#begin() with a path argument.&#39;)
</a><a href="#h27-0-122" id="h27-0-122" class="i">+  endif
</a><a href="#h27-0-123" id="h27-0-123" class="i">+  if fnamemodify(home, &#39;:t&#39;) ==# &#39;plugin&#39; &amp;&amp; fnamemodify(home, &#39;:h&#39;) ==# s:first_rtp
</a><a href="#h27-0-124" id="h27-0-124" class="i">+    return s:err(&#39;Invalid plug home. &#39;.home.&#39; is a standard Vim runtime path and is not allowed.&#39;)
</a><a href="#h27-0-125" id="h27-0-125" class="i">+  endif
</a><a href="#h27-0-126" id="h27-0-126" class="i">+
</a><a href="#h27-0-127" id="h27-0-127" class="i">+  let g:plug_home = home
</a><a href="#h27-0-128" id="h27-0-128" class="i">+  let g:plugs = {}
</a><a href="#h27-0-129" id="h27-0-129" class="i">+  let g:plugs_order = []
</a><a href="#h27-0-130" id="h27-0-130" class="i">+  let s:triggers = {}
</a><a href="#h27-0-131" id="h27-0-131" class="i">+
</a><a href="#h27-0-132" id="h27-0-132" class="i">+  call s:define_commands()
</a><a href="#h27-0-133" id="h27-0-133" class="i">+  return 1
</a><a href="#h27-0-134" id="h27-0-134" class="i">+endfunction
</a><a href="#h27-0-135" id="h27-0-135" class="i">+
</a><a href="#h27-0-136" id="h27-0-136" class="i">+function! s:define_commands()
</a><a href="#h27-0-137" id="h27-0-137" class="i">+  command! -nargs=+ -bar Plug call plug#(&lt;args&gt;)
</a><a href="#h27-0-138" id="h27-0-138" class="i">+  if !executable(&#39;git&#39;)
</a><a href="#h27-0-139" id="h27-0-139" class="i">+    return s:err(&#39;`git` executable not found. Most commands will not be available. To suppress this message, prepend `silent!` to `call plug#begin(...)`.&#39;)
</a><a href="#h27-0-140" id="h27-0-140" class="i">+  endif
</a><a href="#h27-0-141" id="h27-0-141" class="i">+  command! -nargs=* -bar -bang -complete=customlist,s:names PlugInstall call s:install(&lt;bang&gt;0, [&lt;f-args&gt;])
</a><a href="#h27-0-142" id="h27-0-142" class="i">+  command! -nargs=* -bar -bang -complete=customlist,s:names PlugUpdate  call s:update(&lt;bang&gt;0, [&lt;f-args&gt;])
</a><a href="#h27-0-143" id="h27-0-143" class="i">+  command! -nargs=0 -bar -bang PlugClean call s:clean(&lt;bang&gt;0)
</a><a href="#h27-0-144" id="h27-0-144" class="i">+  command! -nargs=0 -bar PlugUpgrade if s:upgrade() | execute &#39;source&#39; s:esc(s:me) | endif
</a><a href="#h27-0-145" id="h27-0-145" class="i">+  command! -nargs=0 -bar PlugStatus  call s:status()
</a><a href="#h27-0-146" id="h27-0-146" class="i">+  command! -nargs=0 -bar PlugDiff    call s:diff()
</a><a href="#h27-0-147" id="h27-0-147" class="i">+  command! -nargs=? -bar -bang -complete=file PlugSnapshot call s:snapshot(&lt;bang&gt;0, &lt;f-args&gt;)
</a><a href="#h27-0-148" id="h27-0-148" class="i">+endfunction
</a><a href="#h27-0-149" id="h27-0-149" class="i">+
</a><a href="#h27-0-150" id="h27-0-150" class="i">+function! s:to_a(v)
</a><a href="#h27-0-151" id="h27-0-151" class="i">+  return type(a:v) == s:TYPE.list ? a:v : [a:v]
</a><a href="#h27-0-152" id="h27-0-152" class="i">+endfunction
</a><a href="#h27-0-153" id="h27-0-153" class="i">+
</a><a href="#h27-0-154" id="h27-0-154" class="i">+function! s:to_s(v)
</a><a href="#h27-0-155" id="h27-0-155" class="i">+  return type(a:v) == s:TYPE.string ? a:v : join(a:v, &quot;\n&quot;) . &quot;\n&quot;
</a><a href="#h27-0-156" id="h27-0-156" class="i">+endfunction
</a><a href="#h27-0-157" id="h27-0-157" class="i">+
</a><a href="#h27-0-158" id="h27-0-158" class="i">+function! s:glob(from, pattern)
</a><a href="#h27-0-159" id="h27-0-159" class="i">+  return s:lines(globpath(a:from, a:pattern))
</a><a href="#h27-0-160" id="h27-0-160" class="i">+endfunction
</a><a href="#h27-0-161" id="h27-0-161" class="i">+
</a><a href="#h27-0-162" id="h27-0-162" class="i">+function! s:source(from, ...)
</a><a href="#h27-0-163" id="h27-0-163" class="i">+  let found = 0
</a><a href="#h27-0-164" id="h27-0-164" class="i">+  for pattern in a:000
</a><a href="#h27-0-165" id="h27-0-165" class="i">+    for vim in s:glob(a:from, pattern)
</a><a href="#h27-0-166" id="h27-0-166" class="i">+      execute &#39;source&#39; s:esc(vim)
</a><a href="#h27-0-167" id="h27-0-167" class="i">+      let found = 1
</a><a href="#h27-0-168" id="h27-0-168" class="i">+    endfor
</a><a href="#h27-0-169" id="h27-0-169" class="i">+  endfor
</a><a href="#h27-0-170" id="h27-0-170" class="i">+  return found
</a><a href="#h27-0-171" id="h27-0-171" class="i">+endfunction
</a><a href="#h27-0-172" id="h27-0-172" class="i">+
</a><a href="#h27-0-173" id="h27-0-173" class="i">+function! s:assoc(dict, key, val)
</a><a href="#h27-0-174" id="h27-0-174" class="i">+  let a:dict[a:key] = add(get(a:dict, a:key, []), a:val)
</a><a href="#h27-0-175" id="h27-0-175" class="i">+endfunction
</a><a href="#h27-0-176" id="h27-0-176" class="i">+
</a><a href="#h27-0-177" id="h27-0-177" class="i">+function! s:ask(message, ...)
</a><a href="#h27-0-178" id="h27-0-178" class="i">+  call inputsave()
</a><a href="#h27-0-179" id="h27-0-179" class="i">+  echohl WarningMsg
</a><a href="#h27-0-180" id="h27-0-180" class="i">+  let answer = input(a:message.(a:0 ? &#39; (y/N/a) &#39; : &#39; (y/N) &#39;))
</a><a href="#h27-0-181" id="h27-0-181" class="i">+  echohl None
</a><a href="#h27-0-182" id="h27-0-182" class="i">+  call inputrestore()
</a><a href="#h27-0-183" id="h27-0-183" class="i">+  echo &quot;\r&quot;
</a><a href="#h27-0-184" id="h27-0-184" class="i">+  return (a:0 &amp;&amp; answer =~? &#39;^a&#39;) ? 2 : (answer =~? &#39;^y&#39;) ? 1 : 0
</a><a href="#h27-0-185" id="h27-0-185" class="i">+endfunction
</a><a href="#h27-0-186" id="h27-0-186" class="i">+
</a><a href="#h27-0-187" id="h27-0-187" class="i">+function! s:ask_no_interrupt(...)
</a><a href="#h27-0-188" id="h27-0-188" class="i">+  try
</a><a href="#h27-0-189" id="h27-0-189" class="i">+    return call(&#39;s:ask&#39;, a:000)
</a><a href="#h27-0-190" id="h27-0-190" class="i">+  catch
</a><a href="#h27-0-191" id="h27-0-191" class="i">+    return 0
</a><a href="#h27-0-192" id="h27-0-192" class="i">+  endtry
</a><a href="#h27-0-193" id="h27-0-193" class="i">+endfunction
</a><a href="#h27-0-194" id="h27-0-194" class="i">+
</a><a href="#h27-0-195" id="h27-0-195" class="i">+function! s:lazy(plug, opt)
</a><a href="#h27-0-196" id="h27-0-196" class="i">+  return has_key(a:plug, a:opt) &amp;&amp;
</a><a href="#h27-0-197" id="h27-0-197" class="i">+        \ (empty(s:to_a(a:plug[a:opt]))         ||
</a><a href="#h27-0-198" id="h27-0-198" class="i">+        \  !isdirectory(a:plug.dir)             ||
</a><a href="#h27-0-199" id="h27-0-199" class="i">+        \  len(s:glob(s:rtp(a:plug), &#39;plugin&#39;)) ||
</a><a href="#h27-0-200" id="h27-0-200" class="i">+        \  len(s:glob(s:rtp(a:plug), &#39;after/plugin&#39;)))
</a><a href="#h27-0-201" id="h27-0-201" class="i">+endfunction
</a><a href="#h27-0-202" id="h27-0-202" class="i">+
</a><a href="#h27-0-203" id="h27-0-203" class="i">+function! plug#end()
</a><a href="#h27-0-204" id="h27-0-204" class="i">+  if !exists(&#39;g:plugs&#39;)
</a><a href="#h27-0-205" id="h27-0-205" class="i">+    return s:err(&#39;Call plug#begin() first&#39;)
</a><a href="#h27-0-206" id="h27-0-206" class="i">+  endif
</a><a href="#h27-0-207" id="h27-0-207" class="i">+
</a><a href="#h27-0-208" id="h27-0-208" class="i">+  if exists(&#39;#PlugLOD&#39;)
</a><a href="#h27-0-209" id="h27-0-209" class="i">+    augroup PlugLOD
</a><a href="#h27-0-210" id="h27-0-210" class="i">+      autocmd!
</a><a href="#h27-0-211" id="h27-0-211" class="i">+    augroup END
</a><a href="#h27-0-212" id="h27-0-212" class="i">+    augroup! PlugLOD
</a><a href="#h27-0-213" id="h27-0-213" class="i">+  endif
</a><a href="#h27-0-214" id="h27-0-214" class="i">+  let lod = { &#39;ft&#39;: {}, &#39;map&#39;: {}, &#39;cmd&#39;: {} }
</a><a href="#h27-0-215" id="h27-0-215" class="i">+
</a><a href="#h27-0-216" id="h27-0-216" class="i">+  if exists(&#39;g:did_load_filetypes&#39;)
</a><a href="#h27-0-217" id="h27-0-217" class="i">+    filetype off
</a><a href="#h27-0-218" id="h27-0-218" class="i">+  endif
</a><a href="#h27-0-219" id="h27-0-219" class="i">+  for name in g:plugs_order
</a><a href="#h27-0-220" id="h27-0-220" class="i">+    if !has_key(g:plugs, name)
</a><a href="#h27-0-221" id="h27-0-221" class="i">+      continue
</a><a href="#h27-0-222" id="h27-0-222" class="i">+    endif
</a><a href="#h27-0-223" id="h27-0-223" class="i">+    let plug = g:plugs[name]
</a><a href="#h27-0-224" id="h27-0-224" class="i">+    if get(s:loaded, name, 0) || !s:lazy(plug, &#39;on&#39;) &amp;&amp; !s:lazy(plug, &#39;for&#39;)
</a><a href="#h27-0-225" id="h27-0-225" class="i">+      let s:loaded[name] = 1
</a><a href="#h27-0-226" id="h27-0-226" class="i">+      continue
</a><a href="#h27-0-227" id="h27-0-227" class="i">+    endif
</a><a href="#h27-0-228" id="h27-0-228" class="i">+
</a><a href="#h27-0-229" id="h27-0-229" class="i">+    if has_key(plug, &#39;on&#39;)
</a><a href="#h27-0-230" id="h27-0-230" class="i">+      let s:triggers[name] = { &#39;map&#39;: [], &#39;cmd&#39;: [] }
</a><a href="#h27-0-231" id="h27-0-231" class="i">+      for cmd in s:to_a(plug.on)
</a><a href="#h27-0-232" id="h27-0-232" class="i">+        if cmd =~? &#39;^&lt;Plug&gt;.\+&#39;
</a><a href="#h27-0-233" id="h27-0-233" class="i">+          if empty(mapcheck(cmd)) &amp;&amp; empty(mapcheck(cmd, &#39;i&#39;))
</a><a href="#h27-0-234" id="h27-0-234" class="i">+            call s:assoc(lod.map, cmd, name)
</a><a href="#h27-0-235" id="h27-0-235" class="i">+          endif
</a><a href="#h27-0-236" id="h27-0-236" class="i">+          call add(s:triggers[name].map, cmd)
</a><a href="#h27-0-237" id="h27-0-237" class="i">+        elseif cmd =~# &#39;^[A-Z]&#39;
</a><a href="#h27-0-238" id="h27-0-238" class="i">+          let cmd = substitute(cmd, &#39;!*$&#39;, &#39;&#39;, &#39;&#39;)
</a><a href="#h27-0-239" id="h27-0-239" class="i">+          if exists(&#39;:&#39;.cmd) != 2
</a><a href="#h27-0-240" id="h27-0-240" class="i">+            call s:assoc(lod.cmd, cmd, name)
</a><a href="#h27-0-241" id="h27-0-241" class="i">+          endif
</a><a href="#h27-0-242" id="h27-0-242" class="i">+          call add(s:triggers[name].cmd, cmd)
</a><a href="#h27-0-243" id="h27-0-243" class="i">+        else
</a><a href="#h27-0-244" id="h27-0-244" class="i">+          call s:err(&#39;Invalid `on` option: &#39;.cmd.
</a><a href="#h27-0-245" id="h27-0-245" class="i">+          \ &#39;. Should start with an uppercase letter or `&lt;Plug&gt;`.&#39;)
</a><a href="#h27-0-246" id="h27-0-246" class="i">+        endif
</a><a href="#h27-0-247" id="h27-0-247" class="i">+      endfor
</a><a href="#h27-0-248" id="h27-0-248" class="i">+    endif
</a><a href="#h27-0-249" id="h27-0-249" class="i">+
</a><a href="#h27-0-250" id="h27-0-250" class="i">+    if has_key(plug, &#39;for&#39;)
</a><a href="#h27-0-251" id="h27-0-251" class="i">+      let types = s:to_a(plug.for)
</a><a href="#h27-0-252" id="h27-0-252" class="i">+      if !empty(types)
</a><a href="#h27-0-253" id="h27-0-253" class="i">+        augroup filetypedetect
</a><a href="#h27-0-254" id="h27-0-254" class="i">+        call s:source(s:rtp(plug), &#39;ftdetect/**/*.vim&#39;, &#39;after/ftdetect/**/*.vim&#39;)
</a><a href="#h27-0-255" id="h27-0-255" class="i">+        augroup END
</a><a href="#h27-0-256" id="h27-0-256" class="i">+      endif
</a><a href="#h27-0-257" id="h27-0-257" class="i">+      for type in types
</a><a href="#h27-0-258" id="h27-0-258" class="i">+        call s:assoc(lod.ft, type, name)
</a><a href="#h27-0-259" id="h27-0-259" class="i">+      endfor
</a><a href="#h27-0-260" id="h27-0-260" class="i">+    endif
</a><a href="#h27-0-261" id="h27-0-261" class="i">+  endfor
</a><a href="#h27-0-262" id="h27-0-262" class="i">+
</a><a href="#h27-0-263" id="h27-0-263" class="i">+  for [cmd, names] in items(lod.cmd)
</a><a href="#h27-0-264" id="h27-0-264" class="i">+    execute printf(
</a><a href="#h27-0-265" id="h27-0-265" class="i">+    \ &#39;command! -nargs=* -range -bang -complete=file %s call s:lod_cmd(%s, &quot;&lt;bang&gt;&quot;, &lt;line1&gt;, &lt;line2&gt;, &lt;q-args&gt;, %s)&#39;,
</a><a href="#h27-0-266" id="h27-0-266" class="i">+    \ cmd, string(cmd), string(names))
</a><a href="#h27-0-267" id="h27-0-267" class="i">+  endfor
</a><a href="#h27-0-268" id="h27-0-268" class="i">+
</a><a href="#h27-0-269" id="h27-0-269" class="i">+  for [map, names] in items(lod.map)
</a><a href="#h27-0-270" id="h27-0-270" class="i">+    for [mode, map_prefix, key_prefix] in
</a><a href="#h27-0-271" id="h27-0-271" class="i">+          \ [[&#39;i&#39;, &#39;&lt;C-O&gt;&#39;, &#39;&#39;], [&#39;n&#39;, &#39;&#39;, &#39;&#39;], [&#39;v&#39;, &#39;&#39;, &#39;gv&#39;], [&#39;o&#39;, &#39;&#39;, &#39;&#39;]]
</a><a href="#h27-0-272" id="h27-0-272" class="i">+      execute printf(
</a><a href="#h27-0-273" id="h27-0-273" class="i">+      \ &#39;%snoremap &lt;silent&gt; %s %s:&lt;C-U&gt;call &lt;SID&gt;lod_map(%s, %s, %s, &quot;%s&quot;)&lt;CR&gt;&#39;,
</a><a href="#h27-0-274" id="h27-0-274" class="i">+      \ mode, map, map_prefix, string(map), string(names), mode != &#39;i&#39;, key_prefix)
</a><a href="#h27-0-275" id="h27-0-275" class="i">+    endfor
</a><a href="#h27-0-276" id="h27-0-276" class="i">+  endfor
</a><a href="#h27-0-277" id="h27-0-277" class="i">+
</a><a href="#h27-0-278" id="h27-0-278" class="i">+  for [ft, names] in items(lod.ft)
</a><a href="#h27-0-279" id="h27-0-279" class="i">+    augroup PlugLOD
</a><a href="#h27-0-280" id="h27-0-280" class="i">+      execute printf(&#39;autocmd FileType %s call &lt;SID&gt;lod_ft(%s, %s)&#39;,
</a><a href="#h27-0-281" id="h27-0-281" class="i">+            \ ft, string(ft), string(names))
</a><a href="#h27-0-282" id="h27-0-282" class="i">+    augroup END
</a><a href="#h27-0-283" id="h27-0-283" class="i">+  endfor
</a><a href="#h27-0-284" id="h27-0-284" class="i">+
</a><a href="#h27-0-285" id="h27-0-285" class="i">+  call s:reorg_rtp()
</a><a href="#h27-0-286" id="h27-0-286" class="i">+  filetype plugin indent on
</a><a href="#h27-0-287" id="h27-0-287" class="i">+  if has(&#39;vim_starting&#39;)
</a><a href="#h27-0-288" id="h27-0-288" class="i">+    if has(&#39;syntax&#39;) &amp;&amp; !exists(&#39;g:syntax_on&#39;)
</a><a href="#h27-0-289" id="h27-0-289" class="i">+      syntax enable
</a><a href="#h27-0-290" id="h27-0-290" class="i">+    end
</a><a href="#h27-0-291" id="h27-0-291" class="i">+  else
</a><a href="#h27-0-292" id="h27-0-292" class="i">+    call s:reload_plugins()
</a><a href="#h27-0-293" id="h27-0-293" class="i">+  endif
</a><a href="#h27-0-294" id="h27-0-294" class="i">+endfunction
</a><a href="#h27-0-295" id="h27-0-295" class="i">+
</a><a href="#h27-0-296" id="h27-0-296" class="i">+function! s:loaded_names()
</a><a href="#h27-0-297" id="h27-0-297" class="i">+  return filter(copy(g:plugs_order), &#39;get(s:loaded, v:val, 0)&#39;)
</a><a href="#h27-0-298" id="h27-0-298" class="i">+endfunction
</a><a href="#h27-0-299" id="h27-0-299" class="i">+
</a><a href="#h27-0-300" id="h27-0-300" class="i">+function! s:load_plugin(spec)
</a><a href="#h27-0-301" id="h27-0-301" class="i">+  call s:source(s:rtp(a:spec), &#39;plugin/**/*.vim&#39;, &#39;after/plugin/**/*.vim&#39;)
</a><a href="#h27-0-302" id="h27-0-302" class="i">+endfunction
</a><a href="#h27-0-303" id="h27-0-303" class="i">+
</a><a href="#h27-0-304" id="h27-0-304" class="i">+function! s:reload_plugins()
</a><a href="#h27-0-305" id="h27-0-305" class="i">+  for name in s:loaded_names()
</a><a href="#h27-0-306" id="h27-0-306" class="i">+    call s:load_plugin(g:plugs[name])
</a><a href="#h27-0-307" id="h27-0-307" class="i">+  endfor
</a><a href="#h27-0-308" id="h27-0-308" class="i">+endfunction
</a><a href="#h27-0-309" id="h27-0-309" class="i">+
</a><a href="#h27-0-310" id="h27-0-310" class="i">+function! s:trim(str)
</a><a href="#h27-0-311" id="h27-0-311" class="i">+  return substitute(a:str, &#39;[\/]\+$&#39;, &#39;&#39;, &#39;&#39;)
</a><a href="#h27-0-312" id="h27-0-312" class="i">+endfunction
</a><a href="#h27-0-313" id="h27-0-313" class="i">+
</a><a href="#h27-0-314" id="h27-0-314" class="i">+function! s:version_requirement(val, min)
</a><a href="#h27-0-315" id="h27-0-315" class="i">+  for idx in range(0, len(a:min) - 1)
</a><a href="#h27-0-316" id="h27-0-316" class="i">+    let v = get(a:val, idx, 0)
</a><a href="#h27-0-317" id="h27-0-317" class="i">+    if     v &lt; a:min[idx] | return 0
</a><a href="#h27-0-318" id="h27-0-318" class="i">+    elseif v &gt; a:min[idx] | return 1
</a><a href="#h27-0-319" id="h27-0-319" class="i">+    endif
</a><a href="#h27-0-320" id="h27-0-320" class="i">+  endfor
</a><a href="#h27-0-321" id="h27-0-321" class="i">+  return 1
</a><a href="#h27-0-322" id="h27-0-322" class="i">+endfunction
</a><a href="#h27-0-323" id="h27-0-323" class="i">+
</a><a href="#h27-0-324" id="h27-0-324" class="i">+function! s:git_version_requirement(...)
</a><a href="#h27-0-325" id="h27-0-325" class="i">+  if !exists(&#39;s:git_version&#39;)
</a><a href="#h27-0-326" id="h27-0-326" class="i">+    let s:git_version = map(split(split(s:system(&#39;git --version&#39;))[2], &#39;\.&#39;), &#39;str2nr(v:val)&#39;)
</a><a href="#h27-0-327" id="h27-0-327" class="i">+  endif
</a><a href="#h27-0-328" id="h27-0-328" class="i">+  return s:version_requirement(s:git_version, a:000)
</a><a href="#h27-0-329" id="h27-0-329" class="i">+endfunction
</a><a href="#h27-0-330" id="h27-0-330" class="i">+
</a><a href="#h27-0-331" id="h27-0-331" class="i">+function! s:progress_opt(base)
</a><a href="#h27-0-332" id="h27-0-332" class="i">+  return a:base &amp;&amp; !s:is_win &amp;&amp;
</a><a href="#h27-0-333" id="h27-0-333" class="i">+        \ s:git_version_requirement(1, 7, 1) ? &#39;--progress&#39; : &#39;&#39;
</a><a href="#h27-0-334" id="h27-0-334" class="i">+endfunction
</a><a href="#h27-0-335" id="h27-0-335" class="i">+
</a><a href="#h27-0-336" id="h27-0-336" class="i">+if s:is_win
</a><a href="#h27-0-337" id="h27-0-337" class="i">+  function! s:rtp(spec)
</a><a href="#h27-0-338" id="h27-0-338" class="i">+    return s:path(a:spec.dir . get(a:spec, &#39;rtp&#39;, &#39;&#39;))
</a><a href="#h27-0-339" id="h27-0-339" class="i">+  endfunction
</a><a href="#h27-0-340" id="h27-0-340" class="i">+
</a><a href="#h27-0-341" id="h27-0-341" class="i">+  function! s:path(path)
</a><a href="#h27-0-342" id="h27-0-342" class="i">+    return s:trim(substitute(a:path, &#39;/&#39;, &#39;\&#39;, &#39;g&#39;))
</a><a href="#h27-0-343" id="h27-0-343" class="i">+  endfunction
</a><a href="#h27-0-344" id="h27-0-344" class="i">+
</a><a href="#h27-0-345" id="h27-0-345" class="i">+  function! s:dirpath(path)
</a><a href="#h27-0-346" id="h27-0-346" class="i">+    return s:path(a:path) . &#39;\&#39;
</a><a href="#h27-0-347" id="h27-0-347" class="i">+  endfunction
</a><a href="#h27-0-348" id="h27-0-348" class="i">+
</a><a href="#h27-0-349" id="h27-0-349" class="i">+  function! s:is_local_plug(repo)
</a><a href="#h27-0-350" id="h27-0-350" class="i">+    return a:repo =~? &#39;^[a-z]:\|^[%~]&#39;
</a><a href="#h27-0-351" id="h27-0-351" class="i">+  endfunction
</a><a href="#h27-0-352" id="h27-0-352" class="i">+else
</a><a href="#h27-0-353" id="h27-0-353" class="i">+  function! s:rtp(spec)
</a><a href="#h27-0-354" id="h27-0-354" class="i">+    return s:dirpath(a:spec.dir . get(a:spec, &#39;rtp&#39;, &#39;&#39;))
</a><a href="#h27-0-355" id="h27-0-355" class="i">+  endfunction
</a><a href="#h27-0-356" id="h27-0-356" class="i">+
</a><a href="#h27-0-357" id="h27-0-357" class="i">+  function! s:path(path)
</a><a href="#h27-0-358" id="h27-0-358" class="i">+    return s:trim(a:path)
</a><a href="#h27-0-359" id="h27-0-359" class="i">+  endfunction
</a><a href="#h27-0-360" id="h27-0-360" class="i">+
</a><a href="#h27-0-361" id="h27-0-361" class="i">+  function! s:dirpath(path)
</a><a href="#h27-0-362" id="h27-0-362" class="i">+    return substitute(a:path, &#39;[/\\]*$&#39;, &#39;/&#39;, &#39;&#39;)
</a><a href="#h27-0-363" id="h27-0-363" class="i">+  endfunction
</a><a href="#h27-0-364" id="h27-0-364" class="i">+
</a><a href="#h27-0-365" id="h27-0-365" class="i">+  function! s:is_local_plug(repo)
</a><a href="#h27-0-366" id="h27-0-366" class="i">+    return a:repo[0] =~ &#39;[/$~]&#39;
</a><a href="#h27-0-367" id="h27-0-367" class="i">+  endfunction
</a><a href="#h27-0-368" id="h27-0-368" class="i">+endif
</a><a href="#h27-0-369" id="h27-0-369" class="i">+
</a><a href="#h27-0-370" id="h27-0-370" class="i">+function! s:err(msg)
</a><a href="#h27-0-371" id="h27-0-371" class="i">+  echohl ErrorMsg
</a><a href="#h27-0-372" id="h27-0-372" class="i">+  echom &#39;[vim-plug] &#39;.a:msg
</a><a href="#h27-0-373" id="h27-0-373" class="i">+  echohl None
</a><a href="#h27-0-374" id="h27-0-374" class="i">+endfunction
</a><a href="#h27-0-375" id="h27-0-375" class="i">+
</a><a href="#h27-0-376" id="h27-0-376" class="i">+function! s:warn(cmd, msg)
</a><a href="#h27-0-377" id="h27-0-377" class="i">+  echohl WarningMsg
</a><a href="#h27-0-378" id="h27-0-378" class="i">+  execute a:cmd &#39;a:msg&#39;
</a><a href="#h27-0-379" id="h27-0-379" class="i">+  echohl None
</a><a href="#h27-0-380" id="h27-0-380" class="i">+endfunction
</a><a href="#h27-0-381" id="h27-0-381" class="i">+
</a><a href="#h27-0-382" id="h27-0-382" class="i">+function! s:esc(path)
</a><a href="#h27-0-383" id="h27-0-383" class="i">+  return escape(a:path, &#39; &#39;)
</a><a href="#h27-0-384" id="h27-0-384" class="i">+endfunction
</a><a href="#h27-0-385" id="h27-0-385" class="i">+
</a><a href="#h27-0-386" id="h27-0-386" class="i">+function! s:escrtp(path)
</a><a href="#h27-0-387" id="h27-0-387" class="i">+  return escape(a:path, &#39; ,&#39;)
</a><a href="#h27-0-388" id="h27-0-388" class="i">+endfunction
</a><a href="#h27-0-389" id="h27-0-389" class="i">+
</a><a href="#h27-0-390" id="h27-0-390" class="i">+function! s:remove_rtp()
</a><a href="#h27-0-391" id="h27-0-391" class="i">+  for name in s:loaded_names()
</a><a href="#h27-0-392" id="h27-0-392" class="i">+    let rtp = s:rtp(g:plugs[name])
</a><a href="#h27-0-393" id="h27-0-393" class="i">+    execute &#39;set rtp-=&#39;.s:escrtp(rtp)
</a><a href="#h27-0-394" id="h27-0-394" class="i">+    let after = globpath(rtp, &#39;after&#39;)
</a><a href="#h27-0-395" id="h27-0-395" class="i">+    if isdirectory(after)
</a><a href="#h27-0-396" id="h27-0-396" class="i">+      execute &#39;set rtp-=&#39;.s:escrtp(after)
</a><a href="#h27-0-397" id="h27-0-397" class="i">+    endif
</a><a href="#h27-0-398" id="h27-0-398" class="i">+  endfor
</a><a href="#h27-0-399" id="h27-0-399" class="i">+endfunction
</a><a href="#h27-0-400" id="h27-0-400" class="i">+
</a><a href="#h27-0-401" id="h27-0-401" class="i">+function! s:reorg_rtp()
</a><a href="#h27-0-402" id="h27-0-402" class="i">+  if !empty(s:first_rtp)
</a><a href="#h27-0-403" id="h27-0-403" class="i">+    execute &#39;set rtp-=&#39;.s:first_rtp
</a><a href="#h27-0-404" id="h27-0-404" class="i">+    execute &#39;set rtp-=&#39;.s:last_rtp
</a><a href="#h27-0-405" id="h27-0-405" class="i">+  endif
</a><a href="#h27-0-406" id="h27-0-406" class="i">+
</a><a href="#h27-0-407" id="h27-0-407" class="i">+  &quot; &amp;rtp is modified from outside
</a><a href="#h27-0-408" id="h27-0-408" class="i">+  if exists(&#39;s:prtp&#39;) &amp;&amp; s:prtp !=# &amp;rtp
</a><a href="#h27-0-409" id="h27-0-409" class="i">+    call s:remove_rtp()
</a><a href="#h27-0-410" id="h27-0-410" class="i">+    unlet! s:middle
</a><a href="#h27-0-411" id="h27-0-411" class="i">+  endif
</a><a href="#h27-0-412" id="h27-0-412" class="i">+
</a><a href="#h27-0-413" id="h27-0-413" class="i">+  let s:middle = get(s:, &#39;middle&#39;, &amp;rtp)
</a><a href="#h27-0-414" id="h27-0-414" class="i">+  let rtps     = map(s:loaded_names(), &#39;s:rtp(g:plugs[v:val])&#39;)
</a><a href="#h27-0-415" id="h27-0-415" class="i">+  let afters   = filter(map(copy(rtps), &#39;globpath(v:val, &quot;after&quot;)&#39;), &#39;!empty(v:val)&#39;)
</a><a href="#h27-0-416" id="h27-0-416" class="i">+  let rtp      = join(map(rtps, &#39;escape(v:val, &quot;,&quot;)&#39;), &#39;,&#39;)
</a><a href="#h27-0-417" id="h27-0-417" class="i">+                 \ . &#39;,&#39;.s:middle.&#39;,&#39;
</a><a href="#h27-0-418" id="h27-0-418" class="i">+                 \ . join(map(afters, &#39;escape(v:val, &quot;,&quot;)&#39;), &#39;,&#39;)
</a><a href="#h27-0-419" id="h27-0-419" class="i">+  let &amp;rtp     = substitute(substitute(rtp, &#39;,,*&#39;, &#39;,&#39;, &#39;g&#39;), &#39;^,\|,$&#39;, &#39;&#39;, &#39;g&#39;)
</a><a href="#h27-0-420" id="h27-0-420" class="i">+  let s:prtp   = &amp;rtp
</a><a href="#h27-0-421" id="h27-0-421" class="i">+
</a><a href="#h27-0-422" id="h27-0-422" class="i">+  if !empty(s:first_rtp)
</a><a href="#h27-0-423" id="h27-0-423" class="i">+    execute &#39;set rtp^=&#39;.s:first_rtp
</a><a href="#h27-0-424" id="h27-0-424" class="i">+    execute &#39;set rtp+=&#39;.s:last_rtp
</a><a href="#h27-0-425" id="h27-0-425" class="i">+  endif
</a><a href="#h27-0-426" id="h27-0-426" class="i">+endfunction
</a><a href="#h27-0-427" id="h27-0-427" class="i">+
</a><a href="#h27-0-428" id="h27-0-428" class="i">+function! s:doautocmd(...)
</a><a href="#h27-0-429" id="h27-0-429" class="i">+  if exists(&#39;#&#39;.join(a:000, &#39;#&#39;))
</a><a href="#h27-0-430" id="h27-0-430" class="i">+    execute &#39;doautocmd&#39; ((v:version &gt; 703 || has(&#39;patch442&#39;)) ? &#39;&lt;nomodeline&gt;&#39; : &#39;&#39;) join(a:000)
</a><a href="#h27-0-431" id="h27-0-431" class="i">+  endif
</a><a href="#h27-0-432" id="h27-0-432" class="i">+endfunction
</a><a href="#h27-0-433" id="h27-0-433" class="i">+
</a><a href="#h27-0-434" id="h27-0-434" class="i">+function! s:dobufread(names)
</a><a href="#h27-0-435" id="h27-0-435" class="i">+  for name in a:names
</a><a href="#h27-0-436" id="h27-0-436" class="i">+    let path = s:rtp(g:plugs[name]).&#39;/**&#39;
</a><a href="#h27-0-437" id="h27-0-437" class="i">+    for dir in [&#39;ftdetect&#39;, &#39;ftplugin&#39;]
</a><a href="#h27-0-438" id="h27-0-438" class="i">+      if len(finddir(dir, path))
</a><a href="#h27-0-439" id="h27-0-439" class="i">+        if exists(&#39;#BufRead&#39;)
</a><a href="#h27-0-440" id="h27-0-440" class="i">+          doautocmd BufRead
</a><a href="#h27-0-441" id="h27-0-441" class="i">+        endif
</a><a href="#h27-0-442" id="h27-0-442" class="i">+        return
</a><a href="#h27-0-443" id="h27-0-443" class="i">+      endif
</a><a href="#h27-0-444" id="h27-0-444" class="i">+    endfor
</a><a href="#h27-0-445" id="h27-0-445" class="i">+  endfor
</a><a href="#h27-0-446" id="h27-0-446" class="i">+endfunction
</a><a href="#h27-0-447" id="h27-0-447" class="i">+
</a><a href="#h27-0-448" id="h27-0-448" class="i">+function! plug#load(...)
</a><a href="#h27-0-449" id="h27-0-449" class="i">+  if a:0 == 0
</a><a href="#h27-0-450" id="h27-0-450" class="i">+    return s:err(&#39;Argument missing: plugin name(s) required&#39;)
</a><a href="#h27-0-451" id="h27-0-451" class="i">+  endif
</a><a href="#h27-0-452" id="h27-0-452" class="i">+  if !exists(&#39;g:plugs&#39;)
</a><a href="#h27-0-453" id="h27-0-453" class="i">+    return s:err(&#39;plug#begin was not called&#39;)
</a><a href="#h27-0-454" id="h27-0-454" class="i">+  endif
</a><a href="#h27-0-455" id="h27-0-455" class="i">+  let names = a:0 == 1 &amp;&amp; type(a:1) == s:TYPE.list ? a:1 : a:000
</a><a href="#h27-0-456" id="h27-0-456" class="i">+  let unknowns = filter(copy(names), &#39;!has_key(g:plugs, v:val)&#39;)
</a><a href="#h27-0-457" id="h27-0-457" class="i">+  if !empty(unknowns)
</a><a href="#h27-0-458" id="h27-0-458" class="i">+    let s = len(unknowns) &gt; 1 ? &#39;s&#39; : &#39;&#39;
</a><a href="#h27-0-459" id="h27-0-459" class="i">+    return s:err(printf(&#39;Unknown plugin%s: %s&#39;, s, join(unknowns, &#39;, &#39;)))
</a><a href="#h27-0-460" id="h27-0-460" class="i">+  end
</a><a href="#h27-0-461" id="h27-0-461" class="i">+  let unloaded = filter(copy(names), &#39;!get(s:loaded, v:val, 0)&#39;)
</a><a href="#h27-0-462" id="h27-0-462" class="i">+  if !empty(unloaded)
</a><a href="#h27-0-463" id="h27-0-463" class="i">+    for name in unloaded
</a><a href="#h27-0-464" id="h27-0-464" class="i">+      call s:lod([name], [&#39;ftdetect&#39;, &#39;after/ftdetect&#39;, &#39;plugin&#39;, &#39;after/plugin&#39;])
</a><a href="#h27-0-465" id="h27-0-465" class="i">+    endfor
</a><a href="#h27-0-466" id="h27-0-466" class="i">+    call s:dobufread(unloaded)
</a><a href="#h27-0-467" id="h27-0-467" class="i">+    return 1
</a><a href="#h27-0-468" id="h27-0-468" class="i">+  end
</a><a href="#h27-0-469" id="h27-0-469" class="i">+  return 0
</a><a href="#h27-0-470" id="h27-0-470" class="i">+endfunction
</a><a href="#h27-0-471" id="h27-0-471" class="i">+
</a><a href="#h27-0-472" id="h27-0-472" class="i">+function! s:remove_triggers(name)
</a><a href="#h27-0-473" id="h27-0-473" class="i">+  if !has_key(s:triggers, a:name)
</a><a href="#h27-0-474" id="h27-0-474" class="i">+    return
</a><a href="#h27-0-475" id="h27-0-475" class="i">+  endif
</a><a href="#h27-0-476" id="h27-0-476" class="i">+  for cmd in s:triggers[a:name].cmd
</a><a href="#h27-0-477" id="h27-0-477" class="i">+    execute &#39;silent! delc&#39; cmd
</a><a href="#h27-0-478" id="h27-0-478" class="i">+  endfor
</a><a href="#h27-0-479" id="h27-0-479" class="i">+  for map in s:triggers[a:name].map
</a><a href="#h27-0-480" id="h27-0-480" class="i">+    execute &#39;silent! unmap&#39; map
</a><a href="#h27-0-481" id="h27-0-481" class="i">+    execute &#39;silent! iunmap&#39; map
</a><a href="#h27-0-482" id="h27-0-482" class="i">+  endfor
</a><a href="#h27-0-483" id="h27-0-483" class="i">+  call remove(s:triggers, a:name)
</a><a href="#h27-0-484" id="h27-0-484" class="i">+endfunction
</a><a href="#h27-0-485" id="h27-0-485" class="i">+
</a><a href="#h27-0-486" id="h27-0-486" class="i">+function! s:lod(names, types, ...)
</a><a href="#h27-0-487" id="h27-0-487" class="i">+  for name in a:names
</a><a href="#h27-0-488" id="h27-0-488" class="i">+    call s:remove_triggers(name)
</a><a href="#h27-0-489" id="h27-0-489" class="i">+    let s:loaded[name] = 1
</a><a href="#h27-0-490" id="h27-0-490" class="i">+  endfor
</a><a href="#h27-0-491" id="h27-0-491" class="i">+  call s:reorg_rtp()
</a><a href="#h27-0-492" id="h27-0-492" class="i">+
</a><a href="#h27-0-493" id="h27-0-493" class="i">+  for name in a:names
</a><a href="#h27-0-494" id="h27-0-494" class="i">+    let rtp = s:rtp(g:plugs[name])
</a><a href="#h27-0-495" id="h27-0-495" class="i">+    for dir in a:types
</a><a href="#h27-0-496" id="h27-0-496" class="i">+      call s:source(rtp, dir.&#39;/**/*.vim&#39;)
</a><a href="#h27-0-497" id="h27-0-497" class="i">+    endfor
</a><a href="#h27-0-498" id="h27-0-498" class="i">+    if a:0
</a><a href="#h27-0-499" id="h27-0-499" class="i">+      if !s:source(rtp, a:1) &amp;&amp; !empty(s:glob(rtp, a:2))
</a><a href="#h27-0-500" id="h27-0-500" class="i">+        execute &#39;runtime&#39; a:1
</a><a href="#h27-0-501" id="h27-0-501" class="i">+      endif
</a><a href="#h27-0-502" id="h27-0-502" class="i">+      call s:source(rtp, a:2)
</a><a href="#h27-0-503" id="h27-0-503" class="i">+    endif
</a><a href="#h27-0-504" id="h27-0-504" class="i">+    call s:doautocmd(&#39;User&#39;, name)
</a><a href="#h27-0-505" id="h27-0-505" class="i">+  endfor
</a><a href="#h27-0-506" id="h27-0-506" class="i">+endfunction
</a><a href="#h27-0-507" id="h27-0-507" class="i">+
</a><a href="#h27-0-508" id="h27-0-508" class="i">+function! s:lod_ft(pat, names)
</a><a href="#h27-0-509" id="h27-0-509" class="i">+  let syn = &#39;syntax/&#39;.a:pat.&#39;.vim&#39;
</a><a href="#h27-0-510" id="h27-0-510" class="i">+  call s:lod(a:names, [&#39;plugin&#39;, &#39;after/plugin&#39;], syn, &#39;after/&#39;.syn)
</a><a href="#h27-0-511" id="h27-0-511" class="i">+  execute &#39;autocmd! PlugLOD FileType&#39; a:pat
</a><a href="#h27-0-512" id="h27-0-512" class="i">+  call s:doautocmd(&#39;filetypeplugin&#39;, &#39;FileType&#39;)
</a><a href="#h27-0-513" id="h27-0-513" class="i">+  call s:doautocmd(&#39;filetypeindent&#39;, &#39;FileType&#39;)
</a><a href="#h27-0-514" id="h27-0-514" class="i">+endfunction
</a><a href="#h27-0-515" id="h27-0-515" class="i">+
</a><a href="#h27-0-516" id="h27-0-516" class="i">+function! s:lod_cmd(cmd, bang, l1, l2, args, names)
</a><a href="#h27-0-517" id="h27-0-517" class="i">+  call s:lod(a:names, [&#39;ftdetect&#39;, &#39;after/ftdetect&#39;, &#39;plugin&#39;, &#39;after/plugin&#39;])
</a><a href="#h27-0-518" id="h27-0-518" class="i">+  call s:dobufread(a:names)
</a><a href="#h27-0-519" id="h27-0-519" class="i">+  execute printf(&#39;%s%s%s %s&#39;, (a:l1 == a:l2 ? &#39;&#39; : (a:l1.&#39;,&#39;.a:l2)), a:cmd, a:bang, a:args)
</a><a href="#h27-0-520" id="h27-0-520" class="i">+endfunction
</a><a href="#h27-0-521" id="h27-0-521" class="i">+
</a><a href="#h27-0-522" id="h27-0-522" class="i">+function! s:lod_map(map, names, with_prefix, prefix)
</a><a href="#h27-0-523" id="h27-0-523" class="i">+  call s:lod(a:names, [&#39;ftdetect&#39;, &#39;after/ftdetect&#39;, &#39;plugin&#39;, &#39;after/plugin&#39;])
</a><a href="#h27-0-524" id="h27-0-524" class="i">+  call s:dobufread(a:names)
</a><a href="#h27-0-525" id="h27-0-525" class="i">+  let extra = &#39;&#39;
</a><a href="#h27-0-526" id="h27-0-526" class="i">+  while 1
</a><a href="#h27-0-527" id="h27-0-527" class="i">+    let c = getchar(0)
</a><a href="#h27-0-528" id="h27-0-528" class="i">+    if c == 0
</a><a href="#h27-0-529" id="h27-0-529" class="i">+      break
</a><a href="#h27-0-530" id="h27-0-530" class="i">+    endif
</a><a href="#h27-0-531" id="h27-0-531" class="i">+    let extra .= nr2char(c)
</a><a href="#h27-0-532" id="h27-0-532" class="i">+  endwhile
</a><a href="#h27-0-533" id="h27-0-533" class="i">+
</a><a href="#h27-0-534" id="h27-0-534" class="i">+  if a:with_prefix
</a><a href="#h27-0-535" id="h27-0-535" class="i">+    let prefix = v:count ? v:count : &#39;&#39;
</a><a href="#h27-0-536" id="h27-0-536" class="i">+    let prefix .= &#39;&quot;&#39;.v:register.a:prefix
</a><a href="#h27-0-537" id="h27-0-537" class="i">+    if mode(1) == &#39;no&#39;
</a><a href="#h27-0-538" id="h27-0-538" class="i">+      if v:operator == &#39;c&#39;
</a><a href="#h27-0-539" id="h27-0-539" class="i">+        let prefix = &quot;\&lt;esc&gt;&quot; . prefix
</a><a href="#h27-0-540" id="h27-0-540" class="i">+      endif
</a><a href="#h27-0-541" id="h27-0-541" class="i">+      let prefix .= v:operator
</a><a href="#h27-0-542" id="h27-0-542" class="i">+    endif
</a><a href="#h27-0-543" id="h27-0-543" class="i">+    call feedkeys(prefix, &#39;n&#39;)
</a><a href="#h27-0-544" id="h27-0-544" class="i">+  endif
</a><a href="#h27-0-545" id="h27-0-545" class="i">+  call feedkeys(substitute(a:map, &#39;^&lt;Plug&gt;&#39;, &quot;\&lt;Plug&gt;&quot;, &#39;&#39;) . extra)
</a><a href="#h27-0-546" id="h27-0-546" class="i">+endfunction
</a><a href="#h27-0-547" id="h27-0-547" class="i">+
</a><a href="#h27-0-548" id="h27-0-548" class="i">+function! plug#(repo, ...)
</a><a href="#h27-0-549" id="h27-0-549" class="i">+  if a:0 &gt; 1
</a><a href="#h27-0-550" id="h27-0-550" class="i">+    return s:err(&#39;Invalid number of arguments (1..2)&#39;)
</a><a href="#h27-0-551" id="h27-0-551" class="i">+  endif
</a><a href="#h27-0-552" id="h27-0-552" class="i">+
</a><a href="#h27-0-553" id="h27-0-553" class="i">+  try
</a><a href="#h27-0-554" id="h27-0-554" class="i">+    let repo = s:trim(a:repo)
</a><a href="#h27-0-555" id="h27-0-555" class="i">+    let opts = a:0 == 1 ? s:parse_options(a:1) : s:base_spec
</a><a href="#h27-0-556" id="h27-0-556" class="i">+    let name = get(opts, &#39;as&#39;, fnamemodify(repo, &#39;:t:s?\.git$??&#39;))
</a><a href="#h27-0-557" id="h27-0-557" class="i">+    let spec = extend(s:infer_properties(name, repo), opts)
</a><a href="#h27-0-558" id="h27-0-558" class="i">+    if !has_key(g:plugs, name)
</a><a href="#h27-0-559" id="h27-0-559" class="i">+      call add(g:plugs_order, name)
</a><a href="#h27-0-560" id="h27-0-560" class="i">+    endif
</a><a href="#h27-0-561" id="h27-0-561" class="i">+    let g:plugs[name] = spec
</a><a href="#h27-0-562" id="h27-0-562" class="i">+    let s:loaded[name] = get(s:loaded, name, 0)
</a><a href="#h27-0-563" id="h27-0-563" class="i">+  catch
</a><a href="#h27-0-564" id="h27-0-564" class="i">+    return s:err(v:exception)
</a><a href="#h27-0-565" id="h27-0-565" class="i">+  endtry
</a><a href="#h27-0-566" id="h27-0-566" class="i">+endfunction
</a><a href="#h27-0-567" id="h27-0-567" class="i">+
</a><a href="#h27-0-568" id="h27-0-568" class="i">+function! s:parse_options(arg)
</a><a href="#h27-0-569" id="h27-0-569" class="i">+  let opts = copy(s:base_spec)
</a><a href="#h27-0-570" id="h27-0-570" class="i">+  let type = type(a:arg)
</a><a href="#h27-0-571" id="h27-0-571" class="i">+  if type == s:TYPE.string
</a><a href="#h27-0-572" id="h27-0-572" class="i">+    let opts.tag = a:arg
</a><a href="#h27-0-573" id="h27-0-573" class="i">+  elseif type == s:TYPE.dict
</a><a href="#h27-0-574" id="h27-0-574" class="i">+    call extend(opts, a:arg)
</a><a href="#h27-0-575" id="h27-0-575" class="i">+    if has_key(opts, &#39;dir&#39;)
</a><a href="#h27-0-576" id="h27-0-576" class="i">+      let opts.dir = s:dirpath(expand(opts.dir))
</a><a href="#h27-0-577" id="h27-0-577" class="i">+    endif
</a><a href="#h27-0-578" id="h27-0-578" class="i">+  else
</a><a href="#h27-0-579" id="h27-0-579" class="i">+    throw &#39;Invalid argument type (expected: string or dictionary)&#39;
</a><a href="#h27-0-580" id="h27-0-580" class="i">+  endif
</a><a href="#h27-0-581" id="h27-0-581" class="i">+  return opts
</a><a href="#h27-0-582" id="h27-0-582" class="i">+endfunction
</a><a href="#h27-0-583" id="h27-0-583" class="i">+
</a><a href="#h27-0-584" id="h27-0-584" class="i">+function! s:infer_properties(name, repo)
</a><a href="#h27-0-585" id="h27-0-585" class="i">+  let repo = a:repo
</a><a href="#h27-0-586" id="h27-0-586" class="i">+  if s:is_local_plug(repo)
</a><a href="#h27-0-587" id="h27-0-587" class="i">+    return { &#39;dir&#39;: s:dirpath(expand(repo)) }
</a><a href="#h27-0-588" id="h27-0-588" class="i">+  else
</a><a href="#h27-0-589" id="h27-0-589" class="i">+    if repo =~ &#39;:&#39;
</a><a href="#h27-0-590" id="h27-0-590" class="i">+      let uri = repo
</a><a href="#h27-0-591" id="h27-0-591" class="i">+    else
</a><a href="#h27-0-592" id="h27-0-592" class="i">+      if repo !~ &#39;/&#39;
</a><a href="#h27-0-593" id="h27-0-593" class="i">+        throw printf(&#39;Invalid argument: %s (implicit `vim-scripts&#39;&#39; expansion is deprecated)&#39;, repo)
</a><a href="#h27-0-594" id="h27-0-594" class="i">+      endif
</a><a href="#h27-0-595" id="h27-0-595" class="i">+      let fmt = get(g:, &#39;plug_url_format&#39;, &#39;https://git::@github.com/%s.git&#39;)
</a><a href="#h27-0-596" id="h27-0-596" class="i">+      let uri = printf(fmt, repo)
</a><a href="#h27-0-597" id="h27-0-597" class="i">+    endif
</a><a href="#h27-0-598" id="h27-0-598" class="i">+    return { &#39;dir&#39;: s:dirpath(g:plug_home.&#39;/&#39;.a:name), &#39;uri&#39;: uri }
</a><a href="#h27-0-599" id="h27-0-599" class="i">+  endif
</a><a href="#h27-0-600" id="h27-0-600" class="i">+endfunction
</a><a href="#h27-0-601" id="h27-0-601" class="i">+
</a><a href="#h27-0-602" id="h27-0-602" class="i">+function! s:install(force, names)
</a><a href="#h27-0-603" id="h27-0-603" class="i">+  call s:update_impl(0, a:force, a:names)
</a><a href="#h27-0-604" id="h27-0-604" class="i">+endfunction
</a><a href="#h27-0-605" id="h27-0-605" class="i">+
</a><a href="#h27-0-606" id="h27-0-606" class="i">+function! s:update(force, names)
</a><a href="#h27-0-607" id="h27-0-607" class="i">+  call s:update_impl(1, a:force, a:names)
</a><a href="#h27-0-608" id="h27-0-608" class="i">+endfunction
</a><a href="#h27-0-609" id="h27-0-609" class="i">+
</a><a href="#h27-0-610" id="h27-0-610" class="i">+function! plug#helptags()
</a><a href="#h27-0-611" id="h27-0-611" class="i">+  if !exists(&#39;g:plugs&#39;)
</a><a href="#h27-0-612" id="h27-0-612" class="i">+    return s:err(&#39;plug#begin was not called&#39;)
</a><a href="#h27-0-613" id="h27-0-613" class="i">+  endif
</a><a href="#h27-0-614" id="h27-0-614" class="i">+  for spec in values(g:plugs)
</a><a href="#h27-0-615" id="h27-0-615" class="i">+    let docd = join([s:rtp(spec), &#39;doc&#39;], &#39;/&#39;)
</a><a href="#h27-0-616" id="h27-0-616" class="i">+    if isdirectory(docd)
</a><a href="#h27-0-617" id="h27-0-617" class="i">+      silent! execute &#39;helptags&#39; s:esc(docd)
</a><a href="#h27-0-618" id="h27-0-618" class="i">+    endif
</a><a href="#h27-0-619" id="h27-0-619" class="i">+  endfor
</a><a href="#h27-0-620" id="h27-0-620" class="i">+  return 1
</a><a href="#h27-0-621" id="h27-0-621" class="i">+endfunction
</a><a href="#h27-0-622" id="h27-0-622" class="i">+
</a><a href="#h27-0-623" id="h27-0-623" class="i">+function! s:syntax()
</a><a href="#h27-0-624" id="h27-0-624" class="i">+  syntax clear
</a><a href="#h27-0-625" id="h27-0-625" class="i">+  syntax region plug1 start=/\%1l/ end=/\%2l/ contains=plugNumber
</a><a href="#h27-0-626" id="h27-0-626" class="i">+  syntax region plug2 start=/\%2l/ end=/\%3l/ contains=plugBracket,plugX
</a><a href="#h27-0-627" id="h27-0-627" class="i">+  syn match plugNumber /[0-9]\+[0-9.]*/ contained
</a><a href="#h27-0-628" id="h27-0-628" class="i">+  syn match plugBracket /[[\]]/ contained
</a><a href="#h27-0-629" id="h27-0-629" class="i">+  syn match plugX /x/ contained
</a><a href="#h27-0-630" id="h27-0-630" class="i">+  syn match plugDash /^-/
</a><a href="#h27-0-631" id="h27-0-631" class="i">+  syn match plugPlus /^+/
</a><a href="#h27-0-632" id="h27-0-632" class="i">+  syn match plugStar /^*/
</a><a href="#h27-0-633" id="h27-0-633" class="i">+  syn match plugMessage /\(^- \)\@&lt;=.*/
</a><a href="#h27-0-634" id="h27-0-634" class="i">+  syn match plugName /\(^- \)\@&lt;=[^ ]*:/
</a><a href="#h27-0-635" id="h27-0-635" class="i">+  syn match plugSha /\%(: \)\@&lt;=[0-9a-f]\{4,}$/
</a><a href="#h27-0-636" id="h27-0-636" class="i">+  syn match plugTag /(tag: [^)]\+)/
</a><a href="#h27-0-637" id="h27-0-637" class="i">+  syn match plugInstall /\(^+ \)\@&lt;=[^:]*/
</a><a href="#h27-0-638" id="h27-0-638" class="i">+  syn match plugUpdate /\(^* \)\@&lt;=[^:]*/
</a><a href="#h27-0-639" id="h27-0-639" class="i">+  syn match plugCommit /^  \X*[0-9a-f]\{7,9} .*/ contains=plugRelDate,plugEdge,plugTag
</a><a href="#h27-0-640" id="h27-0-640" class="i">+  syn match plugEdge /^  \X\+$/
</a><a href="#h27-0-641" id="h27-0-641" class="i">+  syn match plugEdge /^  \X*/ contained nextgroup=plugSha
</a><a href="#h27-0-642" id="h27-0-642" class="i">+  syn match plugSha /[0-9a-f]\{7,9}/ contained
</a><a href="#h27-0-643" id="h27-0-643" class="i">+  syn match plugRelDate /([^)]*)$/ contained
</a><a href="#h27-0-644" id="h27-0-644" class="i">+  syn match plugNotLoaded /(not loaded)$/
</a><a href="#h27-0-645" id="h27-0-645" class="i">+  syn match plugError /^x.*/
</a><a href="#h27-0-646" id="h27-0-646" class="i">+  syn region plugDeleted start=/^\~ .*/ end=/^\ze\S/
</a><a href="#h27-0-647" id="h27-0-647" class="i">+  syn match plugH2 /^.*:\n-\+$/
</a><a href="#h27-0-648" id="h27-0-648" class="i">+  syn keyword Function PlugInstall PlugStatus PlugUpdate PlugClean
</a><a href="#h27-0-649" id="h27-0-649" class="i">+  hi def link plug1       Title
</a><a href="#h27-0-650" id="h27-0-650" class="i">+  hi def link plug2       Repeat
</a><a href="#h27-0-651" id="h27-0-651" class="i">+  hi def link plugH2      Type
</a><a href="#h27-0-652" id="h27-0-652" class="i">+  hi def link plugX       Exception
</a><a href="#h27-0-653" id="h27-0-653" class="i">+  hi def link plugBracket Structure
</a><a href="#h27-0-654" id="h27-0-654" class="i">+  hi def link plugNumber  Number
</a><a href="#h27-0-655" id="h27-0-655" class="i">+
</a><a href="#h27-0-656" id="h27-0-656" class="i">+  hi def link plugDash    Special
</a><a href="#h27-0-657" id="h27-0-657" class="i">+  hi def link plugPlus    Constant
</a><a href="#h27-0-658" id="h27-0-658" class="i">+  hi def link plugStar    Boolean
</a><a href="#h27-0-659" id="h27-0-659" class="i">+
</a><a href="#h27-0-660" id="h27-0-660" class="i">+  hi def link plugMessage Function
</a><a href="#h27-0-661" id="h27-0-661" class="i">+  hi def link plugName    Label
</a><a href="#h27-0-662" id="h27-0-662" class="i">+  hi def link plugInstall Function
</a><a href="#h27-0-663" id="h27-0-663" class="i">+  hi def link plugUpdate  Type
</a><a href="#h27-0-664" id="h27-0-664" class="i">+
</a><a href="#h27-0-665" id="h27-0-665" class="i">+  hi def link plugError   Error
</a><a href="#h27-0-666" id="h27-0-666" class="i">+  hi def link plugDeleted Ignore
</a><a href="#h27-0-667" id="h27-0-667" class="i">+  hi def link plugRelDate Comment
</a><a href="#h27-0-668" id="h27-0-668" class="i">+  hi def link plugEdge    PreProc
</a><a href="#h27-0-669" id="h27-0-669" class="i">+  hi def link plugSha     Identifier
</a><a href="#h27-0-670" id="h27-0-670" class="i">+  hi def link plugTag     Constant
</a><a href="#h27-0-671" id="h27-0-671" class="i">+
</a><a href="#h27-0-672" id="h27-0-672" class="i">+  hi def link plugNotLoaded Comment
</a><a href="#h27-0-673" id="h27-0-673" class="i">+endfunction
</a><a href="#h27-0-674" id="h27-0-674" class="i">+
</a><a href="#h27-0-675" id="h27-0-675" class="i">+function! s:lpad(str, len)
</a><a href="#h27-0-676" id="h27-0-676" class="i">+  return a:str . repeat(&#39; &#39;, a:len - len(a:str))
</a><a href="#h27-0-677" id="h27-0-677" class="i">+endfunction
</a><a href="#h27-0-678" id="h27-0-678" class="i">+
</a><a href="#h27-0-679" id="h27-0-679" class="i">+function! s:lines(msg)
</a><a href="#h27-0-680" id="h27-0-680" class="i">+  return split(a:msg, &quot;[\r\n]&quot;)
</a><a href="#h27-0-681" id="h27-0-681" class="i">+endfunction
</a><a href="#h27-0-682" id="h27-0-682" class="i">+
</a><a href="#h27-0-683" id="h27-0-683" class="i">+function! s:lastline(msg)
</a><a href="#h27-0-684" id="h27-0-684" class="i">+  return get(s:lines(a:msg), -1, &#39;&#39;)
</a><a href="#h27-0-685" id="h27-0-685" class="i">+endfunction
</a><a href="#h27-0-686" id="h27-0-686" class="i">+
</a><a href="#h27-0-687" id="h27-0-687" class="i">+function! s:new_window()
</a><a href="#h27-0-688" id="h27-0-688" class="i">+  execute get(g:, &#39;plug_window&#39;, &#39;vertical topleft new&#39;)
</a><a href="#h27-0-689" id="h27-0-689" class="i">+endfunction
</a><a href="#h27-0-690" id="h27-0-690" class="i">+
</a><a href="#h27-0-691" id="h27-0-691" class="i">+function! s:plug_window_exists()
</a><a href="#h27-0-692" id="h27-0-692" class="i">+  let buflist = tabpagebuflist(s:plug_tab)
</a><a href="#h27-0-693" id="h27-0-693" class="i">+  return !empty(buflist) &amp;&amp; index(buflist, s:plug_buf) &gt;= 0
</a><a href="#h27-0-694" id="h27-0-694" class="i">+endfunction
</a><a href="#h27-0-695" id="h27-0-695" class="i">+
</a><a href="#h27-0-696" id="h27-0-696" class="i">+function! s:switch_in()
</a><a href="#h27-0-697" id="h27-0-697" class="i">+  if !s:plug_window_exists()
</a><a href="#h27-0-698" id="h27-0-698" class="i">+    return 0
</a><a href="#h27-0-699" id="h27-0-699" class="i">+  endif
</a><a href="#h27-0-700" id="h27-0-700" class="i">+
</a><a href="#h27-0-701" id="h27-0-701" class="i">+  if winbufnr(0) != s:plug_buf
</a><a href="#h27-0-702" id="h27-0-702" class="i">+    let s:pos = [tabpagenr(), winnr(), winsaveview()]
</a><a href="#h27-0-703" id="h27-0-703" class="i">+    execute &#39;normal!&#39; s:plug_tab.&#39;gt&#39;
</a><a href="#h27-0-704" id="h27-0-704" class="i">+    let winnr = bufwinnr(s:plug_buf)
</a><a href="#h27-0-705" id="h27-0-705" class="i">+    execute winnr.&#39;wincmd w&#39;
</a><a href="#h27-0-706" id="h27-0-706" class="i">+    call add(s:pos, winsaveview())
</a><a href="#h27-0-707" id="h27-0-707" class="i">+  else
</a><a href="#h27-0-708" id="h27-0-708" class="i">+    let s:pos = [winsaveview()]
</a><a href="#h27-0-709" id="h27-0-709" class="i">+  endif
</a><a href="#h27-0-710" id="h27-0-710" class="i">+
</a><a href="#h27-0-711" id="h27-0-711" class="i">+  setlocal modifiable
</a><a href="#h27-0-712" id="h27-0-712" class="i">+  return 1
</a><a href="#h27-0-713" id="h27-0-713" class="i">+endfunction
</a><a href="#h27-0-714" id="h27-0-714" class="i">+
</a><a href="#h27-0-715" id="h27-0-715" class="i">+function! s:switch_out(...)
</a><a href="#h27-0-716" id="h27-0-716" class="i">+  call winrestview(s:pos[-1])
</a><a href="#h27-0-717" id="h27-0-717" class="i">+  setlocal nomodifiable
</a><a href="#h27-0-718" id="h27-0-718" class="i">+  if a:0 &gt; 0
</a><a href="#h27-0-719" id="h27-0-719" class="i">+    execute a:1
</a><a href="#h27-0-720" id="h27-0-720" class="i">+  endif
</a><a href="#h27-0-721" id="h27-0-721" class="i">+
</a><a href="#h27-0-722" id="h27-0-722" class="i">+  if len(s:pos) &gt; 1
</a><a href="#h27-0-723" id="h27-0-723" class="i">+    execute &#39;normal!&#39; s:pos[0].&#39;gt&#39;
</a><a href="#h27-0-724" id="h27-0-724" class="i">+    execute s:pos[1] &#39;wincmd w&#39;
</a><a href="#h27-0-725" id="h27-0-725" class="i">+    call winrestview(s:pos[2])
</a><a href="#h27-0-726" id="h27-0-726" class="i">+  endif
</a><a href="#h27-0-727" id="h27-0-727" class="i">+endfunction
</a><a href="#h27-0-728" id="h27-0-728" class="i">+
</a><a href="#h27-0-729" id="h27-0-729" class="i">+function! s:finish_bindings()
</a><a href="#h27-0-730" id="h27-0-730" class="i">+  nnoremap &lt;silent&gt; &lt;buffer&gt; R  :call &lt;SID&gt;retry()&lt;cr&gt;
</a><a href="#h27-0-731" id="h27-0-731" class="i">+  nnoremap &lt;silent&gt; &lt;buffer&gt; D  :PlugDiff&lt;cr&gt;
</a><a href="#h27-0-732" id="h27-0-732" class="i">+  nnoremap &lt;silent&gt; &lt;buffer&gt; S  :PlugStatus&lt;cr&gt;
</a><a href="#h27-0-733" id="h27-0-733" class="i">+  nnoremap &lt;silent&gt; &lt;buffer&gt; U  :call &lt;SID&gt;status_update()&lt;cr&gt;
</a><a href="#h27-0-734" id="h27-0-734" class="i">+  xnoremap &lt;silent&gt; &lt;buffer&gt; U  :call &lt;SID&gt;status_update()&lt;cr&gt;
</a><a href="#h27-0-735" id="h27-0-735" class="i">+  nnoremap &lt;silent&gt; &lt;buffer&gt; ]] :silent! call &lt;SID&gt;section(&#39;&#39;)&lt;cr&gt;
</a><a href="#h27-0-736" id="h27-0-736" class="i">+  nnoremap &lt;silent&gt; &lt;buffer&gt; [[ :silent! call &lt;SID&gt;section(&#39;b&#39;)&lt;cr&gt;
</a><a href="#h27-0-737" id="h27-0-737" class="i">+endfunction
</a><a href="#h27-0-738" id="h27-0-738" class="i">+
</a><a href="#h27-0-739" id="h27-0-739" class="i">+function! s:prepare(...)
</a><a href="#h27-0-740" id="h27-0-740" class="i">+  if empty(getcwd())
</a><a href="#h27-0-741" id="h27-0-741" class="i">+    throw &#39;Invalid current working directory. Cannot proceed.&#39;
</a><a href="#h27-0-742" id="h27-0-742" class="i">+  endif
</a><a href="#h27-0-743" id="h27-0-743" class="i">+
</a><a href="#h27-0-744" id="h27-0-744" class="i">+  for evar in [&#39;$GIT_DIR&#39;, &#39;$GIT_WORK_TREE&#39;]
</a><a href="#h27-0-745" id="h27-0-745" class="i">+    if exists(evar)
</a><a href="#h27-0-746" id="h27-0-746" class="i">+      throw evar.&#39; detected. Cannot proceed.&#39;
</a><a href="#h27-0-747" id="h27-0-747" class="i">+    endif
</a><a href="#h27-0-748" id="h27-0-748" class="i">+  endfor
</a><a href="#h27-0-749" id="h27-0-749" class="i">+
</a><a href="#h27-0-750" id="h27-0-750" class="i">+  call s:job_abort()
</a><a href="#h27-0-751" id="h27-0-751" class="i">+  if s:switch_in()
</a><a href="#h27-0-752" id="h27-0-752" class="i">+    if b:plug_preview == 1
</a><a href="#h27-0-753" id="h27-0-753" class="i">+      pc
</a><a href="#h27-0-754" id="h27-0-754" class="i">+    endif
</a><a href="#h27-0-755" id="h27-0-755" class="i">+    enew
</a><a href="#h27-0-756" id="h27-0-756" class="i">+  else
</a><a href="#h27-0-757" id="h27-0-757" class="i">+    call s:new_window()
</a><a href="#h27-0-758" id="h27-0-758" class="i">+  endif
</a><a href="#h27-0-759" id="h27-0-759" class="i">+
</a><a href="#h27-0-760" id="h27-0-760" class="i">+  nnoremap &lt;silent&gt; &lt;buffer&gt; q  :if b:plug_preview==1&lt;bar&gt;pc&lt;bar&gt;endif&lt;bar&gt;bd&lt;cr&gt;
</a><a href="#h27-0-761" id="h27-0-761" class="i">+  if a:0 == 0
</a><a href="#h27-0-762" id="h27-0-762" class="i">+    call s:finish_bindings()
</a><a href="#h27-0-763" id="h27-0-763" class="i">+  endif
</a><a href="#h27-0-764" id="h27-0-764" class="i">+  let b:plug_preview = -1
</a><a href="#h27-0-765" id="h27-0-765" class="i">+  let s:plug_tab = tabpagenr()
</a><a href="#h27-0-766" id="h27-0-766" class="i">+  let s:plug_buf = winbufnr(0)
</a><a href="#h27-0-767" id="h27-0-767" class="i">+  call s:assign_name()
</a><a href="#h27-0-768" id="h27-0-768" class="i">+
</a><a href="#h27-0-769" id="h27-0-769" class="i">+  for k in [&#39;&lt;cr&gt;&#39;, &#39;L&#39;, &#39;o&#39;, &#39;X&#39;, &#39;d&#39;, &#39;dd&#39;]
</a><a href="#h27-0-770" id="h27-0-770" class="i">+    execute &#39;silent! unmap &lt;buffer&gt;&#39; k
</a><a href="#h27-0-771" id="h27-0-771" class="i">+  endfor
</a><a href="#h27-0-772" id="h27-0-772" class="i">+  setlocal buftype=nofile bufhidden=wipe nobuflisted nolist noswapfile nowrap cursorline modifiable nospell
</a><a href="#h27-0-773" id="h27-0-773" class="i">+  if exists(&#39;+colorcolumn&#39;)
</a><a href="#h27-0-774" id="h27-0-774" class="i">+    setlocal colorcolumn=
</a><a href="#h27-0-775" id="h27-0-775" class="i">+  endif
</a><a href="#h27-0-776" id="h27-0-776" class="i">+  setf vim-plug
</a><a href="#h27-0-777" id="h27-0-777" class="i">+  if exists(&#39;g:syntax_on&#39;)
</a><a href="#h27-0-778" id="h27-0-778" class="i">+    call s:syntax()
</a><a href="#h27-0-779" id="h27-0-779" class="i">+  endif
</a><a href="#h27-0-780" id="h27-0-780" class="i">+endfunction
</a><a href="#h27-0-781" id="h27-0-781" class="i">+
</a><a href="#h27-0-782" id="h27-0-782" class="i">+function! s:assign_name()
</a><a href="#h27-0-783" id="h27-0-783" class="i">+  &quot; Assign buffer name
</a><a href="#h27-0-784" id="h27-0-784" class="i">+  let prefix = &#39;[Plugins]&#39;
</a><a href="#h27-0-785" id="h27-0-785" class="i">+  let name   = prefix
</a><a href="#h27-0-786" id="h27-0-786" class="i">+  let idx    = 2
</a><a href="#h27-0-787" id="h27-0-787" class="i">+  while bufexists(name)
</a><a href="#h27-0-788" id="h27-0-788" class="i">+    let name = printf(&#39;%s (%s)&#39;, prefix, idx)
</a><a href="#h27-0-789" id="h27-0-789" class="i">+    let idx = idx + 1
</a><a href="#h27-0-790" id="h27-0-790" class="i">+  endwhile
</a><a href="#h27-0-791" id="h27-0-791" class="i">+  silent! execute &#39;f&#39; fnameescape(name)
</a><a href="#h27-0-792" id="h27-0-792" class="i">+endfunction
</a><a href="#h27-0-793" id="h27-0-793" class="i">+
</a><a href="#h27-0-794" id="h27-0-794" class="i">+function! s:chsh(swap)
</a><a href="#h27-0-795" id="h27-0-795" class="i">+  let prev = [&amp;shell, &amp;shellcmdflag, &amp;shellredir]
</a><a href="#h27-0-796" id="h27-0-796" class="i">+  if s:is_win
</a><a href="#h27-0-797" id="h27-0-797" class="i">+    set shell=cmd.exe shellcmdflag=/c shellredir=&gt;%s\ 2&gt;&amp;1
</a><a href="#h27-0-798" id="h27-0-798" class="i">+  elseif a:swap
</a><a href="#h27-0-799" id="h27-0-799" class="i">+    set shell=sh shellredir=&gt;%s\ 2&gt;&amp;1
</a><a href="#h27-0-800" id="h27-0-800" class="i">+  endif
</a><a href="#h27-0-801" id="h27-0-801" class="i">+  return prev
</a><a href="#h27-0-802" id="h27-0-802" class="i">+endfunction
</a><a href="#h27-0-803" id="h27-0-803" class="i">+
</a><a href="#h27-0-804" id="h27-0-804" class="i">+function! s:bang(cmd, ...)
</a><a href="#h27-0-805" id="h27-0-805" class="i">+  try
</a><a href="#h27-0-806" id="h27-0-806" class="i">+    let [sh, shellcmdflag, shrd] = s:chsh(a:0)
</a><a href="#h27-0-807" id="h27-0-807" class="i">+    &quot; FIXME: Escaping is incomplete. We could use shellescape with eval,
</a><a href="#h27-0-808" id="h27-0-808" class="i">+    &quot;        but it won&#39;t work on Windows.
</a><a href="#h27-0-809" id="h27-0-809" class="i">+    let cmd = a:0 ? s:with_cd(a:cmd, a:1) : a:cmd
</a><a href="#h27-0-810" id="h27-0-810" class="i">+    if s:is_win
</a><a href="#h27-0-811" id="h27-0-811" class="i">+      let batchfile = tempname().&#39;.bat&#39;
</a><a href="#h27-0-812" id="h27-0-812" class="i">+      call writefile([&quot;@echo off\r&quot;, cmd . &quot;\r&quot;], batchfile)
</a><a href="#h27-0-813" id="h27-0-813" class="i">+      let cmd = batchfile
</a><a href="#h27-0-814" id="h27-0-814" class="i">+    endif
</a><a href="#h27-0-815" id="h27-0-815" class="i">+    let g:_plug_bang = (s:is_win &amp;&amp; has(&#39;gui_running&#39;) ? &#39;silent &#39; : &#39;&#39;).&#39;!&#39;.escape(cmd, &#39;#!%&#39;)
</a><a href="#h27-0-816" id="h27-0-816" class="i">+    execute &quot;normal! :execute g:_plug_bang\&lt;cr&gt;\&lt;cr&gt;&quot;
</a><a href="#h27-0-817" id="h27-0-817" class="i">+  finally
</a><a href="#h27-0-818" id="h27-0-818" class="i">+    unlet g:_plug_bang
</a><a href="#h27-0-819" id="h27-0-819" class="i">+    let [&amp;shell, &amp;shellcmdflag, &amp;shellredir] = [sh, shellcmdflag, shrd]
</a><a href="#h27-0-820" id="h27-0-820" class="i">+    if s:is_win
</a><a href="#h27-0-821" id="h27-0-821" class="i">+      call delete(batchfile)
</a><a href="#h27-0-822" id="h27-0-822" class="i">+    endif
</a><a href="#h27-0-823" id="h27-0-823" class="i">+  endtry
</a><a href="#h27-0-824" id="h27-0-824" class="i">+  return v:shell_error ? &#39;Exit status: &#39; . v:shell_error : &#39;&#39;
</a><a href="#h27-0-825" id="h27-0-825" class="i">+endfunction
</a><a href="#h27-0-826" id="h27-0-826" class="i">+
</a><a href="#h27-0-827" id="h27-0-827" class="i">+function! s:regress_bar()
</a><a href="#h27-0-828" id="h27-0-828" class="i">+  let bar = substitute(getline(2)[1:-2], &#39;.*\zs=&#39;, &#39;x&#39;, &#39;&#39;)
</a><a href="#h27-0-829" id="h27-0-829" class="i">+  call s:progress_bar(2, bar, len(bar))
</a><a href="#h27-0-830" id="h27-0-830" class="i">+endfunction
</a><a href="#h27-0-831" id="h27-0-831" class="i">+
</a><a href="#h27-0-832" id="h27-0-832" class="i">+function! s:is_updated(dir)
</a><a href="#h27-0-833" id="h27-0-833" class="i">+  return !empty(s:system_chomp(&#39;git log --pretty=format:&quot;%h&quot; &quot;HEAD...HEAD@{1}&quot;&#39;, a:dir))
</a><a href="#h27-0-834" id="h27-0-834" class="i">+endfunction
</a><a href="#h27-0-835" id="h27-0-835" class="i">+
</a><a href="#h27-0-836" id="h27-0-836" class="i">+function! s:do(pull, force, todo)
</a><a href="#h27-0-837" id="h27-0-837" class="i">+  for [name, spec] in items(a:todo)
</a><a href="#h27-0-838" id="h27-0-838" class="i">+    if !isdirectory(spec.dir)
</a><a href="#h27-0-839" id="h27-0-839" class="i">+      continue
</a><a href="#h27-0-840" id="h27-0-840" class="i">+    endif
</a><a href="#h27-0-841" id="h27-0-841" class="i">+    let installed = has_key(s:update.new, name)
</a><a href="#h27-0-842" id="h27-0-842" class="i">+    let updated = installed ? 0 :
</a><a href="#h27-0-843" id="h27-0-843" class="i">+      \ (a:pull &amp;&amp; index(s:update.errors, name) &lt; 0 &amp;&amp; s:is_updated(spec.dir))
</a><a href="#h27-0-844" id="h27-0-844" class="i">+    if a:force || installed || updated
</a><a href="#h27-0-845" id="h27-0-845" class="i">+      execute &#39;cd&#39; s:esc(spec.dir)
</a><a href="#h27-0-846" id="h27-0-846" class="i">+      call append(3, &#39;- Post-update hook for &#39;. name .&#39; ... &#39;)
</a><a href="#h27-0-847" id="h27-0-847" class="i">+      let error = &#39;&#39;
</a><a href="#h27-0-848" id="h27-0-848" class="i">+      let type = type(spec.do)
</a><a href="#h27-0-849" id="h27-0-849" class="i">+      if type == s:TYPE.string
</a><a href="#h27-0-850" id="h27-0-850" class="i">+        if spec.do[0] == &#39;:&#39;
</a><a href="#h27-0-851" id="h27-0-851" class="i">+          if !get(s:loaded, name, 0)
</a><a href="#h27-0-852" id="h27-0-852" class="i">+            let s:loaded[name] = 1
</a><a href="#h27-0-853" id="h27-0-853" class="i">+            call s:reorg_rtp()
</a><a href="#h27-0-854" id="h27-0-854" class="i">+          endif
</a><a href="#h27-0-855" id="h27-0-855" class="i">+          call s:load_plugin(spec)
</a><a href="#h27-0-856" id="h27-0-856" class="i">+          try
</a><a href="#h27-0-857" id="h27-0-857" class="i">+            execute spec.do[1:]
</a><a href="#h27-0-858" id="h27-0-858" class="i">+          catch
</a><a href="#h27-0-859" id="h27-0-859" class="i">+            let error = v:exception
</a><a href="#h27-0-860" id="h27-0-860" class="i">+          endtry
</a><a href="#h27-0-861" id="h27-0-861" class="i">+          if !s:plug_window_exists()
</a><a href="#h27-0-862" id="h27-0-862" class="i">+            cd -
</a><a href="#h27-0-863" id="h27-0-863" class="i">+            throw &#39;Warning: vim-plug was terminated by the post-update hook of &#39;.name
</a><a href="#h27-0-864" id="h27-0-864" class="i">+          endif
</a><a href="#h27-0-865" id="h27-0-865" class="i">+        else
</a><a href="#h27-0-866" id="h27-0-866" class="i">+          let error = s:bang(spec.do)
</a><a href="#h27-0-867" id="h27-0-867" class="i">+        endif
</a><a href="#h27-0-868" id="h27-0-868" class="i">+      elseif type == s:TYPE.funcref
</a><a href="#h27-0-869" id="h27-0-869" class="i">+        try
</a><a href="#h27-0-870" id="h27-0-870" class="i">+          let status = installed ? &#39;installed&#39; : (updated ? &#39;updated&#39; : &#39;unchanged&#39;)
</a><a href="#h27-0-871" id="h27-0-871" class="i">+          call spec.do({ &#39;name&#39;: name, &#39;status&#39;: status, &#39;force&#39;: a:force })
</a><a href="#h27-0-872" id="h27-0-872" class="i">+        catch
</a><a href="#h27-0-873" id="h27-0-873" class="i">+          let error = v:exception
</a><a href="#h27-0-874" id="h27-0-874" class="i">+        endtry
</a><a href="#h27-0-875" id="h27-0-875" class="i">+      else
</a><a href="#h27-0-876" id="h27-0-876" class="i">+        let error = &#39;Invalid hook type&#39;
</a><a href="#h27-0-877" id="h27-0-877" class="i">+      endif
</a><a href="#h27-0-878" id="h27-0-878" class="i">+      call s:switch_in()
</a><a href="#h27-0-879" id="h27-0-879" class="i">+      call setline(4, empty(error) ? (getline(4) . &#39;OK&#39;)
</a><a href="#h27-0-880" id="h27-0-880" class="i">+                                 \ : (&#39;x&#39; . getline(4)[1:] . error))
</a><a href="#h27-0-881" id="h27-0-881" class="i">+      if !empty(error)
</a><a href="#h27-0-882" id="h27-0-882" class="i">+        call add(s:update.errors, name)
</a><a href="#h27-0-883" id="h27-0-883" class="i">+        call s:regress_bar()
</a><a href="#h27-0-884" id="h27-0-884" class="i">+      endif
</a><a href="#h27-0-885" id="h27-0-885" class="i">+      cd -
</a><a href="#h27-0-886" id="h27-0-886" class="i">+    endif
</a><a href="#h27-0-887" id="h27-0-887" class="i">+  endfor
</a><a href="#h27-0-888" id="h27-0-888" class="i">+endfunction
</a><a href="#h27-0-889" id="h27-0-889" class="i">+
</a><a href="#h27-0-890" id="h27-0-890" class="i">+function! s:hash_match(a, b)
</a><a href="#h27-0-891" id="h27-0-891" class="i">+  return stridx(a:a, a:b) == 0 || stridx(a:b, a:a) == 0
</a><a href="#h27-0-892" id="h27-0-892" class="i">+endfunction
</a><a href="#h27-0-893" id="h27-0-893" class="i">+
</a><a href="#h27-0-894" id="h27-0-894" class="i">+function! s:checkout(spec)
</a><a href="#h27-0-895" id="h27-0-895" class="i">+  let sha = a:spec.commit
</a><a href="#h27-0-896" id="h27-0-896" class="i">+  let output = s:system(&#39;git rev-parse HEAD&#39;, a:spec.dir)
</a><a href="#h27-0-897" id="h27-0-897" class="i">+  if !v:shell_error &amp;&amp; !s:hash_match(sha, s:lines(output)[0])
</a><a href="#h27-0-898" id="h27-0-898" class="i">+    let output = s:system(
</a><a href="#h27-0-899" id="h27-0-899" class="i">+          \ &#39;git fetch --depth 999999 &amp;&amp; git checkout &#39;.s:esc(sha).&#39; --&#39;, a:spec.dir)
</a><a href="#h27-0-900" id="h27-0-900" class="i">+  endif
</a><a href="#h27-0-901" id="h27-0-901" class="i">+  return output
</a><a href="#h27-0-902" id="h27-0-902" class="i">+endfunction
</a><a href="#h27-0-903" id="h27-0-903" class="i">+
</a><a href="#h27-0-904" id="h27-0-904" class="i">+function! s:finish(pull)
</a><a href="#h27-0-905" id="h27-0-905" class="i">+  let new_frozen = len(filter(keys(s:update.new), &#39;g:plugs[v:val].frozen&#39;))
</a><a href="#h27-0-906" id="h27-0-906" class="i">+  if new_frozen
</a><a href="#h27-0-907" id="h27-0-907" class="i">+    let s = new_frozen &gt; 1 ? &#39;s&#39; : &#39;&#39;
</a><a href="#h27-0-908" id="h27-0-908" class="i">+    call append(3, printf(&#39;- Installed %d frozen plugin%s&#39;, new_frozen, s))
</a><a href="#h27-0-909" id="h27-0-909" class="i">+  endif
</a><a href="#h27-0-910" id="h27-0-910" class="i">+  call append(3, &#39;- Finishing ... &#39;) | 4
</a><a href="#h27-0-911" id="h27-0-911" class="i">+  redraw
</a><a href="#h27-0-912" id="h27-0-912" class="i">+  call plug#helptags()
</a><a href="#h27-0-913" id="h27-0-913" class="i">+  call plug#end()
</a><a href="#h27-0-914" id="h27-0-914" class="i">+  call setline(4, getline(4) . &#39;Done!&#39;)
</a><a href="#h27-0-915" id="h27-0-915" class="i">+  redraw
</a><a href="#h27-0-916" id="h27-0-916" class="i">+  let msgs = []
</a><a href="#h27-0-917" id="h27-0-917" class="i">+  if !empty(s:update.errors)
</a><a href="#h27-0-918" id="h27-0-918" class="i">+    call add(msgs, &quot;Press &#39;R&#39; to retry.&quot;)
</a><a href="#h27-0-919" id="h27-0-919" class="i">+  endif
</a><a href="#h27-0-920" id="h27-0-920" class="i">+  if a:pull &amp;&amp; len(s:update.new) &lt; len(filter(getline(5, &#39;$&#39;),
</a><a href="#h27-0-921" id="h27-0-921" class="i">+                \ &quot;v:val =~ &#39;^- &#39; &amp;&amp; v:val !~# &#39;Already up.to.date&#39;&quot;))
</a><a href="#h27-0-922" id="h27-0-922" class="i">+    call add(msgs, &quot;Press &#39;D&#39; to see the updated changes.&quot;)
</a><a href="#h27-0-923" id="h27-0-923" class="i">+  endif
</a><a href="#h27-0-924" id="h27-0-924" class="i">+  echo join(msgs, &#39; &#39;)
</a><a href="#h27-0-925" id="h27-0-925" class="i">+  call s:finish_bindings()
</a><a href="#h27-0-926" id="h27-0-926" class="i">+endfunction
</a><a href="#h27-0-927" id="h27-0-927" class="i">+
</a><a href="#h27-0-928" id="h27-0-928" class="i">+function! s:retry()
</a><a href="#h27-0-929" id="h27-0-929" class="i">+  if empty(s:update.errors)
</a><a href="#h27-0-930" id="h27-0-930" class="i">+    return
</a><a href="#h27-0-931" id="h27-0-931" class="i">+  endif
</a><a href="#h27-0-932" id="h27-0-932" class="i">+  echo
</a><a href="#h27-0-933" id="h27-0-933" class="i">+  call s:update_impl(s:update.pull, s:update.force,
</a><a href="#h27-0-934" id="h27-0-934" class="i">+        \ extend(copy(s:update.errors), [s:update.threads]))
</a><a href="#h27-0-935" id="h27-0-935" class="i">+endfunction
</a><a href="#h27-0-936" id="h27-0-936" class="i">+
</a><a href="#h27-0-937" id="h27-0-937" class="i">+function! s:is_managed(name)
</a><a href="#h27-0-938" id="h27-0-938" class="i">+  return has_key(g:plugs[a:name], &#39;uri&#39;)
</a><a href="#h27-0-939" id="h27-0-939" class="i">+endfunction
</a><a href="#h27-0-940" id="h27-0-940" class="i">+
</a><a href="#h27-0-941" id="h27-0-941" class="i">+function! s:names(...)
</a><a href="#h27-0-942" id="h27-0-942" class="i">+  return sort(filter(keys(g:plugs), &#39;stridx(v:val, a:1) == 0 &amp;&amp; s:is_managed(v:val)&#39;))
</a><a href="#h27-0-943" id="h27-0-943" class="i">+endfunction
</a><a href="#h27-0-944" id="h27-0-944" class="i">+
</a><a href="#h27-0-945" id="h27-0-945" class="i">+function! s:check_ruby()
</a><a href="#h27-0-946" id="h27-0-946" class="i">+  silent! ruby require &#39;thread&#39;; VIM::command(&quot;let g:plug_ruby = &#39;#{RUBY_VERSION}&#39;&quot;)
</a><a href="#h27-0-947" id="h27-0-947" class="i">+  if !exists(&#39;g:plug_ruby&#39;)
</a><a href="#h27-0-948" id="h27-0-948" class="i">+    redraw!
</a><a href="#h27-0-949" id="h27-0-949" class="i">+    return s:warn(&#39;echom&#39;, &#39;Warning: Ruby interface is broken&#39;)
</a><a href="#h27-0-950" id="h27-0-950" class="i">+  endif
</a><a href="#h27-0-951" id="h27-0-951" class="i">+  let ruby_version = split(g:plug_ruby, &#39;\.&#39;)
</a><a href="#h27-0-952" id="h27-0-952" class="i">+  unlet g:plug_ruby
</a><a href="#h27-0-953" id="h27-0-953" class="i">+  return s:version_requirement(ruby_version, [1, 8, 7])
</a><a href="#h27-0-954" id="h27-0-954" class="i">+endfunction
</a><a href="#h27-0-955" id="h27-0-955" class="i">+
</a><a href="#h27-0-956" id="h27-0-956" class="i">+function! s:update_impl(pull, force, args) abort
</a><a href="#h27-0-957" id="h27-0-957" class="i">+  let sync = index(a:args, &#39;--sync&#39;) &gt;= 0 || has(&#39;vim_starting&#39;)
</a><a href="#h27-0-958" id="h27-0-958" class="i">+  let args = filter(copy(a:args), &#39;v:val != &quot;--sync&quot;&#39;)
</a><a href="#h27-0-959" id="h27-0-959" class="i">+  let threads = (len(args) &gt; 0 &amp;&amp; args[-1] =~ &#39;^[1-9][0-9]*$&#39;) ?
</a><a href="#h27-0-960" id="h27-0-960" class="i">+                  \ remove(args, -1) : get(g:, &#39;plug_threads&#39;, 16)
</a><a href="#h27-0-961" id="h27-0-961" class="i">+
</a><a href="#h27-0-962" id="h27-0-962" class="i">+  let managed = filter(copy(g:plugs), &#39;s:is_managed(v:key)&#39;)
</a><a href="#h27-0-963" id="h27-0-963" class="i">+  let todo = empty(args) ? filter(managed, &#39;!v:val.frozen || !isdirectory(v:val.dir)&#39;) :
</a><a href="#h27-0-964" id="h27-0-964" class="i">+                         \ filter(managed, &#39;index(args, v:key) &gt;= 0&#39;)
</a><a href="#h27-0-965" id="h27-0-965" class="i">+
</a><a href="#h27-0-966" id="h27-0-966" class="i">+  if empty(todo)
</a><a href="#h27-0-967" id="h27-0-967" class="i">+    return s:warn(&#39;echo&#39;, &#39;No plugin to &#39;. (a:pull ? &#39;update&#39; : &#39;install&#39;))
</a><a href="#h27-0-968" id="h27-0-968" class="i">+  endif
</a><a href="#h27-0-969" id="h27-0-969" class="i">+
</a><a href="#h27-0-970" id="h27-0-970" class="i">+  if !s:is_win &amp;&amp; s:git_version_requirement(2, 3)
</a><a href="#h27-0-971" id="h27-0-971" class="i">+    let s:git_terminal_prompt = exists(&#39;$GIT_TERMINAL_PROMPT&#39;) ? $GIT_TERMINAL_PROMPT : &#39;&#39;
</a><a href="#h27-0-972" id="h27-0-972" class="i">+    let $GIT_TERMINAL_PROMPT = 0
</a><a href="#h27-0-973" id="h27-0-973" class="i">+    for plug in values(todo)
</a><a href="#h27-0-974" id="h27-0-974" class="i">+      let plug.uri = substitute(plug.uri,
</a><a href="#h27-0-975" id="h27-0-975" class="i">+            \ &#39;^https://git::@github\.com&#39;, &#39;https://github.com&#39;, &#39;&#39;)
</a><a href="#h27-0-976" id="h27-0-976" class="i">+    endfor
</a><a href="#h27-0-977" id="h27-0-977" class="i">+  endif
</a><a href="#h27-0-978" id="h27-0-978" class="i">+
</a><a href="#h27-0-979" id="h27-0-979" class="i">+  if !isdirectory(g:plug_home)
</a><a href="#h27-0-980" id="h27-0-980" class="i">+    try
</a><a href="#h27-0-981" id="h27-0-981" class="i">+      call mkdir(g:plug_home, &#39;p&#39;)
</a><a href="#h27-0-982" id="h27-0-982" class="i">+    catch
</a><a href="#h27-0-983" id="h27-0-983" class="i">+      return s:err(printf(&#39;Invalid plug directory: %s. &#39;.
</a><a href="#h27-0-984" id="h27-0-984" class="i">+              \ &#39;Try to call plug#begin with a valid directory&#39;, g:plug_home))
</a><a href="#h27-0-985" id="h27-0-985" class="i">+    endtry
</a><a href="#h27-0-986" id="h27-0-986" class="i">+  endif
</a><a href="#h27-0-987" id="h27-0-987" class="i">+
</a><a href="#h27-0-988" id="h27-0-988" class="i">+  if has(&#39;nvim&#39;) &amp;&amp; !exists(&#39;*jobwait&#39;) &amp;&amp; threads &gt; 1
</a><a href="#h27-0-989" id="h27-0-989" class="i">+    call s:warn(&#39;echom&#39;, &#39;[vim-plug] Update Neovim for parallel installer&#39;)
</a><a href="#h27-0-990" id="h27-0-990" class="i">+  endif
</a><a href="#h27-0-991" id="h27-0-991" class="i">+
</a><a href="#h27-0-992" id="h27-0-992" class="i">+  let use_job = s:nvim || s:vim8
</a><a href="#h27-0-993" id="h27-0-993" class="i">+  let python = (has(&#39;python&#39;) || has(&#39;python3&#39;)) &amp;&amp; !use_job
</a><a href="#h27-0-994" id="h27-0-994" class="i">+  let ruby = has(&#39;ruby&#39;) &amp;&amp; !use_job &amp;&amp; (v:version &gt;= 703 || v:version == 702 &amp;&amp; has(&#39;patch374&#39;)) &amp;&amp; !(s:is_win &amp;&amp; has(&#39;gui_running&#39;)) &amp;&amp; threads &gt; 1 &amp;&amp; s:check_ruby()
</a><a href="#h27-0-995" id="h27-0-995" class="i">+
</a><a href="#h27-0-996" id="h27-0-996" class="i">+  let s:update = {
</a><a href="#h27-0-997" id="h27-0-997" class="i">+    \ &#39;start&#39;:   reltime(),
</a><a href="#h27-0-998" id="h27-0-998" class="i">+    \ &#39;all&#39;:     todo,
</a><a href="#h27-0-999" id="h27-0-999" class="i">+    \ &#39;todo&#39;:    copy(todo),
</a><a href="#h27-0-1000" id="h27-0-1000" class="i">+    \ &#39;errors&#39;:  [],
</a><a href="#h27-0-1001" id="h27-0-1001" class="i">+    \ &#39;pull&#39;:    a:pull,
</a><a href="#h27-0-1002" id="h27-0-1002" class="i">+    \ &#39;force&#39;:   a:force,
</a><a href="#h27-0-1003" id="h27-0-1003" class="i">+    \ &#39;new&#39;:     {},
</a><a href="#h27-0-1004" id="h27-0-1004" class="i">+    \ &#39;threads&#39;: (python || ruby || use_job) ? min([len(todo), threads]) : 1,
</a><a href="#h27-0-1005" id="h27-0-1005" class="i">+    \ &#39;bar&#39;:     &#39;&#39;,
</a><a href="#h27-0-1006" id="h27-0-1006" class="i">+    \ &#39;fin&#39;:     0
</a><a href="#h27-0-1007" id="h27-0-1007" class="i">+  \ }
</a><a href="#h27-0-1008" id="h27-0-1008" class="i">+
</a><a href="#h27-0-1009" id="h27-0-1009" class="i">+  call s:prepare(1)
</a><a href="#h27-0-1010" id="h27-0-1010" class="i">+  call append(0, [&#39;&#39;, &#39;&#39;])
</a><a href="#h27-0-1011" id="h27-0-1011" class="i">+  normal! 2G
</a><a href="#h27-0-1012" id="h27-0-1012" class="i">+  silent! redraw
</a><a href="#h27-0-1013" id="h27-0-1013" class="i">+
</a><a href="#h27-0-1014" id="h27-0-1014" class="i">+  let s:clone_opt = get(g:, &#39;plug_shallow&#39;, 1) ?
</a><a href="#h27-0-1015" id="h27-0-1015" class="i">+        \ &#39;--depth 1&#39; . (s:git_version_requirement(1, 7, 10) ? &#39; --no-single-branch&#39; : &#39;&#39;) : &#39;&#39;
</a><a href="#h27-0-1016" id="h27-0-1016" class="i">+
</a><a href="#h27-0-1017" id="h27-0-1017" class="i">+  if has(&#39;win32unix&#39;)
</a><a href="#h27-0-1018" id="h27-0-1018" class="i">+    let s:clone_opt .= &#39; -c core.eol=lf -c core.autocrlf=input&#39;
</a><a href="#h27-0-1019" id="h27-0-1019" class="i">+  endif
</a><a href="#h27-0-1020" id="h27-0-1020" class="i">+
</a><a href="#h27-0-1021" id="h27-0-1021" class="i">+  let s:submodule_opt = s:git_version_requirement(2, 8) ? &#39; --jobs=&#39;.threads : &#39;&#39;
</a><a href="#h27-0-1022" id="h27-0-1022" class="i">+
</a><a href="#h27-0-1023" id="h27-0-1023" class="i">+  &quot; Python version requirement (&gt;= 2.7)
</a><a href="#h27-0-1024" id="h27-0-1024" class="i">+  if python &amp;&amp; !has(&#39;python3&#39;) &amp;&amp; !ruby &amp;&amp; !use_job &amp;&amp; s:update.threads &gt; 1
</a><a href="#h27-0-1025" id="h27-0-1025" class="i">+    redir =&gt; pyv
</a><a href="#h27-0-1026" id="h27-0-1026" class="i">+    silent python import platform; print platform.python_version()
</a><a href="#h27-0-1027" id="h27-0-1027" class="i">+    redir END
</a><a href="#h27-0-1028" id="h27-0-1028" class="i">+    let python = s:version_requirement(
</a><a href="#h27-0-1029" id="h27-0-1029" class="i">+          \ map(split(split(pyv)[0], &#39;\.&#39;), &#39;str2nr(v:val)&#39;), [2, 6])
</a><a href="#h27-0-1030" id="h27-0-1030" class="i">+  endif
</a><a href="#h27-0-1031" id="h27-0-1031" class="i">+
</a><a href="#h27-0-1032" id="h27-0-1032" class="i">+  if (python || ruby) &amp;&amp; s:update.threads &gt; 1
</a><a href="#h27-0-1033" id="h27-0-1033" class="i">+    try
</a><a href="#h27-0-1034" id="h27-0-1034" class="i">+      let imd = &amp;imd
</a><a href="#h27-0-1035" id="h27-0-1035" class="i">+      if s:mac_gui
</a><a href="#h27-0-1036" id="h27-0-1036" class="i">+        set noimd
</a><a href="#h27-0-1037" id="h27-0-1037" class="i">+      endif
</a><a href="#h27-0-1038" id="h27-0-1038" class="i">+      if ruby
</a><a href="#h27-0-1039" id="h27-0-1039" class="i">+        call s:update_ruby()
</a><a href="#h27-0-1040" id="h27-0-1040" class="i">+      else
</a><a href="#h27-0-1041" id="h27-0-1041" class="i">+        call s:update_python()
</a><a href="#h27-0-1042" id="h27-0-1042" class="i">+      endif
</a><a href="#h27-0-1043" id="h27-0-1043" class="i">+    catch
</a><a href="#h27-0-1044" id="h27-0-1044" class="i">+      let lines = getline(4, &#39;$&#39;)
</a><a href="#h27-0-1045" id="h27-0-1045" class="i">+      let printed = {}
</a><a href="#h27-0-1046" id="h27-0-1046" class="i">+      silent! 4,$d _
</a><a href="#h27-0-1047" id="h27-0-1047" class="i">+      for line in lines
</a><a href="#h27-0-1048" id="h27-0-1048" class="i">+        let name = s:extract_name(line, &#39;.&#39;, &#39;&#39;)
</a><a href="#h27-0-1049" id="h27-0-1049" class="i">+        if empty(name) || !has_key(printed, name)
</a><a href="#h27-0-1050" id="h27-0-1050" class="i">+          call append(&#39;$&#39;, line)
</a><a href="#h27-0-1051" id="h27-0-1051" class="i">+          if !empty(name)
</a><a href="#h27-0-1052" id="h27-0-1052" class="i">+            let printed[name] = 1
</a><a href="#h27-0-1053" id="h27-0-1053" class="i">+            if line[0] == &#39;x&#39; &amp;&amp; index(s:update.errors, name) &lt; 0
</a><a href="#h27-0-1054" id="h27-0-1054" class="i">+              call add(s:update.errors, name)
</a><a href="#h27-0-1055" id="h27-0-1055" class="i">+            end
</a><a href="#h27-0-1056" id="h27-0-1056" class="i">+          endif
</a><a href="#h27-0-1057" id="h27-0-1057" class="i">+        endif
</a><a href="#h27-0-1058" id="h27-0-1058" class="i">+      endfor
</a><a href="#h27-0-1059" id="h27-0-1059" class="i">+    finally
</a><a href="#h27-0-1060" id="h27-0-1060" class="i">+      let &amp;imd = imd
</a><a href="#h27-0-1061" id="h27-0-1061" class="i">+      call s:update_finish()
</a><a href="#h27-0-1062" id="h27-0-1062" class="i">+    endtry
</a><a href="#h27-0-1063" id="h27-0-1063" class="i">+  else
</a><a href="#h27-0-1064" id="h27-0-1064" class="i">+    call s:update_vim()
</a><a href="#h27-0-1065" id="h27-0-1065" class="i">+    while use_job &amp;&amp; sync
</a><a href="#h27-0-1066" id="h27-0-1066" class="i">+      sleep 100m
</a><a href="#h27-0-1067" id="h27-0-1067" class="i">+      if s:update.fin
</a><a href="#h27-0-1068" id="h27-0-1068" class="i">+        break
</a><a href="#h27-0-1069" id="h27-0-1069" class="i">+      endif
</a><a href="#h27-0-1070" id="h27-0-1070" class="i">+    endwhile
</a><a href="#h27-0-1071" id="h27-0-1071" class="i">+  endif
</a><a href="#h27-0-1072" id="h27-0-1072" class="i">+endfunction
</a><a href="#h27-0-1073" id="h27-0-1073" class="i">+
</a><a href="#h27-0-1074" id="h27-0-1074" class="i">+function! s:log4(name, msg)
</a><a href="#h27-0-1075" id="h27-0-1075" class="i">+  call setline(4, printf(&#39;- %s (%s)&#39;, a:msg, a:name))
</a><a href="#h27-0-1076" id="h27-0-1076" class="i">+  redraw
</a><a href="#h27-0-1077" id="h27-0-1077" class="i">+endfunction
</a><a href="#h27-0-1078" id="h27-0-1078" class="i">+
</a><a href="#h27-0-1079" id="h27-0-1079" class="i">+function! s:update_finish()
</a><a href="#h27-0-1080" id="h27-0-1080" class="i">+  if exists(&#39;s:git_terminal_prompt&#39;)
</a><a href="#h27-0-1081" id="h27-0-1081" class="i">+    let $GIT_TERMINAL_PROMPT = s:git_terminal_prompt
</a><a href="#h27-0-1082" id="h27-0-1082" class="i">+  endif
</a><a href="#h27-0-1083" id="h27-0-1083" class="i">+  if s:switch_in()
</a><a href="#h27-0-1084" id="h27-0-1084" class="i">+    call append(3, &#39;- Updating ...&#39;) | 4
</a><a href="#h27-0-1085" id="h27-0-1085" class="i">+    for [name, spec] in items(filter(copy(s:update.all), &#39;index(s:update.errors, v:key) &lt; 0 &amp;&amp; (s:update.force || s:update.pull || has_key(s:update.new, v:key))&#39;))
</a><a href="#h27-0-1086" id="h27-0-1086" class="i">+      let [pos, _] = s:logpos(name)
</a><a href="#h27-0-1087" id="h27-0-1087" class="i">+      if !pos
</a><a href="#h27-0-1088" id="h27-0-1088" class="i">+        continue
</a><a href="#h27-0-1089" id="h27-0-1089" class="i">+      endif
</a><a href="#h27-0-1090" id="h27-0-1090" class="i">+      if has_key(spec, &#39;commit&#39;)
</a><a href="#h27-0-1091" id="h27-0-1091" class="i">+        call s:log4(name, &#39;Checking out &#39;.spec.commit)
</a><a href="#h27-0-1092" id="h27-0-1092" class="i">+        let out = s:checkout(spec)
</a><a href="#h27-0-1093" id="h27-0-1093" class="i">+      elseif has_key(spec, &#39;tag&#39;)
</a><a href="#h27-0-1094" id="h27-0-1094" class="i">+        let tag = spec.tag
</a><a href="#h27-0-1095" id="h27-0-1095" class="i">+        if tag =~ &#39;\*&#39;
</a><a href="#h27-0-1096" id="h27-0-1096" class="i">+          let tags = s:lines(s:system(&#39;git tag --list &#39;.s:shellesc(tag).&#39; --sort -version:refname 2&gt;&amp;1&#39;, spec.dir))
</a><a href="#h27-0-1097" id="h27-0-1097" class="i">+          if !v:shell_error &amp;&amp; !empty(tags)
</a><a href="#h27-0-1098" id="h27-0-1098" class="i">+            let tag = tags[0]
</a><a href="#h27-0-1099" id="h27-0-1099" class="i">+            call s:log4(name, printf(&#39;Latest tag for %s -&gt; %s&#39;, spec.tag, tag))
</a><a href="#h27-0-1100" id="h27-0-1100" class="i">+            call append(3, &#39;&#39;)
</a><a href="#h27-0-1101" id="h27-0-1101" class="i">+          endif
</a><a href="#h27-0-1102" id="h27-0-1102" class="i">+        endif
</a><a href="#h27-0-1103" id="h27-0-1103" class="i">+        call s:log4(name, &#39;Checking out &#39;.tag)
</a><a href="#h27-0-1104" id="h27-0-1104" class="i">+        let out = s:system(&#39;git checkout -q &#39;.s:esc(tag).&#39; -- 2&gt;&amp;1&#39;, spec.dir)
</a><a href="#h27-0-1105" id="h27-0-1105" class="i">+      else
</a><a href="#h27-0-1106" id="h27-0-1106" class="i">+        let branch = s:esc(get(spec, &#39;branch&#39;, &#39;master&#39;))
</a><a href="#h27-0-1107" id="h27-0-1107" class="i">+        call s:log4(name, &#39;Merging origin/&#39;.branch)
</a><a href="#h27-0-1108" id="h27-0-1108" class="i">+        let out = s:system(&#39;git checkout -q &#39;.branch.&#39; -- 2&gt;&amp;1&#39;
</a><a href="#h27-0-1109" id="h27-0-1109" class="i">+              \. (has_key(s:update.new, name) ? &#39;&#39; : (&#39;&amp;&amp; git merge --ff-only origin/&#39;.branch.&#39; 2&gt;&amp;1&#39;)), spec.dir)
</a><a href="#h27-0-1110" id="h27-0-1110" class="i">+      endif
</a><a href="#h27-0-1111" id="h27-0-1111" class="i">+      if !v:shell_error &amp;&amp; filereadable(spec.dir.&#39;/.gitmodules&#39;) &amp;&amp;
</a><a href="#h27-0-1112" id="h27-0-1112" class="i">+            \ (s:update.force || has_key(s:update.new, name) || s:is_updated(spec.dir))
</a><a href="#h27-0-1113" id="h27-0-1113" class="i">+        call s:log4(name, &#39;Updating submodules. This may take a while.&#39;)
</a><a href="#h27-0-1114" id="h27-0-1114" class="i">+        let out .= s:bang(&#39;git submodule update --init --recursive&#39;.s:submodule_opt.&#39; 2&gt;&amp;1&#39;, spec.dir)
</a><a href="#h27-0-1115" id="h27-0-1115" class="i">+      endif
</a><a href="#h27-0-1116" id="h27-0-1116" class="i">+      let msg = s:format_message(v:shell_error ? &#39;x&#39;: &#39;-&#39;, name, out)
</a><a href="#h27-0-1117" id="h27-0-1117" class="i">+      if v:shell_error
</a><a href="#h27-0-1118" id="h27-0-1118" class="i">+        call add(s:update.errors, name)
</a><a href="#h27-0-1119" id="h27-0-1119" class="i">+        call s:regress_bar()
</a><a href="#h27-0-1120" id="h27-0-1120" class="i">+        silent execute pos &#39;d _&#39;
</a><a href="#h27-0-1121" id="h27-0-1121" class="i">+        call append(4, msg) | 4
</a><a href="#h27-0-1122" id="h27-0-1122" class="i">+      elseif !empty(out)
</a><a href="#h27-0-1123" id="h27-0-1123" class="i">+        call setline(pos, msg[0])
</a><a href="#h27-0-1124" id="h27-0-1124" class="i">+      endif
</a><a href="#h27-0-1125" id="h27-0-1125" class="i">+      redraw
</a><a href="#h27-0-1126" id="h27-0-1126" class="i">+    endfor
</a><a href="#h27-0-1127" id="h27-0-1127" class="i">+    silent 4 d _
</a><a href="#h27-0-1128" id="h27-0-1128" class="i">+    try
</a><a href="#h27-0-1129" id="h27-0-1129" class="i">+      call s:do(s:update.pull, s:update.force, filter(copy(s:update.all), &#39;index(s:update.errors, v:key) &lt; 0 &amp;&amp; has_key(v:val, &quot;do&quot;)&#39;))
</a><a href="#h27-0-1130" id="h27-0-1130" class="i">+    catch
</a><a href="#h27-0-1131" id="h27-0-1131" class="i">+      call s:warn(&#39;echom&#39;, v:exception)
</a><a href="#h27-0-1132" id="h27-0-1132" class="i">+      call s:warn(&#39;echo&#39;, &#39;&#39;)
</a><a href="#h27-0-1133" id="h27-0-1133" class="i">+      return
</a><a href="#h27-0-1134" id="h27-0-1134" class="i">+    endtry
</a><a href="#h27-0-1135" id="h27-0-1135" class="i">+    call s:finish(s:update.pull)
</a><a href="#h27-0-1136" id="h27-0-1136" class="i">+    call setline(1, &#39;Updated. Elapsed time: &#39; . split(reltimestr(reltime(s:update.start)))[0] . &#39; sec.&#39;)
</a><a href="#h27-0-1137" id="h27-0-1137" class="i">+    call s:switch_out(&#39;normal! gg&#39;)
</a><a href="#h27-0-1138" id="h27-0-1138" class="i">+  endif
</a><a href="#h27-0-1139" id="h27-0-1139" class="i">+endfunction
</a><a href="#h27-0-1140" id="h27-0-1140" class="i">+
</a><a href="#h27-0-1141" id="h27-0-1141" class="i">+function! s:job_abort()
</a><a href="#h27-0-1142" id="h27-0-1142" class="i">+  if (!s:nvim &amp;&amp; !s:vim8) || !exists(&#39;s:jobs&#39;)
</a><a href="#h27-0-1143" id="h27-0-1143" class="i">+    return
</a><a href="#h27-0-1144" id="h27-0-1144" class="i">+  endif
</a><a href="#h27-0-1145" id="h27-0-1145" class="i">+
</a><a href="#h27-0-1146" id="h27-0-1146" class="i">+  for [name, j] in items(s:jobs)
</a><a href="#h27-0-1147" id="h27-0-1147" class="i">+    if s:nvim
</a><a href="#h27-0-1148" id="h27-0-1148" class="i">+      silent! call jobstop(j.jobid)
</a><a href="#h27-0-1149" id="h27-0-1149" class="i">+    elseif s:vim8
</a><a href="#h27-0-1150" id="h27-0-1150" class="i">+      silent! call job_stop(j.jobid)
</a><a href="#h27-0-1151" id="h27-0-1151" class="i">+    endif
</a><a href="#h27-0-1152" id="h27-0-1152" class="i">+    if j.new
</a><a href="#h27-0-1153" id="h27-0-1153" class="i">+      call s:system(&#39;rm -rf &#39; . s:shellesc(g:plugs[name].dir))
</a><a href="#h27-0-1154" id="h27-0-1154" class="i">+    endif
</a><a href="#h27-0-1155" id="h27-0-1155" class="i">+  endfor
</a><a href="#h27-0-1156" id="h27-0-1156" class="i">+  let s:jobs = {}
</a><a href="#h27-0-1157" id="h27-0-1157" class="i">+endfunction
</a><a href="#h27-0-1158" id="h27-0-1158" class="i">+
</a><a href="#h27-0-1159" id="h27-0-1159" class="i">+function! s:last_non_empty_line(lines)
</a><a href="#h27-0-1160" id="h27-0-1160" class="i">+  let len = len(a:lines)
</a><a href="#h27-0-1161" id="h27-0-1161" class="i">+  for idx in range(len)
</a><a href="#h27-0-1162" id="h27-0-1162" class="i">+    let line = a:lines[len-idx-1]
</a><a href="#h27-0-1163" id="h27-0-1163" class="i">+    if !empty(line)
</a><a href="#h27-0-1164" id="h27-0-1164" class="i">+      return line
</a><a href="#h27-0-1165" id="h27-0-1165" class="i">+    endif
</a><a href="#h27-0-1166" id="h27-0-1166" class="i">+  endfor
</a><a href="#h27-0-1167" id="h27-0-1167" class="i">+  return &#39;&#39;
</a><a href="#h27-0-1168" id="h27-0-1168" class="i">+endfunction
</a><a href="#h27-0-1169" id="h27-0-1169" class="i">+
</a><a href="#h27-0-1170" id="h27-0-1170" class="i">+function! s:job_out_cb(self, data) abort
</a><a href="#h27-0-1171" id="h27-0-1171" class="i">+  let self = a:self
</a><a href="#h27-0-1172" id="h27-0-1172" class="i">+  let data = remove(self.lines, -1) . a:data
</a><a href="#h27-0-1173" id="h27-0-1173" class="i">+  let lines = map(split(data, &quot;\n&quot;, 1), &#39;split(v:val, &quot;\r&quot;, 1)[-1]&#39;)
</a><a href="#h27-0-1174" id="h27-0-1174" class="i">+  call extend(self.lines, lines)
</a><a href="#h27-0-1175" id="h27-0-1175" class="i">+  &quot; To reduce the number of buffer updates
</a><a href="#h27-0-1176" id="h27-0-1176" class="i">+  let self.tick = get(self, &#39;tick&#39;, -1) + 1
</a><a href="#h27-0-1177" id="h27-0-1177" class="i">+  if !self.running || self.tick % len(s:jobs) == 0
</a><a href="#h27-0-1178" id="h27-0-1178" class="i">+    let bullet = self.running ? (self.new ? &#39;+&#39; : &#39;*&#39;) : (self.error ? &#39;x&#39; : &#39;-&#39;)
</a><a href="#h27-0-1179" id="h27-0-1179" class="i">+    let result = self.error ? join(self.lines, &quot;\n&quot;) : s:last_non_empty_line(self.lines)
</a><a href="#h27-0-1180" id="h27-0-1180" class="i">+    call s:log(bullet, self.name, result)
</a><a href="#h27-0-1181" id="h27-0-1181" class="i">+  endif
</a><a href="#h27-0-1182" id="h27-0-1182" class="i">+endfunction
</a><a href="#h27-0-1183" id="h27-0-1183" class="i">+
</a><a href="#h27-0-1184" id="h27-0-1184" class="i">+function! s:job_exit_cb(self, data) abort
</a><a href="#h27-0-1185" id="h27-0-1185" class="i">+  let a:self.running = 0
</a><a href="#h27-0-1186" id="h27-0-1186" class="i">+  let a:self.error = a:data != 0
</a><a href="#h27-0-1187" id="h27-0-1187" class="i">+  call s:reap(a:self.name)
</a><a href="#h27-0-1188" id="h27-0-1188" class="i">+  call s:tick()
</a><a href="#h27-0-1189" id="h27-0-1189" class="i">+endfunction
</a><a href="#h27-0-1190" id="h27-0-1190" class="i">+
</a><a href="#h27-0-1191" id="h27-0-1191" class="i">+function! s:job_cb(fn, job, ch, data)
</a><a href="#h27-0-1192" id="h27-0-1192" class="i">+  if !s:plug_window_exists() &quot; plug window closed
</a><a href="#h27-0-1193" id="h27-0-1193" class="i">+    return s:job_abort()
</a><a href="#h27-0-1194" id="h27-0-1194" class="i">+  endif
</a><a href="#h27-0-1195" id="h27-0-1195" class="i">+  call call(a:fn, [a:job, a:data])
</a><a href="#h27-0-1196" id="h27-0-1196" class="i">+endfunction
</a><a href="#h27-0-1197" id="h27-0-1197" class="i">+
</a><a href="#h27-0-1198" id="h27-0-1198" class="i">+function! s:nvim_cb(job_id, data, event) dict abort
</a><a href="#h27-0-1199" id="h27-0-1199" class="i">+  return a:event == &#39;stdout&#39; ?
</a><a href="#h27-0-1200" id="h27-0-1200" class="i">+    \ s:job_cb(&#39;s:job_out_cb&#39;,  self, 0, join(a:data, &quot;\n&quot;)) :
</a><a href="#h27-0-1201" id="h27-0-1201" class="i">+    \ s:job_cb(&#39;s:job_exit_cb&#39;, self, 0, a:data)
</a><a href="#h27-0-1202" id="h27-0-1202" class="i">+endfunction
</a><a href="#h27-0-1203" id="h27-0-1203" class="i">+
</a><a href="#h27-0-1204" id="h27-0-1204" class="i">+function! s:spawn(name, cmd, opts)
</a><a href="#h27-0-1205" id="h27-0-1205" class="i">+  let job = { &#39;name&#39;: a:name, &#39;running&#39;: 1, &#39;error&#39;: 0, &#39;lines&#39;: [&#39;&#39;],
</a><a href="#h27-0-1206" id="h27-0-1206" class="i">+            \ &#39;batchfile&#39;: (s:is_win &amp;&amp; (s:nvim || s:vim8)) ? tempname().&#39;.bat&#39; : &#39;&#39;,
</a><a href="#h27-0-1207" id="h27-0-1207" class="i">+            \ &#39;new&#39;: get(a:opts, &#39;new&#39;, 0) }
</a><a href="#h27-0-1208" id="h27-0-1208" class="i">+  let s:jobs[a:name] = job
</a><a href="#h27-0-1209" id="h27-0-1209" class="i">+  let cmd = has_key(a:opts, &#39;dir&#39;) ? s:with_cd(a:cmd, a:opts.dir) : a:cmd
</a><a href="#h27-0-1210" id="h27-0-1210" class="i">+  if !empty(job.batchfile)
</a><a href="#h27-0-1211" id="h27-0-1211" class="i">+    call writefile([&quot;@echo off\r&quot;, cmd . &quot;\r&quot;], job.batchfile)
</a><a href="#h27-0-1212" id="h27-0-1212" class="i">+    let cmd = job.batchfile
</a><a href="#h27-0-1213" id="h27-0-1213" class="i">+  endif
</a><a href="#h27-0-1214" id="h27-0-1214" class="i">+  let argv = add(s:is_win ? [&#39;cmd&#39;, &#39;/c&#39;] : [&#39;sh&#39;, &#39;-c&#39;], cmd)
</a><a href="#h27-0-1215" id="h27-0-1215" class="i">+
</a><a href="#h27-0-1216" id="h27-0-1216" class="i">+  if s:nvim
</a><a href="#h27-0-1217" id="h27-0-1217" class="i">+    call extend(job, {
</a><a href="#h27-0-1218" id="h27-0-1218" class="i">+    \ &#39;on_stdout&#39;: function(&#39;s:nvim_cb&#39;),
</a><a href="#h27-0-1219" id="h27-0-1219" class="i">+    \ &#39;on_exit&#39;:   function(&#39;s:nvim_cb&#39;),
</a><a href="#h27-0-1220" id="h27-0-1220" class="i">+    \ })
</a><a href="#h27-0-1221" id="h27-0-1221" class="i">+    let jid = jobstart(argv, job)
</a><a href="#h27-0-1222" id="h27-0-1222" class="i">+    if jid &gt; 0
</a><a href="#h27-0-1223" id="h27-0-1223" class="i">+      let job.jobid = jid
</a><a href="#h27-0-1224" id="h27-0-1224" class="i">+    else
</a><a href="#h27-0-1225" id="h27-0-1225" class="i">+      let job.running = 0
</a><a href="#h27-0-1226" id="h27-0-1226" class="i">+      let job.error   = 1
</a><a href="#h27-0-1227" id="h27-0-1227" class="i">+      let job.lines   = [jid &lt; 0 ? argv[0].&#39; is not executable&#39; :
</a><a href="#h27-0-1228" id="h27-0-1228" class="i">+            \ &#39;Invalid arguments (or job table is full)&#39;]
</a><a href="#h27-0-1229" id="h27-0-1229" class="i">+    endif
</a><a href="#h27-0-1230" id="h27-0-1230" class="i">+  elseif s:vim8
</a><a href="#h27-0-1231" id="h27-0-1231" class="i">+    let jid = job_start(s:is_win ? join(argv, &#39; &#39;) : argv, {
</a><a href="#h27-0-1232" id="h27-0-1232" class="i">+    \ &#39;out_cb&#39;:   function(&#39;s:job_cb&#39;, [&#39;s:job_out_cb&#39;,  job]),
</a><a href="#h27-0-1233" id="h27-0-1233" class="i">+    \ &#39;exit_cb&#39;:  function(&#39;s:job_cb&#39;, [&#39;s:job_exit_cb&#39;, job]),
</a><a href="#h27-0-1234" id="h27-0-1234" class="i">+    \ &#39;out_mode&#39;: &#39;raw&#39;
</a><a href="#h27-0-1235" id="h27-0-1235" class="i">+    \})
</a><a href="#h27-0-1236" id="h27-0-1236" class="i">+    if job_status(jid) == &#39;run&#39;
</a><a href="#h27-0-1237" id="h27-0-1237" class="i">+      let job.jobid = jid
</a><a href="#h27-0-1238" id="h27-0-1238" class="i">+    else
</a><a href="#h27-0-1239" id="h27-0-1239" class="i">+      let job.running = 0
</a><a href="#h27-0-1240" id="h27-0-1240" class="i">+      let job.error   = 1
</a><a href="#h27-0-1241" id="h27-0-1241" class="i">+      let job.lines   = [&#39;Failed to start job&#39;]
</a><a href="#h27-0-1242" id="h27-0-1242" class="i">+    endif
</a><a href="#h27-0-1243" id="h27-0-1243" class="i">+  else
</a><a href="#h27-0-1244" id="h27-0-1244" class="i">+    let job.lines = s:lines(call(&#39;s:system&#39;, [cmd]))
</a><a href="#h27-0-1245" id="h27-0-1245" class="i">+    let job.error = v:shell_error != 0
</a><a href="#h27-0-1246" id="h27-0-1246" class="i">+    let job.running = 0
</a><a href="#h27-0-1247" id="h27-0-1247" class="i">+  endif
</a><a href="#h27-0-1248" id="h27-0-1248" class="i">+endfunction
</a><a href="#h27-0-1249" id="h27-0-1249" class="i">+
</a><a href="#h27-0-1250" id="h27-0-1250" class="i">+function! s:reap(name)
</a><a href="#h27-0-1251" id="h27-0-1251" class="i">+  let job = s:jobs[a:name]
</a><a href="#h27-0-1252" id="h27-0-1252" class="i">+  if job.error
</a><a href="#h27-0-1253" id="h27-0-1253" class="i">+    call add(s:update.errors, a:name)
</a><a href="#h27-0-1254" id="h27-0-1254" class="i">+  elseif get(job, &#39;new&#39;, 0)
</a><a href="#h27-0-1255" id="h27-0-1255" class="i">+    let s:update.new[a:name] = 1
</a><a href="#h27-0-1256" id="h27-0-1256" class="i">+  endif
</a><a href="#h27-0-1257" id="h27-0-1257" class="i">+  let s:update.bar .= job.error ? &#39;x&#39; : &#39;=&#39;
</a><a href="#h27-0-1258" id="h27-0-1258" class="i">+
</a><a href="#h27-0-1259" id="h27-0-1259" class="i">+  let bullet = job.error ? &#39;x&#39; : &#39;-&#39;
</a><a href="#h27-0-1260" id="h27-0-1260" class="i">+  let result = job.error ? join(job.lines, &quot;\n&quot;) : s:last_non_empty_line(job.lines)
</a><a href="#h27-0-1261" id="h27-0-1261" class="i">+  call s:log(bullet, a:name, empty(result) ? &#39;OK&#39; : result)
</a><a href="#h27-0-1262" id="h27-0-1262" class="i">+  call s:bar()
</a><a href="#h27-0-1263" id="h27-0-1263" class="i">+
</a><a href="#h27-0-1264" id="h27-0-1264" class="i">+  if has_key(job, &#39;batchfile&#39;) &amp;&amp; !empty(job.batchfile)
</a><a href="#h27-0-1265" id="h27-0-1265" class="i">+    call delete(job.batchfile)
</a><a href="#h27-0-1266" id="h27-0-1266" class="i">+  endif
</a><a href="#h27-0-1267" id="h27-0-1267" class="i">+  call remove(s:jobs, a:name)
</a><a href="#h27-0-1268" id="h27-0-1268" class="i">+endfunction
</a><a href="#h27-0-1269" id="h27-0-1269" class="i">+
</a><a href="#h27-0-1270" id="h27-0-1270" class="i">+function! s:bar()
</a><a href="#h27-0-1271" id="h27-0-1271" class="i">+  if s:switch_in()
</a><a href="#h27-0-1272" id="h27-0-1272" class="i">+    let total = len(s:update.all)
</a><a href="#h27-0-1273" id="h27-0-1273" class="i">+    call setline(1, (s:update.pull ? &#39;Updating&#39; : &#39;Installing&#39;).
</a><a href="#h27-0-1274" id="h27-0-1274" class="i">+          \ &#39; plugins (&#39;.len(s:update.bar).&#39;/&#39;.total.&#39;)&#39;)
</a><a href="#h27-0-1275" id="h27-0-1275" class="i">+    call s:progress_bar(2, s:update.bar, total)
</a><a href="#h27-0-1276" id="h27-0-1276" class="i">+    call s:switch_out()
</a><a href="#h27-0-1277" id="h27-0-1277" class="i">+  endif
</a><a href="#h27-0-1278" id="h27-0-1278" class="i">+endfunction
</a><a href="#h27-0-1279" id="h27-0-1279" class="i">+
</a><a href="#h27-0-1280" id="h27-0-1280" class="i">+function! s:logpos(name)
</a><a href="#h27-0-1281" id="h27-0-1281" class="i">+  for i in range(4, line(&#39;$&#39;))
</a><a href="#h27-0-1282" id="h27-0-1282" class="i">+    if getline(i) =~# &#39;^[-+x*] &#39;.a:name.&#39;:&#39;
</a><a href="#h27-0-1283" id="h27-0-1283" class="i">+      for j in range(i + 1, line(&#39;$&#39;))
</a><a href="#h27-0-1284" id="h27-0-1284" class="i">+        if getline(j) !~ &#39;^ &#39;
</a><a href="#h27-0-1285" id="h27-0-1285" class="i">+          return [i, j - 1]
</a><a href="#h27-0-1286" id="h27-0-1286" class="i">+        endif
</a><a href="#h27-0-1287" id="h27-0-1287" class="i">+      endfor
</a><a href="#h27-0-1288" id="h27-0-1288" class="i">+      return [i, i]
</a><a href="#h27-0-1289" id="h27-0-1289" class="i">+    endif
</a><a href="#h27-0-1290" id="h27-0-1290" class="i">+  endfor
</a><a href="#h27-0-1291" id="h27-0-1291" class="i">+  return [0, 0]
</a><a href="#h27-0-1292" id="h27-0-1292" class="i">+endfunction
</a><a href="#h27-0-1293" id="h27-0-1293" class="i">+
</a><a href="#h27-0-1294" id="h27-0-1294" class="i">+function! s:log(bullet, name, lines)
</a><a href="#h27-0-1295" id="h27-0-1295" class="i">+  if s:switch_in()
</a><a href="#h27-0-1296" id="h27-0-1296" class="i">+    let [b, e] = s:logpos(a:name)
</a><a href="#h27-0-1297" id="h27-0-1297" class="i">+    if b &gt; 0
</a><a href="#h27-0-1298" id="h27-0-1298" class="i">+      silent execute printf(&#39;%d,%d d _&#39;, b, e)
</a><a href="#h27-0-1299" id="h27-0-1299" class="i">+      if b &gt; winheight(&#39;.&#39;)
</a><a href="#h27-0-1300" id="h27-0-1300" class="i">+        let b = 4
</a><a href="#h27-0-1301" id="h27-0-1301" class="i">+      endif
</a><a href="#h27-0-1302" id="h27-0-1302" class="i">+    else
</a><a href="#h27-0-1303" id="h27-0-1303" class="i">+      let b = 4
</a><a href="#h27-0-1304" id="h27-0-1304" class="i">+    endif
</a><a href="#h27-0-1305" id="h27-0-1305" class="i">+    &quot; FIXME For some reason, nomodifiable is set after :d in vim8
</a><a href="#h27-0-1306" id="h27-0-1306" class="i">+    setlocal modifiable
</a><a href="#h27-0-1307" id="h27-0-1307" class="i">+    call append(b - 1, s:format_message(a:bullet, a:name, a:lines))
</a><a href="#h27-0-1308" id="h27-0-1308" class="i">+    call s:switch_out()
</a><a href="#h27-0-1309" id="h27-0-1309" class="i">+  endif
</a><a href="#h27-0-1310" id="h27-0-1310" class="i">+endfunction
</a><a href="#h27-0-1311" id="h27-0-1311" class="i">+
</a><a href="#h27-0-1312" id="h27-0-1312" class="i">+function! s:update_vim()
</a><a href="#h27-0-1313" id="h27-0-1313" class="i">+  let s:jobs = {}
</a><a href="#h27-0-1314" id="h27-0-1314" class="i">+
</a><a href="#h27-0-1315" id="h27-0-1315" class="i">+  call s:bar()
</a><a href="#h27-0-1316" id="h27-0-1316" class="i">+  call s:tick()
</a><a href="#h27-0-1317" id="h27-0-1317" class="i">+endfunction
</a><a href="#h27-0-1318" id="h27-0-1318" class="i">+
</a><a href="#h27-0-1319" id="h27-0-1319" class="i">+function! s:tick()
</a><a href="#h27-0-1320" id="h27-0-1320" class="i">+  let pull = s:update.pull
</a><a href="#h27-0-1321" id="h27-0-1321" class="i">+  let prog = s:progress_opt(s:nvim || s:vim8)
</a><a href="#h27-0-1322" id="h27-0-1322" class="i">+while 1 &quot; Without TCO, Vim stack is bound to explode
</a><a href="#h27-0-1323" id="h27-0-1323" class="i">+  if empty(s:update.todo)
</a><a href="#h27-0-1324" id="h27-0-1324" class="i">+    if empty(s:jobs) &amp;&amp; !s:update.fin
</a><a href="#h27-0-1325" id="h27-0-1325" class="i">+      call s:update_finish()
</a><a href="#h27-0-1326" id="h27-0-1326" class="i">+      let s:update.fin = 1
</a><a href="#h27-0-1327" id="h27-0-1327" class="i">+    endif
</a><a href="#h27-0-1328" id="h27-0-1328" class="i">+    return
</a><a href="#h27-0-1329" id="h27-0-1329" class="i">+  endif
</a><a href="#h27-0-1330" id="h27-0-1330" class="i">+
</a><a href="#h27-0-1331" id="h27-0-1331" class="i">+  let name = keys(s:update.todo)[0]
</a><a href="#h27-0-1332" id="h27-0-1332" class="i">+  let spec = remove(s:update.todo, name)
</a><a href="#h27-0-1333" id="h27-0-1333" class="i">+  let new  = empty(globpath(spec.dir, &#39;.git&#39;, 1))
</a><a href="#h27-0-1334" id="h27-0-1334" class="i">+
</a><a href="#h27-0-1335" id="h27-0-1335" class="i">+  call s:log(new ? &#39;+&#39; : &#39;*&#39;, name, pull ? &#39;Updating ...&#39; : &#39;Installing ...&#39;)
</a><a href="#h27-0-1336" id="h27-0-1336" class="i">+  redraw
</a><a href="#h27-0-1337" id="h27-0-1337" class="i">+
</a><a href="#h27-0-1338" id="h27-0-1338" class="i">+  let has_tag = has_key(spec, &#39;tag&#39;)
</a><a href="#h27-0-1339" id="h27-0-1339" class="i">+  if !new
</a><a href="#h27-0-1340" id="h27-0-1340" class="i">+    let [error, _] = s:git_validate(spec, 0)
</a><a href="#h27-0-1341" id="h27-0-1341" class="i">+    if empty(error)
</a><a href="#h27-0-1342" id="h27-0-1342" class="i">+      if pull
</a><a href="#h27-0-1343" id="h27-0-1343" class="i">+        let fetch_opt = (has_tag &amp;&amp; !empty(globpath(spec.dir, &#39;.git/shallow&#39;))) ? &#39;--depth 99999999&#39; : &#39;&#39;
</a><a href="#h27-0-1344" id="h27-0-1344" class="i">+        call s:spawn(name, printf(&#39;git fetch %s %s 2&gt;&amp;1&#39;, fetch_opt, prog), { &#39;dir&#39;: spec.dir })
</a><a href="#h27-0-1345" id="h27-0-1345" class="i">+      else
</a><a href="#h27-0-1346" id="h27-0-1346" class="i">+        let s:jobs[name] = { &#39;running&#39;: 0, &#39;lines&#39;: [&#39;Already installed&#39;], &#39;error&#39;: 0 }
</a><a href="#h27-0-1347" id="h27-0-1347" class="i">+      endif
</a><a href="#h27-0-1348" id="h27-0-1348" class="i">+    else
</a><a href="#h27-0-1349" id="h27-0-1349" class="i">+      let s:jobs[name] = { &#39;running&#39;: 0, &#39;lines&#39;: s:lines(error), &#39;error&#39;: 1 }
</a><a href="#h27-0-1350" id="h27-0-1350" class="i">+    endif
</a><a href="#h27-0-1351" id="h27-0-1351" class="i">+  else
</a><a href="#h27-0-1352" id="h27-0-1352" class="i">+    call s:spawn(name,
</a><a href="#h27-0-1353" id="h27-0-1353" class="i">+          \ printf(&#39;git clone %s %s %s %s 2&gt;&amp;1&#39;,
</a><a href="#h27-0-1354" id="h27-0-1354" class="i">+          \ has_tag ? &#39;&#39; : s:clone_opt,
</a><a href="#h27-0-1355" id="h27-0-1355" class="i">+          \ prog,
</a><a href="#h27-0-1356" id="h27-0-1356" class="i">+          \ s:shellesc(spec.uri),
</a><a href="#h27-0-1357" id="h27-0-1357" class="i">+          \ s:shellesc(s:trim(spec.dir))), { &#39;new&#39;: 1 })
</a><a href="#h27-0-1358" id="h27-0-1358" class="i">+  endif
</a><a href="#h27-0-1359" id="h27-0-1359" class="i">+
</a><a href="#h27-0-1360" id="h27-0-1360" class="i">+  if !s:jobs[name].running
</a><a href="#h27-0-1361" id="h27-0-1361" class="i">+    call s:reap(name)
</a><a href="#h27-0-1362" id="h27-0-1362" class="i">+  endif
</a><a href="#h27-0-1363" id="h27-0-1363" class="i">+  if len(s:jobs) &gt;= s:update.threads
</a><a href="#h27-0-1364" id="h27-0-1364" class="i">+    break
</a><a href="#h27-0-1365" id="h27-0-1365" class="i">+  endif
</a><a href="#h27-0-1366" id="h27-0-1366" class="i">+endwhile
</a><a href="#h27-0-1367" id="h27-0-1367" class="i">+endfunction
</a><a href="#h27-0-1368" id="h27-0-1368" class="i">+
</a><a href="#h27-0-1369" id="h27-0-1369" class="i">+function! s:update_python()
</a><a href="#h27-0-1370" id="h27-0-1370" class="i">+let py_exe = has(&#39;python&#39;) ? &#39;python&#39; : &#39;python3&#39;
</a><a href="#h27-0-1371" id="h27-0-1371" class="i">+execute py_exe &quot;&lt;&lt; EOF&quot;
</a><a href="#h27-0-1372" id="h27-0-1372" class="i">+import datetime
</a><a href="#h27-0-1373" id="h27-0-1373" class="i">+import functools
</a><a href="#h27-0-1374" id="h27-0-1374" class="i">+import os
</a><a href="#h27-0-1375" id="h27-0-1375" class="i">+try:
</a><a href="#h27-0-1376" id="h27-0-1376" class="i">+  import queue
</a><a href="#h27-0-1377" id="h27-0-1377" class="i">+except ImportError:
</a><a href="#h27-0-1378" id="h27-0-1378" class="i">+  import Queue as queue
</a><a href="#h27-0-1379" id="h27-0-1379" class="i">+import random
</a><a href="#h27-0-1380" id="h27-0-1380" class="i">+import re
</a><a href="#h27-0-1381" id="h27-0-1381" class="i">+import shutil
</a><a href="#h27-0-1382" id="h27-0-1382" class="i">+import signal
</a><a href="#h27-0-1383" id="h27-0-1383" class="i">+import subprocess
</a><a href="#h27-0-1384" id="h27-0-1384" class="i">+import tempfile
</a><a href="#h27-0-1385" id="h27-0-1385" class="i">+import threading as thr
</a><a href="#h27-0-1386" id="h27-0-1386" class="i">+import time
</a><a href="#h27-0-1387" id="h27-0-1387" class="i">+import traceback
</a><a href="#h27-0-1388" id="h27-0-1388" class="i">+import vim
</a><a href="#h27-0-1389" id="h27-0-1389" class="i">+
</a><a href="#h27-0-1390" id="h27-0-1390" class="i">+G_NVIM = vim.eval(&quot;has(&#39;nvim&#39;)&quot;) == &#39;1&#39;
</a><a href="#h27-0-1391" id="h27-0-1391" class="i">+G_PULL = vim.eval(&#39;s:update.pull&#39;) == &#39;1&#39;
</a><a href="#h27-0-1392" id="h27-0-1392" class="i">+G_RETRIES = int(vim.eval(&#39;get(g:, &quot;plug_retries&quot;, 2)&#39;)) + 1
</a><a href="#h27-0-1393" id="h27-0-1393" class="i">+G_TIMEOUT = int(vim.eval(&#39;get(g:, &quot;plug_timeout&quot;, 60)&#39;))
</a><a href="#h27-0-1394" id="h27-0-1394" class="i">+G_CLONE_OPT = vim.eval(&#39;s:clone_opt&#39;)
</a><a href="#h27-0-1395" id="h27-0-1395" class="i">+G_PROGRESS = vim.eval(&#39;s:progress_opt(1)&#39;)
</a><a href="#h27-0-1396" id="h27-0-1396" class="i">+G_LOG_PROB = 1.0 / int(vim.eval(&#39;s:update.threads&#39;))
</a><a href="#h27-0-1397" id="h27-0-1397" class="i">+G_STOP = thr.Event()
</a><a href="#h27-0-1398" id="h27-0-1398" class="i">+G_IS_WIN = vim.eval(&#39;s:is_win&#39;) == &#39;1&#39;
</a><a href="#h27-0-1399" id="h27-0-1399" class="i">+
</a><a href="#h27-0-1400" id="h27-0-1400" class="i">+class PlugError(Exception):
</a><a href="#h27-0-1401" id="h27-0-1401" class="i">+  def __init__(self, msg):
</a><a href="#h27-0-1402" id="h27-0-1402" class="i">+    self.msg = msg
</a><a href="#h27-0-1403" id="h27-0-1403" class="i">+class CmdTimedOut(PlugError):
</a><a href="#h27-0-1404" id="h27-0-1404" class="i">+  pass
</a><a href="#h27-0-1405" id="h27-0-1405" class="i">+class CmdFailed(PlugError):
</a><a href="#h27-0-1406" id="h27-0-1406" class="i">+  pass
</a><a href="#h27-0-1407" id="h27-0-1407" class="i">+class InvalidURI(PlugError):
</a><a href="#h27-0-1408" id="h27-0-1408" class="i">+  pass
</a><a href="#h27-0-1409" id="h27-0-1409" class="i">+class Action(object):
</a><a href="#h27-0-1410" id="h27-0-1410" class="i">+  INSTALL, UPDATE, ERROR, DONE = [&#39;+&#39;, &#39;*&#39;, &#39;x&#39;, &#39;-&#39;]
</a><a href="#h27-0-1411" id="h27-0-1411" class="i">+
</a><a href="#h27-0-1412" id="h27-0-1412" class="i">+class Buffer(object):
</a><a href="#h27-0-1413" id="h27-0-1413" class="i">+  def __init__(self, lock, num_plugs, is_pull):
</a><a href="#h27-0-1414" id="h27-0-1414" class="i">+    self.bar = &#39;&#39;
</a><a href="#h27-0-1415" id="h27-0-1415" class="i">+    self.event = &#39;Updating&#39; if is_pull else &#39;Installing&#39;
</a><a href="#h27-0-1416" id="h27-0-1416" class="i">+    self.lock = lock
</a><a href="#h27-0-1417" id="h27-0-1417" class="i">+    self.maxy = int(vim.eval(&#39;winheight(&quot;.&quot;)&#39;))
</a><a href="#h27-0-1418" id="h27-0-1418" class="i">+    self.num_plugs = num_plugs
</a><a href="#h27-0-1419" id="h27-0-1419" class="i">+
</a><a href="#h27-0-1420" id="h27-0-1420" class="i">+  def __where(self, name):
</a><a href="#h27-0-1421" id="h27-0-1421" class="i">+    &quot;&quot;&quot; Find first line with name in current buffer. Return line num. &quot;&quot;&quot;
</a><a href="#h27-0-1422" id="h27-0-1422" class="i">+    found, lnum = False, 0
</a><a href="#h27-0-1423" id="h27-0-1423" class="i">+    matcher = re.compile(&#39;^[-+x*] {0}:&#39;.format(name))
</a><a href="#h27-0-1424" id="h27-0-1424" class="i">+    for line in vim.current.buffer:
</a><a href="#h27-0-1425" id="h27-0-1425" class="i">+      if matcher.search(line) is not None:
</a><a href="#h27-0-1426" id="h27-0-1426" class="i">+        found = True
</a><a href="#h27-0-1427" id="h27-0-1427" class="i">+        break
</a><a href="#h27-0-1428" id="h27-0-1428" class="i">+      lnum += 1
</a><a href="#h27-0-1429" id="h27-0-1429" class="i">+
</a><a href="#h27-0-1430" id="h27-0-1430" class="i">+    if not found:
</a><a href="#h27-0-1431" id="h27-0-1431" class="i">+      lnum = -1
</a><a href="#h27-0-1432" id="h27-0-1432" class="i">+    return lnum
</a><a href="#h27-0-1433" id="h27-0-1433" class="i">+
</a><a href="#h27-0-1434" id="h27-0-1434" class="i">+  def header(self):
</a><a href="#h27-0-1435" id="h27-0-1435" class="i">+    curbuf = vim.current.buffer
</a><a href="#h27-0-1436" id="h27-0-1436" class="i">+    curbuf[0] = self.event + &#39; plugins ({0}/{1})&#39;.format(len(self.bar), self.num_plugs)
</a><a href="#h27-0-1437" id="h27-0-1437" class="i">+
</a><a href="#h27-0-1438" id="h27-0-1438" class="i">+    num_spaces = self.num_plugs - len(self.bar)
</a><a href="#h27-0-1439" id="h27-0-1439" class="i">+    curbuf[1] = &#39;[{0}{1}]&#39;.format(self.bar, num_spaces * &#39; &#39;)
</a><a href="#h27-0-1440" id="h27-0-1440" class="i">+
</a><a href="#h27-0-1441" id="h27-0-1441" class="i">+    with self.lock:
</a><a href="#h27-0-1442" id="h27-0-1442" class="i">+      vim.command(&#39;normal! 2G&#39;)
</a><a href="#h27-0-1443" id="h27-0-1443" class="i">+      vim.command(&#39;redraw&#39;)
</a><a href="#h27-0-1444" id="h27-0-1444" class="i">+
</a><a href="#h27-0-1445" id="h27-0-1445" class="i">+  def write(self, action, name, lines):
</a><a href="#h27-0-1446" id="h27-0-1446" class="i">+    first, rest = lines[0], lines[1:]
</a><a href="#h27-0-1447" id="h27-0-1447" class="i">+    msg = [&#39;{0} {1}{2}{3}&#39;.format(action, name, &#39;: &#39; if first else &#39;&#39;, first)]
</a><a href="#h27-0-1448" id="h27-0-1448" class="i">+    msg.extend([&#39;    &#39; + line for line in rest])
</a><a href="#h27-0-1449" id="h27-0-1449" class="i">+
</a><a href="#h27-0-1450" id="h27-0-1450" class="i">+    try:
</a><a href="#h27-0-1451" id="h27-0-1451" class="i">+      if action == Action.ERROR:
</a><a href="#h27-0-1452" id="h27-0-1452" class="i">+        self.bar += &#39;x&#39;
</a><a href="#h27-0-1453" id="h27-0-1453" class="i">+        vim.command(&quot;call add(s:update.errors, &#39;{0}&#39;)&quot;.format(name))
</a><a href="#h27-0-1454" id="h27-0-1454" class="i">+      elif action == Action.DONE:
</a><a href="#h27-0-1455" id="h27-0-1455" class="i">+        self.bar += &#39;=&#39;
</a><a href="#h27-0-1456" id="h27-0-1456" class="i">+
</a><a href="#h27-0-1457" id="h27-0-1457" class="i">+      curbuf = vim.current.buffer
</a><a href="#h27-0-1458" id="h27-0-1458" class="i">+      lnum = self.__where(name)
</a><a href="#h27-0-1459" id="h27-0-1459" class="i">+      if lnum != -1: # Found matching line num
</a><a href="#h27-0-1460" id="h27-0-1460" class="i">+        del curbuf[lnum]
</a><a href="#h27-0-1461" id="h27-0-1461" class="i">+        if lnum &gt; self.maxy and action in set([Action.INSTALL, Action.UPDATE]):
</a><a href="#h27-0-1462" id="h27-0-1462" class="i">+          lnum = 3
</a><a href="#h27-0-1463" id="h27-0-1463" class="i">+      else:
</a><a href="#h27-0-1464" id="h27-0-1464" class="i">+        lnum = 3
</a><a href="#h27-0-1465" id="h27-0-1465" class="i">+      curbuf.append(msg, lnum)
</a><a href="#h27-0-1466" id="h27-0-1466" class="i">+
</a><a href="#h27-0-1467" id="h27-0-1467" class="i">+      self.header()
</a><a href="#h27-0-1468" id="h27-0-1468" class="i">+    except vim.error:
</a><a href="#h27-0-1469" id="h27-0-1469" class="i">+      pass
</a><a href="#h27-0-1470" id="h27-0-1470" class="i">+
</a><a href="#h27-0-1471" id="h27-0-1471" class="i">+class Command(object):
</a><a href="#h27-0-1472" id="h27-0-1472" class="i">+  CD = &#39;cd /d&#39; if G_IS_WIN else &#39;cd&#39;
</a><a href="#h27-0-1473" id="h27-0-1473" class="i">+
</a><a href="#h27-0-1474" id="h27-0-1474" class="i">+  def __init__(self, cmd, cmd_dir=None, timeout=60, cb=None, clean=None):
</a><a href="#h27-0-1475" id="h27-0-1475" class="i">+    self.cmd = cmd
</a><a href="#h27-0-1476" id="h27-0-1476" class="i">+    if cmd_dir:
</a><a href="#h27-0-1477" id="h27-0-1477" class="i">+      self.cmd = &#39;{0} {1} &amp;&amp; {2}&#39;.format(Command.CD, cmd_dir, self.cmd)
</a><a href="#h27-0-1478" id="h27-0-1478" class="i">+    self.timeout = timeout
</a><a href="#h27-0-1479" id="h27-0-1479" class="i">+    self.callback = cb if cb else (lambda msg: None)
</a><a href="#h27-0-1480" id="h27-0-1480" class="i">+    self.clean = clean if clean else (lambda: None)
</a><a href="#h27-0-1481" id="h27-0-1481" class="i">+    self.proc = None
</a><a href="#h27-0-1482" id="h27-0-1482" class="i">+
</a><a href="#h27-0-1483" id="h27-0-1483" class="i">+  @property
</a><a href="#h27-0-1484" id="h27-0-1484" class="i">+  def alive(self):
</a><a href="#h27-0-1485" id="h27-0-1485" class="i">+    &quot;&quot;&quot; Returns true only if command still running. &quot;&quot;&quot;
</a><a href="#h27-0-1486" id="h27-0-1486" class="i">+    return self.proc and self.proc.poll() is None
</a><a href="#h27-0-1487" id="h27-0-1487" class="i">+
</a><a href="#h27-0-1488" id="h27-0-1488" class="i">+  def execute(self, ntries=3):
</a><a href="#h27-0-1489" id="h27-0-1489" class="i">+    &quot;&quot;&quot; Execute the command with ntries if CmdTimedOut.
</a><a href="#h27-0-1490" id="h27-0-1490" class="i">+        Returns the output of the command if no Exception.
</a><a href="#h27-0-1491" id="h27-0-1491" class="i">+    &quot;&quot;&quot;
</a><a href="#h27-0-1492" id="h27-0-1492" class="i">+    attempt, finished, limit = 0, False, self.timeout
</a><a href="#h27-0-1493" id="h27-0-1493" class="i">+
</a><a href="#h27-0-1494" id="h27-0-1494" class="i">+    while not finished:
</a><a href="#h27-0-1495" id="h27-0-1495" class="i">+      try:
</a><a href="#h27-0-1496" id="h27-0-1496" class="i">+        attempt += 1
</a><a href="#h27-0-1497" id="h27-0-1497" class="i">+        result = self.try_command()
</a><a href="#h27-0-1498" id="h27-0-1498" class="i">+        finished = True
</a><a href="#h27-0-1499" id="h27-0-1499" class="i">+        return result
</a><a href="#h27-0-1500" id="h27-0-1500" class="i">+      except CmdTimedOut:
</a><a href="#h27-0-1501" id="h27-0-1501" class="i">+        if attempt != ntries:
</a><a href="#h27-0-1502" id="h27-0-1502" class="i">+          self.notify_retry()
</a><a href="#h27-0-1503" id="h27-0-1503" class="i">+          self.timeout += limit
</a><a href="#h27-0-1504" id="h27-0-1504" class="i">+        else:
</a><a href="#h27-0-1505" id="h27-0-1505" class="i">+          raise
</a><a href="#h27-0-1506" id="h27-0-1506" class="i">+
</a><a href="#h27-0-1507" id="h27-0-1507" class="i">+  def notify_retry(self):
</a><a href="#h27-0-1508" id="h27-0-1508" class="i">+    &quot;&quot;&quot; Retry required for command, notify user. &quot;&quot;&quot;
</a><a href="#h27-0-1509" id="h27-0-1509" class="i">+    for count in range(3, 0, -1):
</a><a href="#h27-0-1510" id="h27-0-1510" class="i">+      if G_STOP.is_set():
</a><a href="#h27-0-1511" id="h27-0-1511" class="i">+        raise KeyboardInterrupt
</a><a href="#h27-0-1512" id="h27-0-1512" class="i">+      msg = &#39;Timeout. Will retry in {0} second{1} ...&#39;.format(
</a><a href="#h27-0-1513" id="h27-0-1513" class="i">+            count, &#39;s&#39; if count != 1 else &#39;&#39;)
</a><a href="#h27-0-1514" id="h27-0-1514" class="i">+      self.callback([msg])
</a><a href="#h27-0-1515" id="h27-0-1515" class="i">+      time.sleep(1)
</a><a href="#h27-0-1516" id="h27-0-1516" class="i">+    self.callback([&#39;Retrying ...&#39;])
</a><a href="#h27-0-1517" id="h27-0-1517" class="i">+
</a><a href="#h27-0-1518" id="h27-0-1518" class="i">+  def try_command(self):
</a><a href="#h27-0-1519" id="h27-0-1519" class="i">+    &quot;&quot;&quot; Execute a cmd &amp; poll for callback. Returns list of output.
</a><a href="#h27-0-1520" id="h27-0-1520" class="i">+        Raises CmdFailed   -&gt; return code for Popen isn&#39;t 0
</a><a href="#h27-0-1521" id="h27-0-1521" class="i">+        Raises CmdTimedOut -&gt; command exceeded timeout without new output
</a><a href="#h27-0-1522" id="h27-0-1522" class="i">+    &quot;&quot;&quot;
</a><a href="#h27-0-1523" id="h27-0-1523" class="i">+    first_line = True
</a><a href="#h27-0-1524" id="h27-0-1524" class="i">+
</a><a href="#h27-0-1525" id="h27-0-1525" class="i">+    try:
</a><a href="#h27-0-1526" id="h27-0-1526" class="i">+      tfile = tempfile.NamedTemporaryFile(mode=&#39;w+b&#39;)
</a><a href="#h27-0-1527" id="h27-0-1527" class="i">+      preexec_fn = not G_IS_WIN and os.setsid or None
</a><a href="#h27-0-1528" id="h27-0-1528" class="i">+      self.proc = subprocess.Popen(self.cmd, stdout=tfile,
</a><a href="#h27-0-1529" id="h27-0-1529" class="i">+                                   stderr=subprocess.STDOUT,
</a><a href="#h27-0-1530" id="h27-0-1530" class="i">+                                   stdin=subprocess.PIPE, shell=True,
</a><a href="#h27-0-1531" id="h27-0-1531" class="i">+                                   preexec_fn=preexec_fn)
</a><a href="#h27-0-1532" id="h27-0-1532" class="i">+      thrd = thr.Thread(target=(lambda proc: proc.wait()), args=(self.proc,))
</a><a href="#h27-0-1533" id="h27-0-1533" class="i">+      thrd.start()
</a><a href="#h27-0-1534" id="h27-0-1534" class="i">+
</a><a href="#h27-0-1535" id="h27-0-1535" class="i">+      thread_not_started = True
</a><a href="#h27-0-1536" id="h27-0-1536" class="i">+      while thread_not_started:
</a><a href="#h27-0-1537" id="h27-0-1537" class="i">+        try:
</a><a href="#h27-0-1538" id="h27-0-1538" class="i">+          thrd.join(0.1)
</a><a href="#h27-0-1539" id="h27-0-1539" class="i">+          thread_not_started = False
</a><a href="#h27-0-1540" id="h27-0-1540" class="i">+        except RuntimeError:
</a><a href="#h27-0-1541" id="h27-0-1541" class="i">+          pass
</a><a href="#h27-0-1542" id="h27-0-1542" class="i">+
</a><a href="#h27-0-1543" id="h27-0-1543" class="i">+      while self.alive:
</a><a href="#h27-0-1544" id="h27-0-1544" class="i">+        if G_STOP.is_set():
</a><a href="#h27-0-1545" id="h27-0-1545" class="i">+          raise KeyboardInterrupt
</a><a href="#h27-0-1546" id="h27-0-1546" class="i">+
</a><a href="#h27-0-1547" id="h27-0-1547" class="i">+        if first_line or random.random() &lt; G_LOG_PROB:
</a><a href="#h27-0-1548" id="h27-0-1548" class="i">+          first_line = False
</a><a href="#h27-0-1549" id="h27-0-1549" class="i">+          line = &#39;&#39; if G_IS_WIN else nonblock_read(tfile.name)
</a><a href="#h27-0-1550" id="h27-0-1550" class="i">+          if line:
</a><a href="#h27-0-1551" id="h27-0-1551" class="i">+            self.callback([line])
</a><a href="#h27-0-1552" id="h27-0-1552" class="i">+
</a><a href="#h27-0-1553" id="h27-0-1553" class="i">+        time_diff = time.time() - os.path.getmtime(tfile.name)
</a><a href="#h27-0-1554" id="h27-0-1554" class="i">+        if time_diff &gt; self.timeout:
</a><a href="#h27-0-1555" id="h27-0-1555" class="i">+          raise CmdTimedOut([&#39;Timeout!&#39;])
</a><a href="#h27-0-1556" id="h27-0-1556" class="i">+
</a><a href="#h27-0-1557" id="h27-0-1557" class="i">+        thrd.join(0.5)
</a><a href="#h27-0-1558" id="h27-0-1558" class="i">+
</a><a href="#h27-0-1559" id="h27-0-1559" class="i">+      tfile.seek(0)
</a><a href="#h27-0-1560" id="h27-0-1560" class="i">+      result = [line.decode(&#39;utf-8&#39;, &#39;replace&#39;).rstrip() for line in tfile]
</a><a href="#h27-0-1561" id="h27-0-1561" class="i">+
</a><a href="#h27-0-1562" id="h27-0-1562" class="i">+      if self.proc.returncode != 0:
</a><a href="#h27-0-1563" id="h27-0-1563" class="i">+        raise CmdFailed([&#39;&#39;] + result)
</a><a href="#h27-0-1564" id="h27-0-1564" class="i">+
</a><a href="#h27-0-1565" id="h27-0-1565" class="i">+      return result
</a><a href="#h27-0-1566" id="h27-0-1566" class="i">+    except:
</a><a href="#h27-0-1567" id="h27-0-1567" class="i">+      self.terminate()
</a><a href="#h27-0-1568" id="h27-0-1568" class="i">+      raise
</a><a href="#h27-0-1569" id="h27-0-1569" class="i">+
</a><a href="#h27-0-1570" id="h27-0-1570" class="i">+  def terminate(self):
</a><a href="#h27-0-1571" id="h27-0-1571" class="i">+    &quot;&quot;&quot; Terminate process and cleanup. &quot;&quot;&quot;
</a><a href="#h27-0-1572" id="h27-0-1572" class="i">+    if self.alive:
</a><a href="#h27-0-1573" id="h27-0-1573" class="i">+      if G_IS_WIN:
</a><a href="#h27-0-1574" id="h27-0-1574" class="i">+        os.kill(self.proc.pid, signal.SIGINT)
</a><a href="#h27-0-1575" id="h27-0-1575" class="i">+      else:
</a><a href="#h27-0-1576" id="h27-0-1576" class="i">+        os.killpg(self.proc.pid, signal.SIGTERM)
</a><a href="#h27-0-1577" id="h27-0-1577" class="i">+    self.clean()
</a><a href="#h27-0-1578" id="h27-0-1578" class="i">+
</a><a href="#h27-0-1579" id="h27-0-1579" class="i">+class Plugin(object):
</a><a href="#h27-0-1580" id="h27-0-1580" class="i">+  def __init__(self, name, args, buf_q, lock):
</a><a href="#h27-0-1581" id="h27-0-1581" class="i">+    self.name = name
</a><a href="#h27-0-1582" id="h27-0-1582" class="i">+    self.args = args
</a><a href="#h27-0-1583" id="h27-0-1583" class="i">+    self.buf_q = buf_q
</a><a href="#h27-0-1584" id="h27-0-1584" class="i">+    self.lock = lock
</a><a href="#h27-0-1585" id="h27-0-1585" class="i">+    self.tag = args.get(&#39;tag&#39;, 0)
</a><a href="#h27-0-1586" id="h27-0-1586" class="i">+
</a><a href="#h27-0-1587" id="h27-0-1587" class="i">+  def manage(self):
</a><a href="#h27-0-1588" id="h27-0-1588" class="i">+    try:
</a><a href="#h27-0-1589" id="h27-0-1589" class="i">+      if os.path.exists(self.args[&#39;dir&#39;]):
</a><a href="#h27-0-1590" id="h27-0-1590" class="i">+        self.update()
</a><a href="#h27-0-1591" id="h27-0-1591" class="i">+      else:
</a><a href="#h27-0-1592" id="h27-0-1592" class="i">+        self.install()
</a><a href="#h27-0-1593" id="h27-0-1593" class="i">+        with self.lock:
</a><a href="#h27-0-1594" id="h27-0-1594" class="i">+          thread_vim_command(&quot;let s:update.new[&#39;{0}&#39;] = 1&quot;.format(self.name))
</a><a href="#h27-0-1595" id="h27-0-1595" class="i">+    except PlugError as exc:
</a><a href="#h27-0-1596" id="h27-0-1596" class="i">+      self.write(Action.ERROR, self.name, exc.msg)
</a><a href="#h27-0-1597" id="h27-0-1597" class="i">+    except KeyboardInterrupt:
</a><a href="#h27-0-1598" id="h27-0-1598" class="i">+      G_STOP.set()
</a><a href="#h27-0-1599" id="h27-0-1599" class="i">+      self.write(Action.ERROR, self.name, [&#39;Interrupted!&#39;])
</a><a href="#h27-0-1600" id="h27-0-1600" class="i">+    except:
</a><a href="#h27-0-1601" id="h27-0-1601" class="i">+      # Any exception except those above print stack trace
</a><a href="#h27-0-1602" id="h27-0-1602" class="i">+      msg = &#39;Trace:\n{0}&#39;.format(traceback.format_exc().rstrip())
</a><a href="#h27-0-1603" id="h27-0-1603" class="i">+      self.write(Action.ERROR, self.name, msg.split(&#39;\n&#39;))
</a><a href="#h27-0-1604" id="h27-0-1604" class="i">+      raise
</a><a href="#h27-0-1605" id="h27-0-1605" class="i">+
</a><a href="#h27-0-1606" id="h27-0-1606" class="i">+  def install(self):
</a><a href="#h27-0-1607" id="h27-0-1607" class="i">+    target = self.args[&#39;dir&#39;]
</a><a href="#h27-0-1608" id="h27-0-1608" class="i">+    if target[-1] == &#39;\\&#39;:
</a><a href="#h27-0-1609" id="h27-0-1609" class="i">+      target = target[0:-1]
</a><a href="#h27-0-1610" id="h27-0-1610" class="i">+
</a><a href="#h27-0-1611" id="h27-0-1611" class="i">+    def clean(target):
</a><a href="#h27-0-1612" id="h27-0-1612" class="i">+      def _clean():
</a><a href="#h27-0-1613" id="h27-0-1613" class="i">+        try:
</a><a href="#h27-0-1614" id="h27-0-1614" class="i">+          shutil.rmtree(target)
</a><a href="#h27-0-1615" id="h27-0-1615" class="i">+        except OSError:
</a><a href="#h27-0-1616" id="h27-0-1616" class="i">+          pass
</a><a href="#h27-0-1617" id="h27-0-1617" class="i">+      return _clean
</a><a href="#h27-0-1618" id="h27-0-1618" class="i">+
</a><a href="#h27-0-1619" id="h27-0-1619" class="i">+    self.write(Action.INSTALL, self.name, [&#39;Installing ...&#39;])
</a><a href="#h27-0-1620" id="h27-0-1620" class="i">+    callback = functools.partial(self.write, Action.INSTALL, self.name)
</a><a href="#h27-0-1621" id="h27-0-1621" class="i">+    cmd = &#39;git clone {0} {1} {2} {3} 2&gt;&amp;1&#39;.format(
</a><a href="#h27-0-1622" id="h27-0-1622" class="i">+          &#39;&#39; if self.tag else G_CLONE_OPT, G_PROGRESS, self.args[&#39;uri&#39;],
</a><a href="#h27-0-1623" id="h27-0-1623" class="i">+          esc(target))
</a><a href="#h27-0-1624" id="h27-0-1624" class="i">+    com = Command(cmd, None, G_TIMEOUT, callback, clean(target))
</a><a href="#h27-0-1625" id="h27-0-1625" class="i">+    result = com.execute(G_RETRIES)
</a><a href="#h27-0-1626" id="h27-0-1626" class="i">+    self.write(Action.DONE, self.name, result[-1:])
</a><a href="#h27-0-1627" id="h27-0-1627" class="i">+
</a><a href="#h27-0-1628" id="h27-0-1628" class="i">+  def repo_uri(self):
</a><a href="#h27-0-1629" id="h27-0-1629" class="i">+    cmd = &#39;git rev-parse --abbrev-ref HEAD 2&gt;&amp;1 &amp;&amp; git config -f .git/config remote.origin.url&#39;
</a><a href="#h27-0-1630" id="h27-0-1630" class="i">+    command = Command(cmd, self.args[&#39;dir&#39;], G_TIMEOUT,)
</a><a href="#h27-0-1631" id="h27-0-1631" class="i">+    result = command.execute(G_RETRIES)
</a><a href="#h27-0-1632" id="h27-0-1632" class="i">+    return result[-1]
</a><a href="#h27-0-1633" id="h27-0-1633" class="i">+
</a><a href="#h27-0-1634" id="h27-0-1634" class="i">+  def update(self):
</a><a href="#h27-0-1635" id="h27-0-1635" class="i">+    actual_uri = self.repo_uri()
</a><a href="#h27-0-1636" id="h27-0-1636" class="i">+    expect_uri = self.args[&#39;uri&#39;]
</a><a href="#h27-0-1637" id="h27-0-1637" class="i">+    regex = re.compile(r&#39;^(?:\w+://)?(?:[^@/]*@)?([^:/]*(?::[0-9]*)?)[:/](.*?)(?:\.git)?/?$&#39;)
</a><a href="#h27-0-1638" id="h27-0-1638" class="i">+    ma = regex.match(actual_uri)
</a><a href="#h27-0-1639" id="h27-0-1639" class="i">+    mb = regex.match(expect_uri)
</a><a href="#h27-0-1640" id="h27-0-1640" class="i">+    if ma is None or mb is None or ma.groups() != mb.groups():
</a><a href="#h27-0-1641" id="h27-0-1641" class="i">+      msg = [&#39;&#39;,
</a><a href="#h27-0-1642" id="h27-0-1642" class="i">+             &#39;Invalid URI: {0}&#39;.format(actual_uri),
</a><a href="#h27-0-1643" id="h27-0-1643" class="i">+             &#39;Expected     {0}&#39;.format(expect_uri),
</a><a href="#h27-0-1644" id="h27-0-1644" class="i">+             &#39;PlugClean required.&#39;]
</a><a href="#h27-0-1645" id="h27-0-1645" class="i">+      raise InvalidURI(msg)
</a><a href="#h27-0-1646" id="h27-0-1646" class="i">+
</a><a href="#h27-0-1647" id="h27-0-1647" class="i">+    if G_PULL:
</a><a href="#h27-0-1648" id="h27-0-1648" class="i">+      self.write(Action.UPDATE, self.name, [&#39;Updating ...&#39;])
</a><a href="#h27-0-1649" id="h27-0-1649" class="i">+      callback = functools.partial(self.write, Action.UPDATE, self.name)
</a><a href="#h27-0-1650" id="h27-0-1650" class="i">+      fetch_opt = &#39;--depth 99999999&#39; if self.tag and os.path.isfile(os.path.join(self.args[&#39;dir&#39;], &#39;.git/shallow&#39;)) else &#39;&#39;
</a><a href="#h27-0-1651" id="h27-0-1651" class="i">+      cmd = &#39;git fetch {0} {1} 2&gt;&amp;1&#39;.format(fetch_opt, G_PROGRESS)
</a><a href="#h27-0-1652" id="h27-0-1652" class="i">+      com = Command(cmd, self.args[&#39;dir&#39;], G_TIMEOUT, callback)
</a><a href="#h27-0-1653" id="h27-0-1653" class="i">+      result = com.execute(G_RETRIES)
</a><a href="#h27-0-1654" id="h27-0-1654" class="i">+      self.write(Action.DONE, self.name, result[-1:])
</a><a href="#h27-0-1655" id="h27-0-1655" class="i">+    else:
</a><a href="#h27-0-1656" id="h27-0-1656" class="i">+      self.write(Action.DONE, self.name, [&#39;Already installed&#39;])
</a><a href="#h27-0-1657" id="h27-0-1657" class="i">+
</a><a href="#h27-0-1658" id="h27-0-1658" class="i">+  def write(self, action, name, msg):
</a><a href="#h27-0-1659" id="h27-0-1659" class="i">+    self.buf_q.put((action, name, msg))
</a><a href="#h27-0-1660" id="h27-0-1660" class="i">+
</a><a href="#h27-0-1661" id="h27-0-1661" class="i">+class PlugThread(thr.Thread):
</a><a href="#h27-0-1662" id="h27-0-1662" class="i">+  def __init__(self, tname, args):
</a><a href="#h27-0-1663" id="h27-0-1663" class="i">+    super(PlugThread, self).__init__()
</a><a href="#h27-0-1664" id="h27-0-1664" class="i">+    self.tname = tname
</a><a href="#h27-0-1665" id="h27-0-1665" class="i">+    self.args = args
</a><a href="#h27-0-1666" id="h27-0-1666" class="i">+
</a><a href="#h27-0-1667" id="h27-0-1667" class="i">+  def run(self):
</a><a href="#h27-0-1668" id="h27-0-1668" class="i">+    thr.current_thread().name = self.tname
</a><a href="#h27-0-1669" id="h27-0-1669" class="i">+    buf_q, work_q, lock = self.args
</a><a href="#h27-0-1670" id="h27-0-1670" class="i">+
</a><a href="#h27-0-1671" id="h27-0-1671" class="i">+    try:
</a><a href="#h27-0-1672" id="h27-0-1672" class="i">+      while not G_STOP.is_set():
</a><a href="#h27-0-1673" id="h27-0-1673" class="i">+        name, args = work_q.get_nowait()
</a><a href="#h27-0-1674" id="h27-0-1674" class="i">+        plug = Plugin(name, args, buf_q, lock)
</a><a href="#h27-0-1675" id="h27-0-1675" class="i">+        plug.manage()
</a><a href="#h27-0-1676" id="h27-0-1676" class="i">+        work_q.task_done()
</a><a href="#h27-0-1677" id="h27-0-1677" class="i">+    except queue.Empty:
</a><a href="#h27-0-1678" id="h27-0-1678" class="i">+      pass
</a><a href="#h27-0-1679" id="h27-0-1679" class="i">+
</a><a href="#h27-0-1680" id="h27-0-1680" class="i">+class RefreshThread(thr.Thread):
</a><a href="#h27-0-1681" id="h27-0-1681" class="i">+  def __init__(self, lock):
</a><a href="#h27-0-1682" id="h27-0-1682" class="i">+    super(RefreshThread, self).__init__()
</a><a href="#h27-0-1683" id="h27-0-1683" class="i">+    self.lock = lock
</a><a href="#h27-0-1684" id="h27-0-1684" class="i">+    self.running = True
</a><a href="#h27-0-1685" id="h27-0-1685" class="i">+
</a><a href="#h27-0-1686" id="h27-0-1686" class="i">+  def run(self):
</a><a href="#h27-0-1687" id="h27-0-1687" class="i">+    while self.running:
</a><a href="#h27-0-1688" id="h27-0-1688" class="i">+      with self.lock:
</a><a href="#h27-0-1689" id="h27-0-1689" class="i">+        thread_vim_command(&#39;noautocmd normal! a&#39;)
</a><a href="#h27-0-1690" id="h27-0-1690" class="i">+      time.sleep(0.33)
</a><a href="#h27-0-1691" id="h27-0-1691" class="i">+
</a><a href="#h27-0-1692" id="h27-0-1692" class="i">+  def stop(self):
</a><a href="#h27-0-1693" id="h27-0-1693" class="i">+    self.running = False
</a><a href="#h27-0-1694" id="h27-0-1694" class="i">+
</a><a href="#h27-0-1695" id="h27-0-1695" class="i">+if G_NVIM:
</a><a href="#h27-0-1696" id="h27-0-1696" class="i">+  def thread_vim_command(cmd):
</a><a href="#h27-0-1697" id="h27-0-1697" class="i">+    vim.session.threadsafe_call(lambda: vim.command(cmd))
</a><a href="#h27-0-1698" id="h27-0-1698" class="i">+else:
</a><a href="#h27-0-1699" id="h27-0-1699" class="i">+  def thread_vim_command(cmd):
</a><a href="#h27-0-1700" id="h27-0-1700" class="i">+    vim.command(cmd)
</a><a href="#h27-0-1701" id="h27-0-1701" class="i">+
</a><a href="#h27-0-1702" id="h27-0-1702" class="i">+def esc(name):
</a><a href="#h27-0-1703" id="h27-0-1703" class="i">+  return &#39;&quot;&#39; + name.replace(&#39;&quot;&#39;, &#39;\&quot;&#39;) + &#39;&quot;&#39;
</a><a href="#h27-0-1704" id="h27-0-1704" class="i">+
</a><a href="#h27-0-1705" id="h27-0-1705" class="i">+def nonblock_read(fname):
</a><a href="#h27-0-1706" id="h27-0-1706" class="i">+  &quot;&quot;&quot; Read a file with nonblock flag. Return the last line. &quot;&quot;&quot;
</a><a href="#h27-0-1707" id="h27-0-1707" class="i">+  fread = os.open(fname, os.O_RDONLY | os.O_NONBLOCK)
</a><a href="#h27-0-1708" id="h27-0-1708" class="i">+  buf = os.read(fread, 100000).decode(&#39;utf-8&#39;, &#39;replace&#39;)
</a><a href="#h27-0-1709" id="h27-0-1709" class="i">+  os.close(fread)
</a><a href="#h27-0-1710" id="h27-0-1710" class="i">+
</a><a href="#h27-0-1711" id="h27-0-1711" class="i">+  line = buf.rstrip(&#39;\r\n&#39;)
</a><a href="#h27-0-1712" id="h27-0-1712" class="i">+  left = max(line.rfind(&#39;\r&#39;), line.rfind(&#39;\n&#39;))
</a><a href="#h27-0-1713" id="h27-0-1713" class="i">+  if left != -1:
</a><a href="#h27-0-1714" id="h27-0-1714" class="i">+    left += 1
</a><a href="#h27-0-1715" id="h27-0-1715" class="i">+    line = line[left:]
</a><a href="#h27-0-1716" id="h27-0-1716" class="i">+
</a><a href="#h27-0-1717" id="h27-0-1717" class="i">+  return line
</a><a href="#h27-0-1718" id="h27-0-1718" class="i">+
</a><a href="#h27-0-1719" id="h27-0-1719" class="i">+def main():
</a><a href="#h27-0-1720" id="h27-0-1720" class="i">+  thr.current_thread().name = &#39;main&#39;
</a><a href="#h27-0-1721" id="h27-0-1721" class="i">+  nthreads = int(vim.eval(&#39;s:update.threads&#39;))
</a><a href="#h27-0-1722" id="h27-0-1722" class="i">+  plugs = vim.eval(&#39;s:update.todo&#39;)
</a><a href="#h27-0-1723" id="h27-0-1723" class="i">+  mac_gui = vim.eval(&#39;s:mac_gui&#39;) == &#39;1&#39;
</a><a href="#h27-0-1724" id="h27-0-1724" class="i">+
</a><a href="#h27-0-1725" id="h27-0-1725" class="i">+  lock = thr.Lock()
</a><a href="#h27-0-1726" id="h27-0-1726" class="i">+  buf = Buffer(lock, len(plugs), G_PULL)
</a><a href="#h27-0-1727" id="h27-0-1727" class="i">+  buf_q, work_q = queue.Queue(), queue.Queue()
</a><a href="#h27-0-1728" id="h27-0-1728" class="i">+  for work in plugs.items():
</a><a href="#h27-0-1729" id="h27-0-1729" class="i">+    work_q.put(work)
</a><a href="#h27-0-1730" id="h27-0-1730" class="i">+
</a><a href="#h27-0-1731" id="h27-0-1731" class="i">+  start_cnt = thr.active_count()
</a><a href="#h27-0-1732" id="h27-0-1732" class="i">+  for num in range(nthreads):
</a><a href="#h27-0-1733" id="h27-0-1733" class="i">+    tname = &#39;PlugT-{0:02}&#39;.format(num)
</a><a href="#h27-0-1734" id="h27-0-1734" class="i">+    thread = PlugThread(tname, (buf_q, work_q, lock))
</a><a href="#h27-0-1735" id="h27-0-1735" class="i">+    thread.start()
</a><a href="#h27-0-1736" id="h27-0-1736" class="i">+  if mac_gui:
</a><a href="#h27-0-1737" id="h27-0-1737" class="i">+    rthread = RefreshThread(lock)
</a><a href="#h27-0-1738" id="h27-0-1738" class="i">+    rthread.start()
</a><a href="#h27-0-1739" id="h27-0-1739" class="i">+
</a><a href="#h27-0-1740" id="h27-0-1740" class="i">+  while not buf_q.empty() or thr.active_count() != start_cnt:
</a><a href="#h27-0-1741" id="h27-0-1741" class="i">+    try:
</a><a href="#h27-0-1742" id="h27-0-1742" class="i">+      action, name, msg = buf_q.get(True, 0.25)
</a><a href="#h27-0-1743" id="h27-0-1743" class="i">+      buf.write(action, name, [&#39;OK&#39;] if not msg else msg)
</a><a href="#h27-0-1744" id="h27-0-1744" class="i">+      buf_q.task_done()
</a><a href="#h27-0-1745" id="h27-0-1745" class="i">+    except queue.Empty:
</a><a href="#h27-0-1746" id="h27-0-1746" class="i">+      pass
</a><a href="#h27-0-1747" id="h27-0-1747" class="i">+    except KeyboardInterrupt:
</a><a href="#h27-0-1748" id="h27-0-1748" class="i">+      G_STOP.set()
</a><a href="#h27-0-1749" id="h27-0-1749" class="i">+
</a><a href="#h27-0-1750" id="h27-0-1750" class="i">+  if mac_gui:
</a><a href="#h27-0-1751" id="h27-0-1751" class="i">+    rthread.stop()
</a><a href="#h27-0-1752" id="h27-0-1752" class="i">+    rthread.join()
</a><a href="#h27-0-1753" id="h27-0-1753" class="i">+
</a><a href="#h27-0-1754" id="h27-0-1754" class="i">+main()
</a><a href="#h27-0-1755" id="h27-0-1755" class="i">+EOF
</a><a href="#h27-0-1756" id="h27-0-1756" class="i">+endfunction
</a><a href="#h27-0-1757" id="h27-0-1757" class="i">+
</a><a href="#h27-0-1758" id="h27-0-1758" class="i">+function! s:update_ruby()
</a><a href="#h27-0-1759" id="h27-0-1759" class="i">+  ruby &lt;&lt; EOF
</a><a href="#h27-0-1760" id="h27-0-1760" class="i">+  module PlugStream
</a><a href="#h27-0-1761" id="h27-0-1761" class="i">+    SEP = [&quot;\r&quot;, &quot;\n&quot;, nil]
</a><a href="#h27-0-1762" id="h27-0-1762" class="i">+    def get_line
</a><a href="#h27-0-1763" id="h27-0-1763" class="i">+      buffer = &#39;&#39;
</a><a href="#h27-0-1764" id="h27-0-1764" class="i">+      loop do
</a><a href="#h27-0-1765" id="h27-0-1765" class="i">+        char = readchar rescue return
</a><a href="#h27-0-1766" id="h27-0-1766" class="i">+        if SEP.include? char.chr
</a><a href="#h27-0-1767" id="h27-0-1767" class="i">+          buffer &lt;&lt; $/
</a><a href="#h27-0-1768" id="h27-0-1768" class="i">+          break
</a><a href="#h27-0-1769" id="h27-0-1769" class="i">+        else
</a><a href="#h27-0-1770" id="h27-0-1770" class="i">+          buffer &lt;&lt; char
</a><a href="#h27-0-1771" id="h27-0-1771" class="i">+        end
</a><a href="#h27-0-1772" id="h27-0-1772" class="i">+      end
</a><a href="#h27-0-1773" id="h27-0-1773" class="i">+      buffer
</a><a href="#h27-0-1774" id="h27-0-1774" class="i">+    end
</a><a href="#h27-0-1775" id="h27-0-1775" class="i">+  end unless defined?(PlugStream)
</a><a href="#h27-0-1776" id="h27-0-1776" class="i">+
</a><a href="#h27-0-1777" id="h27-0-1777" class="i">+  def esc arg
</a><a href="#h27-0-1778" id="h27-0-1778" class="i">+    %[&quot;#{arg.gsub(&#39;&quot;&#39;, &#39;\&quot;&#39;)}&quot;]
</a><a href="#h27-0-1779" id="h27-0-1779" class="i">+  end
</a><a href="#h27-0-1780" id="h27-0-1780" class="i">+
</a><a href="#h27-0-1781" id="h27-0-1781" class="i">+  def killall pid
</a><a href="#h27-0-1782" id="h27-0-1782" class="i">+    pids = [pid]
</a><a href="#h27-0-1783" id="h27-0-1783" class="i">+    if /mswin|mingw|bccwin/ =~ RUBY_PLATFORM
</a><a href="#h27-0-1784" id="h27-0-1784" class="i">+      pids.each { |pid| Process.kill &#39;INT&#39;, pid.to_i rescue nil }
</a><a href="#h27-0-1785" id="h27-0-1785" class="i">+    else
</a><a href="#h27-0-1786" id="h27-0-1786" class="i">+      unless `which pgrep 2&gt; /dev/null`.empty?
</a><a href="#h27-0-1787" id="h27-0-1787" class="i">+        children = pids
</a><a href="#h27-0-1788" id="h27-0-1788" class="i">+        until children.empty?
</a><a href="#h27-0-1789" id="h27-0-1789" class="i">+          children = children.map { |pid|
</a><a href="#h27-0-1790" id="h27-0-1790" class="i">+            `pgrep -P #{pid}`.lines.map { |l| l.chomp }
</a><a href="#h27-0-1791" id="h27-0-1791" class="i">+          }.flatten
</a><a href="#h27-0-1792" id="h27-0-1792" class="i">+          pids += children
</a><a href="#h27-0-1793" id="h27-0-1793" class="i">+        end
</a><a href="#h27-0-1794" id="h27-0-1794" class="i">+      end
</a><a href="#h27-0-1795" id="h27-0-1795" class="i">+      pids.each { |pid| Process.kill &#39;TERM&#39;, pid.to_i rescue nil }
</a><a href="#h27-0-1796" id="h27-0-1796" class="i">+    end
</a><a href="#h27-0-1797" id="h27-0-1797" class="i">+  end
</a><a href="#h27-0-1798" id="h27-0-1798" class="i">+
</a><a href="#h27-0-1799" id="h27-0-1799" class="i">+  def compare_git_uri a, b
</a><a href="#h27-0-1800" id="h27-0-1800" class="i">+    regex = %r{^(?:\w+://)?(?:[^@/]*@)?([^:/]*(?::[0-9]*)?)[:/](.*?)(?:\.git)?/?$}
</a><a href="#h27-0-1801" id="h27-0-1801" class="i">+    regex.match(a).to_a.drop(1) == regex.match(b).to_a.drop(1)
</a><a href="#h27-0-1802" id="h27-0-1802" class="i">+  end
</a><a href="#h27-0-1803" id="h27-0-1803" class="i">+
</a><a href="#h27-0-1804" id="h27-0-1804" class="i">+  require &#39;thread&#39;
</a><a href="#h27-0-1805" id="h27-0-1805" class="i">+  require &#39;fileutils&#39;
</a><a href="#h27-0-1806" id="h27-0-1806" class="i">+  require &#39;timeout&#39;
</a><a href="#h27-0-1807" id="h27-0-1807" class="i">+  running = true
</a><a href="#h27-0-1808" id="h27-0-1808" class="i">+  iswin = VIM::evaluate(&#39;s:is_win&#39;).to_i == 1
</a><a href="#h27-0-1809" id="h27-0-1809" class="i">+  pull  = VIM::evaluate(&#39;s:update.pull&#39;).to_i == 1
</a><a href="#h27-0-1810" id="h27-0-1810" class="i">+  base  = VIM::evaluate(&#39;g:plug_home&#39;)
</a><a href="#h27-0-1811" id="h27-0-1811" class="i">+  all   = VIM::evaluate(&#39;s:update.todo&#39;)
</a><a href="#h27-0-1812" id="h27-0-1812" class="i">+  limit = VIM::evaluate(&#39;get(g:, &quot;plug_timeout&quot;, 60)&#39;)
</a><a href="#h27-0-1813" id="h27-0-1813" class="i">+  tries = VIM::evaluate(&#39;get(g:, &quot;plug_retries&quot;, 2)&#39;) + 1
</a><a href="#h27-0-1814" id="h27-0-1814" class="i">+  nthr  = VIM::evaluate(&#39;s:update.threads&#39;).to_i
</a><a href="#h27-0-1815" id="h27-0-1815" class="i">+  maxy  = VIM::evaluate(&#39;winheight(&quot;.&quot;)&#39;).to_i
</a><a href="#h27-0-1816" id="h27-0-1816" class="i">+  vim7  = VIM::evaluate(&#39;v:version&#39;).to_i &lt;= 703 &amp;&amp; RUBY_PLATFORM =~ /darwin/
</a><a href="#h27-0-1817" id="h27-0-1817" class="i">+  cd    = iswin ? &#39;cd /d&#39; : &#39;cd&#39;
</a><a href="#h27-0-1818" id="h27-0-1818" class="i">+  tot   = VIM::evaluate(&#39;len(s:update.todo)&#39;) || 0
</a><a href="#h27-0-1819" id="h27-0-1819" class="i">+  bar   = &#39;&#39;
</a><a href="#h27-0-1820" id="h27-0-1820" class="i">+  skip  = &#39;Already installed&#39;
</a><a href="#h27-0-1821" id="h27-0-1821" class="i">+  mtx   = Mutex.new
</a><a href="#h27-0-1822" id="h27-0-1822" class="i">+  take1 = proc { mtx.synchronize { running &amp;&amp; all.shift } }
</a><a href="#h27-0-1823" id="h27-0-1823" class="i">+  logh  = proc {
</a><a href="#h27-0-1824" id="h27-0-1824" class="i">+    cnt = bar.length
</a><a href="#h27-0-1825" id="h27-0-1825" class="i">+    $curbuf[1] = &quot;#{pull ? &#39;Updating&#39; : &#39;Installing&#39;} plugins (#{cnt}/#{tot})&quot;
</a><a href="#h27-0-1826" id="h27-0-1826" class="i">+    $curbuf[2] = &#39;[&#39; + bar.ljust(tot) + &#39;]&#39;
</a><a href="#h27-0-1827" id="h27-0-1827" class="i">+    VIM::command(&#39;normal! 2G&#39;)
</a><a href="#h27-0-1828" id="h27-0-1828" class="i">+    VIM::command(&#39;redraw&#39;)
</a><a href="#h27-0-1829" id="h27-0-1829" class="i">+  }
</a><a href="#h27-0-1830" id="h27-0-1830" class="i">+  where = proc { |name| (1..($curbuf.length)).find { |l| $curbuf[l] =~ /^[-+x*] #{name}:/ } }
</a><a href="#h27-0-1831" id="h27-0-1831" class="i">+  log   = proc { |name, result, type|
</a><a href="#h27-0-1832" id="h27-0-1832" class="i">+    mtx.synchronize do
</a><a href="#h27-0-1833" id="h27-0-1833" class="i">+      ing  = ![true, false].include?(type)
</a><a href="#h27-0-1834" id="h27-0-1834" class="i">+      bar += type ? &#39;=&#39; : &#39;x&#39; unless ing
</a><a href="#h27-0-1835" id="h27-0-1835" class="i">+      b = case type
</a><a href="#h27-0-1836" id="h27-0-1836" class="i">+          when :install  then &#39;+&#39; when :update then &#39;*&#39;
</a><a href="#h27-0-1837" id="h27-0-1837" class="i">+          when true, nil then &#39;-&#39; else
</a><a href="#h27-0-1838" id="h27-0-1838" class="i">+            VIM::command(&quot;call add(s:update.errors, &#39;#{name}&#39;)&quot;)
</a><a href="#h27-0-1839" id="h27-0-1839" class="i">+            &#39;x&#39;
</a><a href="#h27-0-1840" id="h27-0-1840" class="i">+          end
</a><a href="#h27-0-1841" id="h27-0-1841" class="i">+      result =
</a><a href="#h27-0-1842" id="h27-0-1842" class="i">+        if type || type.nil?
</a><a href="#h27-0-1843" id="h27-0-1843" class="i">+          [&quot;#{b} #{name}: #{result.lines.to_a.last || &#39;OK&#39;}&quot;]
</a><a href="#h27-0-1844" id="h27-0-1844" class="i">+        elsif result =~ /^Interrupted|^Timeout/
</a><a href="#h27-0-1845" id="h27-0-1845" class="i">+          [&quot;#{b} #{name}: #{result}&quot;]
</a><a href="#h27-0-1846" id="h27-0-1846" class="i">+        else
</a><a href="#h27-0-1847" id="h27-0-1847" class="i">+          [&quot;#{b} #{name}&quot;] + result.lines.map { |l| &quot;    &quot; &lt;&lt; l }
</a><a href="#h27-0-1848" id="h27-0-1848" class="i">+        end
</a><a href="#h27-0-1849" id="h27-0-1849" class="i">+      if lnum = where.call(name)
</a><a href="#h27-0-1850" id="h27-0-1850" class="i">+        $curbuf.delete lnum
</a><a href="#h27-0-1851" id="h27-0-1851" class="i">+        lnum = 4 if ing &amp;&amp; lnum &gt; maxy
</a><a href="#h27-0-1852" id="h27-0-1852" class="i">+      end
</a><a href="#h27-0-1853" id="h27-0-1853" class="i">+      result.each_with_index do |line, offset|
</a><a href="#h27-0-1854" id="h27-0-1854" class="i">+        $curbuf.append((lnum || 4) - 1 + offset, line.gsub(/\e\[./, &#39;&#39;).chomp)
</a><a href="#h27-0-1855" id="h27-0-1855" class="i">+      end
</a><a href="#h27-0-1856" id="h27-0-1856" class="i">+      logh.call
</a><a href="#h27-0-1857" id="h27-0-1857" class="i">+    end
</a><a href="#h27-0-1858" id="h27-0-1858" class="i">+  }
</a><a href="#h27-0-1859" id="h27-0-1859" class="i">+  bt = proc { |cmd, name, type, cleanup|
</a><a href="#h27-0-1860" id="h27-0-1860" class="i">+    tried = timeout = 0
</a><a href="#h27-0-1861" id="h27-0-1861" class="i">+    begin
</a><a href="#h27-0-1862" id="h27-0-1862" class="i">+      tried += 1
</a><a href="#h27-0-1863" id="h27-0-1863" class="i">+      timeout += limit
</a><a href="#h27-0-1864" id="h27-0-1864" class="i">+      fd = nil
</a><a href="#h27-0-1865" id="h27-0-1865" class="i">+      data = &#39;&#39;
</a><a href="#h27-0-1866" id="h27-0-1866" class="i">+      if iswin
</a><a href="#h27-0-1867" id="h27-0-1867" class="i">+        Timeout::timeout(timeout) do
</a><a href="#h27-0-1868" id="h27-0-1868" class="i">+          tmp = VIM::evaluate(&#39;tempname()&#39;)
</a><a href="#h27-0-1869" id="h27-0-1869" class="i">+          system(&quot;(#{cmd}) &gt; #{tmp}&quot;)
</a><a href="#h27-0-1870" id="h27-0-1870" class="i">+          data = File.read(tmp).chomp
</a><a href="#h27-0-1871" id="h27-0-1871" class="i">+          File.unlink tmp rescue nil
</a><a href="#h27-0-1872" id="h27-0-1872" class="i">+        end
</a><a href="#h27-0-1873" id="h27-0-1873" class="i">+      else
</a><a href="#h27-0-1874" id="h27-0-1874" class="i">+        fd = IO.popen(cmd).extend(PlugStream)
</a><a href="#h27-0-1875" id="h27-0-1875" class="i">+        first_line = true
</a><a href="#h27-0-1876" id="h27-0-1876" class="i">+        log_prob = 1.0 / nthr
</a><a href="#h27-0-1877" id="h27-0-1877" class="i">+        while line = Timeout::timeout(timeout) { fd.get_line }
</a><a href="#h27-0-1878" id="h27-0-1878" class="i">+          data &lt;&lt; line
</a><a href="#h27-0-1879" id="h27-0-1879" class="i">+          log.call name, line.chomp, type if name &amp;&amp; (first_line || rand &lt; log_prob)
</a><a href="#h27-0-1880" id="h27-0-1880" class="i">+          first_line = false
</a><a href="#h27-0-1881" id="h27-0-1881" class="i">+        end
</a><a href="#h27-0-1882" id="h27-0-1882" class="i">+        fd.close
</a><a href="#h27-0-1883" id="h27-0-1883" class="i">+      end
</a><a href="#h27-0-1884" id="h27-0-1884" class="i">+      [$? == 0, data.chomp]
</a><a href="#h27-0-1885" id="h27-0-1885" class="i">+    rescue Timeout::Error, Interrupt =&gt; e
</a><a href="#h27-0-1886" id="h27-0-1886" class="i">+      if fd &amp;&amp; !fd.closed?
</a><a href="#h27-0-1887" id="h27-0-1887" class="i">+        killall fd.pid
</a><a href="#h27-0-1888" id="h27-0-1888" class="i">+        fd.close
</a><a href="#h27-0-1889" id="h27-0-1889" class="i">+      end
</a><a href="#h27-0-1890" id="h27-0-1890" class="i">+      cleanup.call if cleanup
</a><a href="#h27-0-1891" id="h27-0-1891" class="i">+      if e.is_a?(Timeout::Error) &amp;&amp; tried &lt; tries
</a><a href="#h27-0-1892" id="h27-0-1892" class="i">+        3.downto(1) do |countdown|
</a><a href="#h27-0-1893" id="h27-0-1893" class="i">+          s = countdown &gt; 1 ? &#39;s&#39; : &#39;&#39;
</a><a href="#h27-0-1894" id="h27-0-1894" class="i">+          log.call name, &quot;Timeout. Will retry in #{countdown} second#{s} ...&quot;, type
</a><a href="#h27-0-1895" id="h27-0-1895" class="i">+          sleep 1
</a><a href="#h27-0-1896" id="h27-0-1896" class="i">+        end
</a><a href="#h27-0-1897" id="h27-0-1897" class="i">+        log.call name, &#39;Retrying ...&#39;, type
</a><a href="#h27-0-1898" id="h27-0-1898" class="i">+        retry
</a><a href="#h27-0-1899" id="h27-0-1899" class="i">+      end
</a><a href="#h27-0-1900" id="h27-0-1900" class="i">+      [false, e.is_a?(Interrupt) ? &quot;Interrupted!&quot; : &quot;Timeout!&quot;]
</a><a href="#h27-0-1901" id="h27-0-1901" class="i">+    end
</a><a href="#h27-0-1902" id="h27-0-1902" class="i">+  }
</a><a href="#h27-0-1903" id="h27-0-1903" class="i">+  main = Thread.current
</a><a href="#h27-0-1904" id="h27-0-1904" class="i">+  threads = []
</a><a href="#h27-0-1905" id="h27-0-1905" class="i">+  watcher = Thread.new {
</a><a href="#h27-0-1906" id="h27-0-1906" class="i">+    if vim7
</a><a href="#h27-0-1907" id="h27-0-1907" class="i">+      while VIM::evaluate(&#39;getchar(1)&#39;)
</a><a href="#h27-0-1908" id="h27-0-1908" class="i">+        sleep 0.1
</a><a href="#h27-0-1909" id="h27-0-1909" class="i">+      end
</a><a href="#h27-0-1910" id="h27-0-1910" class="i">+    else
</a><a href="#h27-0-1911" id="h27-0-1911" class="i">+      require &#39;io/console&#39; # &gt;= Ruby 1.9
</a><a href="#h27-0-1912" id="h27-0-1912" class="i">+      nil until IO.console.getch == 3.chr
</a><a href="#h27-0-1913" id="h27-0-1913" class="i">+    end
</a><a href="#h27-0-1914" id="h27-0-1914" class="i">+    mtx.synchronize do
</a><a href="#h27-0-1915" id="h27-0-1915" class="i">+      running = false
</a><a href="#h27-0-1916" id="h27-0-1916" class="i">+      threads.each { |t| t.raise Interrupt } unless vim7
</a><a href="#h27-0-1917" id="h27-0-1917" class="i">+    end
</a><a href="#h27-0-1918" id="h27-0-1918" class="i">+    threads.each { |t| t.join rescue nil }
</a><a href="#h27-0-1919" id="h27-0-1919" class="i">+    main.kill
</a><a href="#h27-0-1920" id="h27-0-1920" class="i">+  }
</a><a href="#h27-0-1921" id="h27-0-1921" class="i">+  refresh = Thread.new {
</a><a href="#h27-0-1922" id="h27-0-1922" class="i">+    while true
</a><a href="#h27-0-1923" id="h27-0-1923" class="i">+      mtx.synchronize do
</a><a href="#h27-0-1924" id="h27-0-1924" class="i">+        break unless running
</a><a href="#h27-0-1925" id="h27-0-1925" class="i">+        VIM::command(&#39;noautocmd normal! a&#39;)
</a><a href="#h27-0-1926" id="h27-0-1926" class="i">+      end
</a><a href="#h27-0-1927" id="h27-0-1927" class="i">+      sleep 0.2
</a><a href="#h27-0-1928" id="h27-0-1928" class="i">+    end
</a><a href="#h27-0-1929" id="h27-0-1929" class="i">+  } if VIM::evaluate(&#39;s:mac_gui&#39;) == 1
</a><a href="#h27-0-1930" id="h27-0-1930" class="i">+
</a><a href="#h27-0-1931" id="h27-0-1931" class="i">+  clone_opt = VIM::evaluate(&#39;s:clone_opt&#39;)
</a><a href="#h27-0-1932" id="h27-0-1932" class="i">+  progress = VIM::evaluate(&#39;s:progress_opt(1)&#39;)
</a><a href="#h27-0-1933" id="h27-0-1933" class="i">+  nthr.times do
</a><a href="#h27-0-1934" id="h27-0-1934" class="i">+    mtx.synchronize do
</a><a href="#h27-0-1935" id="h27-0-1935" class="i">+      threads &lt;&lt; Thread.new {
</a><a href="#h27-0-1936" id="h27-0-1936" class="i">+        while pair = take1.call
</a><a href="#h27-0-1937" id="h27-0-1937" class="i">+          name = pair.first
</a><a href="#h27-0-1938" id="h27-0-1938" class="i">+          dir, uri, tag = pair.last.values_at *%w[dir uri tag]
</a><a href="#h27-0-1939" id="h27-0-1939" class="i">+          exists = File.directory? dir
</a><a href="#h27-0-1940" id="h27-0-1940" class="i">+          ok, result =
</a><a href="#h27-0-1941" id="h27-0-1941" class="i">+            if exists
</a><a href="#h27-0-1942" id="h27-0-1942" class="i">+              chdir = &quot;#{cd} #{iswin ? dir : esc(dir)}&quot;
</a><a href="#h27-0-1943" id="h27-0-1943" class="i">+              ret, data = bt.call &quot;#{chdir} &amp;&amp; git rev-parse --abbrev-ref HEAD 2&gt;&amp;1 &amp;&amp; git config -f .git/config remote.origin.url&quot;, nil, nil, nil
</a><a href="#h27-0-1944" id="h27-0-1944" class="i">+              current_uri = data.lines.to_a.last
</a><a href="#h27-0-1945" id="h27-0-1945" class="i">+              if !ret
</a><a href="#h27-0-1946" id="h27-0-1946" class="i">+                if data =~ /^Interrupted|^Timeout/
</a><a href="#h27-0-1947" id="h27-0-1947" class="i">+                  [false, data]
</a><a href="#h27-0-1948" id="h27-0-1948" class="i">+                else
</a><a href="#h27-0-1949" id="h27-0-1949" class="i">+                  [false, [data.chomp, &quot;PlugClean required.&quot;].join($/)]
</a><a href="#h27-0-1950" id="h27-0-1950" class="i">+                end
</a><a href="#h27-0-1951" id="h27-0-1951" class="i">+              elsif !compare_git_uri(current_uri, uri)
</a><a href="#h27-0-1952" id="h27-0-1952" class="i">+                [false, [&quot;Invalid URI: #{current_uri}&quot;,
</a><a href="#h27-0-1953" id="h27-0-1953" class="i">+                         &quot;Expected:    #{uri}&quot;,
</a><a href="#h27-0-1954" id="h27-0-1954" class="i">+                         &quot;PlugClean required.&quot;].join($/)]
</a><a href="#h27-0-1955" id="h27-0-1955" class="i">+              else
</a><a href="#h27-0-1956" id="h27-0-1956" class="i">+                if pull
</a><a href="#h27-0-1957" id="h27-0-1957" class="i">+                  log.call name, &#39;Updating ...&#39;, :update
</a><a href="#h27-0-1958" id="h27-0-1958" class="i">+                  fetch_opt = (tag &amp;&amp; File.exist?(File.join(dir, &#39;.git/shallow&#39;))) ? &#39;--depth 99999999&#39; : &#39;&#39;
</a><a href="#h27-0-1959" id="h27-0-1959" class="i">+                  bt.call &quot;#{chdir} &amp;&amp; git fetch #{fetch_opt} #{progress} 2&gt;&amp;1&quot;, name, :update, nil
</a><a href="#h27-0-1960" id="h27-0-1960" class="i">+                else
</a><a href="#h27-0-1961" id="h27-0-1961" class="i">+                  [true, skip]
</a><a href="#h27-0-1962" id="h27-0-1962" class="i">+                end
</a><a href="#h27-0-1963" id="h27-0-1963" class="i">+              end
</a><a href="#h27-0-1964" id="h27-0-1964" class="i">+            else
</a><a href="#h27-0-1965" id="h27-0-1965" class="i">+              d = esc dir.sub(%r{[\\/]+$}, &#39;&#39;)
</a><a href="#h27-0-1966" id="h27-0-1966" class="i">+              log.call name, &#39;Installing ...&#39;, :install
</a><a href="#h27-0-1967" id="h27-0-1967" class="i">+              bt.call &quot;git clone #{clone_opt unless tag} #{progress} #{uri} #{d} 2&gt;&amp;1&quot;, name, :install, proc {
</a><a href="#h27-0-1968" id="h27-0-1968" class="i">+                FileUtils.rm_rf dir
</a><a href="#h27-0-1969" id="h27-0-1969" class="i">+              }
</a><a href="#h27-0-1970" id="h27-0-1970" class="i">+            end
</a><a href="#h27-0-1971" id="h27-0-1971" class="i">+          mtx.synchronize { VIM::command(&quot;let s:update.new[&#39;#{name}&#39;] = 1&quot;) } if !exists &amp;&amp; ok
</a><a href="#h27-0-1972" id="h27-0-1972" class="i">+          log.call name, result, ok
</a><a href="#h27-0-1973" id="h27-0-1973" class="i">+        end
</a><a href="#h27-0-1974" id="h27-0-1974" class="i">+      } if running
</a><a href="#h27-0-1975" id="h27-0-1975" class="i">+    end
</a><a href="#h27-0-1976" id="h27-0-1976" class="i">+  end
</a><a href="#h27-0-1977" id="h27-0-1977" class="i">+  threads.each { |t| t.join rescue nil }
</a><a href="#h27-0-1978" id="h27-0-1978" class="i">+  logh.call
</a><a href="#h27-0-1979" id="h27-0-1979" class="i">+  refresh.kill if refresh
</a><a href="#h27-0-1980" id="h27-0-1980" class="i">+  watcher.kill
</a><a href="#h27-0-1981" id="h27-0-1981" class="i">+EOF
</a><a href="#h27-0-1982" id="h27-0-1982" class="i">+endfunction
</a><a href="#h27-0-1983" id="h27-0-1983" class="i">+
</a><a href="#h27-0-1984" id="h27-0-1984" class="i">+function! s:shellesc_cmd(arg)
</a><a href="#h27-0-1985" id="h27-0-1985" class="i">+  let escaped = substitute(a:arg, &#39;[&amp;|&lt;&gt;()@^]&#39;, &#39;^&amp;&#39;, &#39;g&#39;)
</a><a href="#h27-0-1986" id="h27-0-1986" class="i">+  let escaped = substitute(escaped, &#39;%&#39;, &#39;%%&#39;, &#39;g&#39;)
</a><a href="#h27-0-1987" id="h27-0-1987" class="i">+  let escaped = substitute(escaped, &#39;&quot;&#39;, &#39;\\^&amp;&#39;, &#39;g&#39;)
</a><a href="#h27-0-1988" id="h27-0-1988" class="i">+  let escaped = substitute(escaped, &#39;\(\\\+\)\(\\^\)&#39;, &#39;\1\1\2&#39;, &#39;g&#39;)
</a><a href="#h27-0-1989" id="h27-0-1989" class="i">+  return &#39;^&quot;&#39;.substitute(escaped, &#39;\(\\\+\)$&#39;, &#39;\1\1&#39;, &#39;&#39;).&#39;^&quot;&#39;
</a><a href="#h27-0-1990" id="h27-0-1990" class="i">+endfunction
</a><a href="#h27-0-1991" id="h27-0-1991" class="i">+
</a><a href="#h27-0-1992" id="h27-0-1992" class="i">+function! s:shellesc(arg)
</a><a href="#h27-0-1993" id="h27-0-1993" class="i">+  if &amp;shell =~# &#39;cmd.exe$&#39;
</a><a href="#h27-0-1994" id="h27-0-1994" class="i">+    return s:shellesc_cmd(a:arg)
</a><a href="#h27-0-1995" id="h27-0-1995" class="i">+  endif
</a><a href="#h27-0-1996" id="h27-0-1996" class="i">+  return shellescape(a:arg)
</a><a href="#h27-0-1997" id="h27-0-1997" class="i">+endfunction
</a><a href="#h27-0-1998" id="h27-0-1998" class="i">+
</a><a href="#h27-0-1999" id="h27-0-1999" class="i">+function! s:glob_dir(path)
</a><a href="#h27-0-2000" id="h27-0-2000" class="i">+  return map(filter(s:glob(a:path, &#39;**&#39;), &#39;isdirectory(v:val)&#39;), &#39;s:dirpath(v:val)&#39;)
</a><a href="#h27-0-2001" id="h27-0-2001" class="i">+endfunction
</a><a href="#h27-0-2002" id="h27-0-2002" class="i">+
</a><a href="#h27-0-2003" id="h27-0-2003" class="i">+function! s:progress_bar(line, bar, total)
</a><a href="#h27-0-2004" id="h27-0-2004" class="i">+  call setline(a:line, &#39;[&#39; . s:lpad(a:bar, a:total) . &#39;]&#39;)
</a><a href="#h27-0-2005" id="h27-0-2005" class="i">+endfunction
</a><a href="#h27-0-2006" id="h27-0-2006" class="i">+
</a><a href="#h27-0-2007" id="h27-0-2007" class="i">+function! s:compare_git_uri(a, b)
</a><a href="#h27-0-2008" id="h27-0-2008" class="i">+  &quot; See `git help clone&#39;
</a><a href="#h27-0-2009" id="h27-0-2009" class="i">+  &quot; https:// [user@] github.com[:port] / junegunn/vim-plug [.git]
</a><a href="#h27-0-2010" id="h27-0-2010" class="i">+  &quot;          [git@]  github.com[:port] : junegunn/vim-plug [.git]
</a><a href="#h27-0-2011" id="h27-0-2011" class="i">+  &quot; file://                            / junegunn/vim-plug        [/]
</a><a href="#h27-0-2012" id="h27-0-2012" class="i">+  &quot;                                    / junegunn/vim-plug        [/]
</a><a href="#h27-0-2013" id="h27-0-2013" class="i">+  let pat = &#39;^\%(\w\+://\)\=&#39;.&#39;\%([^@/]*@\)\=&#39;.&#39;\([^:/]*\%(:[0-9]*\)\=\)&#39;.&#39;[:/]&#39;.&#39;\(.\{-}\)&#39;.&#39;\%(\.git\)\=/\?$&#39;
</a><a href="#h27-0-2014" id="h27-0-2014" class="i">+  let ma = matchlist(a:a, pat)
</a><a href="#h27-0-2015" id="h27-0-2015" class="i">+  let mb = matchlist(a:b, pat)
</a><a href="#h27-0-2016" id="h27-0-2016" class="i">+  return ma[1:2] ==# mb[1:2]
</a><a href="#h27-0-2017" id="h27-0-2017" class="i">+endfunction
</a><a href="#h27-0-2018" id="h27-0-2018" class="i">+
</a><a href="#h27-0-2019" id="h27-0-2019" class="i">+function! s:format_message(bullet, name, message)
</a><a href="#h27-0-2020" id="h27-0-2020" class="i">+  if a:bullet != &#39;x&#39;
</a><a href="#h27-0-2021" id="h27-0-2021" class="i">+    return [printf(&#39;%s %s: %s&#39;, a:bullet, a:name, s:lastline(a:message))]
</a><a href="#h27-0-2022" id="h27-0-2022" class="i">+  else
</a><a href="#h27-0-2023" id="h27-0-2023" class="i">+    let lines = map(s:lines(a:message), &#39;&quot;    &quot;.v:val&#39;)
</a><a href="#h27-0-2024" id="h27-0-2024" class="i">+    return extend([printf(&#39;x %s:&#39;, a:name)], lines)
</a><a href="#h27-0-2025" id="h27-0-2025" class="i">+  endif
</a><a href="#h27-0-2026" id="h27-0-2026" class="i">+endfunction
</a><a href="#h27-0-2027" id="h27-0-2027" class="i">+
</a><a href="#h27-0-2028" id="h27-0-2028" class="i">+function! s:with_cd(cmd, dir)
</a><a href="#h27-0-2029" id="h27-0-2029" class="i">+  return printf(&#39;cd%s %s &amp;&amp; %s&#39;, s:is_win ? &#39; /d&#39; : &#39;&#39;, s:shellesc(a:dir), a:cmd)
</a><a href="#h27-0-2030" id="h27-0-2030" class="i">+endfunction
</a><a href="#h27-0-2031" id="h27-0-2031" class="i">+
</a><a href="#h27-0-2032" id="h27-0-2032" class="i">+function! s:system(cmd, ...)
</a><a href="#h27-0-2033" id="h27-0-2033" class="i">+  try
</a><a href="#h27-0-2034" id="h27-0-2034" class="i">+    let [sh, shellcmdflag, shrd] = s:chsh(1)
</a><a href="#h27-0-2035" id="h27-0-2035" class="i">+    let cmd = a:0 &gt; 0 ? s:with_cd(a:cmd, a:1) : a:cmd
</a><a href="#h27-0-2036" id="h27-0-2036" class="i">+    if s:is_win
</a><a href="#h27-0-2037" id="h27-0-2037" class="i">+      let batchfile = tempname().&#39;.bat&#39;
</a><a href="#h27-0-2038" id="h27-0-2038" class="i">+      call writefile([&quot;@echo off\r&quot;, cmd . &quot;\r&quot;], batchfile)
</a><a href="#h27-0-2039" id="h27-0-2039" class="i">+      let cmd = batchfile
</a><a href="#h27-0-2040" id="h27-0-2040" class="i">+    endif
</a><a href="#h27-0-2041" id="h27-0-2041" class="i">+    return system(s:is_win ? &#39;(&#39;.cmd.&#39;)&#39; : cmd)
</a><a href="#h27-0-2042" id="h27-0-2042" class="i">+  finally
</a><a href="#h27-0-2043" id="h27-0-2043" class="i">+    let [&amp;shell, &amp;shellcmdflag, &amp;shellredir] = [sh, shellcmdflag, shrd]
</a><a href="#h27-0-2044" id="h27-0-2044" class="i">+    if s:is_win
</a><a href="#h27-0-2045" id="h27-0-2045" class="i">+      call delete(batchfile)
</a><a href="#h27-0-2046" id="h27-0-2046" class="i">+    endif
</a><a href="#h27-0-2047" id="h27-0-2047" class="i">+  endtry
</a><a href="#h27-0-2048" id="h27-0-2048" class="i">+endfunction
</a><a href="#h27-0-2049" id="h27-0-2049" class="i">+
</a><a href="#h27-0-2050" id="h27-0-2050" class="i">+function! s:system_chomp(...)
</a><a href="#h27-0-2051" id="h27-0-2051" class="i">+  let ret = call(&#39;s:system&#39;, a:000)
</a><a href="#h27-0-2052" id="h27-0-2052" class="i">+  return v:shell_error ? &#39;&#39; : substitute(ret, &#39;\n$&#39;, &#39;&#39;, &#39;&#39;)
</a><a href="#h27-0-2053" id="h27-0-2053" class="i">+endfunction
</a><a href="#h27-0-2054" id="h27-0-2054" class="i">+
</a><a href="#h27-0-2055" id="h27-0-2055" class="i">+function! s:git_validate(spec, check_branch)
</a><a href="#h27-0-2056" id="h27-0-2056" class="i">+  let err = &#39;&#39;
</a><a href="#h27-0-2057" id="h27-0-2057" class="i">+  if isdirectory(a:spec.dir)
</a><a href="#h27-0-2058" id="h27-0-2058" class="i">+    let result = s:lines(s:system(&#39;git rev-parse --abbrev-ref HEAD 2&gt;&amp;1 &amp;&amp; git config -f .git/config remote.origin.url&#39;, a:spec.dir))
</a><a href="#h27-0-2059" id="h27-0-2059" class="i">+    let remote = result[-1]
</a><a href="#h27-0-2060" id="h27-0-2060" class="i">+    if v:shell_error
</a><a href="#h27-0-2061" id="h27-0-2061" class="i">+      let err = join([remote, &#39;PlugClean required.&#39;], &quot;\n&quot;)
</a><a href="#h27-0-2062" id="h27-0-2062" class="i">+    elseif !s:compare_git_uri(remote, a:spec.uri)
</a><a href="#h27-0-2063" id="h27-0-2063" class="i">+      let err = join([&#39;Invalid URI: &#39;.remote,
</a><a href="#h27-0-2064" id="h27-0-2064" class="i">+                    \ &#39;Expected:    &#39;.a:spec.uri,
</a><a href="#h27-0-2065" id="h27-0-2065" class="i">+                    \ &#39;PlugClean required.&#39;], &quot;\n&quot;)
</a><a href="#h27-0-2066" id="h27-0-2066" class="i">+    elseif a:check_branch &amp;&amp; has_key(a:spec, &#39;commit&#39;)
</a><a href="#h27-0-2067" id="h27-0-2067" class="i">+      let result = s:lines(s:system(&#39;git rev-parse HEAD 2&gt;&amp;1&#39;, a:spec.dir))
</a><a href="#h27-0-2068" id="h27-0-2068" class="i">+      let sha = result[-1]
</a><a href="#h27-0-2069" id="h27-0-2069" class="i">+      if v:shell_error
</a><a href="#h27-0-2070" id="h27-0-2070" class="i">+        let err = join(add(result, &#39;PlugClean required.&#39;), &quot;\n&quot;)
</a><a href="#h27-0-2071" id="h27-0-2071" class="i">+      elseif !s:hash_match(sha, a:spec.commit)
</a><a href="#h27-0-2072" id="h27-0-2072" class="i">+        let err = join([printf(&#39;Invalid HEAD (expected: %s, actual: %s)&#39;,
</a><a href="#h27-0-2073" id="h27-0-2073" class="i">+                              \ a:spec.commit[:6], sha[:6]),
</a><a href="#h27-0-2074" id="h27-0-2074" class="i">+                      \ &#39;PlugUpdate required.&#39;], &quot;\n&quot;)
</a><a href="#h27-0-2075" id="h27-0-2075" class="i">+      endif
</a><a href="#h27-0-2076" id="h27-0-2076" class="i">+    elseif a:check_branch
</a><a href="#h27-0-2077" id="h27-0-2077" class="i">+      let branch = result[0]
</a><a href="#h27-0-2078" id="h27-0-2078" class="i">+      &quot; Check tag
</a><a href="#h27-0-2079" id="h27-0-2079" class="i">+      if has_key(a:spec, &#39;tag&#39;)
</a><a href="#h27-0-2080" id="h27-0-2080" class="i">+        let tag = s:system_chomp(&#39;git describe --exact-match --tags HEAD 2&gt;&amp;1&#39;, a:spec.dir)
</a><a href="#h27-0-2081" id="h27-0-2081" class="i">+        if a:spec.tag !=# tag &amp;&amp; a:spec.tag !~ &#39;\*&#39;
</a><a href="#h27-0-2082" id="h27-0-2082" class="i">+          let err = printf(&#39;Invalid tag: %s (expected: %s). Try PlugUpdate.&#39;,
</a><a href="#h27-0-2083" id="h27-0-2083" class="i">+                \ (empty(tag) ? &#39;N/A&#39; : tag), a:spec.tag)
</a><a href="#h27-0-2084" id="h27-0-2084" class="i">+        endif
</a><a href="#h27-0-2085" id="h27-0-2085" class="i">+      &quot; Check branch
</a><a href="#h27-0-2086" id="h27-0-2086" class="i">+      elseif a:spec.branch !=# branch
</a><a href="#h27-0-2087" id="h27-0-2087" class="i">+        let err = printf(&#39;Invalid branch: %s (expected: %s). Try PlugUpdate.&#39;,
</a><a href="#h27-0-2088" id="h27-0-2088" class="i">+              \ branch, a:spec.branch)
</a><a href="#h27-0-2089" id="h27-0-2089" class="i">+      endif
</a><a href="#h27-0-2090" id="h27-0-2090" class="i">+      if empty(err)
</a><a href="#h27-0-2091" id="h27-0-2091" class="i">+        let [ahead, behind] = split(s:lastline(s:system(printf(
</a><a href="#h27-0-2092" id="h27-0-2092" class="i">+              \ &#39;git rev-list --count --left-right HEAD...origin/%s&#39;,
</a><a href="#h27-0-2093" id="h27-0-2093" class="i">+              \ a:spec.branch), a:spec.dir)), &#39;\t&#39;)
</a><a href="#h27-0-2094" id="h27-0-2094" class="i">+        if !v:shell_error &amp;&amp; ahead
</a><a href="#h27-0-2095" id="h27-0-2095" class="i">+          if behind
</a><a href="#h27-0-2096" id="h27-0-2096" class="i">+            &quot; Only mention PlugClean if diverged, otherwise it&#39;s likely to be
</a><a href="#h27-0-2097" id="h27-0-2097" class="i">+            &quot; pushable (and probably not that messed up).
</a><a href="#h27-0-2098" id="h27-0-2098" class="i">+            let err = printf(
</a><a href="#h27-0-2099" id="h27-0-2099" class="i">+                  \ &quot;Diverged from origin/%s (%d commit(s) ahead and %d commit(s) behind!\n&quot;
</a><a href="#h27-0-2100" id="h27-0-2100" class="i">+                  \ .&#39;Backup local changes and run PlugClean and PlugUpdate to reinstall it.&#39;, a:spec.branch, ahead, behind)
</a><a href="#h27-0-2101" id="h27-0-2101" class="i">+          else
</a><a href="#h27-0-2102" id="h27-0-2102" class="i">+            let err = printf(&quot;Ahead of origin/%s by %d commit(s).\n&quot;
</a><a href="#h27-0-2103" id="h27-0-2103" class="i">+                  \ .&#39;Cannot update until local changes are pushed.&#39;,
</a><a href="#h27-0-2104" id="h27-0-2104" class="i">+                  \ a:spec.branch, ahead)
</a><a href="#h27-0-2105" id="h27-0-2105" class="i">+          endif
</a><a href="#h27-0-2106" id="h27-0-2106" class="i">+        endif
</a><a href="#h27-0-2107" id="h27-0-2107" class="i">+      endif
</a><a href="#h27-0-2108" id="h27-0-2108" class="i">+    endif
</a><a href="#h27-0-2109" id="h27-0-2109" class="i">+  else
</a><a href="#h27-0-2110" id="h27-0-2110" class="i">+    let err = &#39;Not found&#39;
</a><a href="#h27-0-2111" id="h27-0-2111" class="i">+  endif
</a><a href="#h27-0-2112" id="h27-0-2112" class="i">+  return [err, err =~# &#39;PlugClean&#39;]
</a><a href="#h27-0-2113" id="h27-0-2113" class="i">+endfunction
</a><a href="#h27-0-2114" id="h27-0-2114" class="i">+
</a><a href="#h27-0-2115" id="h27-0-2115" class="i">+function! s:rm_rf(dir)
</a><a href="#h27-0-2116" id="h27-0-2116" class="i">+  if isdirectory(a:dir)
</a><a href="#h27-0-2117" id="h27-0-2117" class="i">+    call s:system((s:is_win ? &#39;rmdir /S /Q &#39; : &#39;rm -rf &#39;) . s:shellesc(a:dir))
</a><a href="#h27-0-2118" id="h27-0-2118" class="i">+  endif
</a><a href="#h27-0-2119" id="h27-0-2119" class="i">+endfunction
</a><a href="#h27-0-2120" id="h27-0-2120" class="i">+
</a><a href="#h27-0-2121" id="h27-0-2121" class="i">+function! s:clean(force)
</a><a href="#h27-0-2122" id="h27-0-2122" class="i">+  call s:prepare()
</a><a href="#h27-0-2123" id="h27-0-2123" class="i">+  call append(0, &#39;Searching for invalid plugins in &#39;.g:plug_home)
</a><a href="#h27-0-2124" id="h27-0-2124" class="i">+  call append(1, &#39;&#39;)
</a><a href="#h27-0-2125" id="h27-0-2125" class="i">+
</a><a href="#h27-0-2126" id="h27-0-2126" class="i">+  &quot; List of valid directories
</a><a href="#h27-0-2127" id="h27-0-2127" class="i">+  let dirs = []
</a><a href="#h27-0-2128" id="h27-0-2128" class="i">+  let errs = {}
</a><a href="#h27-0-2129" id="h27-0-2129" class="i">+  let [cnt, total] = [0, len(g:plugs)]
</a><a href="#h27-0-2130" id="h27-0-2130" class="i">+  for [name, spec] in items(g:plugs)
</a><a href="#h27-0-2131" id="h27-0-2131" class="i">+    if !s:is_managed(name)
</a><a href="#h27-0-2132" id="h27-0-2132" class="i">+      call add(dirs, spec.dir)
</a><a href="#h27-0-2133" id="h27-0-2133" class="i">+    else
</a><a href="#h27-0-2134" id="h27-0-2134" class="i">+      let [err, clean] = s:git_validate(spec, 1)
</a><a href="#h27-0-2135" id="h27-0-2135" class="i">+      if clean
</a><a href="#h27-0-2136" id="h27-0-2136" class="i">+        let errs[spec.dir] = s:lines(err)[0]
</a><a href="#h27-0-2137" id="h27-0-2137" class="i">+      else
</a><a href="#h27-0-2138" id="h27-0-2138" class="i">+        call add(dirs, spec.dir)
</a><a href="#h27-0-2139" id="h27-0-2139" class="i">+      endif
</a><a href="#h27-0-2140" id="h27-0-2140" class="i">+    endif
</a><a href="#h27-0-2141" id="h27-0-2141" class="i">+    let cnt += 1
</a><a href="#h27-0-2142" id="h27-0-2142" class="i">+    call s:progress_bar(2, repeat(&#39;=&#39;, cnt), total)
</a><a href="#h27-0-2143" id="h27-0-2143" class="i">+    normal! 2G
</a><a href="#h27-0-2144" id="h27-0-2144" class="i">+    redraw
</a><a href="#h27-0-2145" id="h27-0-2145" class="i">+  endfor
</a><a href="#h27-0-2146" id="h27-0-2146" class="i">+
</a><a href="#h27-0-2147" id="h27-0-2147" class="i">+  let allowed = {}
</a><a href="#h27-0-2148" id="h27-0-2148" class="i">+  for dir in dirs
</a><a href="#h27-0-2149" id="h27-0-2149" class="i">+    let allowed[s:dirpath(fnamemodify(dir, &#39;:h:h&#39;))] = 1
</a><a href="#h27-0-2150" id="h27-0-2150" class="i">+    let allowed[dir] = 1
</a><a href="#h27-0-2151" id="h27-0-2151" class="i">+    for child in s:glob_dir(dir)
</a><a href="#h27-0-2152" id="h27-0-2152" class="i">+      let allowed[child] = 1
</a><a href="#h27-0-2153" id="h27-0-2153" class="i">+    endfor
</a><a href="#h27-0-2154" id="h27-0-2154" class="i">+  endfor
</a><a href="#h27-0-2155" id="h27-0-2155" class="i">+
</a><a href="#h27-0-2156" id="h27-0-2156" class="i">+  let todo = []
</a><a href="#h27-0-2157" id="h27-0-2157" class="i">+  let found = sort(s:glob_dir(g:plug_home))
</a><a href="#h27-0-2158" id="h27-0-2158" class="i">+  while !empty(found)
</a><a href="#h27-0-2159" id="h27-0-2159" class="i">+    let f = remove(found, 0)
</a><a href="#h27-0-2160" id="h27-0-2160" class="i">+    if !has_key(allowed, f) &amp;&amp; isdirectory(f)
</a><a href="#h27-0-2161" id="h27-0-2161" class="i">+      call add(todo, f)
</a><a href="#h27-0-2162" id="h27-0-2162" class="i">+      call append(line(&#39;$&#39;), &#39;- &#39; . f)
</a><a href="#h27-0-2163" id="h27-0-2163" class="i">+      if has_key(errs, f)
</a><a href="#h27-0-2164" id="h27-0-2164" class="i">+        call append(line(&#39;$&#39;), &#39;    &#39; . errs[f])
</a><a href="#h27-0-2165" id="h27-0-2165" class="i">+      endif
</a><a href="#h27-0-2166" id="h27-0-2166" class="i">+      let found = filter(found, &#39;stridx(v:val, f) != 0&#39;)
</a><a href="#h27-0-2167" id="h27-0-2167" class="i">+    end
</a><a href="#h27-0-2168" id="h27-0-2168" class="i">+  endwhile
</a><a href="#h27-0-2169" id="h27-0-2169" class="i">+
</a><a href="#h27-0-2170" id="h27-0-2170" class="i">+  4
</a><a href="#h27-0-2171" id="h27-0-2171" class="i">+  redraw
</a><a href="#h27-0-2172" id="h27-0-2172" class="i">+  if empty(todo)
</a><a href="#h27-0-2173" id="h27-0-2173" class="i">+    call append(line(&#39;$&#39;), &#39;Already clean.&#39;)
</a><a href="#h27-0-2174" id="h27-0-2174" class="i">+  else
</a><a href="#h27-0-2175" id="h27-0-2175" class="i">+    let s:clean_count = 0
</a><a href="#h27-0-2176" id="h27-0-2176" class="i">+    call append(3, [&#39;Directories to delete:&#39;, &#39;&#39;])
</a><a href="#h27-0-2177" id="h27-0-2177" class="i">+    redraw!
</a><a href="#h27-0-2178" id="h27-0-2178" class="i">+    if a:force || s:ask_no_interrupt(&#39;Delete all directories?&#39;)
</a><a href="#h27-0-2179" id="h27-0-2179" class="i">+      call s:delete([6, line(&#39;$&#39;)], 1)
</a><a href="#h27-0-2180" id="h27-0-2180" class="i">+    else
</a><a href="#h27-0-2181" id="h27-0-2181" class="i">+      call setline(4, &#39;Cancelled.&#39;)
</a><a href="#h27-0-2182" id="h27-0-2182" class="i">+      nnoremap &lt;silent&gt; &lt;buffer&gt; d :set opfunc=&lt;sid&gt;delete_op&lt;cr&gt;g@
</a><a href="#h27-0-2183" id="h27-0-2183" class="i">+      nmap     &lt;silent&gt; &lt;buffer&gt; dd d_
</a><a href="#h27-0-2184" id="h27-0-2184" class="i">+      xnoremap &lt;silent&gt; &lt;buffer&gt; d :&lt;c-u&gt;call &lt;sid&gt;delete_op(visualmode(), 1)&lt;cr&gt;
</a><a href="#h27-0-2185" id="h27-0-2185" class="i">+      echo &#39;Delete the lines (d{motion}) to delete the corresponding directories&#39;
</a><a href="#h27-0-2186" id="h27-0-2186" class="i">+    endif
</a><a href="#h27-0-2187" id="h27-0-2187" class="i">+  endif
</a><a href="#h27-0-2188" id="h27-0-2188" class="i">+  4
</a><a href="#h27-0-2189" id="h27-0-2189" class="i">+  setlocal nomodifiable
</a><a href="#h27-0-2190" id="h27-0-2190" class="i">+endfunction
</a><a href="#h27-0-2191" id="h27-0-2191" class="i">+
</a><a href="#h27-0-2192" id="h27-0-2192" class="i">+function! s:delete_op(type, ...)
</a><a href="#h27-0-2193" id="h27-0-2193" class="i">+  call s:delete(a:0 ? [line(&quot;&#39;&lt;&quot;), line(&quot;&#39;&gt;&quot;)] : [line(&quot;&#39;[&quot;), line(&quot;&#39;]&quot;)], 0)
</a><a href="#h27-0-2194" id="h27-0-2194" class="i">+endfunction
</a><a href="#h27-0-2195" id="h27-0-2195" class="i">+
</a><a href="#h27-0-2196" id="h27-0-2196" class="i">+function! s:delete(range, force)
</a><a href="#h27-0-2197" id="h27-0-2197" class="i">+  let [l1, l2] = a:range
</a><a href="#h27-0-2198" id="h27-0-2198" class="i">+  let force = a:force
</a><a href="#h27-0-2199" id="h27-0-2199" class="i">+  while l1 &lt;= l2
</a><a href="#h27-0-2200" id="h27-0-2200" class="i">+    let line = getline(l1)
</a><a href="#h27-0-2201" id="h27-0-2201" class="i">+    if line =~ &#39;^- &#39; &amp;&amp; isdirectory(line[2:])
</a><a href="#h27-0-2202" id="h27-0-2202" class="i">+      execute l1
</a><a href="#h27-0-2203" id="h27-0-2203" class="i">+      redraw!
</a><a href="#h27-0-2204" id="h27-0-2204" class="i">+      let answer = force ? 1 : s:ask(&#39;Delete &#39;.line[2:].&#39;?&#39;, 1)
</a><a href="#h27-0-2205" id="h27-0-2205" class="i">+      let force = force || answer &gt; 1
</a><a href="#h27-0-2206" id="h27-0-2206" class="i">+      if answer
</a><a href="#h27-0-2207" id="h27-0-2207" class="i">+        call s:rm_rf(line[2:])
</a><a href="#h27-0-2208" id="h27-0-2208" class="i">+        setlocal modifiable
</a><a href="#h27-0-2209" id="h27-0-2209" class="i">+        call setline(l1, &#39;~&#39;.line[1:])
</a><a href="#h27-0-2210" id="h27-0-2210" class="i">+        let s:clean_count += 1
</a><a href="#h27-0-2211" id="h27-0-2211" class="i">+        call setline(4, printf(&#39;Removed %d directories.&#39;, s:clean_count))
</a><a href="#h27-0-2212" id="h27-0-2212" class="i">+        setlocal nomodifiable
</a><a href="#h27-0-2213" id="h27-0-2213" class="i">+      endif
</a><a href="#h27-0-2214" id="h27-0-2214" class="i">+    endif
</a><a href="#h27-0-2215" id="h27-0-2215" class="i">+    let l1 += 1
</a><a href="#h27-0-2216" id="h27-0-2216" class="i">+  endwhile
</a><a href="#h27-0-2217" id="h27-0-2217" class="i">+endfunction
</a><a href="#h27-0-2218" id="h27-0-2218" class="i">+
</a><a href="#h27-0-2219" id="h27-0-2219" class="i">+function! s:upgrade()
</a><a href="#h27-0-2220" id="h27-0-2220" class="i">+  echo &#39;Downloading the latest version of vim-plug&#39;
</a><a href="#h27-0-2221" id="h27-0-2221" class="i">+  redraw
</a><a href="#h27-0-2222" id="h27-0-2222" class="i">+  let tmp = tempname()
</a><a href="#h27-0-2223" id="h27-0-2223" class="i">+  let new = tmp . &#39;/plug.vim&#39;
</a><a href="#h27-0-2224" id="h27-0-2224" class="i">+
</a><a href="#h27-0-2225" id="h27-0-2225" class="i">+  try
</a><a href="#h27-0-2226" id="h27-0-2226" class="i">+    let out = s:system(printf(&#39;git clone --depth 1 %s %s&#39;, s:plug_src, tmp))
</a><a href="#h27-0-2227" id="h27-0-2227" class="i">+    if v:shell_error
</a><a href="#h27-0-2228" id="h27-0-2228" class="i">+      return s:err(&#39;Error upgrading vim-plug: &#39;. out)
</a><a href="#h27-0-2229" id="h27-0-2229" class="i">+    endif
</a><a href="#h27-0-2230" id="h27-0-2230" class="i">+
</a><a href="#h27-0-2231" id="h27-0-2231" class="i">+    if readfile(s:me) ==# readfile(new)
</a><a href="#h27-0-2232" id="h27-0-2232" class="i">+      echo &#39;vim-plug is already up-to-date&#39;
</a><a href="#h27-0-2233" id="h27-0-2233" class="i">+      return 0
</a><a href="#h27-0-2234" id="h27-0-2234" class="i">+    else
</a><a href="#h27-0-2235" id="h27-0-2235" class="i">+      call rename(s:me, s:me . &#39;.old&#39;)
</a><a href="#h27-0-2236" id="h27-0-2236" class="i">+      call rename(new, s:me)
</a><a href="#h27-0-2237" id="h27-0-2237" class="i">+      unlet g:loaded_plug
</a><a href="#h27-0-2238" id="h27-0-2238" class="i">+      echo &#39;vim-plug has been upgraded&#39;
</a><a href="#h27-0-2239" id="h27-0-2239" class="i">+      return 1
</a><a href="#h27-0-2240" id="h27-0-2240" class="i">+    endif
</a><a href="#h27-0-2241" id="h27-0-2241" class="i">+  finally
</a><a href="#h27-0-2242" id="h27-0-2242" class="i">+    silent! call s:rm_rf(tmp)
</a><a href="#h27-0-2243" id="h27-0-2243" class="i">+  endtry
</a><a href="#h27-0-2244" id="h27-0-2244" class="i">+endfunction
</a><a href="#h27-0-2245" id="h27-0-2245" class="i">+
</a><a href="#h27-0-2246" id="h27-0-2246" class="i">+function! s:upgrade_specs()
</a><a href="#h27-0-2247" id="h27-0-2247" class="i">+  for spec in values(g:plugs)
</a><a href="#h27-0-2248" id="h27-0-2248" class="i">+    let spec.frozen = get(spec, &#39;frozen&#39;, 0)
</a><a href="#h27-0-2249" id="h27-0-2249" class="i">+  endfor
</a><a href="#h27-0-2250" id="h27-0-2250" class="i">+endfunction
</a><a href="#h27-0-2251" id="h27-0-2251" class="i">+
</a><a href="#h27-0-2252" id="h27-0-2252" class="i">+function! s:status()
</a><a href="#h27-0-2253" id="h27-0-2253" class="i">+  call s:prepare()
</a><a href="#h27-0-2254" id="h27-0-2254" class="i">+  call append(0, &#39;Checking plugins&#39;)
</a><a href="#h27-0-2255" id="h27-0-2255" class="i">+  call append(1, &#39;&#39;)
</a><a href="#h27-0-2256" id="h27-0-2256" class="i">+
</a><a href="#h27-0-2257" id="h27-0-2257" class="i">+  let ecnt = 0
</a><a href="#h27-0-2258" id="h27-0-2258" class="i">+  let unloaded = 0
</a><a href="#h27-0-2259" id="h27-0-2259" class="i">+  let [cnt, total] = [0, len(g:plugs)]
</a><a href="#h27-0-2260" id="h27-0-2260" class="i">+  for [name, spec] in items(g:plugs)
</a><a href="#h27-0-2261" id="h27-0-2261" class="i">+    let is_dir = isdirectory(spec.dir)
</a><a href="#h27-0-2262" id="h27-0-2262" class="i">+    if has_key(spec, &#39;uri&#39;)
</a><a href="#h27-0-2263" id="h27-0-2263" class="i">+      if is_dir
</a><a href="#h27-0-2264" id="h27-0-2264" class="i">+        let [err, _] = s:git_validate(spec, 1)
</a><a href="#h27-0-2265" id="h27-0-2265" class="i">+        let [valid, msg] = [empty(err), empty(err) ? &#39;OK&#39; : err]
</a><a href="#h27-0-2266" id="h27-0-2266" class="i">+      else
</a><a href="#h27-0-2267" id="h27-0-2267" class="i">+        let [valid, msg] = [0, &#39;Not found. Try PlugInstall.&#39;]
</a><a href="#h27-0-2268" id="h27-0-2268" class="i">+      endif
</a><a href="#h27-0-2269" id="h27-0-2269" class="i">+    else
</a><a href="#h27-0-2270" id="h27-0-2270" class="i">+      if is_dir
</a><a href="#h27-0-2271" id="h27-0-2271" class="i">+        let [valid, msg] = [1, &#39;OK&#39;]
</a><a href="#h27-0-2272" id="h27-0-2272" class="i">+      else
</a><a href="#h27-0-2273" id="h27-0-2273" class="i">+        let [valid, msg] = [0, &#39;Not found.&#39;]
</a><a href="#h27-0-2274" id="h27-0-2274" class="i">+      endif
</a><a href="#h27-0-2275" id="h27-0-2275" class="i">+    endif
</a><a href="#h27-0-2276" id="h27-0-2276" class="i">+    let cnt += 1
</a><a href="#h27-0-2277" id="h27-0-2277" class="i">+    let ecnt += !valid
</a><a href="#h27-0-2278" id="h27-0-2278" class="i">+    &quot; `s:loaded` entry can be missing if PlugUpgraded
</a><a href="#h27-0-2279" id="h27-0-2279" class="i">+    if is_dir &amp;&amp; get(s:loaded, name, -1) == 0
</a><a href="#h27-0-2280" id="h27-0-2280" class="i">+      let unloaded = 1
</a><a href="#h27-0-2281" id="h27-0-2281" class="i">+      let msg .= &#39; (not loaded)&#39;
</a><a href="#h27-0-2282" id="h27-0-2282" class="i">+    endif
</a><a href="#h27-0-2283" id="h27-0-2283" class="i">+    call s:progress_bar(2, repeat(&#39;=&#39;, cnt), total)
</a><a href="#h27-0-2284" id="h27-0-2284" class="i">+    call append(3, s:format_message(valid ? &#39;-&#39; : &#39;x&#39;, name, msg))
</a><a href="#h27-0-2285" id="h27-0-2285" class="i">+    normal! 2G
</a><a href="#h27-0-2286" id="h27-0-2286" class="i">+    redraw
</a><a href="#h27-0-2287" id="h27-0-2287" class="i">+  endfor
</a><a href="#h27-0-2288" id="h27-0-2288" class="i">+  call setline(1, &#39;Finished. &#39;.ecnt.&#39; error(s).&#39;)
</a><a href="#h27-0-2289" id="h27-0-2289" class="i">+  normal! gg
</a><a href="#h27-0-2290" id="h27-0-2290" class="i">+  setlocal nomodifiable
</a><a href="#h27-0-2291" id="h27-0-2291" class="i">+  if unloaded
</a><a href="#h27-0-2292" id="h27-0-2292" class="i">+    echo &quot;Press &#39;L&#39; on each line to load plugin, or &#39;U&#39; to update&quot;
</a><a href="#h27-0-2293" id="h27-0-2293" class="i">+    nnoremap &lt;silent&gt; &lt;buffer&gt; L :call &lt;SID&gt;status_load(line(&#39;.&#39;))&lt;cr&gt;
</a><a href="#h27-0-2294" id="h27-0-2294" class="i">+    xnoremap &lt;silent&gt; &lt;buffer&gt; L :call &lt;SID&gt;status_load(line(&#39;.&#39;))&lt;cr&gt;
</a><a href="#h27-0-2295" id="h27-0-2295" class="i">+  end
</a><a href="#h27-0-2296" id="h27-0-2296" class="i">+endfunction
</a><a href="#h27-0-2297" id="h27-0-2297" class="i">+
</a><a href="#h27-0-2298" id="h27-0-2298" class="i">+function! s:extract_name(str, prefix, suffix)
</a><a href="#h27-0-2299" id="h27-0-2299" class="i">+  return matchstr(a:str, &#39;^&#39;.a:prefix.&#39; \zs[^:]\+\ze:.*&#39;.a:suffix.&#39;$&#39;)
</a><a href="#h27-0-2300" id="h27-0-2300" class="i">+endfunction
</a><a href="#h27-0-2301" id="h27-0-2301" class="i">+
</a><a href="#h27-0-2302" id="h27-0-2302" class="i">+function! s:status_load(lnum)
</a><a href="#h27-0-2303" id="h27-0-2303" class="i">+  let line = getline(a:lnum)
</a><a href="#h27-0-2304" id="h27-0-2304" class="i">+  let name = s:extract_name(line, &#39;-&#39;, &#39;(not loaded)&#39;)
</a><a href="#h27-0-2305" id="h27-0-2305" class="i">+  if !empty(name)
</a><a href="#h27-0-2306" id="h27-0-2306" class="i">+    call plug#load(name)
</a><a href="#h27-0-2307" id="h27-0-2307" class="i">+    setlocal modifiable
</a><a href="#h27-0-2308" id="h27-0-2308" class="i">+    call setline(a:lnum, substitute(line, &#39; (not loaded)$&#39;, &#39;&#39;, &#39;&#39;))
</a><a href="#h27-0-2309" id="h27-0-2309" class="i">+    setlocal nomodifiable
</a><a href="#h27-0-2310" id="h27-0-2310" class="i">+  endif
</a><a href="#h27-0-2311" id="h27-0-2311" class="i">+endfunction
</a><a href="#h27-0-2312" id="h27-0-2312" class="i">+
</a><a href="#h27-0-2313" id="h27-0-2313" class="i">+function! s:status_update() range
</a><a href="#h27-0-2314" id="h27-0-2314" class="i">+  let lines = getline(a:firstline, a:lastline)
</a><a href="#h27-0-2315" id="h27-0-2315" class="i">+  let names = filter(map(lines, &#39;s:extract_name(v:val, &quot;[x-]&quot;, &quot;&quot;)&#39;), &#39;!empty(v:val)&#39;)
</a><a href="#h27-0-2316" id="h27-0-2316" class="i">+  if !empty(names)
</a><a href="#h27-0-2317" id="h27-0-2317" class="i">+    echo
</a><a href="#h27-0-2318" id="h27-0-2318" class="i">+    execute &#39;PlugUpdate&#39; join(names)
</a><a href="#h27-0-2319" id="h27-0-2319" class="i">+  endif
</a><a href="#h27-0-2320" id="h27-0-2320" class="i">+endfunction
</a><a href="#h27-0-2321" id="h27-0-2321" class="i">+
</a><a href="#h27-0-2322" id="h27-0-2322" class="i">+function! s:is_preview_window_open()
</a><a href="#h27-0-2323" id="h27-0-2323" class="i">+  silent! wincmd P
</a><a href="#h27-0-2324" id="h27-0-2324" class="i">+  if &amp;previewwindow
</a><a href="#h27-0-2325" id="h27-0-2325" class="i">+    wincmd p
</a><a href="#h27-0-2326" id="h27-0-2326" class="i">+    return 1
</a><a href="#h27-0-2327" id="h27-0-2327" class="i">+  endif
</a><a href="#h27-0-2328" id="h27-0-2328" class="i">+endfunction
</a><a href="#h27-0-2329" id="h27-0-2329" class="i">+
</a><a href="#h27-0-2330" id="h27-0-2330" class="i">+function! s:find_name(lnum)
</a><a href="#h27-0-2331" id="h27-0-2331" class="i">+  for lnum in reverse(range(1, a:lnum))
</a><a href="#h27-0-2332" id="h27-0-2332" class="i">+    let line = getline(lnum)
</a><a href="#h27-0-2333" id="h27-0-2333" class="i">+    if empty(line)
</a><a href="#h27-0-2334" id="h27-0-2334" class="i">+      return &#39;&#39;
</a><a href="#h27-0-2335" id="h27-0-2335" class="i">+    endif
</a><a href="#h27-0-2336" id="h27-0-2336" class="i">+    let name = s:extract_name(line, &#39;-&#39;, &#39;&#39;)
</a><a href="#h27-0-2337" id="h27-0-2337" class="i">+    if !empty(name)
</a><a href="#h27-0-2338" id="h27-0-2338" class="i">+      return name
</a><a href="#h27-0-2339" id="h27-0-2339" class="i">+    endif
</a><a href="#h27-0-2340" id="h27-0-2340" class="i">+  endfor
</a><a href="#h27-0-2341" id="h27-0-2341" class="i">+  return &#39;&#39;
</a><a href="#h27-0-2342" id="h27-0-2342" class="i">+endfunction
</a><a href="#h27-0-2343" id="h27-0-2343" class="i">+
</a><a href="#h27-0-2344" id="h27-0-2344" class="i">+function! s:preview_commit()
</a><a href="#h27-0-2345" id="h27-0-2345" class="i">+  if b:plug_preview &lt; 0
</a><a href="#h27-0-2346" id="h27-0-2346" class="i">+    let b:plug_preview = !s:is_preview_window_open()
</a><a href="#h27-0-2347" id="h27-0-2347" class="i">+  endif
</a><a href="#h27-0-2348" id="h27-0-2348" class="i">+
</a><a href="#h27-0-2349" id="h27-0-2349" class="i">+  let sha = matchstr(getline(&#39;.&#39;), &#39;^  \X*\zs[0-9a-f]\{7,9}&#39;)
</a><a href="#h27-0-2350" id="h27-0-2350" class="i">+  if empty(sha)
</a><a href="#h27-0-2351" id="h27-0-2351" class="i">+    return
</a><a href="#h27-0-2352" id="h27-0-2352" class="i">+  endif
</a><a href="#h27-0-2353" id="h27-0-2353" class="i">+
</a><a href="#h27-0-2354" id="h27-0-2354" class="i">+  let name = s:find_name(line(&#39;.&#39;))
</a><a href="#h27-0-2355" id="h27-0-2355" class="i">+  if empty(name) || !has_key(g:plugs, name) || !isdirectory(g:plugs[name].dir)
</a><a href="#h27-0-2356" id="h27-0-2356" class="i">+    return
</a><a href="#h27-0-2357" id="h27-0-2357" class="i">+  endif
</a><a href="#h27-0-2358" id="h27-0-2358" class="i">+
</a><a href="#h27-0-2359" id="h27-0-2359" class="i">+  if exists(&#39;g:plug_pwindow&#39;) &amp;&amp; !s:is_preview_window_open()
</a><a href="#h27-0-2360" id="h27-0-2360" class="i">+    execute g:plug_pwindow
</a><a href="#h27-0-2361" id="h27-0-2361" class="i">+    execute &#39;e&#39; sha
</a><a href="#h27-0-2362" id="h27-0-2362" class="i">+  else
</a><a href="#h27-0-2363" id="h27-0-2363" class="i">+    execute &#39;pedit&#39; sha
</a><a href="#h27-0-2364" id="h27-0-2364" class="i">+    wincmd P
</a><a href="#h27-0-2365" id="h27-0-2365" class="i">+  endif
</a><a href="#h27-0-2366" id="h27-0-2366" class="i">+  setlocal previewwindow filetype=git buftype=nofile nobuflisted modifiable
</a><a href="#h27-0-2367" id="h27-0-2367" class="i">+  try
</a><a href="#h27-0-2368" id="h27-0-2368" class="i">+    let [sh, shellcmdflag, shrd] = s:chsh(1)
</a><a href="#h27-0-2369" id="h27-0-2369" class="i">+    let cmd = &#39;cd &#39;.s:shellesc(g:plugs[name].dir).&#39; &amp;&amp; git show --no-color --pretty=medium &#39;.sha
</a><a href="#h27-0-2370" id="h27-0-2370" class="i">+    if s:is_win
</a><a href="#h27-0-2371" id="h27-0-2371" class="i">+      let batchfile = tempname().&#39;.bat&#39;
</a><a href="#h27-0-2372" id="h27-0-2372" class="i">+      call writefile([&quot;@echo off\r&quot;, cmd . &quot;\r&quot;], batchfile)
</a><a href="#h27-0-2373" id="h27-0-2373" class="i">+      let cmd = batchfile
</a><a href="#h27-0-2374" id="h27-0-2374" class="i">+    endif
</a><a href="#h27-0-2375" id="h27-0-2375" class="i">+    execute &#39;silent %!&#39; cmd
</a><a href="#h27-0-2376" id="h27-0-2376" class="i">+  finally
</a><a href="#h27-0-2377" id="h27-0-2377" class="i">+    let [&amp;shell, &amp;shellcmdflag, &amp;shellredir] = [sh, shellcmdflag, shrd]
</a><a href="#h27-0-2378" id="h27-0-2378" class="i">+    if s:is_win
</a><a href="#h27-0-2379" id="h27-0-2379" class="i">+      call delete(batchfile)
</a><a href="#h27-0-2380" id="h27-0-2380" class="i">+    endif
</a><a href="#h27-0-2381" id="h27-0-2381" class="i">+  endtry
</a><a href="#h27-0-2382" id="h27-0-2382" class="i">+  setlocal nomodifiable
</a><a href="#h27-0-2383" id="h27-0-2383" class="i">+  nnoremap &lt;silent&gt; &lt;buffer&gt; q :q&lt;cr&gt;
</a><a href="#h27-0-2384" id="h27-0-2384" class="i">+  wincmd p
</a><a href="#h27-0-2385" id="h27-0-2385" class="i">+endfunction
</a><a href="#h27-0-2386" id="h27-0-2386" class="i">+
</a><a href="#h27-0-2387" id="h27-0-2387" class="i">+function! s:section(flags)
</a><a href="#h27-0-2388" id="h27-0-2388" class="i">+  call search(&#39;\(^[x-] \)\@&lt;=[^:]\+:&#39;, a:flags)
</a><a href="#h27-0-2389" id="h27-0-2389" class="i">+endfunction
</a><a href="#h27-0-2390" id="h27-0-2390" class="i">+
</a><a href="#h27-0-2391" id="h27-0-2391" class="i">+function! s:format_git_log(line)
</a><a href="#h27-0-2392" id="h27-0-2392" class="i">+  let indent = &#39;  &#39;
</a><a href="#h27-0-2393" id="h27-0-2393" class="i">+  let tokens = split(a:line, nr2char(1))
</a><a href="#h27-0-2394" id="h27-0-2394" class="i">+  if len(tokens) != 5
</a><a href="#h27-0-2395" id="h27-0-2395" class="i">+    return indent.substitute(a:line, &#39;\s*$&#39;, &#39;&#39;, &#39;&#39;)
</a><a href="#h27-0-2396" id="h27-0-2396" class="i">+  endif
</a><a href="#h27-0-2397" id="h27-0-2397" class="i">+  let [graph, sha, refs, subject, date] = tokens
</a><a href="#h27-0-2398" id="h27-0-2398" class="i">+  let tag = matchstr(refs, &#39;tag: [^,)]\+&#39;)
</a><a href="#h27-0-2399" id="h27-0-2399" class="i">+  let tag = empty(tag) ? &#39; &#39; : &#39; (&#39;.tag.&#39;) &#39;
</a><a href="#h27-0-2400" id="h27-0-2400" class="i">+  return printf(&#39;%s%s%s%s%s (%s)&#39;, indent, graph, sha, tag, subject, date)
</a><a href="#h27-0-2401" id="h27-0-2401" class="i">+endfunction
</a><a href="#h27-0-2402" id="h27-0-2402" class="i">+
</a><a href="#h27-0-2403" id="h27-0-2403" class="i">+function! s:append_ul(lnum, text)
</a><a href="#h27-0-2404" id="h27-0-2404" class="i">+  call append(a:lnum, [&#39;&#39;, a:text, repeat(&#39;-&#39;, len(a:text))])
</a><a href="#h27-0-2405" id="h27-0-2405" class="i">+endfunction
</a><a href="#h27-0-2406" id="h27-0-2406" class="i">+
</a><a href="#h27-0-2407" id="h27-0-2407" class="i">+function! s:diff()
</a><a href="#h27-0-2408" id="h27-0-2408" class="i">+  call s:prepare()
</a><a href="#h27-0-2409" id="h27-0-2409" class="i">+  call append(0, [&#39;Collecting changes ...&#39;, &#39;&#39;])
</a><a href="#h27-0-2410" id="h27-0-2410" class="i">+  let cnts = [0, 0]
</a><a href="#h27-0-2411" id="h27-0-2411" class="i">+  let bar = &#39;&#39;
</a><a href="#h27-0-2412" id="h27-0-2412" class="i">+  let total = filter(copy(g:plugs), &#39;s:is_managed(v:key) &amp;&amp; isdirectory(v:val.dir)&#39;)
</a><a href="#h27-0-2413" id="h27-0-2413" class="i">+  call s:progress_bar(2, bar, len(total))
</a><a href="#h27-0-2414" id="h27-0-2414" class="i">+  for origin in [1, 0]
</a><a href="#h27-0-2415" id="h27-0-2415" class="i">+    let plugs = reverse(sort(items(filter(copy(total), (origin ? &#39;&#39; : &#39;!&#39;).&#39;(has_key(v:val, &quot;commit&quot;) || has_key(v:val, &quot;tag&quot;))&#39;))))
</a><a href="#h27-0-2416" id="h27-0-2416" class="i">+    if empty(plugs)
</a><a href="#h27-0-2417" id="h27-0-2417" class="i">+      continue
</a><a href="#h27-0-2418" id="h27-0-2418" class="i">+    endif
</a><a href="#h27-0-2419" id="h27-0-2419" class="i">+    call s:append_ul(2, origin ? &#39;Pending updates:&#39; : &#39;Last update:&#39;)
</a><a href="#h27-0-2420" id="h27-0-2420" class="i">+    for [k, v] in plugs
</a><a href="#h27-0-2421" id="h27-0-2421" class="i">+      let range = origin ? &#39;..origin/&#39;.v.branch : &#39;HEAD@{1}..&#39;
</a><a href="#h27-0-2422" id="h27-0-2422" class="i">+      let cmd = &#39;git log --graph --color=never &#39;.join(map([&#39;--pretty=format:%x01%h%x01%d%x01%s%x01%cr&#39;, range], &#39;s:shellesc(v:val)&#39;))
</a><a href="#h27-0-2423" id="h27-0-2423" class="i">+      if has_key(v, &#39;rtp&#39;)
</a><a href="#h27-0-2424" id="h27-0-2424" class="i">+        let cmd .= &#39; -- &#39;.s:shellesc(v.rtp)
</a><a href="#h27-0-2425" id="h27-0-2425" class="i">+      endif
</a><a href="#h27-0-2426" id="h27-0-2426" class="i">+      let diff = s:system_chomp(cmd, v.dir)
</a><a href="#h27-0-2427" id="h27-0-2427" class="i">+      if !empty(diff)
</a><a href="#h27-0-2428" id="h27-0-2428" class="i">+        let ref = has_key(v, &#39;tag&#39;) ? (&#39; (tag: &#39;.v.tag.&#39;)&#39;) : has_key(v, &#39;commit&#39;) ? (&#39; &#39;.v.commit) : &#39;&#39;
</a><a href="#h27-0-2429" id="h27-0-2429" class="i">+        call append(5, extend([&#39;&#39;, &#39;- &#39;.k.&#39;:&#39;.ref], map(s:lines(diff), &#39;s:format_git_log(v:val)&#39;)))
</a><a href="#h27-0-2430" id="h27-0-2430" class="i">+        let cnts[origin] += 1
</a><a href="#h27-0-2431" id="h27-0-2431" class="i">+      endif
</a><a href="#h27-0-2432" id="h27-0-2432" class="i">+      let bar .= &#39;=&#39;
</a><a href="#h27-0-2433" id="h27-0-2433" class="i">+      call s:progress_bar(2, bar, len(total))
</a><a href="#h27-0-2434" id="h27-0-2434" class="i">+      normal! 2G
</a><a href="#h27-0-2435" id="h27-0-2435" class="i">+      redraw
</a><a href="#h27-0-2436" id="h27-0-2436" class="i">+    endfor
</a><a href="#h27-0-2437" id="h27-0-2437" class="i">+    if !cnts[origin]
</a><a href="#h27-0-2438" id="h27-0-2438" class="i">+      call append(5, [&#39;&#39;, &#39;N/A&#39;])
</a><a href="#h27-0-2439" id="h27-0-2439" class="i">+    endif
</a><a href="#h27-0-2440" id="h27-0-2440" class="i">+  endfor
</a><a href="#h27-0-2441" id="h27-0-2441" class="i">+  call setline(1, printf(&#39;%d plugin(s) updated.&#39;, cnts[0])
</a><a href="#h27-0-2442" id="h27-0-2442" class="i">+        \ . (cnts[1] ? printf(&#39; %d plugin(s) have pending updates.&#39;, cnts[1]) : &#39;&#39;))
</a><a href="#h27-0-2443" id="h27-0-2443" class="i">+
</a><a href="#h27-0-2444" id="h27-0-2444" class="i">+  if cnts[0] || cnts[1]
</a><a href="#h27-0-2445" id="h27-0-2445" class="i">+    nnoremap &lt;silent&gt; &lt;buffer&gt; &lt;plug&gt;(plug-preview) :silent! call &lt;SID&gt;preview_commit()&lt;cr&gt;
</a><a href="#h27-0-2446" id="h27-0-2446" class="i">+    if empty(maparg(&quot;\&lt;cr&gt;&quot;, &#39;n&#39;))
</a><a href="#h27-0-2447" id="h27-0-2447" class="i">+      nmap &lt;buffer&gt; &lt;cr&gt; &lt;plug&gt;(plug-preview)
</a><a href="#h27-0-2448" id="h27-0-2448" class="i">+    endif
</a><a href="#h27-0-2449" id="h27-0-2449" class="i">+    if empty(maparg(&#39;o&#39;, &#39;n&#39;))
</a><a href="#h27-0-2450" id="h27-0-2450" class="i">+      nmap &lt;buffer&gt; o &lt;plug&gt;(plug-preview)
</a><a href="#h27-0-2451" id="h27-0-2451" class="i">+    endif
</a><a href="#h27-0-2452" id="h27-0-2452" class="i">+  endif
</a><a href="#h27-0-2453" id="h27-0-2453" class="i">+  if cnts[0]
</a><a href="#h27-0-2454" id="h27-0-2454" class="i">+    nnoremap &lt;silent&gt; &lt;buffer&gt; X :call &lt;SID&gt;revert()&lt;cr&gt;
</a><a href="#h27-0-2455" id="h27-0-2455" class="i">+    echo &quot;Press &#39;X&#39; on each block to revert the update&quot;
</a><a href="#h27-0-2456" id="h27-0-2456" class="i">+  endif
</a><a href="#h27-0-2457" id="h27-0-2457" class="i">+  normal! gg
</a><a href="#h27-0-2458" id="h27-0-2458" class="i">+  setlocal nomodifiable
</a><a href="#h27-0-2459" id="h27-0-2459" class="i">+endfunction
</a><a href="#h27-0-2460" id="h27-0-2460" class="i">+
</a><a href="#h27-0-2461" id="h27-0-2461" class="i">+function! s:revert()
</a><a href="#h27-0-2462" id="h27-0-2462" class="i">+  if search(&#39;^Pending updates&#39;, &#39;bnW&#39;)
</a><a href="#h27-0-2463" id="h27-0-2463" class="i">+    return
</a><a href="#h27-0-2464" id="h27-0-2464" class="i">+  endif
</a><a href="#h27-0-2465" id="h27-0-2465" class="i">+
</a><a href="#h27-0-2466" id="h27-0-2466" class="i">+  let name = s:find_name(line(&#39;.&#39;))
</a><a href="#h27-0-2467" id="h27-0-2467" class="i">+  if empty(name) || !has_key(g:plugs, name) ||
</a><a href="#h27-0-2468" id="h27-0-2468" class="i">+    \ input(printf(&#39;Revert the update of %s? (y/N) &#39;, name)) !~? &#39;^y&#39;
</a><a href="#h27-0-2469" id="h27-0-2469" class="i">+    return
</a><a href="#h27-0-2470" id="h27-0-2470" class="i">+  endif
</a><a href="#h27-0-2471" id="h27-0-2471" class="i">+
</a><a href="#h27-0-2472" id="h27-0-2472" class="i">+  call s:system(&#39;git reset --hard HEAD@{1} &amp;&amp; git checkout &#39;.s:esc(g:plugs[name].branch).&#39; --&#39;, g:plugs[name].dir)
</a><a href="#h27-0-2473" id="h27-0-2473" class="i">+  setlocal modifiable
</a><a href="#h27-0-2474" id="h27-0-2474" class="i">+  normal! &quot;_dap
</a><a href="#h27-0-2475" id="h27-0-2475" class="i">+  setlocal nomodifiable
</a><a href="#h27-0-2476" id="h27-0-2476" class="i">+  echo &#39;Reverted&#39;
</a><a href="#h27-0-2477" id="h27-0-2477" class="i">+endfunction
</a><a href="#h27-0-2478" id="h27-0-2478" class="i">+
</a><a href="#h27-0-2479" id="h27-0-2479" class="i">+function! s:snapshot(force, ...) abort
</a><a href="#h27-0-2480" id="h27-0-2480" class="i">+  call s:prepare()
</a><a href="#h27-0-2481" id="h27-0-2481" class="i">+  setf vim
</a><a href="#h27-0-2482" id="h27-0-2482" class="i">+  call append(0, [&#39;&quot; Generated by vim-plug&#39;,
</a><a href="#h27-0-2483" id="h27-0-2483" class="i">+                \ &#39;&quot; &#39;.strftime(&quot;%c&quot;),
</a><a href="#h27-0-2484" id="h27-0-2484" class="i">+                \ &#39;&quot; :source this file in vim to restore the snapshot&#39;,
</a><a href="#h27-0-2485" id="h27-0-2485" class="i">+                \ &#39;&quot; or execute: vim -S snapshot.vim&#39;,
</a><a href="#h27-0-2486" id="h27-0-2486" class="i">+                \ &#39;&#39;, &#39;&#39;, &#39;PlugUpdate!&#39;])
</a><a href="#h27-0-2487" id="h27-0-2487" class="i">+  1
</a><a href="#h27-0-2488" id="h27-0-2488" class="i">+  let anchor = line(&#39;$&#39;) - 3
</a><a href="#h27-0-2489" id="h27-0-2489" class="i">+  let names = sort(keys(filter(copy(g:plugs),
</a><a href="#h27-0-2490" id="h27-0-2490" class="i">+        \&#39;has_key(v:val, &quot;uri&quot;) &amp;&amp; !has_key(v:val, &quot;commit&quot;) &amp;&amp; isdirectory(v:val.dir)&#39;)))
</a><a href="#h27-0-2491" id="h27-0-2491" class="i">+  for name in reverse(names)
</a><a href="#h27-0-2492" id="h27-0-2492" class="i">+    let sha = s:system_chomp(&#39;git rev-parse --short HEAD&#39;, g:plugs[name].dir)
</a><a href="#h27-0-2493" id="h27-0-2493" class="i">+    if !empty(sha)
</a><a href="#h27-0-2494" id="h27-0-2494" class="i">+      call append(anchor, printf(&quot;silent! let g:plugs[&#39;%s&#39;].commit = &#39;%s&#39;&quot;, name, sha))
</a><a href="#h27-0-2495" id="h27-0-2495" class="i">+      redraw
</a><a href="#h27-0-2496" id="h27-0-2496" class="i">+    endif
</a><a href="#h27-0-2497" id="h27-0-2497" class="i">+  endfor
</a><a href="#h27-0-2498" id="h27-0-2498" class="i">+
</a><a href="#h27-0-2499" id="h27-0-2499" class="i">+  if a:0 &gt; 0
</a><a href="#h27-0-2500" id="h27-0-2500" class="i">+    let fn = expand(a:1)
</a><a href="#h27-0-2501" id="h27-0-2501" class="i">+    if filereadable(fn) &amp;&amp; !(a:force || s:ask(a:1.&#39; already exists. Overwrite?&#39;))
</a><a href="#h27-0-2502" id="h27-0-2502" class="i">+      return
</a><a href="#h27-0-2503" id="h27-0-2503" class="i">+    endif
</a><a href="#h27-0-2504" id="h27-0-2504" class="i">+    call writefile(getline(1, &#39;$&#39;), fn)
</a><a href="#h27-0-2505" id="h27-0-2505" class="i">+    echo &#39;Saved as &#39;.a:1
</a><a href="#h27-0-2506" id="h27-0-2506" class="i">+    silent execute &#39;e&#39; s:esc(fn)
</a><a href="#h27-0-2507" id="h27-0-2507" class="i">+    setf vim
</a><a href="#h27-0-2508" id="h27-0-2508" class="i">+  endif
</a><a href="#h27-0-2509" id="h27-0-2509" class="i">+endfunction
</a><a href="#h27-0-2510" id="h27-0-2510" class="i">+
</a><a href="#h27-0-2511" id="h27-0-2511" class="i">+function! s:split_rtp()
</a><a href="#h27-0-2512" id="h27-0-2512" class="i">+  return split(&amp;rtp, &#39;\\\@&lt;!,&#39;)
</a><a href="#h27-0-2513" id="h27-0-2513" class="i">+endfunction
</a><a href="#h27-0-2514" id="h27-0-2514" class="i">+
</a><a href="#h27-0-2515" id="h27-0-2515" class="i">+let s:first_rtp = s:escrtp(get(s:split_rtp(), 0, &#39;&#39;))
</a><a href="#h27-0-2516" id="h27-0-2516" class="i">+let s:last_rtp  = s:escrtp(get(s:split_rtp(), -1, &#39;&#39;))
</a><a href="#h27-0-2517" id="h27-0-2517" class="i">+
</a><a href="#h27-0-2518" id="h27-0-2518" class="i">+if exists(&#39;g:plugs&#39;)
</a><a href="#h27-0-2519" id="h27-0-2519" class="i">+  let g:plugs_order = get(g:, &#39;plugs_order&#39;, keys(g:plugs))
</a><a href="#h27-0-2520" id="h27-0-2520" class="i">+  call s:upgrade_specs()
</a><a href="#h27-0-2521" id="h27-0-2521" class="i">+  call s:define_commands()
</a><a href="#h27-0-2522" id="h27-0-2522" class="i">+endif
</a><a href="#h27-0-2523" id="h27-0-2523" class="i">+
</a><a href="#h27-0-2524" id="h27-0-2524" class="i">+let &amp;cpo = s:cpo_save
</a><a href="#h27-0-2525" id="h27-0-2525" class="i">+unlet s:cpo_save
</a><b>diff --git a/<a id="h28" href="../file/dots/.vimrc.html">dots/.vimrc</a> b/<a href="../file/dots/.vimrc.html">dots/.vimrc</a></b>
<a href="#h28-0" id="h28-0" class="h">@@ -0,0 +1,26 @@
</a><a href="#h28-0-0" id="h28-0-0" class="i">+&quot;        _
</a><a href="#h28-0-1" id="h28-0-1" class="i">+&quot; __   _(_)_ __ ___  _ __ ___
</a><a href="#h28-0-2" id="h28-0-2" class="i">+&quot; \ \ / / | &#39;_ ` _ \| &#39;__/ __|
</a><a href="#h28-0-3" id="h28-0-3" class="i">+&quot;  \ V /| | | | | | | | | (__
</a><a href="#h28-0-4" id="h28-0-4" class="i">+&quot;   \_/ |_|_| |_| |_|_|  \___|
</a><a href="#h28-0-5" id="h28-0-5" class="i">+
</a><a href="#h28-0-6" id="h28-0-6" class="i">+let mapleader =&quot; &quot;
</a><a href="#h28-0-7" id="h28-0-7" class="i">+
</a><a href="#h28-0-8" id="h28-0-8" class="i">+call plug#begin(&#39;~/.vim/plugged&#39;)
</a><a href="#h28-0-9" id="h28-0-9" class="i">+Plug &#39;junegunn/goyo.vim&#39;
</a><a href="#h28-0-10" id="h28-0-10" class="i">+Plug &#39;fatih/vim-go&#39;
</a><a href="#h28-0-11" id="h28-0-11" class="i">+call plug#end()
</a><a href="#h28-0-12" id="h28-0-12" class="i">+
</a><a href="#h28-0-13" id="h28-0-13" class="i">+&quot; Some basics:
</a><a href="#h28-0-14" id="h28-0-14" class="i">+	set nocompatible
</a><a href="#h28-0-15" id="h28-0-15" class="i">+	set encoding=utf-8
</a><a href="#h28-0-16" id="h28-0-16" class="i">+
</a><a href="#h28-0-17" id="h28-0-17" class="i">+&quot; Splits open at the bottom and right, which is non-retarded, unlike vim defaults.
</a><a href="#h28-0-18" id="h28-0-18" class="i">+	set splitbelow
</a><a href="#h28-0-19" id="h28-0-19" class="i">+	set splitright
</a><a href="#h28-0-20" id="h28-0-20" class="i">+
</a><a href="#h28-0-21" id="h28-0-21" class="i">+&quot; Compile document
</a><a href="#h28-0-22" id="h28-0-22" class="i">+	map &lt;leader&gt;c :!compiler &lt;c-r&gt;%&lt;CR&gt;
</a><a href="#h28-0-23" id="h28-0-23" class="i">+
</a><a href="#h28-0-24" id="h28-0-24" class="i">+&quot; Open corresponding .pdf
</a><a href="#h28-0-25" id="h28-0-25" class="i">+	map &lt;leader&gt;p :!open &lt;c-r&gt;%&lt;CR&gt;&lt;CR&gt;
</a><b>diff --git a/<a id="h29" href="../file/dots/.zshenv.html">dots/.zshenv</a> b/<a href="../file/dots/.zshenv.html">dots/.zshenv</a></b>
<a href="#h29-0" id="h29-0" class="h">@@ -0,0 +1,51 @@
</a><a href="#h29-0-0" id="h29-0-0" class="i">+export TERMINAL=$HOME/bin/alacritty
</a><a href="#h29-0-1" id="h29-0-1" class="i">+export PATH=$PATH:/usr/local/bin
</a><a href="#h29-0-2" id="h29-0-2" class="i">+export PATH=$PATH:$HOME/.bin
</a><a href="#h29-0-3" id="h29-0-3" class="i">+
</a><a href="#h29-0-4" id="h29-0-4" class="i">+## ZSH Config
</a><a href="#h29-0-5" id="h29-0-5" class="i">+export ZDOTDIR=$HOME
</a><a href="#h29-0-6" id="h29-0-6" class="i">+export ZSHDDIR=$HOME/.config/zsh
</a><a href="#h29-0-7" id="h29-0-7" class="i">+export ZSH=$HOME/.config/oh-my-zsh
</a><a href="#h29-0-8" id="h29-0-8" class="i">+export SHELL_SESSION_HISTORY=0
</a><a href="#h29-0-9" id="h29-0-9" class="i">+
</a><a href="#h29-0-10" id="h29-0-10" class="i">+export HISTSIZE=1000
</a><a href="#h29-0-11" id="h29-0-11" class="i">+export SAVEHIST=1000
</a><a href="#h29-0-12" id="h29-0-12" class="i">+export HISTFILE=~/.history
</a><a href="#h29-0-13" id="h29-0-13" class="i">+
</a><a href="#h29-0-14" id="h29-0-14" class="i">+export ZSH_THEME=&quot;mark&quot;
</a><a href="#h29-0-15" id="h29-0-15" class="i">+export DISABLE_LS_COLORS=&quot;false&quot;
</a><a href="#h29-0-16" id="h29-0-16" class="i">+export DISABLE_AUTO_TITLE=&quot;true&quot;
</a><a href="#h29-0-17" id="h29-0-17" class="i">+
</a><a href="#h29-0-18" id="h29-0-18" class="i">+## User configuration
</a><a href="#h29-0-19" id="h29-0-19" class="i">+export SHELL=/bin/zsh
</a><a href="#h29-0-20" id="h29-0-20" class="i">+export MANPATH=/usr/local/share/man:$MANPATH
</a><a href="#h29-0-21" id="h29-0-21" class="i">+
</a><a href="#h29-0-22" id="h29-0-22" class="i">+## Homebrew
</a><a href="#h29-0-23" id="h29-0-23" class="i">+export HOMEBREW_GITHUB_API_TOKEN=&quot;30e5da2b006d5f92e5474ff17c7eefe5cad20ee9&quot;
</a><a href="#h29-0-24" id="h29-0-24" class="i">+export PATH=&quot;/usr/local/sbin:$PATH&quot;
</a><a href="#h29-0-25" id="h29-0-25" class="i">+
</a><a href="#h29-0-26" id="h29-0-26" class="i">+## Haskel
</a><a href="#h29-0-27" id="h29-0-27" class="i">+export PATH=$PATH:$HOME/Library/Haskell/bin
</a><a href="#h29-0-28" id="h29-0-28" class="i">+
</a><a href="#h29-0-29" id="h29-0-29" class="i">+## Go
</a><a href="#h29-0-30" id="h29-0-30" class="i">+export GOPATH=$HOME/prog/go
</a><a href="#h29-0-31" id="h29-0-31" class="i">+export PATH=$PATH:$GOPATH/bin
</a><a href="#h29-0-32" id="h29-0-32" class="i">+export CORE=$GOPATH/src/gitlab.com/redeam/core
</a><a href="#h29-0-33" id="h29-0-33" class="i">+
</a><a href="#h29-0-34" id="h29-0-34" class="i">+## Docker
</a><a href="#h29-0-35" id="h29-0-35" class="i">+export DOCKER_HIDE_LEGACY_COMMANDS=1
</a><a href="#h29-0-36" id="h29-0-36" class="i">+
</a><a href="#h29-0-37" id="h29-0-37" class="i">+## Rust
</a><a href="#h29-0-38" id="h29-0-38" class="i">+export PATH=$PATH:$HOME/.cargo/bin
</a><a href="#h29-0-39" id="h29-0-39" class="i">+
</a><a href="#h29-0-40" id="h29-0-40" class="i">+## fzf
</a><a href="#h29-0-41" id="h29-0-41" class="i">+export FZF_DEFAULT_OPTS=&#39;--height 40% --exact&#39;
</a><a href="#h29-0-42" id="h29-0-42" class="i">+export FZF_CTRL_T_OPTS=&quot;--preview &#39;(highlight -O ansi -l {} 2&gt; /dev/null || cat {} || tree -C {}) 2&gt; /dev/null | head -200&#39;&quot;
</a><a href="#h29-0-43" id="h29-0-43" class="i">+export FZF_CTRL_R_OPTS=&#39;--sort --exact&#39;
</a><a href="#h29-0-44" id="h29-0-44" class="i">+
</a><a href="#h29-0-45" id="h29-0-45" class="i">+## Google Cloud SDK
</a><a href="#h29-0-46" id="h29-0-46" class="i">+export PATH=&quot;/usr/local/opt/texinfo/bin:$PATH&quot;
</a><a href="#h29-0-47" id="h29-0-47" class="i">+export PATH=&quot;/usr/local/opt/gpg-agent/bin:$PATH&quot;
</a><a href="#h29-0-48" id="h29-0-48" class="i">+
</a><a href="#h29-0-49" id="h29-0-49" class="i">+## Misc
</a><a href="#h29-0-50" id="h29-0-50" class="i">+export PATH=&quot;$HOME/.scripts:$PATH&quot;
</a><b>diff --git a/<a id="h30" href="../file/dots/.zshrc.html">dots/.zshrc</a> b/<a href="../file/dots/.zshrc.html">dots/.zshrc</a></b>
<a href="#h30-0" id="h30-0" class="h">@@ -0,0 +1,77 @@
</a><a href="#h30-0-0" id="h30-0-0" class="i">+plugins=(git osx brew)
</a><a href="#h30-0-1" id="h30-0-1" class="i">+echo -e &quot;\033]; \007&quot;
</a><a href="#h30-0-2" id="h30-0-2" class="i">+source ~/.config/oh-my-zsh/oh-my-zsh.sh
</a><a href="#h30-0-3" id="h30-0-3" class="i">+
</a><a href="#h30-0-4" id="h30-0-4" class="i">+## Alias
</a><a href="#h30-0-5" id="h30-0-5" class="i">+alias ls=&quot;ls -F&quot;
</a><a href="#h30-0-6" id="h30-0-6" class="i">+alias ll=&quot;ls -lh&quot;
</a><a href="#h30-0-7" id="h30-0-7" class="i">+alias emacs=&quot;TERM=xterm-256color emacs&quot;
</a><a href="#h30-0-8" id="h30-0-8" class="i">+alias q=&quot;exit&quot;
</a><a href="#h30-0-9" id="h30-0-9" class="i">+alias neo=&quot;clear &amp;&amp; neofetch&quot;
</a><a href="#h30-0-10" id="h30-0-10" class="i">+alias notify=&#39;terminal-notifier -title &quot;Terminal&quot; -message &quot;Done with taks&quot;&#39;
</a><a href="#h30-0-11" id="h30-0-11" class="i">+alias weather=&quot;curl wttr.in/\~Boulder+Colorado&quot;
</a><a href="#h30-0-12" id="h30-0-12" class="i">+alias f=&quot;fzf --preview=\&quot;head -$LINES {}\&quot;&quot;
</a><a href="#h30-0-13" id="h30-0-13" class="i">+alias fz=&quot;vim \$(f)&quot;
</a><a href="#h30-0-14" id="h30-0-14" class="i">+alias vi=vim
</a><a href="#h30-0-15" id="h30-0-15" class="i">+alias yt=&quot;youtube-dl&quot;
</a><a href="#h30-0-16" id="h30-0-16" class="i">+
</a><a href="#h30-0-17" id="h30-0-17" class="i">+# Kubernetes
</a><a href="#h30-0-18" id="h30-0-18" class="i">+alias kc=&quot;kubectl --kubeconfig=$HOME/cluster.config&quot;
</a><a href="#h30-0-19" id="h30-0-19" class="i">+alias helm=&quot;helm --kubeconfig=$HOME/cluster.config&quot;
</a><a href="#h30-0-20" id="h30-0-20" class="i">+alias c=&quot;cd $CORE&quot;
</a><a href="#h30-0-21" id="h30-0-21" class="i">+
</a><a href="#h30-0-22" id="h30-0-22" class="i">+## Kubernetes
</a><a href="#h30-0-23" id="h30-0-23" class="i">+function gdep {
</a><a href="#h30-0-24" id="h30-0-24" class="i">+    godepgraph -o gitlab.com/redeam -s gitlab.com/redeam/core/$1 | dot -Tpng -o /tmp/dep.png
</a><a href="#h30-0-25" id="h30-0-25" class="i">+    open /tmp/dep.png
</a><a href="#h30-0-26" id="h30-0-26" class="i">+}
</a><a href="#h30-0-27" id="h30-0-27" class="i">+
</a><a href="#h30-0-28" id="h30-0-28" class="i">+function gp {
</a><a href="#h30-0-29" id="h30-0-29" class="i">+  kubectl --kubeconfig=$HOME/cluster.config get pods | egrep -o  &quot;$1.*Running&quot; | egrep -o &quot;$1[^ ]*&quot; | head -1
</a><a href="#h30-0-30" id="h30-0-30" class="i">+}
</a><a href="#h30-0-31" id="h30-0-31" class="i">+
</a><a href="#h30-0-32" id="h30-0-32" class="i">+function kcforward {
</a><a href="#h30-0-33" id="h30-0-33" class="i">+  POD=`gp $1`
</a><a href="#h30-0-34" id="h30-0-34" class="i">+  kubectl --kubeconfig=$HOME/cluster.config port-forward $POD $2:8001
</a><a href="#h30-0-35" id="h30-0-35" class="i">+}
</a><a href="#h30-0-36" id="h30-0-36" class="i">+
</a><a href="#h30-0-37" id="h30-0-37" class="i">+alias kt=&quot;ktail --kubeconfig=$HOME/cluster.config -t &#39;
</a><a href="#h30-0-38" id="h30-0-38" class="i">+$BOLD$LIGHT_CYAN{{ .Container.Name }}$NONE $DIM{{ .Pod.Name }}$NONE $YELLOW{{ if .Timestamp }}{{ .Timestamp.Format \&quot;2006-01-02T15:04:05.999999999Z07:00\&quot; }}{{ end }}$NONE
</a><a href="#h30-0-39" id="h30-0-39" class="i">+{{ .Message }} &#39;&quot;
</a><a href="#h30-0-40" id="h30-0-40" class="i">+
</a><a href="#h30-0-41" id="h30-0-41" class="i">+# repeat history
</a><a href="#h30-0-42" id="h30-0-42" class="i">+function fh {
</a><a href="#h30-0-43" id="h30-0-43" class="i">+  print -z $( ([ -n &quot;$ZSH_NAME&quot; ] &amp;&amp; fc -l 1 || history) | fzf +s --tac | sed &#39;s/ *[0-9]* *//&#39;)
</a><a href="#h30-0-44" id="h30-0-44" class="i">+}
</a><a href="#h30-0-45" id="h30-0-45" class="i">+
</a><a href="#h30-0-46" id="h30-0-46" class="i">+function fhc {
</a><a href="#h30-0-47" id="h30-0-47" class="i">+  echo -n $( ([ -n &quot;$ZSH_NAME&quot; ] &amp;&amp; fc -l 1 || history) | fzf +s --tac | sed &#39;s/ *[0-9]* *//&#39;) | pbcopy
</a><a href="#h30-0-48" id="h30-0-48" class="i">+}
</a><a href="#h30-0-49" id="h30-0-49" class="i">+
</a><a href="#h30-0-50" id="h30-0-50" class="i">+# coloured manuals
</a><a href="#h30-0-51" id="h30-0-51" class="i">+man() {
</a><a href="#h30-0-52" id="h30-0-52" class="i">+  env \
</a><a href="#h30-0-53" id="h30-0-53" class="i">+    LESS_TERMCAP_mb=$(printf &quot;\e[1;31m&quot;) \
</a><a href="#h30-0-54" id="h30-0-54" class="i">+    LESS_TERMCAP_md=$(printf &quot;\e[1;31m&quot;) \
</a><a href="#h30-0-55" id="h30-0-55" class="i">+    LESS_TERMCAP_me=$(printf &quot;\e[0m&quot;) \
</a><a href="#h30-0-56" id="h30-0-56" class="i">+    LESS_TERMCAP_se=$(printf &quot;\e[0m&quot;) \
</a><a href="#h30-0-57" id="h30-0-57" class="i">+    LESS_TERMCAP_so=$(printf &quot;\e[1;44;33m&quot;) \
</a><a href="#h30-0-58" id="h30-0-58" class="i">+    LESS_TERMCAP_ue=$(printf &quot;\e[0m&quot;) \
</a><a href="#h30-0-59" id="h30-0-59" class="i">+    LESS_TERMCAP_us=$(printf &quot;\e[1;32m&quot;) \
</a><a href="#h30-0-60" id="h30-0-60" class="i">+    man &quot;$@&quot;
</a><a href="#h30-0-61" id="h30-0-61" class="i">+}
</a><a href="#h30-0-62" id="h30-0-62" class="i">+
</a><a href="#h30-0-63" id="h30-0-63" class="i">+autoload -U +X bashcompinit &amp;&amp; bashcompinit
</a><a href="#h30-0-64" id="h30-0-64" class="i">+
</a><a href="#h30-0-65" id="h30-0-65" class="i">+# if [ -z $TMUX ]
</a><a href="#h30-0-66" id="h30-0-66" class="i">+# then
</a><a href="#h30-0-67" id="h30-0-67" class="i">+#         tmux ls &amp;&amp; read tmux_session &amp;&amp; tmux attach -t ${tmux_session:-default} || tmux new -s ${tmux_session:-default}
</a><a href="#h30-0-68" id="h30-0-68" class="i">+# fi
</a><a href="#h30-0-69" id="h30-0-69" class="i">+
</a><a href="#h30-0-70" id="h30-0-70" class="i">+setxkbmap -layout us -option ctrl:nocaps
</a><a href="#h30-0-71" id="h30-0-71" class="i">+
</a><a href="#h30-0-72" id="h30-0-72" class="i">+# The next line updates PATH for the Google Cloud SDK.
</a><a href="#h30-0-73" id="h30-0-73" class="i">+if [ -f &#39;/home/mjf/prog/google-cloud-sdk/path.zsh.inc&#39; ]; then . &#39;/home/mjf/prog/google-cloud-sdk/path.zsh.inc&#39;; fi
</a><a href="#h30-0-74" id="h30-0-74" class="i">+
</a><a href="#h30-0-75" id="h30-0-75" class="i">+# The next line enables shell command completion for gcloud.
</a><a href="#h30-0-76" id="h30-0-76" class="i">+if [ -f &#39;/home/mjf/prog/google-cloud-sdk/completion.zsh.inc&#39; ]; then . &#39;/home/mjf/prog/google-cloud-sdk/completion.zsh.inc&#39;; fi
</a><b>diff --git a/<a id="h31" href="../file/link.sh.html">link.sh</a> b/<a href="../file/link.sh.html">link.sh</a></b>
<a href="#h31-0" id="h31-0" class="h">@@ -1,36 +0,0 @@
</a><a href="#h31-0-0" id="h31-0-0" class="d">-#!/bin/sh
</a><a href="#h31-0-1" id="h31-0-1" class="d">-
</a><a href="#h31-0-2" id="h31-0-2" class="d">-function link {
</a><a href="#h31-0-3" id="h31-0-3" class="d">-	ln -Ff $1 $HOME/$1
</a><a href="#h31-0-4" id="h31-0-4" class="d">-}
</a><a href="#h31-0-5" id="h31-0-5" class="d">-
</a><a href="#h31-0-6" id="h31-0-6" class="d">-function link_config {
</a><a href="#h31-0-7" id="h31-0-7" class="d">-	link .tmux.conf
</a><a href="#h31-0-8" id="h31-0-8" class="d">-	link .zshrc
</a><a href="#h31-0-9" id="h31-0-9" class="d">-	link .zshenv
</a><a href="#h31-0-10" id="h31-0-10" class="d">-
</a><a href="#h31-0-11" id="h31-0-11" class="d">-	link .config/mpd
</a><a href="#h31-0-12" id="h31-0-12" class="d">-	link .config/ranger
</a><a href="#h31-0-13" id="h31-0-13" class="d">-	link .config/neofetch
</a><a href="#h31-0-14" id="h31-0-14" class="d">-	link .config/alactritty
</a><a href="#h31-0-15" id="h31-0-15" class="d">-
</a><a href="#h31-0-16" id="h31-0-16" class="d">-	link .scripts
</a><a href="#h31-0-17" id="h31-0-17" class="d">-}
</a><a href="#h31-0-18" id="h31-0-18" class="d">-
</a><a href="#h31-0-19" id="h31-0-19" class="d">-function setup_mpd {
</a><a href="#h31-0-20" id="h31-0-20" class="d">-	mkdir -p .config/mpd/playlists
</a><a href="#h31-0-21" id="h31-0-21" class="d">-	touch .config/mpd/database
</a><a href="#h31-0-22" id="h31-0-22" class="d">-	touch .config/mpd/log
</a><a href="#h31-0-23" id="h31-0-23" class="d">-	touch .config/mpd/pid
</a><a href="#h31-0-24" id="h31-0-24" class="d">-	touch .config/mpd/state
</a><a href="#h31-0-25" id="h31-0-25" class="d">-	touch .config/mpd/sticker.sql
</a><a href="#h31-0-26" id="h31-0-26" class="d">-}
</a><a href="#h31-0-27" id="h31-0-27" class="d">-
</a><a href="#h31-0-28" id="h31-0-28" class="d">-function setup_vim {
</a><a href="#h31-0-29" id="h31-0-29" class="d">-	link .vimrc
</a><a href="#h31-0-30" id="h31-0-30" class="d">-	link .vim
</a><a href="#h31-0-31" id="h31-0-31" class="d">-}
</a><a href="#h31-0-32" id="h31-0-32" class="d">-
</a><a href="#h31-0-33" id="h31-0-33" class="d">-link_config
</a><a href="#h31-0-34" id="h31-0-34" class="d">-setup_mpd
</a><a href="#h31-0-35" id="h31-0-35" class="d">-setup_vim
</a><b>diff --git a/<a id="h32" href="../file/progs.csv.html">progs.csv</a> b/<a href="../file/progs.csv.html">progs.csv</a></b>
<a href="#h32-0" id="h32-0" class="h">@@ -1,23 +0,0 @@
</a><a href="#h32-0-0" id="h32-0-0" class="d">-bat
</a><a href="#h32-0-1" id="h32-0-1" class="d">-emacs
</a><a href="#h32-0-2" id="h32-0-2" class="d">-fd
</a><a href="#h32-0-3" id="h32-0-3" class="d">-ffmpeg
</a><a href="#h32-0-4" id="h32-0-4" class="d">-fontconfig
</a><a href="#h32-0-5" id="h32-0-5" class="d">-freetype
</a><a href="#h32-0-6" id="h32-0-6" class="d">-fzf
</a><a href="#h32-0-7" id="h32-0-7" class="d">-gpg-agent
</a><a href="#h32-0-8" id="h32-0-8" class="d">-graphviz
</a><a href="#h32-0-9" id="h32-0-9" class="d">-htop
</a><a href="#h32-0-10" id="h32-0-10" class="d">-mpc
</a><a href="#h32-0-11" id="h32-0-11" class="d">-mpd
</a><a href="#h32-0-12" id="h32-0-12" class="d">-ncmpcpp
</a><a href="#h32-0-13" id="h32-0-13" class="d">-ncurses
</a><a href="#h32-0-14" id="h32-0-14" class="d">-neofetch
</a><a href="#h32-0-15" id="h32-0-15" class="d">-openssl
</a><a href="#h32-0-16" id="h32-0-16" class="d">-ranger
</a><a href="#h32-0-17" id="h32-0-17" class="d">-readline
</a><a href="#h32-0-18" id="h32-0-18" class="d">-ripgrep
</a><a href="#h32-0-19" id="h32-0-19" class="d">-tmux
</a><a href="#h32-0-20" id="h32-0-20" class="d">-vim
</a><a href="#h32-0-21" id="h32-0-21" class="d">-wget
</a><a href="#h32-0-22" id="h32-0-22" class="d">-youtube-dl
</a></pre>
</div>
</body>
</html>
