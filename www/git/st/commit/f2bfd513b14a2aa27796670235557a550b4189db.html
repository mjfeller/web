<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>keep some glyph modes for the cursor - st - simple terminal
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="st Atom Feed" href="../atom.xml" />
<link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="/logo.png" alt="" width="32" height="32" /></a></td><td><h1>st</h1><span class="desc">simple terminal
</span></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/f2bfd513b14a2aa27796670235557a550b4189db.html">f2bfd513b14a2aa27796670235557a550b4189db</a>
<b>parent</b> <a href="../commit/e7ed326d2e914a57017c9f34459824614075519b.html">e7ed326d2e914a57017c9f34459824614075519b</a>
<b>Author:</b> Nils Reu√üe &lt;<a href="mailto:n.reusse@hxgn.net">n.reusse@hxgn.net</a>&gt;
<b>Date:</b>   Wed, 29 Mar 2017 18:34:12 +0200

keep some glyph modes for the cursor

st currently does not keep any mode for the cursor that was active
in the underlying glyph (e.g. italic text), the mode is always
ATTR_NULL [1].  At [2] you can find a screenshot that shows the
implications.  Other terminals (at least vte-based, such as
XFCE-terminal) keep some modes for the cursor.  I find the current
behaviour very disruptive, so here is a patch that keeps a few
(arbitrarily chosen) modes for the cursor.

[1] http://git.suckless.org/st/tree/st.c#n3963
[2] http://i.imgur.com/R2yCEaC.png

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">x.c</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
</table></pre><pre>1 file changed, 3 insertions(+), 0 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/x.c.html">x.c</a> b/<a href="../file/x.c.html">x.c</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -1266,6 +1266,7 @@ xdrawcursor(void)
</a> 	Glyph g = {&#39; &#39;, ATTR_NULL, defaultbg, defaultcs}, og;
 	int ena_sel = sel.ob.x != -1 &amp;&amp; sel.alt == IS_SET(MODE_ALTSCREEN);
 	Color drawcol;
<a href="#h0-0-3" id="h0-0-3" class="i">+	unsigned attr;
</a> 
 	LIMIT(oldx, 0, term.col-1);
 	LIMIT(oldy, 0, term.row-1);
<a href="#h0-1" id="h0-1" class="h">@@ -1285,6 +1286,8 @@ xdrawcursor(void)
</a> 	xdrawglyph(og, oldx, oldy);
 
 	g.u = term.line[term.c.y][term.c.x].u;
<a href="#h0-1-3" id="h0-1-3" class="i">+	attr = ATTR_BOLD | ATTR_ITALIC | ATTR_UNDERLINE | ATTR_STRUCK;
</a><a href="#h0-1-4" id="h0-1-4" class="i">+	g.mode |= term.line[term.c.y][term.c.x].mode &amp; attr;
</a> 
 	/*
 	 * Select the right color for the right mode.
</pre>
</div>
</body>
</html>
