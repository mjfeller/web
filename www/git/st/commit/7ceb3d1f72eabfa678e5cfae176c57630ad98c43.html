<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>STREscape: don&#39;t trim prematurely - st - simple terminal
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="st Atom Feed" href="../atom.xml" />
<link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="/logo.png" alt="" width="32" height="32" /></a></td><td><h1>st</h1><span class="desc">simple terminal
</span></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/7ceb3d1f72eabfa678e5cfae176c57630ad98c43.html">7ceb3d1f72eabfa678e5cfae176c57630ad98c43</a>
<b>parent</b> <a href="../commit/ea4d933ed9d8ce16699c84892a29e070c70b2eb9.html">ea4d933ed9d8ce16699c84892a29e070c70b2eb9</a>
<b>Author:</b> Avi Halachmi (:avih) &lt;<a href="mailto:avihpit@yahoo.com">avihpit@yahoo.com</a>&gt;
<b>Date:</b>   Wed, 16 Oct 2019 12:19:49 +0300

STREscape: don&#39;t trim prematurely

STRescape holds strings in escape sequences such as OSC and DCS, and
its buffer is 512 bytes.

If the input is too big then trailing chars are ignored, but the test
was off-by-1 such that it took 510 chars instead of 511 (before a
terminating NULL is added).

Now the full size can be utilized.

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">st.c</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
</table></pre><pre>1 file changed, 1 insertion(+), 1 deletion(-)
<hr/><b>diff --git a/<a id="h0" href="../file/st.c.html">st.c</a> b/<a href="../file/st.c.html">st.c</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -2330,7 +2330,7 @@ tputc(Rune u)
</a> 		if (term.esc&amp;ESC_DCS &amp;&amp; strescseq.len == 0 &amp;&amp; u == &#39;q&#39;)
 			term.mode |= MODE_SIXEL;
 
<a href="#h0-0-3" id="h0-0-3" class="d">-		if (strescseq.len+len &gt;= sizeof(strescseq.buf)-1) {
</a><a href="#h0-0-4" id="h0-0-4" class="i">+		if (strescseq.len+len &gt;= sizeof(strescseq.buf)) {
</a> 			/*
 			 * Here is a bug in terminals. If the user never sends
 			 * some code to stop the str or esc command, then st
</pre>
</div>
</body>
</html>
