<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Moving to the dwm config.h variable usage. - st - simple terminal
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="st Atom Feed" href="../atom.xml" />
<link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="/logo.png" alt="" width="32" height="32" /></a></td><td><h1>st</h1><span class="desc">simple terminal
</span></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/393825f9f8a23dfcdfda5220aa8029e9356fa15b.html">393825f9f8a23dfcdfda5220aa8029e9356fa15b</a>
<b>parent</b> <a href="../commit/e5d7c5a69e17d858984fe2c28b7d026672f42177.html">e5d7c5a69e17d858984fe2c28b7d026672f42177</a>
<b>Author:</b> Christoph Lohmann &lt;<a href="mailto:20h@r-36.net">20h@r-36.net</a>&gt;
<b>Date:</b>   Fri,  2 Nov 2012 19:56:02 +0100

Moving to the dwm config.h variable usage.

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">config.def.h</a></td><td> | </td><td class="num">60</td><td><span class="i">++++++++++++++++++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">st.c</a></td><td> | </td><td class="num">80</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------------</span></td></tr>
</table></pre><pre>2 files changed, 72 insertions(+), 68 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/config.def.h.html">config.def.h</a> b/<a href="../file/config.def.h.html">config.def.h</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -1,11 +1,19 @@
</a><a href="#h0-0-0" id="h0-0-0" class="i">+/* See LICENSE file for copyright and license details. */
</a> 
<a href="#h0-0-2" id="h0-0-2" class="d">-#define FONT &quot;Liberation Mono:pixelsize=12:antialias=false:autohint=false&quot;
</a><a href="#h0-0-3" id="h0-0-3" class="i">+/* appearance */
</a><a href="#h0-0-4" id="h0-0-4" class="i">+static char font[] = &quot;Liberation Mono:pixelsize=12:antialias=false:autohint=false&quot;;
</a><a href="#h0-0-5" id="h0-0-5" class="i">+static unsigned int borderpx = 2;
</a><a href="#h0-0-6" id="h0-0-6" class="i">+static char shell[] = &quot;/bin/sh&quot;;
</a> 
<a href="#h0-0-8" id="h0-0-8" class="d">-/* Space in pixels around the terminal buffer */
</a><a href="#h0-0-9" id="h0-0-9" class="d">-#define BORDER 2
</a><a href="#h0-0-10" id="h0-0-10" class="i">+/* double-click timeout (in milliseconds) between clicks for selection */
</a><a href="#h0-0-11" id="h0-0-11" class="i">+static unsigned int doubleclicktimeout = 300;
</a><a href="#h0-0-12" id="h0-0-12" class="i">+static unsigned int tripleclicktimeout = 600;
</a><a href="#h0-0-13" id="h0-0-13" class="i">+
</a><a href="#h0-0-14" id="h0-0-14" class="i">+/* TERM value */
</a><a href="#h0-0-15" id="h0-0-15" class="i">+static char termname[] = &quot;st-256color&quot;;
</a><a href="#h0-0-16" id="h0-0-16" class="i">+
</a><a href="#h0-0-17" id="h0-0-17" class="i">+static unsigned int tabspaces = 8;
</a> 
<a href="#h0-0-19" id="h0-0-19" class="d">-/* Default shell to use if SHELL is not set in the env */
</a><a href="#h0-0-20" id="h0-0-20" class="d">-#define SHELL &quot;/bin/sh&quot;
</a> 
 /* Terminal colors (16 first used in escape sequence) */
 static const char *colorname[] = {
<a href="#h0-1" id="h0-1" class="h">@@ -36,21 +44,26 @@ static const char *colorname[] = {
</a> 	&quot;#333333&quot;,
 };
 
<a href="#h0-1-3" id="h0-1-3" class="d">-/* Default colors (colorname index)
</a><a href="#h0-1-4" id="h0-1-4" class="d">-   foreground, background, cursor, unfocused cursor */
</a><a href="#h0-1-5" id="h0-1-5" class="d">-#define DefaultFG  7
</a><a href="#h0-1-6" id="h0-1-6" class="d">-#define DefaultBG  0
</a><a href="#h0-1-7" id="h0-1-7" class="d">-#define DefaultCS  256
</a><a href="#h0-1-8" id="h0-1-8" class="d">-#define DefaultUCS 257
</a><a href="#h0-1-9" id="h0-1-9" class="d">-
</a><a href="#h0-1-10" id="h0-1-10" class="d">-/* Special keys (change &amp; recompile st.info accordingly)
</a><a href="#h0-1-11" id="h0-1-11" class="d">-   Keep in mind that kpress() in st.c hardcodes some keys.
</a><a href="#h0-1-12" id="h0-1-12" class="d">-
</a><a href="#h0-1-13" id="h0-1-13" class="d">-   Mask value:
</a><a href="#h0-1-14" id="h0-1-14" class="d">-   * Use XK_ANY_MOD to match the key no matter modifiers state
</a><a href="#h0-1-15" id="h0-1-15" class="d">-   * Use XK_NO_MOD to match the key alone (no modifiers)
</a> 
<a href="#h0-1-17" id="h0-1-17" class="d">-      key,        mask,  output */
</a><a href="#h0-1-18" id="h0-1-18" class="i">+/*
</a><a href="#h0-1-19" id="h0-1-19" class="i">+ * Default colors (colorname index)
</a><a href="#h0-1-20" id="h0-1-20" class="i">+ * foreground, background, cursor, unfocused cursor
</a><a href="#h0-1-21" id="h0-1-21" class="i">+ */
</a><a href="#h0-1-22" id="h0-1-22" class="i">+static unsigned int defaultfg = 7;
</a><a href="#h0-1-23" id="h0-1-23" class="i">+static unsigned int defaultbg = 0;
</a><a href="#h0-1-24" id="h0-1-24" class="i">+static unsigned int defaultcs = 256;
</a><a href="#h0-1-25" id="h0-1-25" class="i">+static unsigned int defaultucs = 257;
</a><a href="#h0-1-26" id="h0-1-26" class="i">+
</a><a href="#h0-1-27" id="h0-1-27" class="i">+/*
</a><a href="#h0-1-28" id="h0-1-28" class="i">+ * Special keys (change &amp; recompile st.info accordingly)
</a><a href="#h0-1-29" id="h0-1-29" class="i">+ * Keep in mind that kpress() in st.c hardcodes some keys.
</a><a href="#h0-1-30" id="h0-1-30" class="i">+ *
</a><a href="#h0-1-31" id="h0-1-31" class="i">+ * Mask value:
</a><a href="#h0-1-32" id="h0-1-32" class="i">+ * * Use XK_ANY_MOD to match the key no matter modifiers state
</a><a href="#h0-1-33" id="h0-1-33" class="i">+ * * Use XK_NO_MOD to match the key alone (no modifiers)
</a><a href="#h0-1-34" id="h0-1-34" class="i">+ */
</a><a href="#h0-1-35" id="h0-1-35" class="i">+
</a><a href="#h0-1-36" id="h0-1-36" class="i">+/* key, mask, output */
</a> static Key key[] = {
 	{ XK_BackSpace, XK_NO_MOD, &quot;\177&quot; },
 	{ XK_Insert,    XK_NO_MOD, &quot;\033[2~&quot; },
<a href="#h0-2" id="h0-2" class="h">@@ -82,12 +95,3 @@ static Shortcut shortcuts[] = {
</a> 	{ MODKEY|ShiftMask,	XK_Next,	xzoom,		{.i = -1} },
 };
 
<a href="#h0-2-3" id="h0-2-3" class="d">-/* Set TERM to this */
</a><a href="#h0-2-4" id="h0-2-4" class="d">-#define TNAME &quot;st-256color&quot;
</a><a href="#h0-2-5" id="h0-2-5" class="d">-
</a><a href="#h0-2-6" id="h0-2-6" class="d">-/* double-click timeout (in milliseconds) between clicks for selection */
</a><a href="#h0-2-7" id="h0-2-7" class="d">-#define DOUBLECLICK_TIMEOUT 300
</a><a href="#h0-2-8" id="h0-2-8" class="d">-#define TRIPLECLICK_TIMEOUT (2*DOUBLECLICK_TIMEOUT)
</a><a href="#h0-2-9" id="h0-2-9" class="d">-
</a><a href="#h0-2-10" id="h0-2-10" class="d">-#define TAB 8
</a><a href="#h0-2-11" id="h0-2-11" class="d">-
</a><b>diff --git a/<a id="h1" href="../file/st.c.html">st.c</a> b/<a href="../file/st.c.html">st.c</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -72,8 +72,8 @@
</a> #define ATTRCMP(a, b) ((a).mode != (b).mode || (a).fg != (b).fg || (a).bg != (b).bg)
 #define IS_SET(flag) (term.mode &amp; (flag))
 #define TIMEDIFF(t1, t2) ((t1.tv_sec-t2.tv_sec)*1000 + (t1.tv_usec-t2.tv_usec)/1000)
<a href="#h1-0-3" id="h1-0-3" class="d">-#define X2COL(x) (((x) - BORDER)/xw.cw)
</a><a href="#h1-0-4" id="h1-0-4" class="d">-#define Y2ROW(y) (((y) - BORDER)/xw.ch)
</a><a href="#h1-0-5" id="h1-0-5" class="i">+#define X2COL(x) (((x) - borderpx)/xw.cw)
</a><a href="#h1-0-6" id="h1-0-6" class="i">+#define Y2ROW(y) (((y) - borderpx)/xw.ch)
</a> 
 #define VT102ID &quot;\033[?6c&quot;
 
<a href="#h1-1" id="h1-1" class="h">@@ -803,13 +803,13 @@ brelease(XEvent *e) {
</a> 			sel.bx = -1;
 			gettimeofday(&amp;now, NULL);
 
<a href="#h1-1-3" id="h1-1-3" class="d">-			if(TIMEDIFF(now, sel.tclick2) &lt;= TRIPLECLICK_TIMEOUT) {
</a><a href="#h1-1-4" id="h1-1-4" class="i">+			if(TIMEDIFF(now, sel.tclick2) &lt;= tripleclicktimeout) {
</a> 				/* triple click on the line */
 				sel.b.x = sel.bx = 0;
 				sel.e.x = sel.ex = term.col;
 				sel.b.y = sel.e.y = sel.ey;
 				selcopy();
<a href="#h1-1-10" id="h1-1-10" class="d">-			} else if(TIMEDIFF(now, sel.tclick1) &lt;= DOUBLECLICK_TIMEOUT) {
</a><a href="#h1-1-11" id="h1-1-11" class="i">+			} else if(TIMEDIFF(now, sel.tclick1) &lt;= doubleclicktimeout) {
</a> 				/* double click to select word */
 				sel.bx = sel.ex;
 				while(sel.bx &gt; 0 &amp;&amp; term.line[sel.ey][sel.bx-1].state &amp; GLYPH_SET &amp;&amp;
<a href="#h1-2" id="h1-2" class="h">@@ -894,8 +894,8 @@ execsh(void) {
</a> 	signal(SIGTERM, SIG_DFL);
 	signal(SIGALRM, SIG_DFL);
 
<a href="#h1-2-3" id="h1-2-3" class="d">-	DEFAULT(envshell, SHELL);
</a><a href="#h1-2-4" id="h1-2-4" class="d">-	putenv(&quot;TERM=&quot;TNAME);
</a><a href="#h1-2-5" id="h1-2-5" class="i">+	DEFAULT(envshell, shell);
</a><a href="#h1-2-6" id="h1-2-6" class="i">+	setenv(&quot;TERM&quot;, termname, 1);
</a> 	args = opt_cmd ? opt_cmd : (char *[]){envshell, &quot;-i&quot;, NULL};
 	execvp(args[0], args);
 	exit(EXIT_FAILURE);
<a href="#h1-3" id="h1-3" class="h">@@ -1045,12 +1045,12 @@ treset(void) {
</a> 
 	term.c = (TCursor){{
 		.mode = ATTR_NULL,
<a href="#h1-3-3" id="h1-3-3" class="d">-		.fg = DefaultFG,
</a><a href="#h1-3-4" id="h1-3-4" class="d">-		.bg = DefaultBG
</a><a href="#h1-3-5" id="h1-3-5" class="i">+		.fg = defaultfg,
</a><a href="#h1-3-6" id="h1-3-6" class="i">+		.bg = defaultbg
</a> 	}, .x = 0, .y = 0, .state = CURSOR_DEFAULT};
 
 	memset(term.tabs, 0, term.col * sizeof(*term.tabs));
<a href="#h1-3-10" id="h1-3-10" class="d">-	for(i = TAB; i &lt; term.col; i += TAB)
</a><a href="#h1-3-11" id="h1-3-11" class="i">+	for(i = tabspaces; i &lt; term.col; i += tabspaces)
</a> 		term.tabs[i] = 1;
 	term.top = 0;
 	term.bot = term.row - 1;
<a href="#h1-4" id="h1-4" class="h">@@ -1310,8 +1310,8 @@ tsetattr(int *attr, int l) {
</a> 		case 0:
 			term.c.attr.mode &amp;= ~(ATTR_REVERSE | ATTR_UNDERLINE | ATTR_BOLD \
 					| ATTR_ITALIC | ATTR_BLINK);
<a href="#h1-4-3" id="h1-4-3" class="d">-			term.c.attr.fg = DefaultFG;
</a><a href="#h1-4-4" id="h1-4-4" class="d">-			term.c.attr.bg = DefaultBG;
</a><a href="#h1-4-5" id="h1-4-5" class="i">+			term.c.attr.fg = defaultfg;
</a><a href="#h1-4-6" id="h1-4-6" class="i">+			term.c.attr.bg = defaultbg;
</a> 			break;
 		case 1:
 			term.c.attr.mode |= ATTR_BOLD;
<a href="#h1-5" id="h1-5" class="h">@@ -1361,7 +1361,7 @@ tsetattr(int *attr, int l) {
</a> 			}
 			break;
 		case 39:
<a href="#h1-5-3" id="h1-5-3" class="d">-			term.c.attr.fg = DefaultFG;
</a><a href="#h1-5-4" id="h1-5-4" class="i">+			term.c.attr.fg = defaultfg;
</a> 			break;
 		case 48:
 			if(i + 2 &lt; l &amp;&amp; attr[i + 1] == 5) {
<a href="#h1-6" id="h1-6" class="h">@@ -1380,7 +1380,7 @@ tsetattr(int *attr, int l) {
</a> 			}
 			break;
 		case 49:
<a href="#h1-6-3" id="h1-6-3" class="d">-			term.c.attr.bg = DefaultBG;
</a><a href="#h1-6-4" id="h1-6-4" class="i">+			term.c.attr.bg = defaultbg;
</a> 			break;
 		default:
 			if(BETWEEN(attr[i], 30, 37)) {
<a href="#h1-7" id="h1-7" class="h">@@ -2091,7 +2091,7 @@ tresize(int col, int row) {
</a> 		memset(bp, 0, sizeof(*term.tabs) * (col - term.col));
 		while(--bp &gt; term.tabs &amp;&amp; !*bp)
 			/* nothing */ ;
<a href="#h1-7-3" id="h1-7-3" class="d">-		for(bp += TAB; bp &lt; term.tabs + col; bp += TAB)
</a><a href="#h1-7-4" id="h1-7-4" class="i">+		for(bp += tabspaces; bp &lt; term.tabs + col; bp += tabspaces)
</a> 			*bp = 1;
 	}
 	/* update terminal size */
<a href="#h1-8" id="h1-8" class="h">@@ -2107,8 +2107,8 @@ tresize(int col, int row) {
</a> 
 void
 xresize(int col, int row) {
<a href="#h1-8-3" id="h1-8-3" class="d">-	xw.tw = MAX(1, 2*BORDER + col * xw.cw);
</a><a href="#h1-8-4" id="h1-8-4" class="d">-	xw.th = MAX(1, 2*BORDER + row * xw.ch);
</a><a href="#h1-8-5" id="h1-8-5" class="i">+	xw.tw = MAX(1, 2*borderpx + col * xw.cw);
</a><a href="#h1-8-6" id="h1-8-6" class="i">+	xw.th = MAX(1, 2*borderpx + row * xw.ch);
</a> 
 	XftDrawChange(xw.xft_draw, xw.buf);
 }
<a href="#h1-9" id="h1-9" class="h">@@ -2154,9 +2154,9 @@ xloadcols(void) {
</a> void
 xtermclear(int col1, int row1, int col2, int row2) {
 	XftDrawRect(xw.xft_draw,
<a href="#h1-9-3" id="h1-9-3" class="d">-			&amp;dc.xft_col[IS_SET(MODE_REVERSE) ? DefaultFG : DefaultBG],
</a><a href="#h1-9-4" id="h1-9-4" class="d">-			BORDER + col1 * xw.cw,
</a><a href="#h1-9-5" id="h1-9-5" class="d">-			BORDER + row1 * xw.ch,
</a><a href="#h1-9-6" id="h1-9-6" class="i">+			&amp;dc.xft_col[IS_SET(MODE_REVERSE) ? defaultfg : defaultbg],
</a><a href="#h1-9-7" id="h1-9-7" class="i">+			borderpx + col1 * xw.cw,
</a><a href="#h1-9-8" id="h1-9-8" class="i">+			borderpx + row1 * xw.ch,
</a> 			(col2-col1+1) * xw.cw,
 			(row2-row1+1) * xw.ch);
 }
<a href="#h1-10" id="h1-10" class="h">@@ -2167,13 +2167,13 @@ xtermclear(int col1, int row1, int col2, int row2) {
</a> void
 xclear(int x1, int y1, int x2, int y2) {
 	XftDrawRect(xw.xft_draw,
<a href="#h1-10-3" id="h1-10-3" class="d">-			&amp;dc.xft_col[IS_SET(MODE_REVERSE) ? DefaultFG : DefaultBG],
</a><a href="#h1-10-4" id="h1-10-4" class="i">+			&amp;dc.xft_col[IS_SET(MODE_REVERSE) ? defaultfg : defaultbg],
</a> 			x1, y1, x2-x1, y2-y1);
 }
 
 void
 xhints(void) {
<a href="#h1-10-10" id="h1-10-10" class="d">-	XClassHint class = {opt_class ? opt_class : TNAME, TNAME};
</a><a href="#h1-10-11" id="h1-10-11" class="i">+	XClassHint class = {opt_class ? opt_class : termname, termname};
</a> 	XWMHints wm = {.flags = InputHint, .input = 1};
 	XSizeHints *sizeh = NULL;
 
<a href="#h1-11" id="h1-11" class="h">@@ -2184,8 +2184,8 @@ xhints(void) {
</a> 		sizeh-&gt;width = xw.w;
 		sizeh-&gt;height_inc = xw.ch;
 		sizeh-&gt;width_inc = xw.cw;
<a href="#h1-11-3" id="h1-11-3" class="d">-		sizeh-&gt;base_height = 2*BORDER;
</a><a href="#h1-11-4" id="h1-11-4" class="d">-		sizeh-&gt;base_width = 2*BORDER;
</a><a href="#h1-11-5" id="h1-11-5" class="i">+		sizeh-&gt;base_height = 2*borderpx;
</a><a href="#h1-11-6" id="h1-11-6" class="i">+		sizeh-&gt;base_width = 2*borderpx;
</a> 	} else {
 		sizeh-&gt;flags = PMaxSize | PMinSize;
 		sizeh-&gt;min_width = sizeh-&gt;max_width = xw.fw;
<a href="#h1-12" id="h1-12" class="h">@@ -2293,7 +2293,7 @@ xinit(void) {
</a> 	xw.vis = XDefaultVisual(xw.dpy, xw.scr);
 
 	/* font */
<a href="#h1-12-3" id="h1-12-3" class="d">-	usedfont = (opt_font == NULL)? FONT : opt_font;
</a><a href="#h1-12-4" id="h1-12-4" class="i">+	usedfont = (opt_font == NULL)? font : opt_font;
</a> 	xloadfonts(usedfont, 0);
 
 	/* colors */
<a href="#h1-13" id="h1-13" class="h">@@ -2313,14 +2313,14 @@ xinit(void) {
</a> 		xw.w = xw.fw;
 	} else {
 		/* window - default size */
<a href="#h1-13-3" id="h1-13-3" class="d">-		xw.h = 2*BORDER + term.row * xw.ch;
</a><a href="#h1-13-4" id="h1-13-4" class="d">-		xw.w = 2*BORDER + term.col * xw.cw;
</a><a href="#h1-13-5" id="h1-13-5" class="i">+		xw.h = 2*borderpx + term.row * xw.ch;
</a><a href="#h1-13-6" id="h1-13-6" class="i">+		xw.w = 2*borderpx + term.col * xw.cw;
</a> 		xw.fx = 0;
 		xw.fy = 0;
 	}
 
<a href="#h1-13-11" id="h1-13-11" class="d">-	attrs.background_pixel = dc.xft_col[DefaultBG].pixel;
</a><a href="#h1-13-12" id="h1-13-12" class="d">-	attrs.border_pixel = dc.xft_col[DefaultBG].pixel;
</a><a href="#h1-13-13" id="h1-13-13" class="i">+	attrs.background_pixel = dc.xft_col[defaultbg].pixel;
</a><a href="#h1-13-14" id="h1-13-14" class="i">+	attrs.border_pixel = dc.xft_col[defaultbg].pixel;
</a> 	attrs.bit_gravity = NorthWestGravity;
 	attrs.event_mask = FocusChangeMask | KeyPressMask
 		| ExposureMask | VisibilityChangeMask | StructureNotifyMask
<a href="#h1-14" id="h1-14" class="h">@@ -2370,7 +2370,7 @@ xinit(void) {
</a> 
 void
 xdraws(char *s, Glyph base, int x, int y, int charlen, int bytelen) {
<a href="#h1-14-3" id="h1-14-3" class="d">-	int winx = BORDER + x * xw.cw, winy = BORDER + y * xw.ch,
</a><a href="#h1-14-4" id="h1-14-4" class="i">+	int winx = borderpx + x * xw.cw, winy = borderpx + y * xw.ch,
</a> 	    width = charlen * xw.cw;
 	Font *font = &amp;dc.font;
 	XGlyphInfo extents;
<a href="#h1-15" id="h1-15" class="h">@@ -2407,8 +2407,8 @@ xdraws(char *s, Glyph base, int x, int y, int charlen, int bytelen) {
</a> 		font = &amp;dc.ibfont;
 
 	if(IS_SET(MODE_REVERSE)) {
<a href="#h1-15-3" id="h1-15-3" class="d">-		if(fg == &amp;dc.xft_col[DefaultFG]) {
</a><a href="#h1-15-4" id="h1-15-4" class="d">-			fg = &amp;dc.xft_col[DefaultBG];
</a><a href="#h1-15-5" id="h1-15-5" class="i">+		if(fg == &amp;dc.xft_col[defaultfg]) {
</a><a href="#h1-15-6" id="h1-15-6" class="i">+			fg = &amp;dc.xft_col[defaultbg];
</a> 		} else {
 			colfg.red = ~fg-&gt;color.red;
 			colfg.green = ~fg-&gt;color.green;
<a href="#h1-16" id="h1-16" class="h">@@ -2418,8 +2418,8 @@ xdraws(char *s, Glyph base, int x, int y, int charlen, int bytelen) {
</a> 			fg = &amp;revfg;
 		}
 
<a href="#h1-16-3" id="h1-16-3" class="d">-		if(bg == &amp;dc.xft_col[DefaultBG]) {
</a><a href="#h1-16-4" id="h1-16-4" class="d">-			bg = &amp;dc.xft_col[DefaultFG];
</a><a href="#h1-16-5" id="h1-16-5" class="i">+		if(bg == &amp;dc.xft_col[defaultbg]) {
</a><a href="#h1-16-6" id="h1-16-6" class="i">+			bg = &amp;dc.xft_col[defaultfg];
</a> 		} else {
 			colbg.red = ~bg-&gt;color.red;
 			colbg.green = ~bg-&gt;color.green;
<a href="#h1-17" id="h1-17" class="h">@@ -2436,7 +2436,7 @@ xdraws(char *s, Glyph base, int x, int y, int charlen, int bytelen) {
</a> 
 	/* Intelligent cleaning up of the borders. */
 	if(x == 0) {
<a href="#h1-17-3" id="h1-17-3" class="d">-		xclear(0, (y == 0)? 0 : winy, BORDER,
</a><a href="#h1-17-4" id="h1-17-4" class="i">+		xclear(0, (y == 0)? 0 : winy, borderpx,
</a> 			winy + xw.ch + (y == term.row-1)? xw.h : 0);
 	}
 	if(x + charlen &gt;= term.col-1) {
<a href="#h1-18" id="h1-18" class="h">@@ -2444,7 +2444,7 @@ xdraws(char *s, Glyph base, int x, int y, int charlen, int bytelen) {
</a> 			(y == term.row-1)? xw.h : (winy + xw.ch));
 	}
 	if(y == 0)
<a href="#h1-18-3" id="h1-18-3" class="d">-		xclear(winx, 0, winx + width, BORDER);
</a><a href="#h1-18-4" id="h1-18-4" class="i">+		xclear(winx, 0, winx + width, borderpx);
</a> 	if(y == term.row-1)
 		xclear(winx, winy + xw.ch, winx + width, xw.h);
 
<a href="#h1-19" id="h1-19" class="h">@@ -2462,7 +2462,7 @@ void
</a> xdrawcursor(void) {
 	static int oldx = 0, oldy = 0;
 	int sl;
<a href="#h1-19-3" id="h1-19-3" class="d">-	Glyph g = {{&#39; &#39;}, ATTR_NULL, DefaultBG, DefaultCS, 0};
</a><a href="#h1-19-4" id="h1-19-4" class="i">+	Glyph g = {{&#39; &#39;}, ATTR_NULL, defaultbg, defaultcs, 0};
</a> 
 	LIMIT(oldx, 0, term.col-1);
 	LIMIT(oldy, 0, term.row-1);
<a href="#h1-20" id="h1-20" class="h">@@ -2482,10 +2482,10 @@ xdrawcursor(void) {
</a> 	/* draw the new one */
 	if(!(term.c.state &amp; CURSOR_HIDE)) {
 		if(!(xw.state &amp; WIN_FOCUSED))
<a href="#h1-20-3" id="h1-20-3" class="d">-			g.bg = DefaultUCS;
</a><a href="#h1-20-4" id="h1-20-4" class="i">+			g.bg = defaultucs;
</a> 
 		if(IS_SET(MODE_REVERSE))
<a href="#h1-20-7" id="h1-20-7" class="d">-			g.mode |= ATTR_REVERSE, g.fg = DefaultCS, g.bg = DefaultFG;
</a><a href="#h1-20-8" id="h1-20-8" class="i">+			g.mode |= ATTR_REVERSE, g.fg = defaultcs, g.bg = defaultfg;
</a> 
 		sl = utf8size(g.c);
 		xdraws(g.c, g, term.c.x, term.c.y, 1, sl);
<a href="#h1-21" id="h1-21" class="h">@@ -2720,8 +2720,8 @@ cresize(int width, int height)
</a> 	if(height != 0)
 		xw.h = height;
 
<a href="#h1-21-3" id="h1-21-3" class="d">-	col = (xw.w - 2*BORDER) / xw.cw;
</a><a href="#h1-21-4" id="h1-21-4" class="d">-	row = (xw.h - 2*BORDER) / xw.ch;
</a><a href="#h1-21-5" id="h1-21-5" class="i">+	col = (xw.w - 2*borderpx) / xw.cw;
</a><a href="#h1-21-6" id="h1-21-6" class="i">+	row = (xw.h - 2*borderpx) / xw.ch;
</a> 	if(col == term.col &amp;&amp; row == term.row)
 		return;
 
</pre>
</div>
</body>
</html>
