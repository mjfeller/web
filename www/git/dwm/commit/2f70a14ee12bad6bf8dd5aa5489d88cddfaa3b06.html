<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>some more changes towards a better dwm - dwm - dynamic window manager
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="dwm Atom Feed" href="../atom.xml" />
<link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="/logo.png" alt="" width="32" height="32" /></a></td><td><h1>dwm</h1><span class="desc">dynamic window manager
</span></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/2f70a14ee12bad6bf8dd5aa5489d88cddfaa3b06.html">2f70a14ee12bad6bf8dd5aa5489d88cddfaa3b06</a>
<b>parent</b> <a href="../commit/00ca643bd7ccba6efd001cc679525a53a3c75586.html">00ca643bd7ccba6efd001cc679525a53a3c75586</a>
<b>Author:</b> Anselm R Garbe &lt;<a href="mailto:garbeam@gmail.com">garbeam@gmail.com</a>&gt;
<b>Date:</b>   Thu, 28 Feb 2008 17:07:30 +0000

some more changes towards a better dwm
<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">config.def.h</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">dwm.c</a></td><td> | </td><td class="num">108</td><td><span class="i">+++++++++++++++++++++++++++++++++++</span><span class="d">--------------------------------------------</span></td></tr>
</table></pre><pre>2 files changed, 49 insertions(+), 61 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/config.def.h.html">config.def.h</a> b/<a href="../file/config.def.h.html">config.def.h</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -11,7 +11,7 @@
</a> #define SELBGCOLOR		&quot;#0066ff&quot;
 #define SELFGCOLOR		&quot;#ffffff&quot;
 
<a href="#h0-0-3" id="h0-0-3" class="d">-/* tagging */
</a><a href="#h0-0-4" id="h0-0-4" class="i">+/* old */
</a> const char tags[][MAXTAGLEN]     = { &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;nil&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;www&quot; };
 unsigned int vtags[LENGTH(tags)] = {  0 ,  0 ,  0 ,  0 ,   0  ,  1 ,  1 ,  1 ,   1   };
 Bool initags[LENGTH(tags)]       = { [0] = True, [5] = True };
<b>diff --git a/<a id="h1" href="../file/dwm.c.html">dwm.c</a> b/<a href="../file/dwm.c.html">dwm.c</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -71,6 +71,7 @@ struct Client {
</a> 	unsigned int border, oldborder;
 	Bool isbanned, isfixed, isfloating, isurgent;
 	Bool *tags;
<a href="#h1-0-3" id="h1-0-3" class="i">+	View *view;
</a> 	Client *next;
 	Client *prev;
 	Client *snext;
<a href="#h1-1" id="h1-1" class="h">@@ -110,12 +111,8 @@ typedef struct {
</a> 	Bool isfloating;
 } Rule;
 
<a href="#h1-1-3" id="h1-1-3" class="d">-typedef struct {
</a><a href="#h1-1-4" id="h1-1-4" class="d">-	const char name[MAXTAGLEN];
</a><a href="#h1-1-5" id="h1-1-5" class="d">-	unsigned int view;
</a><a href="#h1-1-6" id="h1-1-6" class="d">-} Tag;
</a><a href="#h1-1-7" id="h1-1-7" class="d">-
</a> struct View {
<a href="#h1-1-9" id="h1-1-9" class="i">+	unsigned int id;
</a> 	int x, y, w, h, wax, way, wah, waw;
 	double mwfact;
 	Layout *layout;
<a href="#h1-2" id="h1-2" class="h">@@ -139,8 +136,8 @@ void destroynotify(XEvent *e);
</a> void detach(Client *c);
 void detachstack(Client *c);
 void drawbar(View *v);
<a href="#h1-2-3" id="h1-2-3" class="d">-void drawsquare(View *v, Bool filled, Bool empty, Bool invert, unsigned long col[ColLast]);
</a><a href="#h1-2-4" id="h1-2-4" class="d">-void drawtext(View *v, const char *text, unsigned long col[ColLast], Bool invert);
</a><a href="#h1-2-5" id="h1-2-5" class="i">+void drawsquare(Bool filled, Bool empty, Bool invert, unsigned long col[ColLast]);
</a><a href="#h1-2-6" id="h1-2-6" class="i">+void drawtext(const char *text, unsigned long col[ColLast], Bool invert);
</a> void *emallocz(unsigned int size);
 void enternotify(XEvent *e);
 void eprint(const char *errstr, ...);
<a href="#h1-3" id="h1-3" class="h">@@ -153,7 +150,6 @@ void focusprev(const char *arg);
</a> Client *getclient(Window w);
 unsigned long getcolor(const char *colstr);
 View *getviewbar(Window barwin);
<a href="#h1-3-3" id="h1-3-3" class="d">-View *getview(Client *c);
</a> long getstate(Window w);
 Bool gettextprop(Window w, Atom atom, char *text, unsigned int size);
 void grabbuttons(Client *c, Bool focused);
<a href="#h1-4" id="h1-4" class="h">@@ -211,7 +207,6 @@ void selectview(const char *arg);
</a> /* variables */
 char stext[256], buf[256];
 int nviews = 1;
<a href="#h1-4-3" id="h1-4-3" class="d">-View *selview;
</a> int screen;
 int (*xerrorxlib)(Display *, XErrorEvent *);
 unsigned int bh, bpos;
<a href="#h1-5" id="h1-5" class="h">@@ -246,6 +241,7 @@ Cursor cursor[CurLast];
</a> Display *dpy;
 DC dc = {0};
 View *views;
<a href="#h1-5-3" id="h1-5-3" class="i">+View *selview;
</a> Window root;
 
 /* configuration, allows nested code to access above variables */
<a href="#h1-6" id="h1-6" class="h">@@ -260,6 +256,7 @@ addtag(Client *c, const char *t) {
</a> 		if(c-&gt;tags[i] &amp;&amp; vtags[i] != vtags[tidx])
 			return; /* conflict */
 	c-&gt;tags[tidx] = True;
<a href="#h1-6-3" id="h1-6-3" class="i">+	c-&gt;view = &amp;views[vtags[tidx]];
</a> }
 
 void
<a href="#h1-7" id="h1-7" class="h">@@ -288,8 +285,10 @@ applyrules(Client *c) {
</a> 		XFree(ch.res_class);
 	if(ch.res_name)
 		XFree(ch.res_name);
<a href="#h1-7-3" id="h1-7-3" class="d">-	if(!matched)
</a><a href="#h1-7-4" id="h1-7-4" class="i">+	if(!matched) {
</a> 		memcpy(c-&gt;tags, seltags, sizeof initags);
<a href="#h1-7-6" id="h1-7-6" class="i">+		c-&gt;view = selview;
</a><a href="#h1-7-7" id="h1-7-7" class="i">+	}
</a> }
 
 
<a href="#h1-8" id="h1-8" class="h">@@ -330,7 +329,7 @@ void
</a> ban(Client *c) {
 	if(c-&gt;isbanned)
 		return;
<a href="#h1-8-3" id="h1-8-3" class="d">-	XMoveWindow(dpy, c-&gt;win, c-&gt;x + 3 * getview(c)-&gt;w, c-&gt;y);
</a><a href="#h1-8-4" id="h1-8-4" class="i">+	XMoveWindow(dpy, c-&gt;win, c-&gt;x + 3 * c-&gt;view-&gt;w, c-&gt;y);
</a> 	c-&gt;isbanned = True;
 }
 
<a href="#h1-9" id="h1-9" class="h">@@ -340,9 +339,7 @@ buttonpress(XEvent *e) {
</a> 	Client *c;
 	XButtonPressedEvent *ev = &amp;e-&gt;xbutton;
 
<a href="#h1-9-3" id="h1-9-3" class="d">-	View *v = selview;
</a><a href="#h1-9-4" id="h1-9-4" class="d">-
</a><a href="#h1-9-5" id="h1-9-5" class="d">-	if(ev-&gt;window == v-&gt;barwin) {
</a><a href="#h1-9-6" id="h1-9-6" class="i">+	if(ev-&gt;window == selview-&gt;barwin) {
</a> 		x = 0;
 		for(i = 0; i &lt; LENGTH(tags); i++) {
 			x += textw(tags[i]);
<a href="#h1-10" id="h1-10" class="h">@@ -370,17 +367,17 @@ buttonpress(XEvent *e) {
</a> 		if(CLEANMASK(ev-&gt;state) != MODKEY)
 			return;
 		if(ev-&gt;button == Button1) {
<a href="#h1-10-3" id="h1-10-3" class="d">-			restack(getview(c));
</a><a href="#h1-10-4" id="h1-10-4" class="i">+			restack(c-&gt;view);
</a> 			movemouse(c);
 		}
 		else if(ev-&gt;button == Button2) {
<a href="#h1-10-8" id="h1-10-8" class="d">-			if((floating != v-&gt;layout-&gt;arrange) &amp;&amp; c-&gt;isfloating)
</a><a href="#h1-10-9" id="h1-10-9" class="i">+			if((floating != c-&gt;view-&gt;layout-&gt;arrange) &amp;&amp; c-&gt;isfloating)
</a> 				togglefloating(NULL);
 			else
 				zoom(NULL);
 		}
 		else if(ev-&gt;button == Button3 &amp;&amp; !c-&gt;isfixed) {
<a href="#h1-10-15" id="h1-10-15" class="d">-			restack(getview(c));
</a><a href="#h1-10-16" id="h1-10-16" class="i">+			restack(c-&gt;view);
</a> 			resizemouse(c);
 		}
 	}
<a href="#h1-11" id="h1-11" class="h">@@ -457,7 +454,7 @@ configurenotify(XEvent *e) {
</a> 		XFreePixmap(dpy, dc.drawable);
 		dc.drawable = XCreatePixmap(dpy, root, DisplayWidth(root, screen), bh, DefaultDepth(dpy, screen));
 		XResizeWindow(dpy, v-&gt;barwin, v-&gt;w, bh);
<a href="#h1-11-3" id="h1-11-3" class="d">-		updatebarpos(v);
</a><a href="#h1-11-4" id="h1-11-4" class="i">+		updatebarpos(selview);
</a> 		arrange();
 	}
 }
<a href="#h1-12" id="h1-12" class="h">@@ -469,7 +466,7 @@ configurerequest(XEvent *e) {
</a> 	XWindowChanges wc;
 
 	if((c = getclient(ev-&gt;window))) {
<a href="#h1-12-3" id="h1-12-3" class="d">-		View *v = getview(c);
</a><a href="#h1-12-4" id="h1-12-4" class="i">+		View *v = c-&gt;view;
</a> 		if(ev-&gt;value_mask &amp; CWBorderWidth)
 			c-&gt;border = ev-&gt;border_width;
 		if(c-&gt;isfixed || c-&gt;isfloating || (floating == v-&gt;layout-&gt;arrange)) {
<a href="#h1-13" id="h1-13" class="h">@@ -541,21 +538,23 @@ drawbar(View *v) {
</a> 	Client *c;
 
 	dc.x = 0;
<a href="#h1-13-3" id="h1-13-3" class="d">-	for(c = stack; c &amp;&amp; (!isvisible(c) || getview(c) != v); c = c-&gt;snext);
</a><a href="#h1-13-4" id="h1-13-4" class="i">+	for(c = stack; c &amp;&amp; (!isvisible(c) || c-&gt;view != v); c = c-&gt;snext);
</a> 	for(i = 0; i &lt; LENGTH(tags); i++) {
<a href="#h1-13-6" id="h1-13-6" class="i">+		if(&amp;views[vtags[i]] != v)
</a><a href="#h1-13-7" id="h1-13-7" class="i">+			continue;
</a> 		dc.w = textw(tags[i]);
 		if(seltags[i]) {
<a href="#h1-13-10" id="h1-13-10" class="d">-			drawtext(v, tags[i], dc.sel, isurgent(i));
</a><a href="#h1-13-11" id="h1-13-11" class="d">-			drawsquare(v, c &amp;&amp; c-&gt;tags[i], isoccupied(i), isurgent(i), dc.sel);
</a><a href="#h1-13-12" id="h1-13-12" class="i">+			drawtext(tags[i], dc.sel, isurgent(i));
</a><a href="#h1-13-13" id="h1-13-13" class="i">+			drawsquare(c &amp;&amp; c-&gt;tags[i], isoccupied(i), isurgent(i), dc.sel);
</a> 		}
 		else {
<a href="#h1-13-16" id="h1-13-16" class="d">-			drawtext(v, tags[i], dc.norm, isurgent(i));
</a><a href="#h1-13-17" id="h1-13-17" class="d">-			drawsquare(v, c &amp;&amp; c-&gt;tags[i], isoccupied(i), isurgent(i), dc.norm);
</a><a href="#h1-13-18" id="h1-13-18" class="i">+			drawtext(tags[i], dc.norm, isurgent(i));
</a><a href="#h1-13-19" id="h1-13-19" class="i">+			drawsquare(c &amp;&amp; c-&gt;tags[i], isoccupied(i), isurgent(i), dc.norm);
</a> 		}
 		dc.x += dc.w;
 	}
 	dc.w = blw;
<a href="#h1-13-24" id="h1-13-24" class="d">-	drawtext(v, v-&gt;layout-&gt;symbol, dc.norm, False);
</a><a href="#h1-13-25" id="h1-13-25" class="i">+	drawtext(v-&gt;layout-&gt;symbol, dc.norm, False);
</a> 	x = dc.x + dc.w;
 	if(v == selview) {
 		dc.w = textw(stext);
<a href="#h1-14" id="h1-14" class="h">@@ -564,25 +563,25 @@ drawbar(View *v) {
</a> 			dc.x = x;
 			dc.w = v-&gt;w - x;
 		}
<a href="#h1-14-3" id="h1-14-3" class="d">-		drawtext(v, stext, dc.norm, False);
</a><a href="#h1-14-4" id="h1-14-4" class="i">+		drawtext(stext, dc.norm, False);
</a> 	}
 	else
 		dc.x = v-&gt;w;
 	if((dc.w = dc.x - x) &gt; bh) {
 		dc.x = x;
 		if(c) {
<a href="#h1-14-11" id="h1-14-11" class="d">-			drawtext(v, c-&gt;name, dc.sel, False);
</a><a href="#h1-14-12" id="h1-14-12" class="d">-			drawsquare(v, False, c-&gt;isfloating, False, dc.sel);
</a><a href="#h1-14-13" id="h1-14-13" class="i">+			drawtext(c-&gt;name, dc.sel, False);
</a><a href="#h1-14-14" id="h1-14-14" class="i">+			drawsquare(False, c-&gt;isfloating, False, dc.sel);
</a> 		}
 		else
<a href="#h1-14-17" id="h1-14-17" class="d">-			drawtext(v, NULL, dc.norm, False);
</a><a href="#h1-14-18" id="h1-14-18" class="i">+			drawtext(NULL, dc.norm, False);
</a> 	}
 	XCopyArea(dpy, dc.drawable, v-&gt;barwin, dc.gc, 0, 0, v-&gt;w, bh, 0, 0);
 	XSync(dpy, False);
 }
 
 void
<a href="#h1-14-25" id="h1-14-25" class="d">-drawsquare(View *v, Bool filled, Bool empty, Bool invert, unsigned long col[ColLast]) {
</a><a href="#h1-14-26" id="h1-14-26" class="i">+drawsquare(Bool filled, Bool empty, Bool invert, unsigned long col[ColLast]) {
</a> 	int x;
 	XGCValues gcv;
 	XRectangle r = { dc.x, dc.y, dc.w, dc.h };
<a href="#h1-15" id="h1-15" class="h">@@ -603,7 +602,7 @@ drawsquare(View *v, Bool filled, Bool empty, Bool invert, unsigned long col[ColL
</a> }
 
 void
<a href="#h1-15-3" id="h1-15-3" class="d">-drawtext(View *v, const char *text, unsigned long col[ColLast], Bool invert) {
</a><a href="#h1-15-4" id="h1-15-4" class="i">+drawtext(const char *text, unsigned long col[ColLast], Bool invert) {
</a> 	int x, y, w, h;
 	unsigned int len, olen;
 	XRectangle r = { dc.x, dc.y, dc.w, dc.h };
<a href="#h1-16" id="h1-16" class="h">@@ -680,7 +679,7 @@ expose(XEvent *e) {
</a> 	View *v;
 	XExposeEvent *ev = &amp;e-&gt;xexpose;
 
<a href="#h1-16-3" id="h1-16-3" class="d">-	if(ev-&gt;count == 0 &amp;&amp; (v = getviewbar(ev-&gt;window)))
</a><a href="#h1-16-4" id="h1-16-4" class="i">+	if(ev-&gt;count == 0 &amp;&amp; ((v = getviewbar(ev-&gt;window))))
</a> 		drawbar(v);
 }
 
<a href="#h1-17" id="h1-17" class="h">@@ -698,13 +697,13 @@ void
</a> focus(Client *c) {
 	View *v = selview;
 	if(c)
<a href="#h1-17-3" id="h1-17-3" class="d">-		selview = getview(c);
</a><a href="#h1-17-4" id="h1-17-4" class="i">+		selview = c-&gt;view;
</a> 	else
 		selview = viewat();
 	if(selview != v)
 		drawbar(v);
 	if(!c || (c &amp;&amp; !isvisible(c)))
<a href="#h1-17-10" id="h1-17-10" class="d">-		for(c = stack; c &amp;&amp; (!isvisible(c) || getview(c) != selview); c = c-&gt;snext);
</a><a href="#h1-17-11" id="h1-17-11" class="i">+		for(c = stack; c &amp;&amp; (!isvisible(c) || c-&gt;view != selview); c = c-&gt;snext);
</a> 	if(sel &amp;&amp; sel != c) {
 		grabbuttons(sel, False);
 		XSetWindowBorder(dpy, sel-&gt;win, dc.norm[ColBorder]);
<a href="#h1-18" id="h1-18" class="h">@@ -718,7 +717,7 @@ focus(Client *c) {
</a> 	if(c) {
 		XSetWindowBorder(dpy, c-&gt;win, dc.sel[ColBorder]);
 		XSetInputFocus(dpy, c-&gt;win, RevertToPointerRoot, CurrentTime);
<a href="#h1-18-3" id="h1-18-3" class="d">-		selview = getview(c);
</a><a href="#h1-18-4" id="h1-18-4" class="i">+		selview = c-&gt;view;
</a> 	}
 	else
 		XSetInputFocus(dpy, root, RevertToPointerRoot, CurrentTime);
<a href="#h1-19" id="h1-19" class="h">@@ -744,7 +743,7 @@ focusnext(const char *arg) {
</a> 		for(c = clients; c &amp;&amp; !isvisible(c); c = c-&gt;next);
 	if(c) {
 		focus(c);
<a href="#h1-19-3" id="h1-19-3" class="d">-		restack(getview(c));
</a><a href="#h1-19-4" id="h1-19-4" class="i">+		restack(c-&gt;view);
</a> 	}
 }
 
<a href="#h1-20" id="h1-20" class="h">@@ -761,7 +760,7 @@ focusprev(const char *arg) {
</a> 	}
 	if(c) {
 		focus(c);
<a href="#h1-20-3" id="h1-20-3" class="d">-		restack(getview(c));
</a><a href="#h1-20-4" id="h1-20-4" class="i">+		restack(c-&gt;view);
</a> 	}
 }
 
<a href="#h1-21" id="h1-21" class="h">@@ -793,16 +792,6 @@ getviewbar(Window barwin) {
</a> 	return NULL;
 }
 
<a href="#h1-21-3" id="h1-21-3" class="d">-View *
</a><a href="#h1-21-4" id="h1-21-4" class="d">-getview(Client *c) {
</a><a href="#h1-21-5" id="h1-21-5" class="d">-	unsigned int i;
</a><a href="#h1-21-6" id="h1-21-6" class="d">-
</a><a href="#h1-21-7" id="h1-21-7" class="d">-	for(i = 0; i &lt; LENGTH(tags); i++)
</a><a href="#h1-21-8" id="h1-21-8" class="d">-		if(c-&gt;tags[i])
</a><a href="#h1-21-9" id="h1-21-9" class="d">-			return &amp;views[c-&gt;tags[i] - 1];
</a><a href="#h1-21-10" id="h1-21-10" class="d">-	return &amp;views[0]; /* fallback */
</a><a href="#h1-21-11" id="h1-21-11" class="d">-}
</a><a href="#h1-21-12" id="h1-21-12" class="d">-
</a> long
 getstate(Window w) {
 	int format, status;
<a href="#h1-22" id="h1-22" class="h">@@ -1058,7 +1047,7 @@ manage(Window w, XWindowAttributes *wa) {
</a> 
 	applyrules(c);
 
<a href="#h1-22-3" id="h1-22-3" class="d">-	v = getview(c);
</a><a href="#h1-22-4" id="h1-22-4" class="i">+	v = c-&gt;view;
</a> 
 	c-&gt;x = wa-&gt;x + v-&gt;x;
 	c-&gt;y = wa-&gt;y + v-&gt;y;
<a href="#h1-23" id="h1-23" class="h">@@ -1137,7 +1126,7 @@ movemouse(Client *c) {
</a> 
 	ocx = nx = c-&gt;x;
 	ocy = ny = c-&gt;y;
<a href="#h1-23-3" id="h1-23-3" class="d">-	v = getview(c);
</a><a href="#h1-23-4" id="h1-23-4" class="i">+	v = c-&gt;view;
</a> 	if(XGrabPointer(dpy, root, False, MOUSEMASK, GrabModeAsync, GrabModeAsync,
 			None, cursor[CurMove], CurrentTime) != GrabSuccess)
 		return;
<a href="#h1-24" id="h1-24" class="h">@@ -1176,7 +1165,7 @@ movemouse(Client *c) {
</a> 
 Client *
 nexttiled(Client *c, View *v) {
<a href="#h1-24-3" id="h1-24-3" class="d">-	for(; c &amp;&amp; (c-&gt;isfloating || getview(c) != v || !isvisible(c)); c = c-&gt;next);
</a><a href="#h1-24-4" id="h1-24-4" class="i">+	for(; c &amp;&amp; (c-&gt;isfloating || c-&gt;view != v || !isvisible(c)); c = c-&gt;next);
</a> 	return c;
 }
 
<a href="#h1-25" id="h1-25" class="h">@@ -1201,7 +1190,7 @@ propertynotify(XEvent *e) {
</a> 			break;
 		case XA_WM_HINTS:
 			updatewmhints(c);
<a href="#h1-25-3" id="h1-25-3" class="d">-			drawbar(getview(c));
</a><a href="#h1-25-4" id="h1-25-4" class="i">+			drawbar(c-&gt;view);
</a> 			break;
 		}
 		if(ev-&gt;atom == XA_WM_NAME || ev-&gt;atom == netatom[NetWMName]) {
<a href="#h1-26" id="h1-26" class="h">@@ -1234,7 +1223,7 @@ resize(Client *c, int x, int y, int w, int h, Bool sizehints) {
</a> 	View *v;
 	XWindowChanges wc;
 
<a href="#h1-26-3" id="h1-26-3" class="d">-	v = getview(c);
</a><a href="#h1-26-4" id="h1-26-4" class="i">+	v = c-&gt;view;
</a> 	if(sizehints) {
 		/* set minimum possible */
 		if (w &lt; 1)
<a href="#h1-27" id="h1-27" class="h">@@ -1305,7 +1294,7 @@ resizemouse(Client *c) {
</a> 
 	ocx = c-&gt;x;
 	ocy = c-&gt;y;
<a href="#h1-27-3" id="h1-27-3" class="d">-	v = getview(c);
</a><a href="#h1-27-4" id="h1-27-4" class="i">+	v = c-&gt;view;
</a> 	if(XGrabPointer(dpy, root, False, MOUSEMASK, GrabModeAsync, GrabModeAsync,
 			None, cursor[CurResize], CurrentTime) != GrabSuccess)
 		return;
<a href="#h1-28" id="h1-28" class="h">@@ -1484,13 +1473,12 @@ setlayout(const char *arg) {
</a> 	if(sel)
 		arrange();
 	else
<a href="#h1-28-3" id="h1-28-3" class="d">-		drawbar(v);
</a><a href="#h1-28-4" id="h1-28-4" class="i">+		drawbar(selview);
</a> }
 
 void
 setmwfact(const char *arg) {
 	double delta;
<a href="#h1-28-10" id="h1-28-10" class="d">-
</a> 	View *v = selview;
 
 	if(!domwfact)
<a href="#h1-29" id="h1-29" class="h">@@ -1537,7 +1525,7 @@ setup(void) {
</a> isxinerama = True;
 nviews = 2; /* aim Xinerama */
 #endif
<a href="#h1-29-3" id="h1-29-3" class="d">-	selview = views = emallocz(nviews * sizeof(View));
</a><a href="#h1-29-4" id="h1-29-4" class="i">+	views = emallocz(nviews * sizeof(View));
</a> 
 	screen = DefaultScreen(dpy);
 	root = RootWindow(dpy, screen);
<a href="#h1-30" id="h1-30" class="h">@@ -1627,10 +1615,10 @@ v-&gt;h = DisplayHeight(dpy, screen);
</a> 	if(info)
 		XFree(info);
 
<a href="#h1-30-3" id="h1-30-3" class="i">+	selview = viewat();
</a><a href="#h1-30-4" id="h1-30-4" class="i">+
</a> 	/* grab keys */
 	grabkeys();
<a href="#h1-30-7" id="h1-30-7" class="d">-
</a><a href="#h1-30-8" id="h1-30-8" class="d">-	selview = &amp;views[0];
</a> }
 
 void
<a href="#h1-31" id="h1-31" class="h">@@ -1990,8 +1978,8 @@ zoom(const char *arg) {
</a> 
 	if(!sel || !dozoom || sel-&gt;isfloating)
 		return;
<a href="#h1-31-3" id="h1-31-3" class="d">-	if(c == nexttiled(clients, getview(c)))
</a><a href="#h1-31-4" id="h1-31-4" class="d">-		if(!(c = nexttiled(c-&gt;next, getview(c))))
</a><a href="#h1-31-5" id="h1-31-5" class="i">+	if(c == nexttiled(clients, c-&gt;view))
</a><a href="#h1-31-6" id="h1-31-6" class="i">+		if(!(c = nexttiled(c-&gt;next, c-&gt;view)))
</a> 			return;
 	detach(c);
 	attach(c);
</pre>
</div>
</body>
</html>
