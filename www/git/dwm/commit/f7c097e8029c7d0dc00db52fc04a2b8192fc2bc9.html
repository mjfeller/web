<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>removed View cruft, now back to the roots - dwm - dynamic window manager
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="dwm Atom Feed" href="../atom.xml" />
<link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="/logo.png" alt="" width="32" height="32" /></a></td><td><h1>dwm</h1><span class="desc">dynamic window manager
</span></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/f7c097e8029c7d0dc00db52fc04a2b8192fc2bc9.html">f7c097e8029c7d0dc00db52fc04a2b8192fc2bc9</a>
<b>parent</b> <a href="../commit/da1b3fa4379acc7431eaee1331e755ef5335011b.html">da1b3fa4379acc7431eaee1331e755ef5335011b</a>
<b>Author:</b> anselm@anselm1 &lt;<a href="mailto:unknown">unknown</a>&gt;
<b>Date:</b>   Mon,  3 Mar 2008 21:40:37 +0000

removed View cruft, now back to the roots
<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">config.def.h</a></td><td> | </td><td class="num">1</td><td><span class="i"></span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">dwm.c</a></td><td> | </td><td class="num">549</td><td><span class="i">+++++++++++++++++++++++++++++</span><span class="d">--------------------------------------------------</span></td></tr>
</table></pre><pre>2 files changed, 201 insertions(+), 349 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/config.def.h.html">config.def.h</a> b/<a href="../file/config.def.h.html">config.def.h</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -13,7 +13,6 @@
</a> 
 /* old */
 const char tags[][MAXTAGLEN]     = { &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot; };
<a href="#h0-0-3" id="h0-0-3" class="d">-unsigned int vtags[LENGTH(tags)] = {  0 ,  0 ,  0 ,  0 ,   0  ,  1 ,  1 ,  1 ,   1   };
</a> 
 Rule rules[] = {
 	/* class:instance:title substr	tags ref	isfloating */
<b>diff --git a/<a id="h1" href="../file/dwm.c.html">dwm.c</a> b/<a href="../file/dwm.c.html">dwm.c</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -40,9 +40,9 @@
</a> #include &lt;X11/Xlib.h&gt;
 #include &lt;X11/Xproto.h&gt;
 #include &lt;X11/Xutil.h&gt;
<a href="#h1-0-3" id="h1-0-3" class="d">-//#ifdef XINERAMA
</a><a href="#h1-0-4" id="h1-0-4" class="i">+#ifdef XINERAMA
</a> #include &lt;X11/extensions/Xinerama.h&gt;
<a href="#h1-0-6" id="h1-0-6" class="d">-//#endif
</a><a href="#h1-0-7" id="h1-0-7" class="i">+#endif
</a> 
 /* macros */
 #define BUTTONMASK		(ButtonPressMask|ButtonReleaseMask)
<a href="#h1-1" id="h1-1" class="h">@@ -60,7 +60,6 @@ enum { NetSupported, NetWMName, NetLast };		/* EWMH atoms */
</a> enum { WMProtocols, WMDelete, WMName, WMState, WMLast };/* default atoms */
 
 /* typedefs */
<a href="#h1-1-3" id="h1-1-3" class="d">-typedef struct View View;
</a> typedef struct Client Client;
 struct Client {
 	char name[256];
<a href="#h1-2" id="h1-2" class="h">@@ -101,7 +100,7 @@ typedef struct {
</a> 
 typedef struct {
 	const char *symbol;
<a href="#h1-2-3" id="h1-2-3" class="d">-	void (*arrange)(View *);
</a><a href="#h1-2-4" id="h1-2-4" class="i">+	void (*arrange)(void);
</a> } Layout;
 
 typedef struct {
<a href="#h1-3" id="h1-3" class="h">@@ -110,14 +109,6 @@ typedef struct {
</a> 	Bool isfloating;
 } Rule;
 
<a href="#h1-3-3" id="h1-3-3" class="d">-struct View {
</a><a href="#h1-3-4" id="h1-3-4" class="d">-	unsigned int id;
</a><a href="#h1-3-5" id="h1-3-5" class="d">-	int x, y, w, h, wax, way, wah, waw;
</a><a href="#h1-3-6" id="h1-3-6" class="d">-	double mwfact;
</a><a href="#h1-3-7" id="h1-3-7" class="d">-	Layout *layout;
</a><a href="#h1-3-8" id="h1-3-8" class="d">-	Window barwin;
</a><a href="#h1-3-9" id="h1-3-9" class="d">-};
</a><a href="#h1-3-10" id="h1-3-10" class="d">-
</a> /* function declarations */
 void applyrules(Client *c);
 void arrange(void);
<a href="#h1-4" id="h1-4" class="h">@@ -130,27 +121,23 @@ void cleanup(void);
</a> void configure(Client *c);
 void configurenotify(XEvent *e);
 void configurerequest(XEvent *e);
<a href="#h1-4-3" id="h1-4-3" class="d">-Bool conflicts(Client *c, unsigned int tidx);
</a> void destroynotify(XEvent *e);
 void detach(Client *c);
 void detachstack(Client *c);
<a href="#h1-4-7" id="h1-4-7" class="d">-void drawbar(View *v);
</a><a href="#h1-4-8" id="h1-4-8" class="i">+void drawbar(void);
</a> void drawsquare(Bool filled, Bool empty, Bool invert, unsigned long col[ColLast]);
 void drawtext(const char *text, unsigned long col[ColLast], Bool invert);
 void *emallocz(unsigned int size);
 void enternotify(XEvent *e);
 void eprint(const char *errstr, ...);
 void expose(XEvent *e);
<a href="#h1-4-15" id="h1-4-15" class="d">-unsigned int firstag(View *v);
</a><a href="#h1-4-16" id="h1-4-16" class="d">-void floating(View *v); /* default floating layout */
</a><a href="#h1-4-17" id="h1-4-17" class="i">+void floating(void); /* default floating layout */
</a> void focus(Client *c);
 void focusin(XEvent *e);
 void focusnext(const char *arg);
 void focusprev(const char *arg);
 Client *getclient(Window w);
 unsigned long getcolor(const char *colstr);
<a href="#h1-4-24" id="h1-4-24" class="d">-View *getview(Client *c);
</a><a href="#h1-4-25" id="h1-4-25" class="d">-View *getviewbar(Window barwin);
</a> long getstate(Window w);
 Bool gettextprop(Window w, Atom atom, char *text, unsigned int size);
 void grabbuttons(Client *c, Bool focused);
<a href="#h1-5" id="h1-5" class="h">@@ -166,15 +153,14 @@ void killclient(const char *arg);
</a> void manage(Window w, XWindowAttributes *wa);
 void mappingnotify(XEvent *e);
 void maprequest(XEvent *e);
<a href="#h1-5-3" id="h1-5-3" class="d">-View *viewat(void);
</a> void movemouse(Client *c);
<a href="#h1-5-5" id="h1-5-5" class="d">-Client *nexttiled(Client *c, View *v);
</a><a href="#h1-5-6" id="h1-5-6" class="i">+Client *nexttiled(Client *c);
</a> void propertynotify(XEvent *e);
 void quit(const char *arg);
 void reapply(const char *arg);
 void resize(Client *c, int x, int y, int w, int h, Bool sizehints);
 void resizemouse(Client *c);
<a href="#h1-5-12" id="h1-5-12" class="d">-void restack(View *v);
</a><a href="#h1-5-13" id="h1-5-13" class="i">+void restack(void);
</a> void run(void);
 void scan(void);
 void setclientstate(Client *c, long state);
<a href="#h1-6" id="h1-6" class="h">@@ -185,7 +171,7 @@ void spawn(const char *arg);
</a> void tag(const char *arg);
 unsigned int textnw(const char *text, unsigned int len);
 unsigned int textw(const char *text);
<a href="#h1-6-3" id="h1-6-3" class="d">-void tile(View *v);
</a><a href="#h1-6-4" id="h1-6-4" class="i">+void tile(void);
</a> void togglebar(const char *arg);
 void togglefloating(const char *arg);
 void toggletag(const char *arg);
<a href="#h1-7" id="h1-7" class="h">@@ -193,7 +179,7 @@ void toggleview(const char *arg);
</a> void unban(Client *c);
 void unmanage(Client *c);
 void unmapnotify(XEvent *e);
<a href="#h1-7-3" id="h1-7-3" class="d">-void updatebarpos(View *v);
</a><a href="#h1-7-4" id="h1-7-4" class="i">+void updatebarpos(void);
</a> void updatesizehints(Client *c);
 void updatetitle(Client *c);
 void updatewmhints(Client *c);
<a href="#h1-8" id="h1-8" class="h">@@ -207,8 +193,8 @@ void selectview(const char *arg);
</a> 
 /* variables */
 char stext[256], buf[256];
<a href="#h1-8-3" id="h1-8-3" class="d">-int nviews = 1;
</a><a href="#h1-8-4" id="h1-8-4" class="d">-int screen;
</a><a href="#h1-8-5" id="h1-8-5" class="i">+double mwfact;
</a><a href="#h1-8-6" id="h1-8-6" class="i">+int screen, sx, sy, sw, sh, wax, way, waw, wah, xscreens;
</a> int (*xerrorxlib)(Display *, XErrorEvent *);
 unsigned int bh, bpos;
 unsigned int blw = 0;
<a href="#h1-9" id="h1-9" class="h">@@ -240,19 +226,22 @@ Client *stack = NULL;
</a> Cursor cursor[CurLast];
 Display *dpy;
 DC dc = {0};
<a href="#h1-9-3" id="h1-9-3" class="d">-View *views;
</a><a href="#h1-9-4" id="h1-9-4" class="d">-View *selview;
</a><a href="#h1-9-5" id="h1-9-5" class="d">-Window root;
</a><a href="#h1-9-6" id="h1-9-6" class="i">+Layout *lt;
</a><a href="#h1-9-7" id="h1-9-7" class="i">+Window root, barwin;
</a><a href="#h1-9-8" id="h1-9-8" class="i">+#ifdef XINERAMA
</a><a href="#h1-9-9" id="h1-9-9" class="i">+XineramaScreenInfo *info = NULL;
</a><a href="#h1-9-10" id="h1-9-10" class="i">+#endif
</a> 
 /* configuration, allows nested code to access above variables */
 #include &quot;config.h&quot;
 #define TAGSZ (LENGTH(tags) * sizeof(Bool))
<a href="#h1-9-15" id="h1-9-15" class="i">+static Bool tmp[LENGTH(tags)];
</a> 
 /* function implementations */
 
 void
 applyrules(Client *c) {
<a href="#h1-9-21" id="h1-9-21" class="d">-	unsigned int i, idx;
</a><a href="#h1-9-22" id="h1-9-22" class="i">+	unsigned int i;
</a> 	Bool matched = False;
 	Rule *r;
 	XClassHint ch = { 0 };
<a href="#h1-10" id="h1-10" class="h">@@ -266,8 +255,8 @@ applyrules(Client *c) {
</a> 		|| (ch.res_name &amp;&amp; strstr(ch.res_name, r-&gt;prop)))
 		{
 			c-&gt;isfloating = r-&gt;isfloating;
<a href="#h1-10-3" id="h1-10-3" class="d">-			if(r-&gt;tag &amp;&amp; !conflicts(c, (idx = idxoftag(r-&gt;tag)))) {
</a><a href="#h1-10-4" id="h1-10-4" class="d">-				c-&gt;tags[idx] = True;
</a><a href="#h1-10-5" id="h1-10-5" class="i">+			if(r-&gt;tag) {
</a><a href="#h1-10-6" id="h1-10-6" class="i">+				c-&gt;tags[idxoftag(r-&gt;tag)] = True;
</a> 				matched = True;
 			}
 		}
<a href="#h1-11" id="h1-11" class="h">@@ -276,16 +265,12 @@ applyrules(Client *c) {
</a> 		XFree(ch.res_class);
 	if(ch.res_name)
 		XFree(ch.res_name);
<a href="#h1-11-3" id="h1-11-3" class="d">-	if(!matched) {
</a><a href="#h1-11-4" id="h1-11-4" class="d">-		for(i = 0; i &lt; LENGTH(tags); i++)
</a><a href="#h1-11-5" id="h1-11-5" class="d">-			if(seltags[i] &amp;&amp; vtags[i] == selview-&gt;id)
</a><a href="#h1-11-6" id="h1-11-6" class="d">-				c-&gt;tags[i] = True;
</a><a href="#h1-11-7" id="h1-11-7" class="d">-	}
</a><a href="#h1-11-8" id="h1-11-8" class="i">+	if(!matched)
</a><a href="#h1-11-9" id="h1-11-9" class="i">+		memcpy(c-&gt;tags, seltags, TAGSZ);
</a> }
 
 void
 arrange(void) {
<a href="#h1-11-14" id="h1-11-14" class="d">-	unsigned int i;
</a> 	Client *c;
 
 	for(c = clients; c; c = c-&gt;next)
<a href="#h1-12" id="h1-12" class="h">@@ -295,10 +280,8 @@ arrange(void) {
</a> 			ban(c);
 
 	focus(NULL);
<a href="#h1-12-3" id="h1-12-3" class="d">-	for(i = 0; i &lt; nviews; i++) {
</a><a href="#h1-12-4" id="h1-12-4" class="d">-		views[i].layout-&gt;arrange(&amp;views[i]);
</a><a href="#h1-12-5" id="h1-12-5" class="d">-		restack(&amp;views[i]);
</a><a href="#h1-12-6" id="h1-12-6" class="d">-	}
</a><a href="#h1-12-7" id="h1-12-7" class="i">+	lt-&gt;arrange();
</a><a href="#h1-12-8" id="h1-12-8" class="i">+	restack();
</a> }
 
 void
<a href="#h1-13" id="h1-13" class="h">@@ -319,7 +302,7 @@ void
</a> ban(Client *c) {
 	if(c-&gt;isbanned)
 		return;
<a href="#h1-13-3" id="h1-13-3" class="d">-	XMoveWindow(dpy, c-&gt;win, c-&gt;x + 3 * getview(c)-&gt;w, c-&gt;y);
</a><a href="#h1-13-4" id="h1-13-4" class="i">+	XMoveWindow(dpy, c-&gt;win, c-&gt;x + 3 * sw, c-&gt;y);
</a> 	c-&gt;isbanned = True;
 }
 
<a href="#h1-14" id="h1-14" class="h">@@ -329,11 +312,9 @@ buttonpress(XEvent *e) {
</a> 	Client *c;
 	XButtonPressedEvent *ev = &amp;e-&gt;xbutton;
 
<a href="#h1-14-3" id="h1-14-3" class="d">-	if(ev-&gt;window == selview-&gt;barwin) {
</a><a href="#h1-14-4" id="h1-14-4" class="i">+	if(ev-&gt;window == barwin) {
</a> 		x = 0;
 		for(i = 0; i &lt; LENGTH(tags); i++) {
<a href="#h1-14-7" id="h1-14-7" class="d">-			if(&amp;views[vtags[i]] != selview)
</a><a href="#h1-14-8" id="h1-14-8" class="d">-				continue;
</a> 			x += textw(tags[i]);
 			if(ev-&gt;x &lt; x) {
 				if(ev-&gt;button == Button1) {
<a href="#h1-15" id="h1-15" class="h">@@ -359,17 +340,17 @@ buttonpress(XEvent *e) {
</a> 		if(CLEANMASK(ev-&gt;state) != MODKEY)
 			return;
 		if(ev-&gt;button == Button1) {
<a href="#h1-15-3" id="h1-15-3" class="d">-			restack(getview(c));
</a><a href="#h1-15-4" id="h1-15-4" class="i">+			restack();
</a> 			movemouse(c);
 		}
 		else if(ev-&gt;button == Button2) {
<a href="#h1-15-8" id="h1-15-8" class="d">-			if((floating != getview(c)-&gt;layout-&gt;arrange) &amp;&amp; c-&gt;isfloating)
</a><a href="#h1-15-9" id="h1-15-9" class="i">+			if((floating != lt-&gt;arrange) &amp;&amp; c-&gt;isfloating)
</a> 				togglefloating(NULL);
 			else
 				zoom(NULL);
 		}
 		else if(ev-&gt;button == Button3 &amp;&amp; !c-&gt;isfixed) {
<a href="#h1-15-15" id="h1-15-15" class="d">-			restack(getview(c));
</a><a href="#h1-15-16" id="h1-15-16" class="i">+			restack();
</a> 			resizemouse(c);
 		}
 	}
<a href="#h1-16" id="h1-16" class="h">@@ -393,7 +374,6 @@ checkotherwm(void) {
</a> 
 void
 cleanup(void) {
<a href="#h1-16-3" id="h1-16-3" class="d">-	unsigned int i;
</a> 
 	close(STDIN_FILENO);
 	while(stack) {
<a href="#h1-17" id="h1-17" class="h">@@ -411,8 +391,11 @@ cleanup(void) {
</a> 	XFreeCursor(dpy, cursor[CurNormal]);
 	XFreeCursor(dpy, cursor[CurResize]);
 	XFreeCursor(dpy, cursor[CurMove]);
<a href="#h1-17-3" id="h1-17-3" class="d">-	for(i = 0; i &lt; nviews; i++)
</a><a href="#h1-17-4" id="h1-17-4" class="d">-		XDestroyWindow(dpy, views[i].barwin);
</a><a href="#h1-17-5" id="h1-17-5" class="i">+	XDestroyWindow(dpy, barwin);
</a><a href="#h1-17-6" id="h1-17-6" class="i">+#if XINERAMA
</a><a href="#h1-17-7" id="h1-17-7" class="i">+	if(info)
</a><a href="#h1-17-8" id="h1-17-8" class="i">+		XFree(info);
</a><a href="#h1-17-9" id="h1-17-9" class="i">+#endif
</a> 	XSync(dpy, False);
 	XSetInputFocus(dpy, PointerRoot, RevertToPointerRoot, CurrentTime);
 }
<a href="#h1-18" id="h1-18" class="h">@@ -438,16 +421,15 @@ configure(Client *c) {
</a> void
 configurenotify(XEvent *e) {
 	XConfigureEvent *ev = &amp;e-&gt;xconfigure;
<a href="#h1-18-3" id="h1-18-3" class="d">-	View *v = selview;
</a> 
<a href="#h1-18-5" id="h1-18-5" class="d">-	if(ev-&gt;window == root &amp;&amp; (ev-&gt;width != v-&gt;w || ev-&gt;height != v-&gt;h)) {
</a><a href="#h1-18-6" id="h1-18-6" class="d">-		/* TODO -- update Xinerama dimensions here */
</a><a href="#h1-18-7" id="h1-18-7" class="d">-		v-&gt;w = ev-&gt;width;
</a><a href="#h1-18-8" id="h1-18-8" class="d">-		v-&gt;h = ev-&gt;height;
</a><a href="#h1-18-9" id="h1-18-9" class="i">+	if(ev-&gt;window == root &amp;&amp; (ev-&gt;width != sw || ev-&gt;height != sh)) {
</a><a href="#h1-18-10" id="h1-18-10" class="i">+		/* TODO -- use Xinerama dimensions here ? */
</a><a href="#h1-18-11" id="h1-18-11" class="i">+		sw = ev-&gt;width;
</a><a href="#h1-18-12" id="h1-18-12" class="i">+		sh = ev-&gt;height;
</a> 		XFreePixmap(dpy, dc.drawable);
 		dc.drawable = XCreatePixmap(dpy, root, DisplayWidth(root, screen), bh, DefaultDepth(dpy, screen));
<a href="#h1-18-15" id="h1-18-15" class="d">-		XResizeWindow(dpy, v-&gt;barwin, v-&gt;w, bh);
</a><a href="#h1-18-16" id="h1-18-16" class="d">-		updatebarpos(selview);
</a><a href="#h1-18-17" id="h1-18-17" class="i">+		XResizeWindow(dpy, barwin, sw, bh);
</a><a href="#h1-18-18" id="h1-18-18" class="i">+		updatebarpos();
</a> 		arrange();
 	}
 }
<a href="#h1-19" id="h1-19" class="h">@@ -458,23 +440,23 @@ configurerequest(XEvent *e) {
</a> 	XConfigureRequestEvent *ev = &amp;e-&gt;xconfigurerequest;
 	XWindowChanges wc;
 
<a href="#h1-19-3" id="h1-19-3" class="i">+	/* TODO -- consider Xinerama if necessary when centering */
</a> 	if((c = getclient(ev-&gt;window))) {
<a href="#h1-19-5" id="h1-19-5" class="d">-		View *v = getview(c);
</a> 		if(ev-&gt;value_mask &amp; CWBorderWidth)
 			c-&gt;border = ev-&gt;border_width;
<a href="#h1-19-8" id="h1-19-8" class="d">-		if(c-&gt;isfixed || c-&gt;isfloating || (floating == v-&gt;layout-&gt;arrange)) {
</a><a href="#h1-19-9" id="h1-19-9" class="i">+		if(c-&gt;isfixed || c-&gt;isfloating || (floating == lt-&gt;arrange)) {
</a> 			if(ev-&gt;value_mask &amp; CWX)
<a href="#h1-19-11" id="h1-19-11" class="d">-				c-&gt;x = v-&gt;x + ev-&gt;x;
</a><a href="#h1-19-12" id="h1-19-12" class="i">+				c-&gt;x = sx + ev-&gt;x;
</a> 			if(ev-&gt;value_mask &amp; CWY)
<a href="#h1-19-14" id="h1-19-14" class="d">-				c-&gt;y = v-&gt;y + ev-&gt;y;
</a><a href="#h1-19-15" id="h1-19-15" class="i">+				c-&gt;y = sy + ev-&gt;y;
</a> 			if(ev-&gt;value_mask &amp; CWWidth)
 				c-&gt;w = ev-&gt;width;
 			if(ev-&gt;value_mask &amp; CWHeight)
 				c-&gt;h = ev-&gt;height;
<a href="#h1-19-20" id="h1-19-20" class="d">-			if((c-&gt;x - v-&gt;x + c-&gt;w) &gt; v-&gt;w &amp;&amp; c-&gt;isfloating)
</a><a href="#h1-19-21" id="h1-19-21" class="d">-				c-&gt;x = v-&gt;x + (v-&gt;w / 2 - c-&gt;w / 2); /* center in x direction */
</a><a href="#h1-19-22" id="h1-19-22" class="d">-			if((c-&gt;y - v-&gt;y + c-&gt;h) &gt; v-&gt;h &amp;&amp; c-&gt;isfloating)
</a><a href="#h1-19-23" id="h1-19-23" class="d">-				c-&gt;y = v-&gt;y + (v-&gt;h / 2 - c-&gt;h / 2); /* center in y direction */
</a><a href="#h1-19-24" id="h1-19-24" class="i">+			if((c-&gt;x - sx + c-&gt;w) &gt; sw &amp;&amp; c-&gt;isfloating)
</a><a href="#h1-19-25" id="h1-19-25" class="i">+				c-&gt;x = sx + (sw / 2 - c-&gt;w / 2); /* center in x direction */
</a><a href="#h1-19-26" id="h1-19-26" class="i">+			if((c-&gt;y - sy + c-&gt;h) &gt; sh &amp;&amp; c-&gt;isfloating)
</a><a href="#h1-19-27" id="h1-19-27" class="i">+				c-&gt;y = sy + (sh / 2 - c-&gt;h / 2); /* center in y direction */
</a> 			if((ev-&gt;value_mask &amp; (CWX|CWY))
 			&amp;&amp; !(ev-&gt;value_mask &amp; (CWWidth|CWHeight)))
 				configure(c);
<a href="#h1-20" id="h1-20" class="h">@@ -502,7 +484,7 @@ conflicts(Client *c, unsigned int tidx) {
</a> 	unsigned int i;
 
 	for(i = 0; i &lt; LENGTH(tags); i++)
<a href="#h1-20-3" id="h1-20-3" class="d">-		if(c-&gt;tags[i] &amp;&amp; vtags[i] != vtags[tidx])
</a><a href="#h1-20-4" id="h1-20-4" class="i">+		if(c-&gt;tags[i])
</a> 			return True; /* conflict */
 	return False;
 }
<a href="#h1-21" id="h1-21" class="h">@@ -536,15 +518,13 @@ detachstack(Client *c) {
</a> }
 
 void
<a href="#h1-21-3" id="h1-21-3" class="d">-drawbar(View *v) {
</a><a href="#h1-21-4" id="h1-21-4" class="i">+drawbar(void) {
</a> 	int i, x;
 	Client *c;
 
 	dc.x = 0;
<a href="#h1-21-9" id="h1-21-9" class="d">-	for(c = stack; c &amp;&amp; (!isvisible(c) || getview(c) != v); c = c-&gt;snext);
</a><a href="#h1-21-10" id="h1-21-10" class="i">+	for(c = stack; c &amp;&amp; !isvisible(c); c = c-&gt;snext);
</a> 	for(i = 0; i &lt; LENGTH(tags); i++) {
<a href="#h1-21-12" id="h1-21-12" class="d">-		if(&amp;views[vtags[i]] != v)
</a><a href="#h1-21-13" id="h1-21-13" class="d">-			continue;
</a> 		dc.w = textw(tags[i]);
 		if(seltags[i]) {
 			drawtext(tags[i], dc.sel, isurgent(i));
<a href="#h1-22" id="h1-22" class="h">@@ -557,19 +537,15 @@ drawbar(View *v) {
</a> 		dc.x += dc.w;
 	}
 	dc.w = blw;
<a href="#h1-22-3" id="h1-22-3" class="d">-	drawtext(v-&gt;layout-&gt;symbol, dc.norm, False);
</a><a href="#h1-22-4" id="h1-22-4" class="i">+	drawtext(lt-&gt;symbol, dc.norm, False);
</a> 	x = dc.x + dc.w;
<a href="#h1-22-6" id="h1-22-6" class="d">-	if(v == selview) {
</a><a href="#h1-22-7" id="h1-22-7" class="d">-		dc.w = textw(stext);
</a><a href="#h1-22-8" id="h1-22-8" class="d">-		dc.x = v-&gt;w - dc.w;
</a><a href="#h1-22-9" id="h1-22-9" class="d">-		if(dc.x &lt; x) {
</a><a href="#h1-22-10" id="h1-22-10" class="d">-			dc.x = x;
</a><a href="#h1-22-11" id="h1-22-11" class="d">-			dc.w = v-&gt;w - x;
</a><a href="#h1-22-12" id="h1-22-12" class="d">-		}
</a><a href="#h1-22-13" id="h1-22-13" class="d">-		drawtext(stext, dc.norm, False);
</a><a href="#h1-22-14" id="h1-22-14" class="i">+	dc.w = textw(stext);
</a><a href="#h1-22-15" id="h1-22-15" class="i">+	dc.x = sw - dc.w;
</a><a href="#h1-22-16" id="h1-22-16" class="i">+	if(dc.x &lt; x) {
</a><a href="#h1-22-17" id="h1-22-17" class="i">+		dc.x = x;
</a><a href="#h1-22-18" id="h1-22-18" class="i">+		dc.w = sw - x;
</a> 	}
<a href="#h1-22-20" id="h1-22-20" class="d">-	else
</a><a href="#h1-22-21" id="h1-22-21" class="d">-		dc.x = v-&gt;w;
</a><a href="#h1-22-22" id="h1-22-22" class="i">+	drawtext(stext, dc.norm, False);
</a> 	if((dc.w = dc.x - x) &gt; bh) {
 		dc.x = x;
 		if(c) {
<a href="#h1-23" id="h1-23" class="h">@@ -579,7 +555,7 @@ drawbar(View *v) {
</a> 		else
 			drawtext(NULL, dc.norm, False);
 	}
<a href="#h1-23-3" id="h1-23-3" class="d">-	XCopyArea(dpy, dc.drawable, v-&gt;barwin, dc.gc, 0, 0, v-&gt;w, bh, 0, 0);
</a><a href="#h1-23-4" id="h1-23-4" class="i">+	XCopyArea(dpy, dc.drawable, barwin, dc.gc, 0, 0, sw, bh, 0, 0);
</a> 	XSync(dpy, False);
 }
 
<a href="#h1-24" id="h1-24" class="h">@@ -677,25 +653,14 @@ eprint(const char *errstr, ...) {
</a> 
 void
 expose(XEvent *e) {
<a href="#h1-24-3" id="h1-24-3" class="d">-	View *v;
</a> 	XExposeEvent *ev = &amp;e-&gt;xexpose;
 
<a href="#h1-24-6" id="h1-24-6" class="d">-	if(ev-&gt;count == 0 &amp;&amp; ((v = getviewbar(ev-&gt;window))))
</a><a href="#h1-24-7" id="h1-24-7" class="d">-		drawbar(v);
</a><a href="#h1-24-8" id="h1-24-8" class="d">-}
</a><a href="#h1-24-9" id="h1-24-9" class="d">-
</a><a href="#h1-24-10" id="h1-24-10" class="d">-unsigned int
</a><a href="#h1-24-11" id="h1-24-11" class="d">-firstag(View *v) {
</a><a href="#h1-24-12" id="h1-24-12" class="d">-	unsigned int i;
</a><a href="#h1-24-13" id="h1-24-13" class="d">-
</a><a href="#h1-24-14" id="h1-24-14" class="d">-	for(i = 0; i &lt; LENGTH(tags); i++)
</a><a href="#h1-24-15" id="h1-24-15" class="d">-		if(vtags[i] == v-&gt;id)
</a><a href="#h1-24-16" id="h1-24-16" class="d">-			return i;
</a><a href="#h1-24-17" id="h1-24-17" class="d">-	return 0; /* safe fallback */
</a><a href="#h1-24-18" id="h1-24-18" class="i">+	if(ev-&gt;count == 0 &amp;&amp; (ev-&gt;window == barwin))
</a><a href="#h1-24-19" id="h1-24-19" class="i">+		drawbar();
</a> }
 
 void
<a href="#h1-24-23" id="h1-24-23" class="d">-floating(View *v) { /* default floating layout */
</a><a href="#h1-24-24" id="h1-24-24" class="i">+floating(void) { /* default floating layout */
</a> 	Client *c;
 
 	domwfact = dozoom = False;
<a href="#h1-25" id="h1-25" class="h">@@ -706,15 +671,8 @@ floating(View *v) { /* default floating layout */
</a> 
 void
 focus(Client *c) {
<a href="#h1-25-3" id="h1-25-3" class="d">-	View *v = selview;
</a><a href="#h1-25-4" id="h1-25-4" class="d">-
</a><a href="#h1-25-5" id="h1-25-5" class="d">-	if(c)
</a><a href="#h1-25-6" id="h1-25-6" class="d">-		selview = getview(c);
</a><a href="#h1-25-7" id="h1-25-7" class="d">-	if(selview != v)
</a><a href="#h1-25-8" id="h1-25-8" class="d">-		drawbar(v);
</a> 	if(!c || (c &amp;&amp; !isvisible(c)))
<a href="#h1-25-10" id="h1-25-10" class="d">-		/* TODO: isvisible might take getview(c) as constraint? */
</a><a href="#h1-25-11" id="h1-25-11" class="d">-		for(c = stack; c &amp;&amp; (!isvisible(c) || getview(c) != selview); c = c-&gt;snext);
</a><a href="#h1-25-12" id="h1-25-12" class="i">+		for(c = stack; c &amp;&amp; !isvisible(c); c = c-&gt;snext);
</a> 	if(sel &amp;&amp; sel != c) {
 		grabbuttons(sel, False);
 		XSetWindowBorder(dpy, sel-&gt;win, dc.norm[ColBorder]);
<a href="#h1-26" id="h1-26" class="h">@@ -728,11 +686,10 @@ focus(Client *c) {
</a> 	if(c) {
 		XSetWindowBorder(dpy, c-&gt;win, dc.sel[ColBorder]);
 		XSetInputFocus(dpy, c-&gt;win, RevertToPointerRoot, CurrentTime);
<a href="#h1-26-3" id="h1-26-3" class="d">-		selview = getview(c);
</a> 	}
 	else
 		XSetInputFocus(dpy, root, RevertToPointerRoot, CurrentTime);
<a href="#h1-26-7" id="h1-26-7" class="d">-	drawbar(selview);
</a><a href="#h1-26-8" id="h1-26-8" class="i">+	drawbar();
</a> }
 
 void
<a href="#h1-27" id="h1-27" class="h">@@ -754,7 +711,7 @@ focusnext(const char *arg) {
</a> 		for(c = clients; c &amp;&amp; !isvisible(c); c = c-&gt;next);
 	if(c) {
 		focus(c);
<a href="#h1-27-3" id="h1-27-3" class="d">-		restack(getview(c));
</a><a href="#h1-27-4" id="h1-27-4" class="i">+		restack();
</a> 	}
 }
 
<a href="#h1-28" id="h1-28" class="h">@@ -771,7 +728,7 @@ focusprev(const char *arg) {
</a> 	}
 	if(c) {
 		focus(c);
<a href="#h1-28-3" id="h1-28-3" class="d">-		restack(getview(c));
</a><a href="#h1-28-4" id="h1-28-4" class="i">+		restack();
</a> 	}
 }
 
<a href="#h1-29" id="h1-29" class="h">@@ -793,26 +750,6 @@ getcolor(const char *colstr) {
</a> 	return color.pixel;
 }
 
<a href="#h1-29-3" id="h1-29-3" class="d">-View *
</a><a href="#h1-29-4" id="h1-29-4" class="d">-getview(Client *c) {
</a><a href="#h1-29-5" id="h1-29-5" class="d">-	unsigned int i;
</a><a href="#h1-29-6" id="h1-29-6" class="d">-
</a><a href="#h1-29-7" id="h1-29-7" class="d">-	for(i = 0; i &lt; LENGTH(tags); i++)
</a><a href="#h1-29-8" id="h1-29-8" class="d">-		if(c-&gt;tags[i])
</a><a href="#h1-29-9" id="h1-29-9" class="d">-			return &amp;views[vtags[i]];
</a><a href="#h1-29-10" id="h1-29-10" class="d">-	return NULL;
</a><a href="#h1-29-11" id="h1-29-11" class="d">-}
</a><a href="#h1-29-12" id="h1-29-12" class="d">-
</a><a href="#h1-29-13" id="h1-29-13" class="d">-View *
</a><a href="#h1-29-14" id="h1-29-14" class="d">-getviewbar(Window barwin) {
</a><a href="#h1-29-15" id="h1-29-15" class="d">-	unsigned int i;
</a><a href="#h1-29-16" id="h1-29-16" class="d">-
</a><a href="#h1-29-17" id="h1-29-17" class="d">-	for(i = 0; i &lt; nviews; i++)
</a><a href="#h1-29-18" id="h1-29-18" class="d">-		if(views[i].barwin == barwin)
</a><a href="#h1-29-19" id="h1-29-19" class="d">-			return &amp;views[i];
</a><a href="#h1-29-20" id="h1-29-20" class="d">-	return NULL;
</a><a href="#h1-29-21" id="h1-29-21" class="d">-}
</a><a href="#h1-29-22" id="h1-29-22" class="d">-
</a> long
 getstate(Window w) {
 	int format, status;
<a href="#h1-30" id="h1-30" class="h">@@ -928,7 +865,7 @@ idxoftag(const char *t) {
</a> 	unsigned int i;
 
 	for(i = 0; (i &lt; LENGTH(tags)) &amp;&amp; (tags[i] != t); i++);
<a href="#h1-30-3" id="h1-30-3" class="d">-	return (i &lt; LENGTH(tags)) ? i : firstag(selview);
</a><a href="#h1-30-4" id="h1-30-4" class="i">+	return (i &lt; LENGTH(tags)) ? i : 0;
</a> }
 
 void
<a href="#h1-31" id="h1-31" class="h">@@ -1057,7 +994,6 @@ killclient(const char *arg) {
</a> void
 manage(Window w, XWindowAttributes *wa) {
 	Client *c, *t = NULL;
<a href="#h1-31-3" id="h1-31-3" class="d">-	View *v;
</a> 	Status rettrans;
 	Window trans;
 	XWindowChanges wc;
<a href="#h1-32" id="h1-32" class="h">@@ -1068,28 +1004,26 @@ manage(Window w, XWindowAttributes *wa) {
</a> 
 	applyrules(c);
 
<a href="#h1-32-3" id="h1-32-3" class="d">-	v = getview(c);
</a><a href="#h1-32-4" id="h1-32-4" class="d">-
</a><a href="#h1-32-5" id="h1-32-5" class="d">-	c-&gt;x = wa-&gt;x + v-&gt;x;
</a><a href="#h1-32-6" id="h1-32-6" class="d">-	c-&gt;y = wa-&gt;y + v-&gt;y;
</a><a href="#h1-32-7" id="h1-32-7" class="i">+	c-&gt;x = wa-&gt;x + sx;
</a><a href="#h1-32-8" id="h1-32-8" class="i">+	c-&gt;y = wa-&gt;y + sy;
</a> 	c-&gt;w = wa-&gt;width;
 	c-&gt;h = wa-&gt;height;
 	c-&gt;oldborder = wa-&gt;border_width;
 
<a href="#h1-32-13" id="h1-32-13" class="d">-	if(c-&gt;w == v-&gt;w &amp;&amp; c-&gt;h == v-&gt;h) {
</a><a href="#h1-32-14" id="h1-32-14" class="d">-		c-&gt;x = v-&gt;x;
</a><a href="#h1-32-15" id="h1-32-15" class="d">-		c-&gt;y = v-&gt;y;
</a><a href="#h1-32-16" id="h1-32-16" class="i">+	if(c-&gt;w == sw &amp;&amp; c-&gt;h == sh) {
</a><a href="#h1-32-17" id="h1-32-17" class="i">+		c-&gt;x = sx;
</a><a href="#h1-32-18" id="h1-32-18" class="i">+		c-&gt;y = sy;
</a> 		c-&gt;border = wa-&gt;border_width;
 	}
 	else {
<a href="#h1-32-22" id="h1-32-22" class="d">-		if(c-&gt;x + c-&gt;w + 2 * c-&gt;border &gt; v-&gt;wax + v-&gt;waw)
</a><a href="#h1-32-23" id="h1-32-23" class="d">-			c-&gt;x = v-&gt;wax + v-&gt;waw - c-&gt;w - 2 * c-&gt;border;
</a><a href="#h1-32-24" id="h1-32-24" class="d">-		if(c-&gt;y + c-&gt;h + 2 * c-&gt;border &gt; v-&gt;way + v-&gt;wah)
</a><a href="#h1-32-25" id="h1-32-25" class="d">-			c-&gt;y = v-&gt;way + v-&gt;wah - c-&gt;h - 2 * c-&gt;border;
</a><a href="#h1-32-26" id="h1-32-26" class="d">-		if(c-&gt;x &lt; v-&gt;wax)
</a><a href="#h1-32-27" id="h1-32-27" class="d">-			c-&gt;x = v-&gt;wax;
</a><a href="#h1-32-28" id="h1-32-28" class="d">-		if(c-&gt;y &lt; v-&gt;way)
</a><a href="#h1-32-29" id="h1-32-29" class="d">-			c-&gt;y = v-&gt;way;
</a><a href="#h1-32-30" id="h1-32-30" class="i">+		if(c-&gt;x + c-&gt;w + 2 * c-&gt;border &gt; wax + waw)
</a><a href="#h1-32-31" id="h1-32-31" class="i">+			c-&gt;x = wax + waw - c-&gt;w - 2 * c-&gt;border;
</a><a href="#h1-32-32" id="h1-32-32" class="i">+		if(c-&gt;y + c-&gt;h + 2 * c-&gt;border &gt; way + wah)
</a><a href="#h1-32-33" id="h1-32-33" class="i">+			c-&gt;y = way + wah - c-&gt;h - 2 * c-&gt;border;
</a><a href="#h1-32-34" id="h1-32-34" class="i">+		if(c-&gt;x &lt; wax)
</a><a href="#h1-32-35" id="h1-32-35" class="i">+			c-&gt;x = wax;
</a><a href="#h1-32-36" id="h1-32-36" class="i">+		if(c-&gt;y &lt; way)
</a><a href="#h1-32-37" id="h1-32-37" class="i">+			c-&gt;y = way;
</a> 		c-&gt;border = BORDERPX;
 	}
 	wc.border_width = c-&gt;border;
<a href="#h1-33" id="h1-33" class="h">@@ -1141,13 +1075,11 @@ void
</a> movemouse(Client *c) {
 	int x1, y1, ocx, ocy, di, nx, ny;
 	unsigned int dui;
<a href="#h1-33-3" id="h1-33-3" class="d">-	View *v;
</a> 	Window dummy;
 	XEvent ev;
 
 	ocx = nx = c-&gt;x;
 	ocy = ny = c-&gt;y;
<a href="#h1-33-9" id="h1-33-9" class="d">-	v = getview(c);
</a> 	if(XGrabPointer(dpy, root, False, MOUSEMASK, GrabModeAsync, GrabModeAsync,
 			None, cursor[CurMove], CurrentTime) != GrabSuccess)
 		return;
<a href="#h1-34" id="h1-34" class="h">@@ -1167,17 +1099,17 @@ movemouse(Client *c) {
</a> 			XSync(dpy, False);
 			nx = ocx + (ev.xmotion.x - x1);
 			ny = ocy + (ev.xmotion.y - y1);
<a href="#h1-34-3" id="h1-34-3" class="d">-			if(abs(v-&gt;wax - nx) &lt; SNAP)
</a><a href="#h1-34-4" id="h1-34-4" class="d">-				nx = v-&gt;wax;
</a><a href="#h1-34-5" id="h1-34-5" class="d">-			else if(abs((v-&gt;wax + v-&gt;waw) - (nx + c-&gt;w + 2 * c-&gt;border)) &lt; SNAP)
</a><a href="#h1-34-6" id="h1-34-6" class="d">-				nx = v-&gt;wax + v-&gt;waw - c-&gt;w - 2 * c-&gt;border;
</a><a href="#h1-34-7" id="h1-34-7" class="d">-			if(abs(v-&gt;way - ny) &lt; SNAP)
</a><a href="#h1-34-8" id="h1-34-8" class="d">-				ny = v-&gt;way;
</a><a href="#h1-34-9" id="h1-34-9" class="d">-			else if(abs((v-&gt;way + v-&gt;wah) - (ny + c-&gt;h + 2 * c-&gt;border)) &lt; SNAP)
</a><a href="#h1-34-10" id="h1-34-10" class="d">-				ny = v-&gt;way + v-&gt;wah - c-&gt;h - 2 * c-&gt;border;
</a><a href="#h1-34-11" id="h1-34-11" class="d">-			if(!c-&gt;isfloating &amp;&amp; (v-&gt;layout-&gt;arrange != floating) &amp;&amp; (abs(nx - c-&gt;x) &gt; SNAP || abs(ny - c-&gt;y) &gt; SNAP))
</a><a href="#h1-34-12" id="h1-34-12" class="i">+			if(abs(wax - nx) &lt; SNAP)
</a><a href="#h1-34-13" id="h1-34-13" class="i">+				nx = wax;
</a><a href="#h1-34-14" id="h1-34-14" class="i">+			else if(abs((wax + waw) - (nx + c-&gt;w + 2 * c-&gt;border)) &lt; SNAP)
</a><a href="#h1-34-15" id="h1-34-15" class="i">+				nx = wax + waw - c-&gt;w - 2 * c-&gt;border;
</a><a href="#h1-34-16" id="h1-34-16" class="i">+			if(abs(way - ny) &lt; SNAP)
</a><a href="#h1-34-17" id="h1-34-17" class="i">+				ny = way;
</a><a href="#h1-34-18" id="h1-34-18" class="i">+			else if(abs((way + wah) - (ny + c-&gt;h + 2 * c-&gt;border)) &lt; SNAP)
</a><a href="#h1-34-19" id="h1-34-19" class="i">+				ny = way + wah - c-&gt;h - 2 * c-&gt;border;
</a><a href="#h1-34-20" id="h1-34-20" class="i">+			if(!c-&gt;isfloating &amp;&amp; (lt-&gt;arrange != floating) &amp;&amp; (abs(nx - c-&gt;x) &gt; SNAP || abs(ny - c-&gt;y) &gt; SNAP))
</a> 				togglefloating(NULL);
<a href="#h1-34-22" id="h1-34-22" class="d">-			if((v-&gt;layout-&gt;arrange == floating) || c-&gt;isfloating)
</a><a href="#h1-34-23" id="h1-34-23" class="i">+			if((lt-&gt;arrange == floating) || c-&gt;isfloating)
</a> 				resize(c, nx, ny, c-&gt;w, c-&gt;h, False);
 			break;
 		}
<a href="#h1-35" id="h1-35" class="h">@@ -1185,8 +1117,8 @@ movemouse(Client *c) {
</a> }
 
 Client *
<a href="#h1-35-3" id="h1-35-3" class="d">-nexttiled(Client *c, View *v) {
</a><a href="#h1-35-4" id="h1-35-4" class="d">-	for(; c &amp;&amp; (c-&gt;isfloating || getview(c) != v || !isvisible(c)); c = c-&gt;next);
</a><a href="#h1-35-5" id="h1-35-5" class="i">+nexttiled(Client *c) {
</a><a href="#h1-35-6" id="h1-35-6" class="i">+	for(; c &amp;&amp; (c-&gt;isfloating || !isvisible(c)); c = c-&gt;next);
</a> 	return c;
 }
 
<a href="#h1-36" id="h1-36" class="h">@@ -1211,13 +1143,13 @@ propertynotify(XEvent *e) {
</a> 			break;
 		case XA_WM_HINTS:
 			updatewmhints(c);
<a href="#h1-36-3" id="h1-36-3" class="d">-			drawbar(getview(c));
</a><a href="#h1-36-4" id="h1-36-4" class="i">+			drawbar();
</a> 			break;
 		}
 		if(ev-&gt;atom == XA_WM_NAME || ev-&gt;atom == netatom[NetWMName]) {
 			updatetitle(c);
 			if(c == sel)
<a href="#h1-36-10" id="h1-36-10" class="d">-				drawbar(selview);
</a><a href="#h1-36-11" id="h1-36-11" class="i">+				drawbar();
</a> 		}
 	}
 }
<a href="#h1-37" id="h1-37" class="h">@@ -1241,10 +1173,8 @@ reapply(const char *arg) {
</a> 
 void
 resize(Client *c, int x, int y, int w, int h, Bool sizehints) {
<a href="#h1-37-3" id="h1-37-3" class="d">-	View *v;
</a> 	XWindowChanges wc;
 
<a href="#h1-37-6" id="h1-37-6" class="d">-	v = getview(c);
</a> 	if(sizehints) {
 		/* set minimum possible */
 		if (w &lt; 1)
<a href="#h1-38" id="h1-38" class="h">@@ -1285,14 +1215,14 @@ resize(Client *c, int x, int y, int w, int h, Bool sizehints) {
</a> 	}
 	if(w &lt;= 0 || h &lt;= 0)
 		return;
<a href="#h1-38-3" id="h1-38-3" class="d">-	if(x &gt; v-&gt;x + v-&gt;w)
</a><a href="#h1-38-4" id="h1-38-4" class="d">-		x = v-&gt;w - w - 2 * c-&gt;border;
</a><a href="#h1-38-5" id="h1-38-5" class="d">-	if(y &gt; v-&gt;y + v-&gt;h)
</a><a href="#h1-38-6" id="h1-38-6" class="d">-		y = v-&gt;h - h - 2 * c-&gt;border;
</a><a href="#h1-38-7" id="h1-38-7" class="d">-	if(x + w + 2 * c-&gt;border &lt; v-&gt;x)
</a><a href="#h1-38-8" id="h1-38-8" class="d">-		x = v-&gt;x;
</a><a href="#h1-38-9" id="h1-38-9" class="d">-	if(y + h + 2 * c-&gt;border &lt; v-&gt;y)
</a><a href="#h1-38-10" id="h1-38-10" class="d">-		y = v-&gt;y;
</a><a href="#h1-38-11" id="h1-38-11" class="i">+	if(x &gt; sx + sw)
</a><a href="#h1-38-12" id="h1-38-12" class="i">+		x = sw - w - 2 * c-&gt;border;
</a><a href="#h1-38-13" id="h1-38-13" class="i">+	if(y &gt; sy + sh)
</a><a href="#h1-38-14" id="h1-38-14" class="i">+		y = sh - h - 2 * c-&gt;border;
</a><a href="#h1-38-15" id="h1-38-15" class="i">+	if(x + w + 2 * c-&gt;border &lt; sx)
</a><a href="#h1-38-16" id="h1-38-16" class="i">+		x = sx;
</a><a href="#h1-38-17" id="h1-38-17" class="i">+	if(y + h + 2 * c-&gt;border &lt; sy)
</a><a href="#h1-38-18" id="h1-38-18" class="i">+		y = sy;
</a> 	if(c-&gt;x != x || c-&gt;y != y || c-&gt;w != w || c-&gt;h != h) {
 		c-&gt;x = wc.x = x;
 		c-&gt;y = wc.y = y;
<a href="#h1-39" id="h1-39" class="h">@@ -1310,12 +1240,10 @@ void
</a> resizemouse(Client *c) {
 	int ocx, ocy;
 	int nw, nh;
<a href="#h1-39-3" id="h1-39-3" class="d">-	View *v;
</a> 	XEvent ev;
 
 	ocx = c-&gt;x;
 	ocy = c-&gt;y;
<a href="#h1-39-8" id="h1-39-8" class="d">-	v = getview(c);
</a> 	if(XGrabPointer(dpy, root, False, MOUSEMASK, GrabModeAsync, GrabModeAsync,
 			None, cursor[CurResize], CurrentTime) != GrabSuccess)
 		return;
<a href="#h1-40" id="h1-40" class="h">@@ -1340,9 +1268,9 @@ resizemouse(Client *c) {
</a> 				nw = 1;
 			if((nh = ev.xmotion.y - ocy - 2 * c-&gt;border + 1) &lt;= 0)
 				nh = 1;
<a href="#h1-40-3" id="h1-40-3" class="d">-			if(!c-&gt;isfloating &amp;&amp; (v-&gt;layout-&gt;arrange != floating) &amp;&amp; (abs(nw - c-&gt;w) &gt; SNAP || abs(nh - c-&gt;h) &gt; SNAP))
</a><a href="#h1-40-4" id="h1-40-4" class="i">+			if(!c-&gt;isfloating &amp;&amp; (lt-&gt;arrange != floating) &amp;&amp; (abs(nw - c-&gt;w) &gt; SNAP || abs(nh - c-&gt;h) &gt; SNAP))
</a> 				togglefloating(NULL);
<a href="#h1-40-6" id="h1-40-6" class="d">-			if((v-&gt;layout-&gt;arrange == floating) || c-&gt;isfloating)
</a><a href="#h1-40-7" id="h1-40-7" class="i">+			if((lt-&gt;arrange == floating) || c-&gt;isfloating)
</a> 				resize(c, c-&gt;x, c-&gt;y, nw, nh, True);
 			break;
 		}
<a href="#h1-41" id="h1-41" class="h">@@ -1350,24 +1278,24 @@ resizemouse(Client *c) {
</a> }
 
 void
<a href="#h1-41-3" id="h1-41-3" class="d">-restack(View *v) {
</a><a href="#h1-41-4" id="h1-41-4" class="i">+restack(void) {
</a> 	Client *c;
 	XEvent ev;
 	XWindowChanges wc;
 
<a href="#h1-41-9" id="h1-41-9" class="d">-	drawbar(v);
</a><a href="#h1-41-10" id="h1-41-10" class="i">+	drawbar();
</a> 	if(!sel)
 		return;
<a href="#h1-41-13" id="h1-41-13" class="d">-	if(sel-&gt;isfloating || (v-&gt;layout-&gt;arrange == floating))
</a><a href="#h1-41-14" id="h1-41-14" class="i">+	if(sel-&gt;isfloating || (lt-&gt;arrange == floating))
</a> 		XRaiseWindow(dpy, sel-&gt;win);
<a href="#h1-41-16" id="h1-41-16" class="d">-	if(v-&gt;layout-&gt;arrange != floating) {
</a><a href="#h1-41-17" id="h1-41-17" class="i">+	if(lt-&gt;arrange != floating) {
</a> 		wc.stack_mode = Below;
<a href="#h1-41-19" id="h1-41-19" class="d">-		wc.sibling = v-&gt;barwin;
</a><a href="#h1-41-20" id="h1-41-20" class="i">+		wc.sibling = barwin;
</a> 		if(!sel-&gt;isfloating) {
 			XConfigureWindow(dpy, sel-&gt;win, CWSibling|CWStackMode, &amp;wc);
 			wc.sibling = sel-&gt;win;
 		}
<a href="#h1-41-25" id="h1-41-25" class="d">-		for(c = nexttiled(clients, v); c; c = nexttiled(c-&gt;next, v)) {
</a><a href="#h1-41-26" id="h1-41-26" class="i">+		for(c = nexttiled(clients); c; c = nexttiled(c-&gt;next)) {
</a> 			if(c == sel)
 				continue;
 			XConfigureWindow(dpy, c-&gt;win, CWSibling|CWStackMode, &amp;wc);
<a href="#h1-42" id="h1-42" class="h">@@ -1428,7 +1356,7 @@ run(void) {
</a> 					}
 				break;
 			}
<a href="#h1-42-3" id="h1-42-3" class="d">-			drawbar(selview);
</a><a href="#h1-42-4" id="h1-42-4" class="i">+			drawbar();
</a> 		}
 		while(XPending(dpy)) {
 			XNextEvent(dpy, &amp;ev);
<a href="#h1-43" id="h1-43" class="h">@@ -1476,56 +1404,60 @@ setclientstate(Client *c, long state) {
</a> void
 setlayout(const char *arg) {
 	unsigned int i;
<a href="#h1-43-3" id="h1-43-3" class="d">-	View *v = selview;
</a> 
 	if(!arg) {
<a href="#h1-43-6" id="h1-43-6" class="d">-		v-&gt;layout++;
</a><a href="#h1-43-7" id="h1-43-7" class="d">-		if(v-&gt;layout == &amp;layouts[LENGTH(layouts)])
</a><a href="#h1-43-8" id="h1-43-8" class="d">-			v-&gt;layout = &amp;layouts[0];
</a><a href="#h1-43-9" id="h1-43-9" class="i">+		lt++;
</a><a href="#h1-43-10" id="h1-43-10" class="i">+		if(lt == &amp;layouts[LENGTH(layouts)])
</a><a href="#h1-43-11" id="h1-43-11" class="i">+			lt = &amp;layouts[0];
</a> 	}
 	else {
 		for(i = 0; i &lt; LENGTH(layouts); i++)
<a href="#h1-43-15" id="h1-43-15" class="d">-			if(!strcmp(arg, layouts[i].symbol))
</a><a href="#h1-43-16" id="h1-43-16" class="i">+			if(arg == layouts[i].symbol)
</a> 				break;
 		if(i == LENGTH(layouts))
 			return;
<a href="#h1-43-20" id="h1-43-20" class="d">-		v-&gt;layout = &amp;layouts[i];
</a><a href="#h1-43-21" id="h1-43-21" class="i">+		lt = &amp;layouts[i];
</a> 	}
 	if(sel)
 		arrange();
 	else
<a href="#h1-43-26" id="h1-43-26" class="d">-		drawbar(selview);
</a><a href="#h1-43-27" id="h1-43-27" class="i">+		drawbar();
</a> }
 
 void
 setmwfact(const char *arg) {
 	double delta;
<a href="#h1-43-33" id="h1-43-33" class="d">-	View *v = selview;
</a> 
 	if(!domwfact)
 		return;
 	/* arg handling, manipulate mwfact */
 	if(arg == NULL)
<a href="#h1-43-39" id="h1-43-39" class="d">-		v-&gt;mwfact = MWFACT;
</a><a href="#h1-43-40" id="h1-43-40" class="i">+		mwfact = MWFACT;
</a> 	else if(sscanf(arg, &quot;%lf&quot;, &amp;delta) == 1) {
 		if(arg[0] == &#39;+&#39; || arg[0] == &#39;-&#39;)
<a href="#h1-43-43" id="h1-43-43" class="d">-			v-&gt;mwfact += delta;
</a><a href="#h1-43-44" id="h1-43-44" class="i">+			mwfact += delta;
</a> 		else
<a href="#h1-43-46" id="h1-43-46" class="d">-			v-&gt;mwfact = delta;
</a><a href="#h1-43-47" id="h1-43-47" class="d">-		if(v-&gt;mwfact &lt; 0.1)
</a><a href="#h1-43-48" id="h1-43-48" class="d">-			v-&gt;mwfact = 0.1;
</a><a href="#h1-43-49" id="h1-43-49" class="d">-		else if(v-&gt;mwfact &gt; 0.9)
</a><a href="#h1-43-50" id="h1-43-50" class="d">-			v-&gt;mwfact = 0.9;
</a><a href="#h1-43-51" id="h1-43-51" class="i">+			mwfact = delta;
</a><a href="#h1-43-52" id="h1-43-52" class="i">+		if(mwfact &lt; 0.1)
</a><a href="#h1-43-53" id="h1-43-53" class="i">+			mwfact = 0.1;
</a><a href="#h1-43-54" id="h1-43-54" class="i">+		else if(mwfact &gt; 0.9)
</a><a href="#h1-43-55" id="h1-43-55" class="i">+			mwfact = 0.9;
</a> 	}
 	arrange();
 }
 
 void
 setup(void) {
<a href="#h1-43-62" id="h1-43-62" class="d">-	unsigned int i, j;
</a><a href="#h1-43-63" id="h1-43-63" class="d">-	View *v;
</a><a href="#h1-43-64" id="h1-43-64" class="i">+	unsigned int i;
</a> 	XSetWindowAttributes wa;
<a href="#h1-43-66" id="h1-43-66" class="d">-	XineramaScreenInfo *info = NULL;
</a><a href="#h1-43-67" id="h1-43-67" class="i">+
</a><a href="#h1-43-68" id="h1-43-68" class="i">+	/* init screen */
</a><a href="#h1-43-69" id="h1-43-69" class="i">+	screen = DefaultScreen(dpy);
</a><a href="#h1-43-70" id="h1-43-70" class="i">+	root = RootWindow(dpy, screen);
</a><a href="#h1-43-71" id="h1-43-71" class="i">+	sx = 0;
</a><a href="#h1-43-72" id="h1-43-72" class="i">+	sy = 0;
</a><a href="#h1-43-73" id="h1-43-73" class="i">+	sw = DisplayWidth(dpy, screen);
</a><a href="#h1-43-74" id="h1-43-74" class="i">+	sh = DisplayHeight(dpy, screen);
</a> 
 	/* init atoms */
 	wmatom[WMProtocols] = XInternAtom(dpy, &quot;WM_PROTOCOLS&quot;, False);
<a href="#h1-44" id="h1-44" class="h">@@ -1540,16 +1472,10 @@ setup(void) {
</a> 	cursor[CurResize] = XCreateFontCursor(dpy, XC_sizing);
 	cursor[CurMove] = XCreateFontCursor(dpy, XC_fleur);
 
<a href="#h1-44-3" id="h1-44-3" class="i">+#ifdef XINERAMA
</a> 	if(XineramaIsActive(dpy))
<a href="#h1-44-5" id="h1-44-5" class="d">-		info = XineramaQueryScreens(dpy, &amp;nviews);
</a><a href="#h1-44-6" id="h1-44-6" class="d">-
</a><a href="#h1-44-7" id="h1-44-7" class="d">-#if defined(AIM_XINERAMA)
</a><a href="#h1-44-8" id="h1-44-8" class="d">-nviews = 2; /* aim Xinerama */
</a><a href="#h1-44-9" id="h1-44-9" class="i">+		info = XineramaQueryScreens(dpy, &amp;xscreens);
</a> #endif
<a href="#h1-44-11" id="h1-44-11" class="d">-	views = emallocz(nviews * sizeof(View));
</a><a href="#h1-44-12" id="h1-44-12" class="d">-
</a><a href="#h1-44-13" id="h1-44-13" class="d">-	screen = DefaultScreen(dpy);
</a><a href="#h1-44-14" id="h1-44-14" class="d">-	root = RootWindow(dpy, screen);
</a> 
 	/* init appearance */
 	dc.norm[ColBorder] = getcolor(NORMBORDERCOLOR);
<a href="#h1-45" id="h1-45" class="h">@@ -1566,85 +1492,47 @@ nviews = 2; /* aim Xinerama */
</a> 	if(!dc.font.set)
 		XSetFont(dpy, dc.gc, dc.font.xfont-&gt;fid);
 
<a href="#h1-45-3" id="h1-45-3" class="i">+	/* init tags */
</a><a href="#h1-45-4" id="h1-45-4" class="i">+	seltags = emallocz(TAGSZ);
</a><a href="#h1-45-5" id="h1-45-5" class="i">+	prevtags = emallocz(TAGSZ);
</a><a href="#h1-45-6" id="h1-45-6" class="i">+	seltags[0] = prevtags[0] = True;
</a><a href="#h1-45-7" id="h1-45-7" class="i">+
</a><a href="#h1-45-8" id="h1-45-8" class="i">+	/* init layouts */
</a><a href="#h1-45-9" id="h1-45-9" class="i">+	mwfact = MWFACT;
</a><a href="#h1-45-10" id="h1-45-10" class="i">+	lt = &amp;layouts[0];
</a><a href="#h1-45-11" id="h1-45-11" class="i">+
</a><a href="#h1-45-12" id="h1-45-12" class="i">+	/* TODO: Xinerama hints ? */
</a><a href="#h1-45-13" id="h1-45-13" class="i">+	/* init bar */
</a> 	for(blw = i = 0; i &lt; LENGTH(layouts); i++) {
 		i = textw(layouts[i].symbol);
 		if(i &gt; blw)
 			blw = i;
 	}
 
<a href="#h1-45-20" id="h1-45-20" class="d">-	seltags = emallocz(TAGSZ);
</a><a href="#h1-45-21" id="h1-45-21" class="d">-	prevtags = emallocz(TAGSZ);
</a><a href="#h1-45-22" id="h1-45-22" class="i">+	bpos = BARPOS;
</a><a href="#h1-45-23" id="h1-45-23" class="i">+	wa.override_redirect = 1;
</a><a href="#h1-45-24" id="h1-45-24" class="i">+	wa.background_pixmap = ParentRelative;
</a><a href="#h1-45-25" id="h1-45-25" class="i">+	wa.event_mask = ButtonPressMask|ExposureMask;
</a> 
<a href="#h1-45-27" id="h1-45-27" class="d">-	/* check, if vtags need assistance, because there is only 1 view */
</a><a href="#h1-45-28" id="h1-45-28" class="d">-	if(nviews == 1)
</a><a href="#h1-45-29" id="h1-45-29" class="d">-		for(i = 0; i &lt; LENGTH(tags); i++)
</a><a href="#h1-45-30" id="h1-45-30" class="d">-			vtags[i] = 0;
</a><a href="#h1-45-31" id="h1-45-31" class="d">-
</a><a href="#h1-45-32" id="h1-45-32" class="d">-	for(i = 0; i &lt; nviews; i++) {
</a><a href="#h1-45-33" id="h1-45-33" class="d">-		/* init geometry */
</a><a href="#h1-45-34" id="h1-45-34" class="d">-		v = &amp;views[i];
</a><a href="#h1-45-35" id="h1-45-35" class="d">-		v-&gt;id = i;
</a><a href="#h1-45-36" id="h1-45-36" class="d">-
</a><a href="#h1-45-37" id="h1-45-37" class="d">-		/* select first tag of view */
</a><a href="#h1-45-38" id="h1-45-38" class="d">-		j = firstag(v);
</a><a href="#h1-45-39" id="h1-45-39" class="d">-		seltags[j] = prevtags[j] = True; 
</a><a href="#h1-45-40" id="h1-45-40" class="d">-
</a><a href="#h1-45-41" id="h1-45-41" class="d">-		if(info) {
</a><a href="#h1-45-42" id="h1-45-42" class="d">-
</a><a href="#h1-45-43" id="h1-45-43" class="d">-#if defined(AIM_XINERAMA)
</a><a href="#h1-45-44" id="h1-45-44" class="d">-v-&gt;w = DisplayWidth(dpy, screen) / 2;
</a><a href="#h1-45-45" id="h1-45-45" class="d">-v-&gt;x = (i == 0) ? 0 : v-&gt;w;
</a><a href="#h1-45-46" id="h1-45-46" class="d">-v-&gt;y = 0;
</a><a href="#h1-45-47" id="h1-45-47" class="d">-v-&gt;h = DisplayHeight(dpy, screen);
</a><a href="#h1-45-48" id="h1-45-48" class="d">-#else
</a><a href="#h1-45-49" id="h1-45-49" class="d">-			v-&gt;x = info[i].x_org;
</a><a href="#h1-45-50" id="h1-45-50" class="d">-			v-&gt;y = info[i].y_org;
</a><a href="#h1-45-51" id="h1-45-51" class="d">-			v-&gt;w = info[i].width;
</a><a href="#h1-45-52" id="h1-45-52" class="d">-			v-&gt;h = info[i].height;
</a><a href="#h1-45-53" id="h1-45-53" class="d">-#endif
</a><a href="#h1-45-54" id="h1-45-54" class="d">-		}
</a><a href="#h1-45-55" id="h1-45-55" class="d">-		else {
</a><a href="#h1-45-56" id="h1-45-56" class="d">-			v-&gt;x = 0;
</a><a href="#h1-45-57" id="h1-45-57" class="d">-			v-&gt;y = 0;
</a><a href="#h1-45-58" id="h1-45-58" class="d">-			v-&gt;w = DisplayWidth(dpy, screen);
</a><a href="#h1-45-59" id="h1-45-59" class="d">-			v-&gt;h = DisplayHeight(dpy, screen);
</a><a href="#h1-45-60" id="h1-45-60" class="d">-		}
</a><a href="#h1-45-61" id="h1-45-61" class="d">-
</a><a href="#h1-45-62" id="h1-45-62" class="d">-		/* init layouts */
</a><a href="#h1-45-63" id="h1-45-63" class="d">-		v-&gt;mwfact = MWFACT;
</a><a href="#h1-45-64" id="h1-45-64" class="d">-		v-&gt;layout = &amp;layouts[0];
</a><a href="#h1-45-65" id="h1-45-65" class="i">+	barwin = XCreateWindow(dpy, root, sx, sy, sw, bh, 0, DefaultDepth(dpy, screen),
</a><a href="#h1-45-66" id="h1-45-66" class="i">+				CopyFromParent, DefaultVisual(dpy, screen),
</a><a href="#h1-45-67" id="h1-45-67" class="i">+				CWOverrideRedirect|CWBackPixmap|CWEventMask, &amp;wa);
</a><a href="#h1-45-68" id="h1-45-68" class="i">+	XDefineCursor(dpy, barwin, cursor[CurNormal]);
</a><a href="#h1-45-69" id="h1-45-69" class="i">+	updatebarpos();
</a><a href="#h1-45-70" id="h1-45-70" class="i">+	XMapRaised(dpy, barwin);
</a><a href="#h1-45-71" id="h1-45-71" class="i">+	strcpy(stext, &quot;dwm-&quot;VERSION);
</a><a href="#h1-45-72" id="h1-45-72" class="i">+	drawbar();
</a> 
<a href="#h1-45-74" id="h1-45-74" class="d">-		// TODO: bpos per screen?
</a><a href="#h1-45-75" id="h1-45-75" class="d">-		bpos = BARPOS;
</a><a href="#h1-45-76" id="h1-45-76" class="d">-		wa.override_redirect = 1;
</a><a href="#h1-45-77" id="h1-45-77" class="d">-		wa.background_pixmap = ParentRelative;
</a><a href="#h1-45-78" id="h1-45-78" class="d">-		wa.event_mask = ButtonPressMask|ExposureMask;
</a><a href="#h1-45-79" id="h1-45-79" class="i">+	/* EWMH support per view */
</a><a href="#h1-45-80" id="h1-45-80" class="i">+	XChangeProperty(dpy, root, netatom[NetSupported], XA_ATOM, 32,
</a><a href="#h1-45-81" id="h1-45-81" class="i">+			PropModeReplace, (unsigned char *) netatom, NetLast);
</a> 
<a href="#h1-45-83" id="h1-45-83" class="d">-		/* init bars */
</a><a href="#h1-45-84" id="h1-45-84" class="d">-		v-&gt;barwin = XCreateWindow(dpy, root, v-&gt;x, v-&gt;y, v-&gt;w, bh, 0,
</a><a href="#h1-45-85" id="h1-45-85" class="d">-				DefaultDepth(dpy, screen), CopyFromParent, DefaultVisual(dpy, screen),
</a><a href="#h1-45-86" id="h1-45-86" class="d">-				CWOverrideRedirect|CWBackPixmap|CWEventMask, &amp;wa);
</a><a href="#h1-45-87" id="h1-45-87" class="d">-		XDefineCursor(dpy, v-&gt;barwin, cursor[CurNormal]);
</a><a href="#h1-45-88" id="h1-45-88" class="d">-		updatebarpos(v);
</a><a href="#h1-45-89" id="h1-45-89" class="d">-		XMapRaised(dpy, v-&gt;barwin);
</a><a href="#h1-45-90" id="h1-45-90" class="d">-		strcpy(stext, &quot;dwm-&quot;VERSION);
</a><a href="#h1-45-91" id="h1-45-91" class="d">-
</a><a href="#h1-45-92" id="h1-45-92" class="d">-		/* EWMH support per view */
</a><a href="#h1-45-93" id="h1-45-93" class="d">-		XChangeProperty(dpy, root, netatom[NetSupported], XA_ATOM, 32,
</a><a href="#h1-45-94" id="h1-45-94" class="d">-				PropModeReplace, (unsigned char *) netatom, NetLast);
</a><a href="#h1-45-95" id="h1-45-95" class="d">-
</a><a href="#h1-45-96" id="h1-45-96" class="d">-		/* select for events */
</a><a href="#h1-45-97" id="h1-45-97" class="d">-		wa.event_mask = SubstructureRedirectMask|SubstructureNotifyMask
</a><a href="#h1-45-98" id="h1-45-98" class="d">-				|EnterWindowMask|LeaveWindowMask|StructureNotifyMask;
</a><a href="#h1-45-99" id="h1-45-99" class="d">-		XChangeWindowAttributes(dpy, root, CWEventMask|CWCursor, &amp;wa);
</a><a href="#h1-45-100" id="h1-45-100" class="d">-		XSelectInput(dpy, root, wa.event_mask);
</a><a href="#h1-45-101" id="h1-45-101" class="d">-
</a><a href="#h1-45-102" id="h1-45-102" class="d">-		drawbar(v);
</a><a href="#h1-45-103" id="h1-45-103" class="d">-	}
</a><a href="#h1-45-104" id="h1-45-104" class="d">-	if(info)
</a><a href="#h1-45-105" id="h1-45-105" class="d">-		XFree(info);
</a><a href="#h1-45-106" id="h1-45-106" class="i">+	/* select for events */
</a><a href="#h1-45-107" id="h1-45-107" class="i">+	wa.event_mask = SubstructureRedirectMask|SubstructureNotifyMask
</a><a href="#h1-45-108" id="h1-45-108" class="i">+			|EnterWindowMask|LeaveWindowMask|StructureNotifyMask;
</a><a href="#h1-45-109" id="h1-45-109" class="i">+	XChangeWindowAttributes(dpy, root, CWEventMask|CWCursor, &amp;wa);
</a><a href="#h1-45-110" id="h1-45-110" class="i">+	XSelectInput(dpy, root, wa.event_mask);
</a> 
<a href="#h1-45-112" id="h1-45-112" class="d">-	selview = viewat();
</a> 
 	/* grab keys */
 	grabkeys();
<a href="#h1-46" id="h1-46" class="h">@@ -1681,10 +1569,8 @@ tag(const char *arg) {
</a> 	if(!sel)
 		return;
 	for(i = 0; i &lt; LENGTH(tags); i++)
<a href="#h1-46-3" id="h1-46-3" class="d">-		sel-&gt;tags[i] = (NULL == arg) &amp;&amp; (vtags[i] == getview(sel)-&gt;id);
</a><a href="#h1-46-4" id="h1-46-4" class="d">-	i = idxoftag(arg);
</a><a href="#h1-46-5" id="h1-46-5" class="d">-	if(!conflicts(sel, i))
</a><a href="#h1-46-6" id="h1-46-6" class="d">-		sel-&gt;tags[idxoftag(arg)] = True;
</a><a href="#h1-46-7" id="h1-46-7" class="i">+		sel-&gt;tags[i] = (NULL == arg);
</a><a href="#h1-46-8" id="h1-46-8" class="i">+	sel-&gt;tags[idxoftag(arg)] = True;
</a> 	arrange();
 }
 
<a href="#h1-47" id="h1-47" class="h">@@ -1705,36 +1591,36 @@ textw(const char *text) {
</a> }
 
 void
<a href="#h1-47-3" id="h1-47-3" class="d">-tile(View *v) {
</a><a href="#h1-47-4" id="h1-47-4" class="i">+tile(void) {
</a> 	unsigned int i, n, nx, ny, nw, nh, mw, th;
 	Client *c, *mc;
 
 	domwfact = dozoom = True;
<a href="#h1-47-9" id="h1-47-9" class="d">-	nx = v-&gt;wax;
</a><a href="#h1-47-10" id="h1-47-10" class="d">-	ny = v-&gt;way;
</a><a href="#h1-47-11" id="h1-47-11" class="i">+	nx = wax;
</a><a href="#h1-47-12" id="h1-47-12" class="i">+	ny = way;
</a> 	nw = 0;
<a href="#h1-47-14" id="h1-47-14" class="d">-	for(n = 0, c = nexttiled(clients, v); c; c = nexttiled(c-&gt;next, v))
</a><a href="#h1-47-15" id="h1-47-15" class="i">+	for(n = 0, c = nexttiled(clients); c; c = nexttiled(c-&gt;next))
</a> 		n++;
 
 	/* window geoms */
<a href="#h1-47-19" id="h1-47-19" class="d">-	mw = (n == 1) ? v-&gt;waw : v-&gt;mwfact * v-&gt;waw;
</a><a href="#h1-47-20" id="h1-47-20" class="d">-	th = (n &gt; 1) ? v-&gt;wah / (n - 1) : 0;
</a><a href="#h1-47-21" id="h1-47-21" class="i">+	mw = (n == 1) ? waw : mwfact * waw;
</a><a href="#h1-47-22" id="h1-47-22" class="i">+	th = (n &gt; 1) ? wah / (n - 1) : 0;
</a> 	if(n &gt; 1 &amp;&amp; th &lt; bh)
<a href="#h1-47-24" id="h1-47-24" class="d">-		th = v-&gt;wah;
</a><a href="#h1-47-25" id="h1-47-25" class="i">+		th = wah;
</a> 
<a href="#h1-47-27" id="h1-47-27" class="d">-	for(i = 0, c = mc = nexttiled(clients, v); c; c = nexttiled(c-&gt;next, v)) {
</a><a href="#h1-47-28" id="h1-47-28" class="i">+	for(i = 0, c = mc = nexttiled(clients); c; c = nexttiled(c-&gt;next)) {
</a> 		if(i == 0) { /* master */
 			nw = mw - 2 * c-&gt;border;
<a href="#h1-47-31" id="h1-47-31" class="d">-			nh = v-&gt;wah - 2 * c-&gt;border;
</a><a href="#h1-47-32" id="h1-47-32" class="i">+			nh = wah - 2 * c-&gt;border;
</a> 		}
 		else {  /* tile window */
 			if(i == 1) {
<a href="#h1-47-36" id="h1-47-36" class="d">-				ny = v-&gt;way;
</a><a href="#h1-47-37" id="h1-47-37" class="i">+				ny = way;
</a> 				nx += mc-&gt;w + 2 * mc-&gt;border;
<a href="#h1-47-39" id="h1-47-39" class="d">-				nw = v-&gt;waw - mw - 2 * c-&gt;border;
</a><a href="#h1-47-40" id="h1-47-40" class="i">+				nw = waw - mw - 2 * c-&gt;border;
</a> 			}
 			if(i + 1 == n) /* remainder */
<a href="#h1-47-43" id="h1-47-43" class="d">-				nh = (v-&gt;way + v-&gt;wah) - ny - 2 * c-&gt;border;
</a><a href="#h1-47-44" id="h1-47-44" class="i">+				nh = (way + wah) - ny - 2 * c-&gt;border;
</a> 			else
 				nh = th - 2 * c-&gt;border;
 		}
<a href="#h1-48" id="h1-48" class="h">@@ -1742,7 +1628,7 @@ tile(View *v) {
</a> 		if((RESIZEHINTS) &amp;&amp; ((c-&gt;h &lt; bh) || (c-&gt;h &gt; nh) || (c-&gt;w &lt; bh) || (c-&gt;w &gt; nw)))
 			/* client doesn&#39;t accept size constraints */
 			resize(c, nx, ny, nw, nh, False);
<a href="#h1-48-3" id="h1-48-3" class="d">-		if(n &gt; 1 &amp;&amp; th != v-&gt;wah)
</a><a href="#h1-48-4" id="h1-48-4" class="i">+		if(n &gt; 1 &amp;&amp; th != wah)
</a> 			ny = c-&gt;y + c-&gt;h + 2 * c-&gt;border;
 		i++;
 	}
<a href="#h1-49" id="h1-49" class="h">@@ -1754,7 +1640,7 @@ togglebar(const char *arg) {
</a> 		bpos = (BARPOS == BarOff) ? BarTop : BARPOS;
 	else
 		bpos = BarOff;
<a href="#h1-49-3" id="h1-49-3" class="d">-	updatebarpos(selview);
</a><a href="#h1-49-4" id="h1-49-4" class="i">+	updatebarpos();
</a> 	arrange();
 }
 
<a href="#h1-50" id="h1-50" class="h">@@ -1837,25 +1723,25 @@ unmapnotify(XEvent *e) {
</a> }
 
 void
<a href="#h1-50-3" id="h1-50-3" class="d">-updatebarpos(View *v) {
</a><a href="#h1-50-4" id="h1-50-4" class="i">+updatebarpos(void) {
</a> 	XEvent ev;
 
<a href="#h1-50-7" id="h1-50-7" class="d">-	v-&gt;wax = v-&gt;x;
</a><a href="#h1-50-8" id="h1-50-8" class="d">-	v-&gt;way = v-&gt;y;
</a><a href="#h1-50-9" id="h1-50-9" class="d">-	v-&gt;wah = v-&gt;h;
</a><a href="#h1-50-10" id="h1-50-10" class="d">-	v-&gt;waw = v-&gt;w;
</a><a href="#h1-50-11" id="h1-50-11" class="i">+	wax = sx;
</a><a href="#h1-50-12" id="h1-50-12" class="i">+	way = sy;
</a><a href="#h1-50-13" id="h1-50-13" class="i">+	wah = sh;
</a><a href="#h1-50-14" id="h1-50-14" class="i">+	waw = sw;
</a> 	switch(bpos) {
 	default:
<a href="#h1-50-17" id="h1-50-17" class="d">-		v-&gt;wah -= bh;
</a><a href="#h1-50-18" id="h1-50-18" class="d">-		v-&gt;way += bh;
</a><a href="#h1-50-19" id="h1-50-19" class="d">-		XMoveWindow(dpy, v-&gt;barwin, v-&gt;x, v-&gt;y);
</a><a href="#h1-50-20" id="h1-50-20" class="i">+		wah -= bh;
</a><a href="#h1-50-21" id="h1-50-21" class="i">+		way += bh;
</a><a href="#h1-50-22" id="h1-50-22" class="i">+		XMoveWindow(dpy, barwin, sx, sy);
</a> 		break;
 	case BarBot:
<a href="#h1-50-25" id="h1-50-25" class="d">-		v-&gt;wah -= bh;
</a><a href="#h1-50-26" id="h1-50-26" class="d">-		XMoveWindow(dpy, v-&gt;barwin, v-&gt;x, v-&gt;y + v-&gt;wah);
</a><a href="#h1-50-27" id="h1-50-27" class="i">+		wah -= bh;
</a><a href="#h1-50-28" id="h1-50-28" class="i">+		XMoveWindow(dpy, barwin, sx, sy + wah);
</a> 		break;
 	case BarOff:
<a href="#h1-50-31" id="h1-50-31" class="d">-		XMoveWindow(dpy, v-&gt;barwin, v-&gt;x, v-&gt;y - bh);
</a><a href="#h1-50-32" id="h1-50-32" class="i">+		XMoveWindow(dpy, barwin, sx, sy - bh);
</a> 		break;
 	}
 	XSync(dpy, False);
<a href="#h1-51" id="h1-51" class="h">@@ -1930,32 +1816,15 @@ updatewmhints(Client *c) {
</a> 	}
 }
 
<a href="#h1-51-3" id="h1-51-3" class="i">+
</a> void
 view(const char *arg) {
<a href="#h1-51-6" id="h1-51-6" class="d">-	unsigned int i, j;
</a><a href="#h1-51-7" id="h1-51-7" class="d">-	Bool tmp[LENGTH(tags)];
</a><a href="#h1-51-8" id="h1-51-8" class="i">+	unsigned int i;
</a><a href="#h1-51-9" id="h1-51-9" class="i">+
</a><a href="#h1-51-10" id="h1-51-10" class="i">+	for(i = 0; i &lt; LENGTH(tags); i++)
</a><a href="#h1-51-11" id="h1-51-11" class="i">+		tmp[i] = (NULL == arg);
</a><a href="#h1-51-12" id="h1-51-12" class="i">+	tmp[idxoftag(arg)] = True;
</a> 
<a href="#h1-51-14" id="h1-51-14" class="d">-	memcpy(tmp, seltags, TAGSZ);
</a><a href="#h1-51-15" id="h1-51-15" class="d">-	if(arg == NULL) {
</a><a href="#h1-51-16" id="h1-51-16" class="d">-		for(i = 0; i &lt; LENGTH(tags); i++)
</a><a href="#h1-51-17" id="h1-51-17" class="d">-			tmp[i] = (vtags[i] == selview-&gt;id);
</a><a href="#h1-51-18" id="h1-51-18" class="d">-	}
</a><a href="#h1-51-19" id="h1-51-19" class="d">-	else {
</a><a href="#h1-51-20" id="h1-51-20" class="d">-		i = idxoftag(arg);
</a><a href="#h1-51-21" id="h1-51-21" class="d">-		for(j = 0; j &lt; LENGTH(tags); j++)
</a><a href="#h1-51-22" id="h1-51-22" class="d">-			if(selview-&gt;id == vtags[i]) {
</a><a href="#h1-51-23" id="h1-51-23" class="d">-				/* view tag of selview */
</a><a href="#h1-51-24" id="h1-51-24" class="d">-				if(selview-&gt;id == vtags[j])
</a><a href="#h1-51-25" id="h1-51-25" class="d">-					tmp[j] = False;
</a><a href="#h1-51-26" id="h1-51-26" class="d">-			}
</a><a href="#h1-51-27" id="h1-51-27" class="d">-			else {
</a><a href="#h1-51-28" id="h1-51-28" class="d">-				/* only touch the view the focus should go */
</a><a href="#h1-51-29" id="h1-51-29" class="d">-				if(vtags[j] == vtags[i])
</a><a href="#h1-51-30" id="h1-51-30" class="d">-					tmp[j] = False;
</a><a href="#h1-51-31" id="h1-51-31" class="d">-			}
</a><a href="#h1-51-32" id="h1-51-32" class="d">-		selview = &amp;views[vtags[i]];
</a><a href="#h1-51-33" id="h1-51-33" class="d">-		tmp[i] = True;
</a><a href="#h1-51-34" id="h1-51-34" class="d">-	}
</a> 	if(memcmp(seltags, tmp, TAGSZ) != 0) {
 		memcpy(prevtags, seltags, TAGSZ);
 		memcpy(seltags, tmp, TAGSZ);
<a href="#h1-52" id="h1-52" class="h">@@ -1963,24 +1832,8 @@ view(const char *arg) {
</a> 	}
 }
 
<a href="#h1-52-3" id="h1-52-3" class="d">-View *
</a><a href="#h1-52-4" id="h1-52-4" class="d">-viewat() {
</a><a href="#h1-52-5" id="h1-52-5" class="d">-	int i, x, y;
</a><a href="#h1-52-6" id="h1-52-6" class="d">-	Window win;
</a><a href="#h1-52-7" id="h1-52-7" class="d">-	unsigned int mask;
</a><a href="#h1-52-8" id="h1-52-8" class="d">-
</a><a href="#h1-52-9" id="h1-52-9" class="d">-	XQueryPointer(dpy, root, &amp;win, &amp;win, &amp;x, &amp;y, &amp;i, &amp;i, &amp;mask);
</a><a href="#h1-52-10" id="h1-52-10" class="d">-	for(i = 0; i &lt; nviews; i++) {
</a><a href="#h1-52-11" id="h1-52-11" class="d">-		if((x &gt;= views[i].x &amp;&amp; x &lt; views[i].x + views[i].w)
</a><a href="#h1-52-12" id="h1-52-12" class="d">-		&amp;&amp; (y &gt;= views[i].y &amp;&amp; y &lt; views[i].y + views[i].h))
</a><a href="#h1-52-13" id="h1-52-13" class="d">-			return &amp;views[i];
</a><a href="#h1-52-14" id="h1-52-14" class="d">-	}
</a><a href="#h1-52-15" id="h1-52-15" class="d">-	return NULL;
</a><a href="#h1-52-16" id="h1-52-16" class="d">-}
</a><a href="#h1-52-17" id="h1-52-17" class="d">-
</a> void
 viewprevtag(const char *arg) {
<a href="#h1-52-20" id="h1-52-20" class="d">-	static Bool tmp[LENGTH(tags)];
</a> 
 	memcpy(tmp, seltags, TAGSZ);
 	memcpy(seltags, prevtags, TAGSZ);
<a href="#h1-53" id="h1-53" class="h">@@ -2026,8 +1879,8 @@ zoom(const char *arg) {
</a> 
 	if(!sel || !dozoom || sel-&gt;isfloating)
 		return;
<a href="#h1-53-3" id="h1-53-3" class="d">-	if(c == nexttiled(clients, getview(c)))
</a><a href="#h1-53-4" id="h1-53-4" class="d">-		if(!(c = nexttiled(c-&gt;next, getview(c))))
</a><a href="#h1-53-5" id="h1-53-5" class="i">+	if(c == nexttiled(clients))
</a><a href="#h1-53-6" id="h1-53-6" class="i">+		if(!(c = nexttiled(c-&gt;next)))
</a> 			return;
 	detach(c);
 	attach(c);
</pre>
</div>
</body>
</html>
