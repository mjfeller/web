<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>fififi - dwm - dynamic window manager
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="dwm Atom Feed" href="../atom.xml" />
<link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="/logo.png" alt="" width="32" height="32" /></a></td><td><h1>dwm</h1><span class="desc">dynamic window manager
</span></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/10d13f01ff764ba0e875adf5d2b83c49aa08d148.html">10d13f01ff764ba0e875adf5d2b83c49aa08d148</a>
<b>parent</b> <a href="../commit/8fcc4ff0ae2b20f9605370cee02ebcda50f8777c.html">8fcc4ff0ae2b20f9605370cee02ebcda50f8777c</a>
<b>Author:</b> Anselm R. Garbe &lt;<a href="mailto:garbeam@gmail.com">garbeam@gmail.com</a>&gt;
<b>Date:</b>   Wed, 15 Aug 2007 19:27:32 +0200

fififi
<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">Makefile</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">client.c</a></td><td> | </td><td class="num">14</td><td><span class="i">++</span><span class="d">------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">dwm.h</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">event.c</a></td><td> | </td><td class="num">5</td><td><span class="i">+++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">main.c</a></td><td> | </td><td class="num">7</td><td><span class="i">++++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">tag.c</a></td><td> | </td><td class="num">31</td><td><span class="i">++++++++++++++++++++++</span><span class="d">---------</span></td></tr>
</table></pre><pre>6 files changed, 35 insertions(+), 30 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/Makefile.html">Makefile</a> b/<a href="../file/Makefile.html">Makefile</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -36,7 +36,7 @@ dist: clean
</a> 	@echo creating dist tarball
 	@mkdir -p dwm-${VERSION}
 	@cp -R LICENSE Makefile README config.*.h config.mk \
<a href="#h0-0-3" id="h0-0-3" class="d">-		dwm.1 dwm.h ${SRC} dwm-${VERSION}
</a><a href="#h0-0-4" id="h0-0-4" class="i">+		dwm.1 dwm.h tile.h ${SRC} dwm-${VERSION}
</a> 	@tar -cf dwm-${VERSION}.tar dwm-${VERSION}
 	@gzip dwm-${VERSION}.tar
 	@rm -rf dwm-${VERSION}
<b>diff --git a/<a id="h1" href="../file/client.c.html">client.c</a> b/<a href="../file/client.c.html">client.c</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -297,16 +297,6 @@ resize(Client *c, int x, int y, int w, int h, Bool sizehints) {
</a> }
 
 void
<a href="#h1-0-3" id="h1-0-3" class="d">-togglefloating(const char *arg) {
</a><a href="#h1-0-4" id="h1-0-4" class="d">-	if(!sel || isfloating())
</a><a href="#h1-0-5" id="h1-0-5" class="d">-		return;
</a><a href="#h1-0-6" id="h1-0-6" class="d">-	sel-&gt;isfloating = !sel-&gt;isfloating;
</a><a href="#h1-0-7" id="h1-0-7" class="d">-	if(sel-&gt;isfloating)
</a><a href="#h1-0-8" id="h1-0-8" class="d">-		resize(sel, sel-&gt;x, sel-&gt;y, sel-&gt;w, sel-&gt;h, True);
</a><a href="#h1-0-9" id="h1-0-9" class="d">-	arrange();
</a><a href="#h1-0-10" id="h1-0-10" class="d">-}
</a><a href="#h1-0-11" id="h1-0-11" class="d">-
</a><a href="#h1-0-12" id="h1-0-12" class="d">-void
</a> unban(Client *c) {
 	if(!c-&gt;isbanned)
 		return;
<a href="#h1-1" id="h1-1" class="h">@@ -316,7 +306,7 @@ unban(Client *c) {
</a> }
 
 void
<a href="#h1-1-3" id="h1-1-3" class="d">-unmanage(Client *c) {
</a><a href="#h1-1-4" id="h1-1-4" class="i">+unmanage(Client *c, long state) {
</a> 	XWindowChanges wc;
 
 	wc.border_width = c-&gt;oldborder;
<a href="#h1-2" id="h1-2" class="h">@@ -329,7 +319,7 @@ unmanage(Client *c) {
</a> 	if(sel == c)
 		focus(NULL);
 	XUngrabButton(dpy, AnyButton, AnyModifier, c-&gt;win);
<a href="#h1-2-3" id="h1-2-3" class="d">-	setclientstate(c, WithdrawnState);
</a><a href="#h1-2-4" id="h1-2-4" class="i">+	setclientstate(c, state);
</a> 	free(c-&gt;tags);
 	free(c);
 	XSync(dpy, False);
<b>diff --git a/<a id="h2" href="../file/dwm.h.html">dwm.h</a> b/<a href="../file/dwm.h.html">dwm.h</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -81,7 +81,7 @@ extern int wax, way, wah, waw;			/* windowarea geometry */
</a> extern unsigned int bh, blw, bpos;		/* bar height, bar layout label width, bar position */
 extern unsigned int ntags, numlockmask;		/* number of tags, numlock mask */
 extern void (*handler[LASTEvent])(XEvent *);	/* event handler */
<a href="#h2-0-3" id="h2-0-3" class="d">-extern Atom dwmtags, wmatom[WMLast], netatom[NetLast];
</a><a href="#h2-0-4" id="h2-0-4" class="i">+extern Atom dwmconfig, wmatom[WMLast], netatom[NetLast];
</a> extern Bool selscreen, *seltag;			/* seltag is array of Bool */
 extern Client *clients, *sel, *stack;		/* global client list and stack */
 extern Cursor cursor[CurLast];
<a href="#h2-1" id="h2-1" class="h">@@ -99,9 +99,8 @@ void killclient(const char *arg);	/* kill sel  nicely */
</a> void manage(Window w, XWindowAttributes *wa);	/* manage new client */
 void resize(Client *c, int x, int y,
 		int w, int h, Bool sizehints);	/* resize with given coordinates c*/
<a href="#h2-1-3" id="h2-1-3" class="d">-void togglefloating(const char *arg);	/* toggles sel between floating/tiled state */
</a> void unban(Client *c);			/* unbans c */
<a href="#h2-1-5" id="h2-1-5" class="d">-void unmanage(Client *c);		/* destroy c */
</a><a href="#h2-1-6" id="h2-1-6" class="i">+void unmanage(Client *c, long state);	/* unmanage c */
</a> void updatesizehints(Client *c);	/* update the size hint variables of c */
 void updatetitle(Client *c);		/* update the name of c */
 
<a href="#h2-2" id="h2-2" class="h">@@ -136,6 +135,7 @@ void compileregs(void);			/* initialize regexps of rules defined in config.h */
</a> Bool isvisible(Client *c);		/* returns True if client is visible */
 void settags(Client *c, Client *trans);	/* sets tags of c */
 void tag(const char *arg);		/* tags sel with arg&#39;s index */
<a href="#h2-2-3" id="h2-2-3" class="i">+void togglefloating(const char *arg);	/* toggles sel between floating/tiled state */
</a> void toggletag(const char *arg);	/* toggles sel tags with arg&#39;s index */
 void toggleview(const char *arg);	/* toggles the tag with arg&#39;s index (in)visible */
 void view(const char *arg);		/* views the tag with arg&#39;s index */
<b>diff --git a/<a id="h3" href="../file/event.c.html">event.c</a> b/<a href="../file/event.c.html">event.c</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -4,6 +4,7 @@
</a> #include &lt;stdlib.h&gt;
 #include &lt;X11/keysym.h&gt;
 #include &lt;X11/Xatom.h&gt;
<a href="#h3-0-3" id="h3-0-3" class="i">+#include &lt;X11/Xutil.h&gt;
</a> 
 /* static */
 
<a href="#h3-1" id="h3-1" class="h">@@ -226,7 +227,7 @@ destroynotify(XEvent *e) {
</a> 	XDestroyWindowEvent *ev = &amp;e-&gt;xdestroywindow;
 
 	if((c = getclient(ev-&gt;window)))
<a href="#h3-1-3" id="h3-1-3" class="d">-		unmanage(c);
</a><a href="#h3-1-4" id="h3-1-4" class="i">+		unmanage(c, WithdrawnState);
</a> }
 
 static void
<a href="#h3-2" id="h3-2" class="h">@@ -338,7 +339,7 @@ unmapnotify(XEvent *e) {
</a> 
 	if((c = getclient(ev-&gt;window)) &amp;&amp; (ev-&gt;event == root)) {
 		if(ev-&gt;send_event || c-&gt;unmapped-- == 0)
<a href="#h3-2-3" id="h3-2-3" class="d">-			unmanage(c);
</a><a href="#h3-2-4" id="h3-2-4" class="i">+			unmanage(c, WithdrawnState);
</a> 	}
 }
 
<b>diff --git a/<a id="h4" href="../file/main.c.html">main.c</a> b/<a href="../file/main.c.html">main.c</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -11,6 +11,7 @@
</a> #include &lt;X11/keysym.h&gt;
 #include &lt;X11/Xatom.h&gt;
 #include &lt;X11/Xproto.h&gt;
<a href="#h4-0-3" id="h4-0-3" class="i">+#include &lt;X11/Xutil.h&gt;
</a> 
 /* extern */
 
<a href="#h4-1" id="h4-1" class="h">@@ -19,7 +20,7 @@ int screen, sx, sy, sw, sh, wax, way, waw, wah;
</a> unsigned int bh, ntags;
 unsigned int bpos = BARPOS;
 unsigned int numlockmask = 0;
<a href="#h4-1-3" id="h4-1-3" class="d">-Atom dwmtags, wmatom[WMLast], netatom[NetLast];
</a><a href="#h4-1-4" id="h4-1-4" class="i">+Atom dwmconfig, wmatom[WMLast], netatom[NetLast];
</a> Bool *seltag;
 Bool selscreen = True;
 Client *clients = NULL;
<a href="#h4-2" id="h4-2" class="h">@@ -41,7 +42,7 @@ cleanup(void) {
</a> 	close(STDIN_FILENO);
 	while(stack) {
 		unban(stack);
<a href="#h4-2-3" id="h4-2-3" class="d">-		unmanage(stack);
</a><a href="#h4-2-4" id="h4-2-4" class="i">+		unmanage(stack, NormalState);
</a> 	}
 	if(dc.font.set)
 		XFreeFontSet(dpy, dc.font.set);
<a href="#h4-3" id="h4-3" class="h">@@ -139,7 +140,7 @@ setup(void) {
</a> 	XSetWindowAttributes wa;
 
 	/* init atoms */
<a href="#h4-3-3" id="h4-3-3" class="d">-	dwmtags = XInternAtom(dpy, &quot;__DWM_TAGS&quot;, False);
</a><a href="#h4-3-4" id="h4-3-4" class="i">+	dwmconfig = XInternAtom(dpy, &quot;_DWM_CONFIG&quot;, False);
</a> 	wmatom[WMProtocols] = XInternAtom(dpy, &quot;WM_PROTOCOLS&quot;, False);
 	wmatom[WMDelete] = XInternAtom(dpy, &quot;WM_DELETE_WINDOW&quot;, False);
 	wmatom[WMState] = XInternAtom(dpy, &quot;WM_STATE&quot;, False);
<b>diff --git a/<a id="h5" href="../file/tag.c.html">tag.c</a> b/<a href="../file/tag.c.html">tag.c</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -28,14 +28,15 @@ static unsigned int nrules = 0;
</a> static char prop[512];
 
 static void
<a href="#h5-0-3" id="h5-0-3" class="d">-persisttags(Client *c)
</a><a href="#h5-0-4" id="h5-0-4" class="d">-{
</a><a href="#h5-0-5" id="h5-0-5" class="i">+persistconfig(Client *c) {
</a> 	unsigned int i;
 
 	for(i = 0; i &lt; ntags &amp;&amp; i &lt; sizeof prop - 1; i++)
<a href="#h5-0-9" id="h5-0-9" class="d">-		prop[i] = c-&gt;tags[i] ? &#39;+&#39; : &#39;-&#39;;
</a><a href="#h5-0-10" id="h5-0-10" class="i">+		prop[i] = c-&gt;tags[i] ? &#39;1&#39; : &#39;0&#39;;
</a><a href="#h5-0-11" id="h5-0-11" class="i">+	if(i &lt; sizeof prop - 1)
</a><a href="#h5-0-12" id="h5-0-12" class="i">+		prop[i++] = c-&gt;isfloating ? &#39;1&#39; : &#39;0&#39;;
</a> 	prop[i] = &#39;\0&#39;;
<a href="#h5-0-14" id="h5-0-14" class="d">-	XChangeProperty(dpy, c-&gt;win, dwmtags, XA_STRING, 8,
</a><a href="#h5-0-15" id="h5-0-15" class="i">+	XChangeProperty(dpy, c-&gt;win, dwmconfig, XA_STRING, 8,
</a> 			PropModeReplace, (unsigned char *)prop, i);
 }
 
<a href="#h5-1" id="h5-1" class="h">@@ -93,14 +94,16 @@ settags(Client *c, Client *trans) {
</a> 	else {
 		/* check if window has set a property */
 		name.nitems = 0;
<a href="#h5-1-3" id="h5-1-3" class="d">-		XGetTextProperty(dpy, c-&gt;win, &amp;name, dwmtags);
</a><a href="#h5-1-4" id="h5-1-4" class="i">+		XGetTextProperty(dpy, c-&gt;win, &amp;name, dwmconfig);
</a> 		if(name.nitems &amp;&amp; name.encoding == XA_STRING) {
 			strncpy(prop, (char *)name.value, sizeof prop - 1);
 			prop[sizeof prop - 1] = &#39;\0&#39;;
 			XFree(name.value);
 			for(i = 0; i &lt; ntags &amp;&amp; i &lt; sizeof prop - 1 &amp;&amp; prop[i] != &#39;\0&#39;; i++)
<a href="#h5-1-10" id="h5-1-10" class="d">-				if((c-&gt;tags[i] = prop[i] == &#39;+&#39;))
</a><a href="#h5-1-11" id="h5-1-11" class="i">+				if((c-&gt;tags[i] = prop[i] == &#39;1&#39;))
</a> 					matched = True;
<a href="#h5-1-13" id="h5-1-13" class="i">+			if(i &lt; sizeof prop - 1 &amp;&amp; prop[i] != &#39;\0&#39;)
</a><a href="#h5-1-14" id="h5-1-14" class="i">+				c-&gt;isfloating = prop[i] == &#39;1&#39;;
</a> 		}
 	}
 	if(!matched) {
<a href="#h5-2" id="h5-2" class="h">@@ -127,7 +130,7 @@ settags(Client *c, Client *trans) {
</a> 	if(!matched)
 		for(i = 0; i &lt; ntags; i++)
 			c-&gt;tags[i] = seltag[i];
<a href="#h5-2-3" id="h5-2-3" class="d">-	persisttags(c);
</a><a href="#h5-2-4" id="h5-2-4" class="i">+	persistconfig(c);
</a> }
 
 void
<a href="#h5-3" id="h5-3" class="h">@@ -142,7 +145,17 @@ tag(const char *arg) {
</a> 	if(i &gt;= 0 &amp;&amp; i &lt; ntags)
 		sel-&gt;tags[i] = True;
 	if(sel)
<a href="#h5-3-3" id="h5-3-3" class="d">-		persisttags(sel);
</a><a href="#h5-3-4" id="h5-3-4" class="i">+		persistconfig(sel);
</a><a href="#h5-3-5" id="h5-3-5" class="i">+	arrange();
</a><a href="#h5-3-6" id="h5-3-6" class="i">+}
</a><a href="#h5-3-7" id="h5-3-7" class="i">+
</a><a href="#h5-3-8" id="h5-3-8" class="i">+void
</a><a href="#h5-3-9" id="h5-3-9" class="i">+togglefloating(const char *arg) {
</a><a href="#h5-3-10" id="h5-3-10" class="i">+	if(!sel || isfloating())
</a><a href="#h5-3-11" id="h5-3-11" class="i">+		return;
</a><a href="#h5-3-12" id="h5-3-12" class="i">+	sel-&gt;isfloating = !sel-&gt;isfloating;
</a><a href="#h5-3-13" id="h5-3-13" class="i">+	if(sel-&gt;isfloating)
</a><a href="#h5-3-14" id="h5-3-14" class="i">+		resize(sel, sel-&gt;x, sel-&gt;y, sel-&gt;w, sel-&gt;h, True);
</a> 	arrange();
 }
 
<a href="#h5-4" id="h5-4" class="h">@@ -158,7 +171,7 @@ toggletag(const char *arg) {
</a> 	if(j == ntags)
 		sel-&gt;tags[i] = True;
 	if(sel)
<a href="#h5-4-3" id="h5-4-3" class="d">-		persisttags(sel);
</a><a href="#h5-4-4" id="h5-4-4" class="i">+		persistconfig(sel);
</a> 	arrange();
 }
 
</pre>
</div>
</body>
</html>
