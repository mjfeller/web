<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>some more polishing/consistency changes - dwm - dynamic window manager
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="dwm Atom Feed" href="../atom.xml" />
<link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="/logo.png" alt="" width="32" height="32" /></a></td><td><h1>dwm</h1><span class="desc">dynamic window manager
</span></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/a62630ae9200f36f2ef7df805c22213b54c776c7.html">a62630ae9200f36f2ef7df805c22213b54c776c7</a>
<b>parent</b> <a href="../commit/62b18fb9d46caa3d59f4a3ac6b6e5609da9f953f.html">62b18fb9d46caa3d59f4a3ac6b6e5609da9f953f</a>
<b>Author:</b> anselm@anselm1 &lt;<a href="mailto:unknown">unknown</a>&gt;
<b>Date:</b>   Sat, 22 Dec 2007 14:40:44 +0000

some more polishing/consistency changes
<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">dwm.c</a></td><td> | </td><td class="num">79</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------------</span></td></tr>
</table></pre><pre>1 file changed, 39 insertions(+), 40 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/dwm.c.html">dwm.c</a> b/<a href="../file/dwm.c.html">dwm.c</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -198,7 +198,7 @@ void toggleview(const char *arg);
</a> void unban(Client *c);
 void unmanage(Client *c);
 void unmapnotify(XEvent *e);
<a href="#h0-0-3" id="h0-0-3" class="d">-void updatebarpos(Monitor *s);
</a><a href="#h0-0-4" id="h0-0-4" class="i">+void updatebarpos(Monitor *m);
</a> void updatesizehints(Client *c);
 void updatetitle(Client *c);
 void view(const char *arg);
<a href="#h0-1" id="h0-1" class="h">@@ -336,12 +336,12 @@ buttonpress(XEvent *e) {
</a> 	Client *c;
 	XButtonPressedEvent *ev = &amp;e-&gt;xbutton;
 
<a href="#h0-1-3" id="h0-1-3" class="d">-	Monitor s = monitors[monitorat(-1, -1)];
</a><a href="#h0-1-4" id="h0-1-4" class="i">+	Monitor *m = &amp;monitors[monitorat(-1, -1)];
</a> 
<a href="#h0-1-6" id="h0-1-6" class="d">-	if(ev-&gt;window == s.barwin) {
</a><a href="#h0-1-7" id="h0-1-7" class="i">+	if(ev-&gt;window == m-&gt;barwin) {
</a> 		x = 0;
 		for(i = 0; i &lt; LENGTH(tags); i++) {
<a href="#h0-1-10" id="h0-1-10" class="d">-			x += textw(&amp;s, tags[i]);
</a><a href="#h0-1-11" id="h0-1-11" class="i">+			x += textw(m, tags[i]);
</a> 			if(ev-&gt;x &lt; x) {
 				if(ev-&gt;button == Button1) {
 					if(ev-&gt;state &amp; MODKEY)
<a href="#h0-2" id="h0-2" class="h">@@ -366,20 +366,20 @@ buttonpress(XEvent *e) {
</a> 		if(CLEANMASK(ev-&gt;state) != MODKEY)
 			return;
 		if(ev-&gt;button == Button1) {
<a href="#h0-2-3" id="h0-2-3" class="d">-			if((s.layout-&gt;arrange == floating) || c-&gt;isfloating)
</a><a href="#h0-2-4" id="h0-2-4" class="i">+			if((m-&gt;layout-&gt;arrange == floating) || c-&gt;isfloating)
</a> 				restack();
 			else
 				togglefloating(NULL);
 			movemouse(c);
 		}
 		else if(ev-&gt;button == Button2) {
<a href="#h0-2-11" id="h0-2-11" class="d">-			if((floating != s.layout-&gt;arrange) &amp;&amp; c-&gt;isfloating)
</a><a href="#h0-2-12" id="h0-2-12" class="i">+			if((floating != m-&gt;layout-&gt;arrange) &amp;&amp; c-&gt;isfloating)
</a> 				togglefloating(NULL);
 			else
 				zoom(NULL);
 		}
 		else if(ev-&gt;button == Button3 &amp;&amp; !c-&gt;isfixed) {
<a href="#h0-2-18" id="h0-2-18" class="d">-			if((floating == s.layout-&gt;arrange) || c-&gt;isfloating)
</a><a href="#h0-2-19" id="h0-2-19" class="i">+			if((floating == m-&gt;layout-&gt;arrange) || c-&gt;isfloating)
</a> 				restack();
 			else
 				togglefloating(NULL);
<a href="#h0-3" id="h0-3" class="h">@@ -565,20 +565,20 @@ detachstack(Client *c) {
</a> 
 void
 drawbar(void) {
<a href="#h0-3-3" id="h0-3-3" class="d">-	int i, x, s;
</a><a href="#h0-3-4" id="h0-3-4" class="i">+	int i, j, x;
</a> 
<a href="#h0-3-6" id="h0-3-6" class="d">-	for(s = 0; s &lt; mcount; ++s) {
</a><a href="#h0-3-7" id="h0-3-7" class="d">-		Monitor *m = &amp;monitors[s];
</a><a href="#h0-3-8" id="h0-3-8" class="i">+	for(i = 0; i &lt; mcount; i++) {
</a><a href="#h0-3-9" id="h0-3-9" class="i">+		Monitor *m = &amp;monitors[i];
</a> 		m-&gt;dc.x = 0;
<a href="#h0-3-11" id="h0-3-11" class="d">-		for(i = 0; i &lt; LENGTH(tags); i++) {
</a><a href="#h0-3-12" id="h0-3-12" class="d">-			m-&gt;dc.w = textw(m, tags[i]);
</a><a href="#h0-3-13" id="h0-3-13" class="d">-			if(m-&gt;seltags[i]) {
</a><a href="#h0-3-14" id="h0-3-14" class="d">-				drawtext(m, tags[i], m-&gt;dc.sel);
</a><a href="#h0-3-15" id="h0-3-15" class="d">-				drawsquare(m, sel &amp;&amp; sel-&gt;tags[i] &amp;&amp; sel-&gt;monitor == selmonitor, isoccupied(m, i), m-&gt;dc.sel);
</a><a href="#h0-3-16" id="h0-3-16" class="i">+		for(j = 0; j &lt; LENGTH(tags); j++) {
</a><a href="#h0-3-17" id="h0-3-17" class="i">+			m-&gt;dc.w = textw(m, tags[j]);
</a><a href="#h0-3-18" id="h0-3-18" class="i">+			if(m-&gt;seltags[j]) {
</a><a href="#h0-3-19" id="h0-3-19" class="i">+				drawtext(m, tags[j], m-&gt;dc.sel);
</a><a href="#h0-3-20" id="h0-3-20" class="i">+				drawsquare(m, sel &amp;&amp; sel-&gt;tags[j] &amp;&amp; sel-&gt;monitor == selmonitor, isoccupied(m, j), m-&gt;dc.sel);
</a> 			}
 			else {
<a href="#h0-3-23" id="h0-3-23" class="d">-				drawtext(m, tags[i], m-&gt;dc.norm);
</a><a href="#h0-3-24" id="h0-3-24" class="d">-				drawsquare(m, sel &amp;&amp; sel-&gt;tags[i] &amp;&amp; sel-&gt;monitor == selmonitor, isoccupied(m, i), m-&gt;dc.norm);
</a><a href="#h0-3-25" id="h0-3-25" class="i">+				drawtext(m, tags[j], m-&gt;dc.norm);
</a><a href="#h0-3-26" id="h0-3-26" class="i">+				drawsquare(m, sel &amp;&amp; sel-&gt;tags[j] &amp;&amp; sel-&gt;monitor == selmonitor, isoccupied(m, j), m-&gt;dc.norm);
</a> 			}
 			m-&gt;dc.x += m-&gt;dc.w;
 		}
<a href="#h0-4" id="h0-4" class="h">@@ -1336,10 +1336,10 @@ resizemouse(Client *c) {
</a> 
 void
 restack(void) {
<a href="#h0-4-3" id="h0-4-3" class="i">+	unsigned int i;
</a> 	Client *c;
 	XEvent ev;
 	XWindowChanges wc;
<a href="#h0-4-7" id="h0-4-7" class="d">-	int s;
</a> 
 	drawbar();
 	if(!sel)
<a href="#h0-5" id="h0-5" class="h">@@ -1353,8 +1353,8 @@ restack(void) {
</a> 			XConfigureWindow(dpy, sel-&gt;win, CWSibling | CWStackMode, &amp;wc);
 			wc.sibling = sel-&gt;win;
 		}
<a href="#h0-5-3" id="h0-5-3" class="d">-		for(s = 0; s &lt; mcount; s++) {
</a><a href="#h0-5-4" id="h0-5-4" class="d">-			for(c = nexttiled(clients, &amp;monitors[s]); c; c = nexttiled(c-&gt;next, &amp;monitors[s])) {
</a><a href="#h0-5-5" id="h0-5-5" class="i">+		for(i = 0; i &lt; mcount; i++) {
</a><a href="#h0-5-6" id="h0-5-6" class="i">+			for(c = nexttiled(clients, &amp;monitors[i]); c; c = nexttiled(c-&gt;next, &amp;monitors[i])) {
</a> 				if(c == sel)
 					continue;
 				XConfigureWindow(dpy, c-&gt;win, CWSibling | CWStackMode, &amp;wc);
<a href="#h0-6" id="h0-6" class="h">@@ -1676,39 +1676,38 @@ textw(Monitor *m, const char *text) {
</a> 
 void
 tile(void) {
<a href="#h0-6-3" id="h0-6-3" class="d">-	unsigned int i, n, nx, ny, nw, nh, mw, th;
</a><a href="#h0-6-4" id="h0-6-4" class="d">-	int s;
</a><a href="#h0-6-5" id="h0-6-5" class="i">+	unsigned int i, j, n, nx, ny, nw, nh, mw, th;
</a> 	Client *c, *mc;
 
 	domwfact = dozoom = True;
 
 	nw = 0; /* gcc stupidity requires this */
 
<a href="#h0-6-12" id="h0-6-12" class="d">-	for (s = 0; s &lt; mcount; s++) {
</a><a href="#h0-6-13" id="h0-6-13" class="d">-		Monitor *m = &amp;monitors[s];
</a><a href="#h0-6-14" id="h0-6-14" class="i">+	for (i = 0; i &lt; mcount; i++) {
</a><a href="#h0-6-15" id="h0-6-15" class="i">+		Monitor *m = &amp;monitors[i];
</a> 
 		for(n = 0, c = nexttiled(clients, m); c; c = nexttiled(c-&gt;next, m))
 			n++;
 
<a href="#h0-6-20" id="h0-6-20" class="d">-		for(i = 0, c = mc = nexttiled(clients, m); c; c = nexttiled(c-&gt;next, m)) {
</a><a href="#h0-6-21" id="h0-6-21" class="i">+		for(j = 0, c = mc = nexttiled(clients, m); c; c = nexttiled(c-&gt;next, m)) {
</a> 			/* window geoms */
 			mw = (n == 1) ? m-&gt;waw : m-&gt;mwfact * m-&gt;waw;
 			th = (n &gt; 1) ? m-&gt;wah / (n - 1) : 0;
 			if(n &gt; 1 &amp;&amp; th &lt; bh)
 				th = m-&gt;wah;
<a href="#h0-6-27" id="h0-6-27" class="d">-			if(i == 0) { /* master */
</a><a href="#h0-6-28" id="h0-6-28" class="i">+			if(j == 0) { /* master */
</a> 				nx = m-&gt;wax;
 				ny = m-&gt;way;
 				nw = mw - 2 * c-&gt;border;
 				nh = m-&gt;wah - 2 * c-&gt;border;
 			}
 			else {  /* tile window */
<a href="#h0-6-35" id="h0-6-35" class="d">-				if(i == 1) {
</a><a href="#h0-6-36" id="h0-6-36" class="i">+				if(j == 1) {
</a> 					ny = m-&gt;way;
 					nx += mc-&gt;w + 2 * mc-&gt;border;
 					nw = m-&gt;waw - mw - 2 * c-&gt;border;
 				}
<a href="#h0-6-41" id="h0-6-41" class="d">-				if(i + 1 == n) /* remainder */
</a><a href="#h0-6-42" id="h0-6-42" class="i">+				if(j + 1 == n) /* remainder */
</a> 					nh = (m-&gt;way + m-&gt;wah) - ny - 2 * c-&gt;border;
 				else
 					nh = th - 2 * c-&gt;border;
<a href="#h0-7" id="h0-7" class="h">@@ -1720,7 +1719,7 @@ tile(void) {
</a> 			if(n &gt; 1 &amp;&amp; th != m-&gt;wah)
 				ny = c-&gt;y + c-&gt;h + 2 * c-&gt;border;
 
<a href="#h0-7-3" id="h0-7-3" class="d">-			i++;
</a><a href="#h0-7-4" id="h0-7-4" class="i">+			j++;
</a> 		}
 	}
 }
<a href="#h0-8" id="h0-8" class="h">@@ -1813,25 +1812,25 @@ unmapnotify(XEvent *e) {
</a> }
 
 void
<a href="#h0-8-3" id="h0-8-3" class="d">-updatebarpos(Monitor *s) {
</a><a href="#h0-8-4" id="h0-8-4" class="i">+updatebarpos(Monitor *m) {
</a> 	XEvent ev;
 
<a href="#h0-8-7" id="h0-8-7" class="d">-	s-&gt;wax = s-&gt;sx;
</a><a href="#h0-8-8" id="h0-8-8" class="d">-	s-&gt;way = s-&gt;sy;
</a><a href="#h0-8-9" id="h0-8-9" class="d">-	s-&gt;wah = s-&gt;sh;
</a><a href="#h0-8-10" id="h0-8-10" class="d">-	s-&gt;waw = s-&gt;sw;
</a><a href="#h0-8-11" id="h0-8-11" class="i">+	m-&gt;wax = m-&gt;sx;
</a><a href="#h0-8-12" id="h0-8-12" class="i">+	m-&gt;way = m-&gt;sy;
</a><a href="#h0-8-13" id="h0-8-13" class="i">+	m-&gt;wah = m-&gt;sh;
</a><a href="#h0-8-14" id="h0-8-14" class="i">+	m-&gt;waw = m-&gt;sw;
</a> 	switch(bpos) {
 	default:
<a href="#h0-8-17" id="h0-8-17" class="d">-		s-&gt;wah -= bh;
</a><a href="#h0-8-18" id="h0-8-18" class="d">-		s-&gt;way += bh;
</a><a href="#h0-8-19" id="h0-8-19" class="d">-		XMoveWindow(dpy, s-&gt;barwin, s-&gt;sx, s-&gt;sy);
</a><a href="#h0-8-20" id="h0-8-20" class="i">+		m-&gt;wah -= bh;
</a><a href="#h0-8-21" id="h0-8-21" class="i">+		m-&gt;way += bh;
</a><a href="#h0-8-22" id="h0-8-22" class="i">+		XMoveWindow(dpy, m-&gt;barwin, m-&gt;sx, m-&gt;sy);
</a> 		break;
 	case BarBot:
<a href="#h0-8-25" id="h0-8-25" class="d">-		s-&gt;wah -= bh;
</a><a href="#h0-8-26" id="h0-8-26" class="d">-		XMoveWindow(dpy, s-&gt;barwin, s-&gt;sx, s-&gt;sy + s-&gt;wah);
</a><a href="#h0-8-27" id="h0-8-27" class="i">+		m-&gt;wah -= bh;
</a><a href="#h0-8-28" id="h0-8-28" class="i">+		XMoveWindow(dpy, m-&gt;barwin, m-&gt;sx, m-&gt;sy + m-&gt;wah);
</a> 		break;
 	case BarOff:
<a href="#h0-8-31" id="h0-8-31" class="d">-		XMoveWindow(dpy, s-&gt;barwin, s-&gt;sx, s-&gt;sy - bh);
</a><a href="#h0-8-32" id="h0-8-32" class="i">+		XMoveWindow(dpy, m-&gt;barwin, m-&gt;sx, m-&gt;sy - bh);
</a> 		break;
 	}
 	XSync(dpy, False);
</pre>
</div>
</body>
</html>
