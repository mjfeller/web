<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>pushing my changes of tonight upstream (hg tip is NOW very UNSTABLE -- but those changes are necessary to get a decent multihead support) -- I renamed Monitor into View, to reflect in a better way the dwm terminology of the past - dwm - dynamic window manager
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="dwm Atom Feed" href="../atom.xml" />
<link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="/logo.png" alt="" width="32" height="32" /></a></td><td><h1>dwm</h1><span class="desc">dynamic window manager
</span></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/a3d8c05a95edbd4dad544c3373301551440c8092.html">a3d8c05a95edbd4dad544c3373301551440c8092</a>
<b>parent</b> <a href="../commit/fd01413fae6dea101ed07e6ee7c0d26be5e92d03.html">fd01413fae6dea101ed07e6ee7c0d26be5e92d03</a>
<b>Author:</b> anselm@anselm1 &lt;<a href="mailto:unknown">unknown</a>&gt;
<b>Date:</b>   Sat, 23 Feb 2008 23:11:27 +0000

pushing my changes of tonight upstream (hg tip is NOW very UNSTABLE -- but those changes are necessary to get a decent multihead support) -- I renamed Monitor into View, to reflect in a better way the dwm terminology of the past
<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">config.def.h</a></td><td> | </td><td class="num">14</td><td><span class="i">+++++++</span><span class="d">-------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">dwm.c</a></td><td> | </td><td class="num">697</td><td><span class="i">++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------------------------------------</span></td></tr>
</table></pre><pre>2 files changed, 345 insertions(+), 366 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/config.def.h.html">config.def.h</a> b/<a href="../file/config.def.h.html">config.def.h</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -3,7 +3,7 @@
</a> /* appearance */
 #define BARPOS			BarTop /* BarBot, BarOff */
 #define BORDERPX		1
<a href="#h0-0-3" id="h0-0-3" class="d">-#define FONT			&quot;-*-terminus-medium-r-normal-*-14-*-*-*-*-*-*-*&quot;
</a><a href="#h0-0-4" id="h0-0-4" class="i">+#define FONT			&quot;-*-terminus-medium-r-normal-*-12-*-*-*-*-*-*-*&quot;
</a> #define NORMBORDERCOLOR		&quot;#cccccc&quot;
 #define NORMBGCOLOR		&quot;#cccccc&quot;
 #define NORMFGCOLOR		&quot;#000000&quot;
<a href="#h0-1" id="h0-1" class="h">@@ -13,13 +13,13 @@
</a> 
 /* tagging */
 const char tags[][MAXTAGLEN] = { &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;www&quot; };
<a href="#h0-1-3" id="h0-1-3" class="d">-Bool initags[LENGTH(tags)] = {[0] = True};
</a><a href="#h0-1-4" id="h0-1-4" class="i">+int initags[LENGTH(tags)]    = { [0] = 1 };
</a> Rule rules[] = {
<a href="#h0-1-6" id="h0-1-6" class="d">-	/* class:instance:title regex	tags regex	isfloating */	/* monitor */
</a><a href="#h0-1-7" id="h0-1-7" class="d">-	{ &quot;Firefox&quot;,			&quot;www&quot;,		False,		-1 },
</a><a href="#h0-1-8" id="h0-1-8" class="d">-	{ &quot;Gimp&quot;,			NULL,		True,		-1 },
</a><a href="#h0-1-9" id="h0-1-9" class="d">-	{ &quot;MPlayer&quot;,			NULL,		True,		-1 },
</a><a href="#h0-1-10" id="h0-1-10" class="d">-	{ &quot;Acroread&quot;,			NULL,		True,		-1 },
</a><a href="#h0-1-11" id="h0-1-11" class="i">+	/* class:instance:title regex	tags regex	isfloating */
</a><a href="#h0-1-12" id="h0-1-12" class="i">+	{ &quot;Firefox&quot;,			&quot;www&quot;,		False },
</a><a href="#h0-1-13" id="h0-1-13" class="i">+	{ &quot;Gimp&quot;,			NULL,		True },
</a><a href="#h0-1-14" id="h0-1-14" class="i">+	{ &quot;MPlayer&quot;,			NULL,		True },
</a><a href="#h0-1-15" id="h0-1-15" class="i">+	{ &quot;Acroread&quot;,			NULL,		True },
</a> };
 
 /* layout(s) */
<b>diff --git a/<a id="h1" href="../file/dwm.c.html">dwm.c</a> b/<a href="../file/dwm.c.html">dwm.c</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -17,7 +17,7 @@
</a>  * set the override_redirect flag.  Clients are organized in a global
  * doubly-linked client list, the focus history is remembered through a global
  * stack list. Each client contains an array of Bools of the same size as the
<a href="#h1-0-3" id="h1-0-3" class="d">- * global tags array to indicate the tags of a client.  
</a><a href="#h1-0-4" id="h1-0-4" class="i">+ * global tags array to indicate the tags of a client.
</a>  *
  * Keys and tagging rules are organized as arrays and defined in config.h.
  *
<a href="#h1-1" id="h1-1" class="h">@@ -45,11 +45,11 @@
</a> //#endif
 
 /* macros */
<a href="#h1-1-3" id="h1-1-3" class="d">-#define BUTTONMASK		(ButtonPressMask | ButtonReleaseMask)
</a><a href="#h1-1-4" id="h1-1-4" class="d">-#define CLEANMASK(mask)		(mask &amp; ~(numlockmask | LockMask))
</a><a href="#h1-1-5" id="h1-1-5" class="i">+#define BUTTONMASK		(ButtonPressMask|ButtonReleaseMask)
</a><a href="#h1-1-6" id="h1-1-6" class="i">+#define CLEANMASK(mask)		(mask &amp; ~(numlockmask|LockMask))
</a> #define LENGTH(x)		(sizeof x / sizeof x[0])
 #define MAXTAGLEN		16
<a href="#h1-1-9" id="h1-1-9" class="d">-#define MOUSEMASK		(BUTTONMASK | PointerMotionMask)
</a><a href="#h1-1-10" id="h1-1-10" class="i">+#define MOUSEMASK		(BUTTONMASK|PointerMotionMask)
</a> 
 
 /* enums */
<a href="#h1-2" id="h1-2" class="h">@@ -60,22 +60,21 @@ enum { NetSupported, NetWMName, NetLast };		/* EWMH atoms */
</a> enum { WMProtocols, WMDelete, WMName, WMState, WMLast };/* default atoms */
 
 /* typedefs */
<a href="#h1-2-3" id="h1-2-3" class="d">-typedef struct Monitor Monitor;
</a><a href="#h1-2-4" id="h1-2-4" class="i">+typedef struct View View;
</a> typedef struct Client Client;
 struct Client {
 	char name[256];
 	int x, y, w, h;
 	int basew, baseh, incw, inch, maxw, maxh, minw, minh;
 	int minax, maxax, minay, maxay;
<a href="#h1-2-11" id="h1-2-11" class="i">+	int *tags;
</a> 	long flags;
 	unsigned int border, oldborder;
 	Bool isbanned, isfixed, isfloating, isurgent;
<a href="#h1-2-15" id="h1-2-15" class="d">-	Bool *tags;
</a> 	Client *next;
 	Client *prev;
 	Client *snext;
 	Window win;
<a href="#h1-2-20" id="h1-2-20" class="d">-	Monitor *monitor;
</a> };
 
 typedef struct {
<a href="#h1-3" id="h1-3" class="h">@@ -102,14 +101,13 @@ typedef struct {
</a> 
 typedef struct {
 	const char *symbol;
<a href="#h1-3-3" id="h1-3-3" class="d">-	void (*arrange)(Monitor *);
</a><a href="#h1-3-4" id="h1-3-4" class="i">+	void (*arrange)(View *);
</a> } Layout;
 
 typedef struct {
 	const char *prop;
 	const char *tags;
 	Bool isfloating;
<a href="#h1-3-11" id="h1-3-11" class="d">-	int monitor;
</a> } Rule;
 
 typedef struct {
<a href="#h1-4" id="h1-4" class="h">@@ -117,19 +115,17 @@ typedef struct {
</a> 	regex_t *tagregex;
 } Regs;
 
<a href="#h1-4-3" id="h1-4-3" class="d">-struct Monitor {
</a><a href="#h1-4-4" id="h1-4-4" class="d">-	int sx, sy, sw, sh, wax, way, wah, waw;
</a><a href="#h1-4-5" id="h1-4-5" class="i">+struct View {
</a><a href="#h1-4-6" id="h1-4-6" class="i">+	int id;
</a><a href="#h1-4-7" id="h1-4-7" class="i">+	int x, y, w, h, wax, way, wah, waw;
</a> 	double mwfact;
<a href="#h1-4-9" id="h1-4-9" class="d">-	Bool *seltags;
</a><a href="#h1-4-10" id="h1-4-10" class="d">-	Bool *prevtags;
</a> 	Layout *layout;
 	Window barwin;
 };
 
<a href="#h1-4-15" id="h1-4-15" class="d">-
</a> /* function declarations */
 void applyrules(Client *c);
<a href="#h1-4-18" id="h1-4-18" class="d">-void arrange(Monitor *m);
</a><a href="#h1-4-19" id="h1-4-19" class="i">+void arrange(void);
</a> void attach(Client *c);
 void attachstack(Client *c);
 void ban(Client *c);
<a href="#h1-5" id="h1-5" class="h">@@ -143,45 +139,46 @@ void configurerequest(XEvent *e);
</a> void destroynotify(XEvent *e);
 void detach(Client *c);
 void detachstack(Client *c);
<a href="#h1-5-3" id="h1-5-3" class="d">-void drawbar(Monitor *m);
</a><a href="#h1-5-4" id="h1-5-4" class="d">-void drawsquare(Monitor *m, Bool filled, Bool empty, Bool invert, unsigned long col[ColLast]);
</a><a href="#h1-5-5" id="h1-5-5" class="d">-void drawtext(Monitor *m, const char *text, unsigned long col[ColLast], Bool invert);
</a><a href="#h1-5-6" id="h1-5-6" class="i">+void drawbar(View *v);
</a><a href="#h1-5-7" id="h1-5-7" class="i">+void drawsquare(View *v, Bool filled, Bool empty, Bool invert, unsigned long col[ColLast]);
</a><a href="#h1-5-8" id="h1-5-8" class="i">+void drawtext(View *v, const char *text, unsigned long col[ColLast], Bool invert);
</a> void *emallocz(unsigned int size);
 void enternotify(XEvent *e);
 void eprint(const char *errstr, ...);
 void expose(XEvent *e);
<a href="#h1-5-13" id="h1-5-13" class="d">-void floating(Monitor *m); /* default floating layout */
</a><a href="#h1-5-14" id="h1-5-14" class="i">+void floating(View *v); /* default floating layout */
</a> void focus(Client *c);
 void focusin(XEvent *e);
 void focusnext(const char *arg);
 void focusprev(const char *arg);
 Client *getclient(Window w);
 unsigned long getcolor(const char *colstr);
<a href="#h1-5-21" id="h1-5-21" class="d">-Monitor *getmonitor(Window barwin);
</a><a href="#h1-5-22" id="h1-5-22" class="i">+View *getviewbar(Window barwin);
</a><a href="#h1-5-23" id="h1-5-23" class="i">+View *getview(Client *c);
</a> long getstate(Window w);
 Bool gettextprop(Window w, Atom atom, char *text, unsigned int size);
 void grabbuttons(Client *c, Bool focused);
 void grabkeys(void);
 unsigned int idxoftag(const char *tag);
 void initfont(const char *fontstr);
<a href="#h1-5-30" id="h1-5-30" class="d">-Bool isoccupied(Monitor *monitor, unsigned int t);
</a><a href="#h1-5-31" id="h1-5-31" class="i">+Bool isoccupied(unsigned int t);
</a> Bool isprotodel(Client *c);
<a href="#h1-5-33" id="h1-5-33" class="d">-Bool isurgent(Monitor *monitor, unsigned int t);
</a><a href="#h1-5-34" id="h1-5-34" class="d">-Bool isvisible(Client *c, Monitor *m);
</a><a href="#h1-5-35" id="h1-5-35" class="i">+Bool isurgent(unsigned int t);
</a><a href="#h1-5-36" id="h1-5-36" class="i">+Bool isvisible(Client *c);
</a> void keypress(XEvent *e);
 void killclient(const char *arg);
 void manage(Window w, XWindowAttributes *wa);
 void mappingnotify(XEvent *e);
 void maprequest(XEvent *e);
<a href="#h1-5-42" id="h1-5-42" class="d">-Monitor *monitorat(void);
</a><a href="#h1-5-43" id="h1-5-43" class="i">+View *viewat(void);
</a> void movemouse(Client *c);
<a href="#h1-5-45" id="h1-5-45" class="d">-Client *nexttiled(Client *c, Monitor *monitor);
</a><a href="#h1-5-46" id="h1-5-46" class="i">+Client *nexttiled(Client *c, View *v);
</a> void propertynotify(XEvent *e);
 void quit(const char *arg);
 void reapply(const char *arg);
 void resize(Client *c, int x, int y, int w, int h, Bool sizehints);
 void resizemouse(Client *c);
<a href="#h1-5-52" id="h1-5-52" class="d">-void restack(Monitor *m);
</a><a href="#h1-5-53" id="h1-5-53" class="i">+void restack(View *v);
</a> void run(void);
 void scan(void);
 void setclientstate(Client *c, long state);
<a href="#h1-6" id="h1-6" class="h">@@ -192,7 +189,7 @@ void spawn(const char *arg);
</a> void tag(const char *arg);
 unsigned int textnw(const char *text, unsigned int len);
 unsigned int textw(const char *text);
<a href="#h1-6-3" id="h1-6-3" class="d">-void tile(Monitor *m);
</a><a href="#h1-6-4" id="h1-6-4" class="i">+void tile(View *v);
</a> void togglebar(const char *arg);
 void togglefloating(const char *arg);
 void toggletag(const char *arg);
<a href="#h1-7" id="h1-7" class="h">@@ -200,24 +197,25 @@ void toggleview(const char *arg);
</a> void unban(Client *c);
 void unmanage(Client *c);
 void unmapnotify(XEvent *e);
<a href="#h1-7-3" id="h1-7-3" class="d">-void updatebarpos(Monitor *m);
</a><a href="#h1-7-4" id="h1-7-4" class="i">+void updatebarpos(View *v);
</a> void updatesizehints(Client *c);
 void updatetitle(Client *c);
 void updatewmhints(Client *c);
 void view(const char *arg);
 void viewprevtag(const char *arg);	/* views previous selected tags */
 int xerror(Display *dpy, XErrorEvent *ee);
<a href="#h1-7-11" id="h1-7-11" class="d">-int xerrordummy(Display *dsply, XErrorEvent *ee);
</a><a href="#h1-7-12" id="h1-7-12" class="d">-int xerrorstart(Display *dsply, XErrorEvent *ee);
</a><a href="#h1-7-13" id="h1-7-13" class="i">+int xerrordummy(Display *dpy, XErrorEvent *ee);
</a><a href="#h1-7-14" id="h1-7-14" class="i">+int xerrorstart(Display *dpy, XErrorEvent *ee);
</a> void zoom(const char *arg);
<a href="#h1-7-16" id="h1-7-16" class="d">-void movetomonitor(const char *arg);
</a><a href="#h1-7-17" id="h1-7-17" class="d">-void selectmonitor(const char *arg);
</a><a href="#h1-7-18" id="h1-7-18" class="i">+void selectview(const char *arg);
</a> 
 /* variables */
 char stext[256];
<a href="#h1-7-22" id="h1-7-22" class="d">-int mcount = 1;
</a><a href="#h1-7-23" id="h1-7-23" class="d">-Monitor *selmonitor;
</a><a href="#h1-7-24" id="h1-7-24" class="i">+int nviews = 1;
</a><a href="#h1-7-25" id="h1-7-25" class="i">+View *selview;
</a> int screen;
<a href="#h1-7-27" id="h1-7-27" class="i">+int *seltags;
</a><a href="#h1-7-28" id="h1-7-28" class="i">+int *prevtags;
</a> int (*xerrorxlib)(Display *, XErrorEvent *);
 unsigned int bh, bpos;
 unsigned int blw = 0;
<a href="#h1-8" id="h1-8" class="h">@@ -249,14 +247,12 @@ Cursor cursor[CurLast];
</a> Display *dpy;
 DC dc = {0};
 Regs *regs = NULL;
<a href="#h1-8-3" id="h1-8-3" class="d">-Monitor *monitors;
</a><a href="#h1-8-4" id="h1-8-4" class="i">+View *views;
</a> Window root;
 
 /* configuration, allows nested code to access above variables */
 #include &quot;config.h&quot;
 
<a href="#h1-8-10" id="h1-8-10" class="d">-//Bool prevtags[LENGTH(tags)];
</a><a href="#h1-8-11" id="h1-8-11" class="d">-
</a> /* function implementations */
 void
 applyrules(Client *c) {
<a href="#h1-9" id="h1-9" class="h">@@ -264,7 +260,6 @@ applyrules(Client *c) {
</a> 	unsigned int i, j;
 	regmatch_t tmp;
 	Bool matched_tag = False;
<a href="#h1-9-3" id="h1-9-3" class="d">-	Bool matched_monitor = False;
</a> 	XClassHint ch = { 0 };
 
 	/* rule matching */
<a href="#h1-10" id="h1-10" class="h">@@ -274,16 +269,11 @@ applyrules(Client *c) {
</a> 			ch.res_name ? ch.res_name : &quot;&quot;, c-&gt;name);
 	for(i = 0; i &lt; LENGTH(rules); i++)
 		if(regs[i].propregex &amp;&amp; !regexec(regs[i].propregex, buf, 1, &amp;tmp, 0)) {
<a href="#h1-10-3" id="h1-10-3" class="d">-			if (rules[i].monitor &gt;= 0 &amp;&amp; rules[i].monitor &lt; mcount) {
</a><a href="#h1-10-4" id="h1-10-4" class="d">-				matched_monitor = True;
</a><a href="#h1-10-5" id="h1-10-5" class="d">-				c-&gt;monitor = &amp;monitors[rules[i].monitor];
</a><a href="#h1-10-6" id="h1-10-6" class="d">-			}
</a><a href="#h1-10-7" id="h1-10-7" class="d">-
</a> 			c-&gt;isfloating = rules[i].isfloating;
 			for(j = 0; regs[i].tagregex &amp;&amp; j &lt; LENGTH(tags); j++) {
 				if(!regexec(regs[i].tagregex, tags[j], 1, &amp;tmp, 0)) {
 					matched_tag = True;
<a href="#h1-10-12" id="h1-10-12" class="d">-					c-&gt;tags[j] = True;
</a><a href="#h1-10-13" id="h1-10-13" class="i">+					c-&gt;tags[j] = selview-&gt;id;
</a> 				}
 			}
 		}
<a href="#h1-11" id="h1-11" class="h">@@ -292,29 +282,27 @@ applyrules(Client *c) {
</a> 	if(ch.res_name)
 		XFree(ch.res_name);
 	if(!matched_tag)
<a href="#h1-11-3" id="h1-11-3" class="d">-		memcpy(c-&gt;tags, monitorat()-&gt;seltags, sizeof initags);
</a><a href="#h1-11-4" id="h1-11-4" class="d">-	if (!matched_monitor)
</a><a href="#h1-11-5" id="h1-11-5" class="d">-		c-&gt;monitor = monitorat();
</a><a href="#h1-11-6" id="h1-11-6" class="i">+		memcpy(c-&gt;tags, seltags, sizeof initags);
</a> }
 
<a href="#h1-11-9" id="h1-11-9" class="i">+
</a><a href="#h1-11-10" id="h1-11-10" class="i">+
</a> void
<a href="#h1-11-12" id="h1-11-12" class="d">-arrange(Monitor *m) {
</a><a href="#h1-11-13" id="h1-11-13" class="i">+arrange(void) {
</a> 	unsigned int i;
 	Client *c;
 
 	for(c = clients; c; c = c-&gt;next)
<a href="#h1-11-18" id="h1-11-18" class="d">-		if(isvisible(c, c-&gt;monitor))
</a><a href="#h1-11-19" id="h1-11-19" class="i">+		if(isvisible(c))
</a> 			unban(c);
 		else
 			ban(c);
 
<a href="#h1-11-24" id="h1-11-24" class="d">-	if(m)
</a><a href="#h1-11-25" id="h1-11-25" class="d">-		m-&gt;layout-&gt;arrange(m);
</a><a href="#h1-11-26" id="h1-11-26" class="d">-	else
</a><a href="#h1-11-27" id="h1-11-27" class="d">-		for(i = 0; i &lt; mcount; i++)
</a><a href="#h1-11-28" id="h1-11-28" class="d">-			monitors[i].layout-&gt;arrange(&amp;monitors[i]);
</a><a href="#h1-11-29" id="h1-11-29" class="i">+	for(i = 0; i &lt; nviews; i++) {
</a><a href="#h1-11-30" id="h1-11-30" class="i">+		views[i].layout-&gt;arrange(&amp;views[i]);
</a><a href="#h1-11-31" id="h1-11-31" class="i">+		restack(&amp;views[i]);
</a><a href="#h1-11-32" id="h1-11-32" class="i">+	}
</a> 	focus(NULL);
<a href="#h1-11-34" id="h1-11-34" class="d">-	restack(m);
</a> }
 
 void
<a href="#h1-12" id="h1-12" class="h">@@ -335,7 +323,7 @@ void
</a> ban(Client *c) {
 	if(c-&gt;isbanned)
 		return;
<a href="#h1-12-3" id="h1-12-3" class="d">-	XMoveWindow(dpy, c-&gt;win, c-&gt;x + 3 * c-&gt;monitor-&gt;sw, c-&gt;y);
</a><a href="#h1-12-4" id="h1-12-4" class="i">+	XMoveWindow(dpy, c-&gt;win, c-&gt;x + 3 * getview(c)-&gt;w, c-&gt;y);
</a> 	c-&gt;isbanned = True;
 }
 
<a href="#h1-13" id="h1-13" class="h">@@ -345,9 +333,9 @@ buttonpress(XEvent *e) {
</a> 	Client *c;
 	XButtonPressedEvent *ev = &amp;e-&gt;xbutton;
 
<a href="#h1-13-3" id="h1-13-3" class="d">-	Monitor *m = monitorat();
</a><a href="#h1-13-4" id="h1-13-4" class="i">+	View *v = selview;
</a> 
<a href="#h1-13-6" id="h1-13-6" class="d">-	if(ev-&gt;window == m-&gt;barwin) {
</a><a href="#h1-13-7" id="h1-13-7" class="i">+	if(ev-&gt;window == v-&gt;barwin) {
</a> 		x = 0;
 		for(i = 0; i &lt; LENGTH(tags); i++) {
 			x += textw(tags[i]);
<a href="#h1-14" id="h1-14" class="h">@@ -375,17 +363,17 @@ buttonpress(XEvent *e) {
</a> 		if(CLEANMASK(ev-&gt;state) != MODKEY)
 			return;
 		if(ev-&gt;button == Button1) {
<a href="#h1-14-3" id="h1-14-3" class="d">-			restack(c-&gt;monitor);
</a><a href="#h1-14-4" id="h1-14-4" class="i">+			restack(getview(c));
</a> 			movemouse(c);
 		}
 		else if(ev-&gt;button == Button2) {
<a href="#h1-14-8" id="h1-14-8" class="d">-			if((floating != m-&gt;layout-&gt;arrange) &amp;&amp; c-&gt;isfloating)
</a><a href="#h1-14-9" id="h1-14-9" class="i">+			if((floating != v-&gt;layout-&gt;arrange) &amp;&amp; c-&gt;isfloating)
</a> 				togglefloating(NULL);
 			else
 				zoom(NULL);
 		}
 		else if(ev-&gt;button == Button3 &amp;&amp; !c-&gt;isfixed) {
<a href="#h1-14-15" id="h1-14-15" class="d">-			restack(c-&gt;monitor);
</a><a href="#h1-14-16" id="h1-14-16" class="i">+			restack(getview(c));
</a> 			resizemouse(c);
 		}
 	}
<a href="#h1-15" id="h1-15" class="h">@@ -426,8 +414,8 @@ cleanup(void) {
</a> 	XFreeCursor(dpy, cursor[CurNormal]);
 	XFreeCursor(dpy, cursor[CurResize]);
 	XFreeCursor(dpy, cursor[CurMove]);
<a href="#h1-15-3" id="h1-15-3" class="d">-	for(i = 0; i &lt; mcount; i++)
</a><a href="#h1-15-4" id="h1-15-4" class="d">-		XDestroyWindow(dpy, monitors[i].barwin);
</a><a href="#h1-15-5" id="h1-15-5" class="i">+	for(i = 0; i &lt; nviews; i++)
</a><a href="#h1-15-6" id="h1-15-6" class="i">+		XDestroyWindow(dpy, views[i].barwin);
</a> 	XSync(dpy, False);
 	XSetInputFocus(dpy, PointerRoot, RevertToPointerRoot, CurrentTime);
 }
<a href="#h1-16" id="h1-16" class="h">@@ -479,17 +467,17 @@ configure(Client *c) {
</a> void
 configurenotify(XEvent *e) {
 	XConfigureEvent *ev = &amp;e-&gt;xconfigure;
<a href="#h1-16-3" id="h1-16-3" class="d">-	Monitor *m = selmonitor;
</a><a href="#h1-16-4" id="h1-16-4" class="i">+	View *v = selview;
</a> 
<a href="#h1-16-6" id="h1-16-6" class="d">-	if(ev-&gt;window == root &amp;&amp; (ev-&gt;width != m-&gt;sw || ev-&gt;height != m-&gt;sh)) {
</a><a href="#h1-16-7" id="h1-16-7" class="i">+	if(ev-&gt;window == root &amp;&amp; (ev-&gt;width != v-&gt;w || ev-&gt;height != v-&gt;h)) {
</a> 		/* TODO -- update Xinerama dimensions here */
<a href="#h1-16-9" id="h1-16-9" class="d">-		m-&gt;sw = ev-&gt;width;
</a><a href="#h1-16-10" id="h1-16-10" class="d">-		m-&gt;sh = ev-&gt;height;
</a><a href="#h1-16-11" id="h1-16-11" class="i">+		v-&gt;w = ev-&gt;width;
</a><a href="#h1-16-12" id="h1-16-12" class="i">+		v-&gt;h = ev-&gt;height;
</a> 		XFreePixmap(dpy, dc.drawable);
 		dc.drawable = XCreatePixmap(dpy, root, DisplayWidth(root, screen), bh, DefaultDepth(dpy, screen));
<a href="#h1-16-15" id="h1-16-15" class="d">-		XResizeWindow(dpy, m-&gt;barwin, m-&gt;sw, bh);
</a><a href="#h1-16-16" id="h1-16-16" class="d">-		updatebarpos(m);
</a><a href="#h1-16-17" id="h1-16-17" class="d">-		arrange(m);
</a><a href="#h1-16-18" id="h1-16-18" class="i">+		XResizeWindow(dpy, v-&gt;barwin, v-&gt;w, bh);
</a><a href="#h1-16-19" id="h1-16-19" class="i">+		updatebarpos(v);
</a><a href="#h1-16-20" id="h1-16-20" class="i">+		arrange();
</a> 	}
 }
 
<a href="#h1-17" id="h1-17" class="h">@@ -500,26 +488,26 @@ configurerequest(XEvent *e) {
</a> 	XWindowChanges wc;
 
 	if((c = getclient(ev-&gt;window))) {
<a href="#h1-17-3" id="h1-17-3" class="d">-		Monitor *m = c-&gt;monitor;
</a><a href="#h1-17-4" id="h1-17-4" class="i">+		View *v = getview(c);
</a> 		if(ev-&gt;value_mask &amp; CWBorderWidth)
 			c-&gt;border = ev-&gt;border_width;
<a href="#h1-17-7" id="h1-17-7" class="d">-		if(c-&gt;isfixed || c-&gt;isfloating || (floating == m-&gt;layout-&gt;arrange)) {
</a><a href="#h1-17-8" id="h1-17-8" class="i">+		if(c-&gt;isfixed || c-&gt;isfloating || (floating == v-&gt;layout-&gt;arrange)) {
</a> 			if(ev-&gt;value_mask &amp; CWX)
<a href="#h1-17-10" id="h1-17-10" class="d">-				c-&gt;x = m-&gt;sx+ev-&gt;x;
</a><a href="#h1-17-11" id="h1-17-11" class="i">+				c-&gt;x = v-&gt;x + ev-&gt;x;
</a> 			if(ev-&gt;value_mask &amp; CWY)
<a href="#h1-17-13" id="h1-17-13" class="d">-				c-&gt;y = m-&gt;sy+ev-&gt;y;
</a><a href="#h1-17-14" id="h1-17-14" class="i">+				c-&gt;y = v-&gt;y + ev-&gt;y;
</a> 			if(ev-&gt;value_mask &amp; CWWidth)
 				c-&gt;w = ev-&gt;width;
 			if(ev-&gt;value_mask &amp; CWHeight)
 				c-&gt;h = ev-&gt;height;
<a href="#h1-17-19" id="h1-17-19" class="d">-			if((c-&gt;x - m-&gt;sx + c-&gt;w) &gt; m-&gt;sw &amp;&amp; c-&gt;isfloating)
</a><a href="#h1-17-20" id="h1-17-20" class="d">-				c-&gt;x = m-&gt;sx + (m-&gt;sw / 2 - c-&gt;w / 2); /* center in x direction */
</a><a href="#h1-17-21" id="h1-17-21" class="d">-			if((c-&gt;y - m-&gt;sy + c-&gt;h) &gt; m-&gt;sh &amp;&amp; c-&gt;isfloating)
</a><a href="#h1-17-22" id="h1-17-22" class="d">-				c-&gt;y = m-&gt;sy + (m-&gt;sh / 2 - c-&gt;h / 2); /* center in y direction */
</a><a href="#h1-17-23" id="h1-17-23" class="d">-			if((ev-&gt;value_mask &amp; (CWX | CWY))
</a><a href="#h1-17-24" id="h1-17-24" class="d">-			&amp;&amp; !(ev-&gt;value_mask &amp; (CWWidth | CWHeight)))
</a><a href="#h1-17-25" id="h1-17-25" class="i">+			if((c-&gt;x - v-&gt;x + c-&gt;w) &gt; v-&gt;w &amp;&amp; c-&gt;isfloating)
</a><a href="#h1-17-26" id="h1-17-26" class="i">+				c-&gt;x = v-&gt;x + (v-&gt;w / 2 - c-&gt;w / 2); /* center in x direction */
</a><a href="#h1-17-27" id="h1-17-27" class="i">+			if((c-&gt;y - v-&gt;y + c-&gt;h) &gt; v-&gt;h &amp;&amp; c-&gt;isfloating)
</a><a href="#h1-17-28" id="h1-17-28" class="i">+				c-&gt;y = v-&gt;y + (v-&gt;h / 2 - c-&gt;h / 2); /* center in y direction */
</a><a href="#h1-17-29" id="h1-17-29" class="i">+			if((ev-&gt;value_mask &amp; (CWX|CWY))
</a><a href="#h1-17-30" id="h1-17-30" class="i">+			&amp;&amp; !(ev-&gt;value_mask &amp; (CWWidth|CWHeight)))
</a> 				configure(c);
<a href="#h1-17-32" id="h1-17-32" class="d">-			if(isvisible(c, monitorat()))
</a><a href="#h1-17-33" id="h1-17-33" class="i">+			if(isvisible(c))
</a> 				XMoveResizeWindow(dpy, c-&gt;win, c-&gt;x, c-&gt;y, c-&gt;w, c-&gt;h);
 		}
 		else
<a href="#h1-18" id="h1-18" class="h">@@ -567,55 +555,53 @@ detachstack(Client *c) {
</a> }
 
 void
<a href="#h1-18-3" id="h1-18-3" class="d">-drawbar(Monitor *m) {
</a><a href="#h1-18-4" id="h1-18-4" class="d">-	int j, x;
</a><a href="#h1-18-5" id="h1-18-5" class="i">+drawbar(View *v) {
</a><a href="#h1-18-6" id="h1-18-6" class="i">+	int i, x;
</a> 	Client *c;
 
 	dc.x = 0;
<a href="#h1-18-10" id="h1-18-10" class="d">-	for(c = stack; c &amp;&amp; !isvisible(c, m); c = c-&gt;snext);
</a><a href="#h1-18-11" id="h1-18-11" class="d">-	for(j = 0; j &lt; LENGTH(tags); j++) {
</a><a href="#h1-18-12" id="h1-18-12" class="d">-		dc.w = textw(tags[j]);
</a><a href="#h1-18-13" id="h1-18-13" class="d">-		if(m-&gt;seltags[j]) {
</a><a href="#h1-18-14" id="h1-18-14" class="d">-			drawtext(m, tags[j], dc.sel, isurgent(m, j));
</a><a href="#h1-18-15" id="h1-18-15" class="d">-			drawsquare(m, c &amp;&amp; c-&gt;tags[j] &amp;&amp; c-&gt;monitor == m,
</a><a href="#h1-18-16" id="h1-18-16" class="d">-					isoccupied(m, j), isurgent(m, j), dc.sel);
</a><a href="#h1-18-17" id="h1-18-17" class="i">+	for(c = stack; c &amp;&amp; !isvisible(c); c = c-&gt;snext);
</a><a href="#h1-18-18" id="h1-18-18" class="i">+	for(i = 0; i &lt; LENGTH(tags); i++) {
</a><a href="#h1-18-19" id="h1-18-19" class="i">+		dc.w = textw(tags[i]);
</a><a href="#h1-18-20" id="h1-18-20" class="i">+		if(seltags[i]) {
</a><a href="#h1-18-21" id="h1-18-21" class="i">+			drawtext(v, tags[i], dc.sel, isurgent(i));
</a><a href="#h1-18-22" id="h1-18-22" class="i">+			drawsquare(v, c &amp;&amp; c-&gt;tags[i], isoccupied(i), isurgent(i), dc.sel);
</a> 		}
 		else {
<a href="#h1-18-25" id="h1-18-25" class="d">-			drawtext(m, tags[j], dc.norm, isurgent(m, j));
</a><a href="#h1-18-26" id="h1-18-26" class="d">-			drawsquare(m, c &amp;&amp; c-&gt;tags[j] &amp;&amp; c-&gt;monitor == m,
</a><a href="#h1-18-27" id="h1-18-27" class="d">-					isoccupied(m, j), isurgent(m, j), dc.norm);
</a><a href="#h1-18-28" id="h1-18-28" class="i">+			drawtext(v, tags[i], dc.norm, isurgent(i));
</a><a href="#h1-18-29" id="h1-18-29" class="i">+			drawsquare(v, c &amp;&amp; c-&gt;tags[i], isoccupied(i), isurgent(i), dc.norm);
</a> 		}
 		dc.x += dc.w;
 	}
 	dc.w = blw;
<a href="#h1-18-34" id="h1-18-34" class="d">-	drawtext(m, m-&gt;layout-&gt;symbol, dc.norm, False);
</a><a href="#h1-18-35" id="h1-18-35" class="i">+	drawtext(v, v-&gt;layout-&gt;symbol, dc.norm, False);
</a> 	x = dc.x + dc.w;
<a href="#h1-18-37" id="h1-18-37" class="d">-	if(m == selmonitor) {
</a><a href="#h1-18-38" id="h1-18-38" class="i">+	if(v == selview) {
</a> 		dc.w = textw(stext);
<a href="#h1-18-40" id="h1-18-40" class="d">-		dc.x = m-&gt;sw - dc.w;
</a><a href="#h1-18-41" id="h1-18-41" class="i">+		dc.x = v-&gt;w - dc.w;
</a> 		if(dc.x &lt; x) {
 			dc.x = x;
<a href="#h1-18-44" id="h1-18-44" class="d">-			dc.w = m-&gt;sw - x;
</a><a href="#h1-18-45" id="h1-18-45" class="i">+			dc.w = v-&gt;w - x;
</a> 		}
<a href="#h1-18-47" id="h1-18-47" class="d">-		drawtext(m, stext, dc.norm, False);
</a><a href="#h1-18-48" id="h1-18-48" class="i">+		drawtext(v, stext, dc.norm, False);
</a> 	}
 	else
<a href="#h1-18-51" id="h1-18-51" class="d">-		dc.x = m-&gt;sw;
</a><a href="#h1-18-52" id="h1-18-52" class="i">+		dc.x = v-&gt;w;
</a> 	if((dc.w = dc.x - x) &gt; bh) {
 		dc.x = x;
 		if(c) {
<a href="#h1-18-56" id="h1-18-56" class="d">-			drawtext(m, c-&gt;name, dc.sel, False);
</a><a href="#h1-18-57" id="h1-18-57" class="d">-			drawsquare(m, False, c-&gt;isfloating, False, dc.sel);
</a><a href="#h1-18-58" id="h1-18-58" class="i">+			drawtext(v, c-&gt;name, dc.sel, False);
</a><a href="#h1-18-59" id="h1-18-59" class="i">+			drawsquare(v, False, c-&gt;isfloating, False, dc.sel);
</a> 		}
 		else
<a href="#h1-18-62" id="h1-18-62" class="d">-			drawtext(m, NULL, dc.norm, False);
</a><a href="#h1-18-63" id="h1-18-63" class="i">+			drawtext(v, NULL, dc.norm, False);
</a> 	}
<a href="#h1-18-65" id="h1-18-65" class="d">-	XCopyArea(dpy, dc.drawable, m-&gt;barwin, dc.gc, 0, 0, m-&gt;sw, bh, 0, 0);
</a><a href="#h1-18-66" id="h1-18-66" class="i">+	XCopyArea(dpy, dc.drawable, v-&gt;barwin, dc.gc, 0, 0, v-&gt;w, bh, 0, 0);
</a> 	XSync(dpy, False);
 }
 
 void
<a href="#h1-18-71" id="h1-18-71" class="d">-drawsquare(Monitor *m, Bool filled, Bool empty, Bool invert, unsigned long col[ColLast]) {
</a><a href="#h1-18-72" id="h1-18-72" class="i">+drawsquare(View *v, Bool filled, Bool empty, Bool invert, unsigned long col[ColLast]) {
</a> 	int x;
 	XGCValues gcv;
 	XRectangle r = { dc.x, dc.y, dc.w, dc.h };
<a href="#h1-19" id="h1-19" class="h">@@ -636,7 +622,7 @@ drawsquare(Monitor *m, Bool filled, Bool empty, Bool invert, unsigned long col[C
</a> }
 
 void
<a href="#h1-19-3" id="h1-19-3" class="d">-drawtext(Monitor *m, const char *text, unsigned long col[ColLast], Bool invert) {
</a><a href="#h1-19-4" id="h1-19-4" class="i">+drawtext(View *v, const char *text, unsigned long col[ColLast], Bool invert) {
</a> 	int x, y, w, h;
 	static char buf[256];
 	unsigned int len, olen;
<a href="#h1-20" id="h1-20" class="h">@@ -695,11 +681,8 @@ enternotify(XEvent *e) {
</a> 	}
 	if((c = getclient(ev-&gt;window)))
 		focus(c);
<a href="#h1-20-3" id="h1-20-3" class="d">-	else {
</a><a href="#h1-20-4" id="h1-20-4" class="d">-		selmonitor = monitorat();
</a><a href="#h1-20-5" id="h1-20-5" class="d">-		fprintf(stderr, &quot;updating selmonitor %d\n&quot;, selmonitor - monitors);
</a><a href="#h1-20-6" id="h1-20-6" class="i">+	else
</a> 		focus(NULL);
<a href="#h1-20-8" id="h1-20-8" class="d">-	}
</a> }
 
 void
<a href="#h1-21" id="h1-21" class="h">@@ -714,29 +697,34 @@ eprint(const char *errstr, ...) {
</a> 
 void
 expose(XEvent *e) {
<a href="#h1-21-3" id="h1-21-3" class="d">-	Monitor *m;
</a><a href="#h1-21-4" id="h1-21-4" class="i">+	View *v;
</a> 	XExposeEvent *ev = &amp;e-&gt;xexpose;
 
<a href="#h1-21-7" id="h1-21-7" class="d">-	if(ev-&gt;count == 0 &amp;&amp; (m = getmonitor(ev-&gt;window)))
</a><a href="#h1-21-8" id="h1-21-8" class="d">-		drawbar(m);
</a><a href="#h1-21-9" id="h1-21-9" class="i">+	if(ev-&gt;count == 0 &amp;&amp; (v = getviewbar(ev-&gt;window)))
</a><a href="#h1-21-10" id="h1-21-10" class="i">+		drawbar(v);
</a> }
 
 void
<a href="#h1-21-14" id="h1-21-14" class="d">-floating(Monitor *m) { /* default floating layout */
</a><a href="#h1-21-15" id="h1-21-15" class="i">+floating(View *v) { /* default floating layout */
</a> 	Client *c;
 
 	domwfact = dozoom = False;
 	for(c = clients; c; c = c-&gt;next)
<a href="#h1-21-20" id="h1-21-20" class="d">-		if(isvisible(c, m))
</a><a href="#h1-21-21" id="h1-21-21" class="i">+		if(isvisible(c))
</a> 			resize(c, c-&gt;x, c-&gt;y, c-&gt;w, c-&gt;h, True);
 }
 
 void
 focus(Client *c) {
<a href="#h1-21-27" id="h1-21-27" class="i">+	View *v = selview;
</a> 	if(c)
<a href="#h1-21-29" id="h1-21-29" class="d">-		selmonitor = c-&gt;monitor;
</a><a href="#h1-21-30" id="h1-21-30" class="d">-	if(!c || (c &amp;&amp; !isvisible(c, selmonitor)))
</a><a href="#h1-21-31" id="h1-21-31" class="d">-		for(c = stack; c &amp;&amp; !isvisible(c, c-&gt;monitor); c = c-&gt;snext);
</a><a href="#h1-21-32" id="h1-21-32" class="i">+		selview = getview(c);
</a><a href="#h1-21-33" id="h1-21-33" class="i">+	else
</a><a href="#h1-21-34" id="h1-21-34" class="i">+		selview = viewat();
</a><a href="#h1-21-35" id="h1-21-35" class="i">+	if(selview != v)
</a><a href="#h1-21-36" id="h1-21-36" class="i">+		drawbar(v);
</a><a href="#h1-21-37" id="h1-21-37" class="i">+	if(!c || (c &amp;&amp; !isvisible(c)))
</a><a href="#h1-21-38" id="h1-21-38" class="i">+		for(c = stack; c &amp;&amp; !isvisible(c); c = c-&gt;snext);
</a> 	if(sel &amp;&amp; sel != c) {
 		grabbuttons(sel, False);
 		XSetWindowBorder(dpy, sel-&gt;win, dc.norm[ColBorder]);
<a href="#h1-22" id="h1-22" class="h">@@ -750,11 +738,11 @@ focus(Client *c) {
</a> 	if(c) {
 		XSetWindowBorder(dpy, c-&gt;win, dc.sel[ColBorder]);
 		XSetInputFocus(dpy, c-&gt;win, RevertToPointerRoot, CurrentTime);
<a href="#h1-22-3" id="h1-22-3" class="d">-		selmonitor = c-&gt;monitor;
</a><a href="#h1-22-4" id="h1-22-4" class="i">+		selview = getview(c);
</a> 	}
 	else
 		XSetInputFocus(dpy, root, RevertToPointerRoot, CurrentTime);
<a href="#h1-22-8" id="h1-22-8" class="d">-	drawbar(selmonitor);
</a><a href="#h1-22-9" id="h1-22-9" class="i">+	drawbar(selview);
</a> }
 
 void
<a href="#h1-23" id="h1-23" class="h">@@ -771,12 +759,12 @@ focusnext(const char *arg) {
</a> 
 	if(!sel)
 		return;
<a href="#h1-23-3" id="h1-23-3" class="d">-	for(c = sel-&gt;next; c &amp;&amp; !isvisible(c, selmonitor); c = c-&gt;next);
</a><a href="#h1-23-4" id="h1-23-4" class="i">+	for(c = sel-&gt;next; c &amp;&amp; !isvisible(c); c = c-&gt;next);
</a> 	if(!c)
<a href="#h1-23-6" id="h1-23-6" class="d">-		for(c = clients; c &amp;&amp; !isvisible(c, selmonitor); c = c-&gt;next);
</a><a href="#h1-23-7" id="h1-23-7" class="i">+		for(c = clients; c &amp;&amp; !isvisible(c); c = c-&gt;next);
</a> 	if(c) {
 		focus(c);
<a href="#h1-23-10" id="h1-23-10" class="d">-		restack(c-&gt;monitor);
</a><a href="#h1-23-11" id="h1-23-11" class="i">+		restack(getview(c));
</a> 	}
 }
 
<a href="#h1-24" id="h1-24" class="h">@@ -786,14 +774,14 @@ focusprev(const char *arg) {
</a> 
 	if(!sel)
 		return;
<a href="#h1-24-3" id="h1-24-3" class="d">-	for(c = sel-&gt;prev; c &amp;&amp; !isvisible(c, selmonitor); c = c-&gt;prev);
</a><a href="#h1-24-4" id="h1-24-4" class="i">+	for(c = sel-&gt;prev; c &amp;&amp; !isvisible(c); c = c-&gt;prev);
</a> 	if(!c) {
 		for(c = clients; c &amp;&amp; c-&gt;next; c = c-&gt;next);
<a href="#h1-24-7" id="h1-24-7" class="d">-		for(; c &amp;&amp; !isvisible(c, selmonitor); c = c-&gt;prev);
</a><a href="#h1-24-8" id="h1-24-8" class="i">+		for(; c &amp;&amp; !isvisible(c); c = c-&gt;prev);
</a> 	}
 	if(c) {
 		focus(c);
<a href="#h1-24-12" id="h1-24-12" class="d">-		restack(c-&gt;monitor);
</a><a href="#h1-24-13" id="h1-24-13" class="i">+		restack(getview(c));
</a> 	}
 }
 
<a href="#h1-25" id="h1-25" class="h">@@ -815,16 +803,26 @@ getcolor(const char *colstr) {
</a> 	return color.pixel;
 }
 
<a href="#h1-25-3" id="h1-25-3" class="d">-Monitor *
</a><a href="#h1-25-4" id="h1-25-4" class="d">-getmonitor(Window barwin) {
</a><a href="#h1-25-5" id="h1-25-5" class="i">+View *
</a><a href="#h1-25-6" id="h1-25-6" class="i">+getviewbar(Window barwin) {
</a> 	unsigned int i;
 
<a href="#h1-25-9" id="h1-25-9" class="d">-	for(i = 0; i &lt; mcount; i++)
</a><a href="#h1-25-10" id="h1-25-10" class="d">-		if(monitors[i].barwin == barwin)
</a><a href="#h1-25-11" id="h1-25-11" class="d">-			return &amp;monitors[i];
</a><a href="#h1-25-12" id="h1-25-12" class="i">+	for(i = 0; i &lt; nviews; i++)
</a><a href="#h1-25-13" id="h1-25-13" class="i">+		if(views[i].barwin == barwin)
</a><a href="#h1-25-14" id="h1-25-14" class="i">+			return &amp;views[i];
</a> 	return NULL;
 }
 
<a href="#h1-25-18" id="h1-25-18" class="i">+View *
</a><a href="#h1-25-19" id="h1-25-19" class="i">+getview(Client *c) {
</a><a href="#h1-25-20" id="h1-25-20" class="i">+	unsigned int i;
</a><a href="#h1-25-21" id="h1-25-21" class="i">+
</a><a href="#h1-25-22" id="h1-25-22" class="i">+	for(i = 0; i &lt; LENGTH(tags); i++)
</a><a href="#h1-25-23" id="h1-25-23" class="i">+		if(c-&gt;tags[i])
</a><a href="#h1-25-24" id="h1-25-24" class="i">+			return &amp;views[c-&gt;tags[i] - 1];
</a><a href="#h1-25-25" id="h1-25-25" class="i">+	return &amp;views[0]; /* fallback */
</a><a href="#h1-25-26" id="h1-25-26" class="i">+}
</a><a href="#h1-25-27" id="h1-25-27" class="i">+
</a> long
 getstate(Window w) {
 	int format, status;
<a href="#h1-26" id="h1-26" class="h">@@ -876,29 +874,29 @@ grabbuttons(Client *c, Bool focused) {
</a> 	if(focused) {
 		XGrabButton(dpy, Button1, MODKEY, c-&gt;win, False, BUTTONMASK,
 				GrabModeAsync, GrabModeSync, None, None);
<a href="#h1-26-3" id="h1-26-3" class="d">-		XGrabButton(dpy, Button1, MODKEY | LockMask, c-&gt;win, False, BUTTONMASK,
</a><a href="#h1-26-4" id="h1-26-4" class="i">+		XGrabButton(dpy, Button1, MODKEY|LockMask, c-&gt;win, False, BUTTONMASK,
</a> 				GrabModeAsync, GrabModeSync, None, None);
<a href="#h1-26-6" id="h1-26-6" class="d">-		XGrabButton(dpy, Button1, MODKEY | numlockmask, c-&gt;win, False, BUTTONMASK,
</a><a href="#h1-26-7" id="h1-26-7" class="i">+		XGrabButton(dpy, Button1, MODKEY|numlockmask, c-&gt;win, False, BUTTONMASK,
</a> 				GrabModeAsync, GrabModeSync, None, None);
<a href="#h1-26-9" id="h1-26-9" class="d">-		XGrabButton(dpy, Button1, MODKEY | numlockmask | LockMask, c-&gt;win, False, BUTTONMASK,
</a><a href="#h1-26-10" id="h1-26-10" class="i">+		XGrabButton(dpy, Button1, MODKEY|numlockmask|LockMask, c-&gt;win, False, BUTTONMASK,
</a> 				GrabModeAsync, GrabModeSync, None, None);
 
 		XGrabButton(dpy, Button2, MODKEY, c-&gt;win, False, BUTTONMASK,
 				GrabModeAsync, GrabModeSync, None, None);
<a href="#h1-26-15" id="h1-26-15" class="d">-		XGrabButton(dpy, Button2, MODKEY | LockMask, c-&gt;win, False, BUTTONMASK,
</a><a href="#h1-26-16" id="h1-26-16" class="i">+		XGrabButton(dpy, Button2, MODKEY|LockMask, c-&gt;win, False, BUTTONMASK,
</a> 				GrabModeAsync, GrabModeSync, None, None);
<a href="#h1-26-18" id="h1-26-18" class="d">-		XGrabButton(dpy, Button2, MODKEY | numlockmask, c-&gt;win, False, BUTTONMASK,
</a><a href="#h1-26-19" id="h1-26-19" class="i">+		XGrabButton(dpy, Button2, MODKEY|numlockmask, c-&gt;win, False, BUTTONMASK,
</a> 				GrabModeAsync, GrabModeSync, None, None);
<a href="#h1-26-21" id="h1-26-21" class="d">-		XGrabButton(dpy, Button2, MODKEY | numlockmask | LockMask, c-&gt;win, False, BUTTONMASK,
</a><a href="#h1-26-22" id="h1-26-22" class="i">+		XGrabButton(dpy, Button2, MODKEY|numlockmask|LockMask, c-&gt;win, False, BUTTONMASK,
</a> 				GrabModeAsync, GrabModeSync, None, None);
 
 		XGrabButton(dpy, Button3, MODKEY, c-&gt;win, False, BUTTONMASK,
 				GrabModeAsync, GrabModeSync, None, None);
<a href="#h1-26-27" id="h1-26-27" class="d">-		XGrabButton(dpy, Button3, MODKEY | LockMask, c-&gt;win, False, BUTTONMASK,
</a><a href="#h1-26-28" id="h1-26-28" class="i">+		XGrabButton(dpy, Button3, MODKEY|LockMask, c-&gt;win, False, BUTTONMASK,
</a> 				GrabModeAsync, GrabModeSync, None, None);
<a href="#h1-26-30" id="h1-26-30" class="d">-		XGrabButton(dpy, Button3, MODKEY | numlockmask, c-&gt;win, False, BUTTONMASK,
</a><a href="#h1-26-31" id="h1-26-31" class="i">+		XGrabButton(dpy, Button3, MODKEY|numlockmask, c-&gt;win, False, BUTTONMASK,
</a> 				GrabModeAsync, GrabModeSync, None, None);
<a href="#h1-26-33" id="h1-26-33" class="d">-		XGrabButton(dpy, Button3, MODKEY | numlockmask | LockMask, c-&gt;win, False, BUTTONMASK,
</a><a href="#h1-26-34" id="h1-26-34" class="i">+		XGrabButton(dpy, Button3, MODKEY|numlockmask|LockMask, c-&gt;win, False, BUTTONMASK,
</a> 				GrabModeAsync, GrabModeSync, None, None);
 	}
 	else
<a href="#h1-27" id="h1-27" class="h">@@ -926,11 +924,11 @@ grabkeys(void)  {
</a> 		code = XKeysymToKeycode(dpy, keys[i].keysym);
 		XGrabKey(dpy, code, keys[i].mod, root, True,
 				GrabModeAsync, GrabModeAsync);
<a href="#h1-27-3" id="h1-27-3" class="d">-		XGrabKey(dpy, code, keys[i].mod | LockMask, root, True,
</a><a href="#h1-27-4" id="h1-27-4" class="i">+		XGrabKey(dpy, code, keys[i].mod|LockMask, root, True,
</a> 				GrabModeAsync, GrabModeAsync);
<a href="#h1-27-6" id="h1-27-6" class="d">-		XGrabKey(dpy, code, keys[i].mod | numlockmask, root, True,
</a><a href="#h1-27-7" id="h1-27-7" class="i">+		XGrabKey(dpy, code, keys[i].mod|numlockmask, root, True,
</a> 				GrabModeAsync, GrabModeAsync);
<a href="#h1-27-9" id="h1-27-9" class="d">-		XGrabKey(dpy, code, keys[i].mod | numlockmask | LockMask, root, True,
</a><a href="#h1-27-10" id="h1-27-10" class="i">+		XGrabKey(dpy, code, keys[i].mod|numlockmask|LockMask, root, True,
</a> 				GrabModeAsync, GrabModeAsync);
 	}
 }
<a href="#h1-28" id="h1-28" class="h">@@ -986,11 +984,11 @@ initfont(const char *fontstr) {
</a> }
 
 Bool
<a href="#h1-28-3" id="h1-28-3" class="d">-isoccupied(Monitor *monitor, unsigned int t) {
</a><a href="#h1-28-4" id="h1-28-4" class="i">+isoccupied(unsigned int t) {
</a> 	Client *c;
 
 	for(c = clients; c; c = c-&gt;next)
<a href="#h1-28-8" id="h1-28-8" class="d">-		if(c-&gt;tags[t] &amp;&amp; c-&gt;monitor == monitor)
</a><a href="#h1-28-9" id="h1-28-9" class="i">+		if(c-&gt;tags[t])
</a> 			return True;
 	return False;
 }
<a href="#h1-29" id="h1-29" class="h">@@ -1011,23 +1009,21 @@ isprotodel(Client *c) {
</a> }
 
 Bool
<a href="#h1-29-3" id="h1-29-3" class="d">-isurgent(Monitor *monitor, unsigned int t) {
</a><a href="#h1-29-4" id="h1-29-4" class="i">+isurgent(unsigned int t) {
</a> 	Client *c;
 
 	for(c = clients; c; c = c-&gt;next)
<a href="#h1-29-8" id="h1-29-8" class="d">-		if(c-&gt;monitor == monitor &amp;&amp; c-&gt;isurgent &amp;&amp; c-&gt;tags[t])
</a><a href="#h1-29-9" id="h1-29-9" class="i">+		if(c-&gt;isurgent &amp;&amp; c-&gt;tags[t])
</a> 			return True;
 	return False;
 }
 
 Bool
<a href="#h1-29-15" id="h1-29-15" class="d">-isvisible(Client *c, Monitor *m) {
</a><a href="#h1-29-16" id="h1-29-16" class="i">+isvisible(Client *c) {
</a> 	unsigned int i;
 
<a href="#h1-29-19" id="h1-29-19" class="d">-	if(c-&gt;monitor != m)
</a><a href="#h1-29-20" id="h1-29-20" class="d">-		return False;
</a> 	for(i = 0; i &lt; LENGTH(tags); i++)
<a href="#h1-29-22" id="h1-29-22" class="d">-		if(c-&gt;tags[i] &amp;&amp; c-&gt;monitor-&gt;seltags[i])
</a><a href="#h1-29-23" id="h1-29-23" class="i">+		if(c-&gt;tags[i] &amp;&amp; seltags[i])
</a> 			return True;
 	return False;
 }
<a href="#h1-30" id="h1-30" class="h">@@ -1071,7 +1067,7 @@ killclient(const char *arg) {
</a> void
 manage(Window w, XWindowAttributes *wa) {
 	Client *c, *t = NULL;
<a href="#h1-30-3" id="h1-30-3" class="d">-	Monitor *m;
</a><a href="#h1-30-4" id="h1-30-4" class="i">+	View *v;
</a> 	Status rettrans;
 	Window trans;
 	XWindowChanges wc;
<a href="#h1-31" id="h1-31" class="h">@@ -1082,28 +1078,28 @@ manage(Window w, XWindowAttributes *wa) {
</a> 
 	applyrules(c);
 
<a href="#h1-31-3" id="h1-31-3" class="d">-	m = c-&gt;monitor;
</a><a href="#h1-31-4" id="h1-31-4" class="i">+	v = getview(c);
</a> 
<a href="#h1-31-6" id="h1-31-6" class="d">-	c-&gt;x = wa-&gt;x + m-&gt;sx;
</a><a href="#h1-31-7" id="h1-31-7" class="d">-	c-&gt;y = wa-&gt;y + m-&gt;sy;
</a><a href="#h1-31-8" id="h1-31-8" class="i">+	c-&gt;x = wa-&gt;x + v-&gt;x;
</a><a href="#h1-31-9" id="h1-31-9" class="i">+	c-&gt;y = wa-&gt;y + v-&gt;y;
</a> 	c-&gt;w = wa-&gt;width;
 	c-&gt;h = wa-&gt;height;
 	c-&gt;oldborder = wa-&gt;border_width;
 
<a href="#h1-31-14" id="h1-31-14" class="d">-	if(c-&gt;w == m-&gt;sw &amp;&amp; c-&gt;h == m-&gt;sh) {
</a><a href="#h1-31-15" id="h1-31-15" class="d">-		c-&gt;x = m-&gt;sx;
</a><a href="#h1-31-16" id="h1-31-16" class="d">-		c-&gt;y = m-&gt;sy;
</a><a href="#h1-31-17" id="h1-31-17" class="i">+	if(c-&gt;w == v-&gt;w &amp;&amp; c-&gt;h == v-&gt;h) {
</a><a href="#h1-31-18" id="h1-31-18" class="i">+		c-&gt;x = v-&gt;x;
</a><a href="#h1-31-19" id="h1-31-19" class="i">+		c-&gt;y = v-&gt;y;
</a> 		c-&gt;border = wa-&gt;border_width;
 	}
 	else {
<a href="#h1-31-23" id="h1-31-23" class="d">-		if(c-&gt;x + c-&gt;w + 2 * c-&gt;border &gt; m-&gt;wax + m-&gt;waw)
</a><a href="#h1-31-24" id="h1-31-24" class="d">-			c-&gt;x = m-&gt;wax + m-&gt;waw - c-&gt;w - 2 * c-&gt;border;
</a><a href="#h1-31-25" id="h1-31-25" class="d">-		if(c-&gt;y + c-&gt;h + 2 * c-&gt;border &gt; m-&gt;way + m-&gt;wah)
</a><a href="#h1-31-26" id="h1-31-26" class="d">-			c-&gt;y = m-&gt;way + m-&gt;wah - c-&gt;h - 2 * c-&gt;border;
</a><a href="#h1-31-27" id="h1-31-27" class="d">-		if(c-&gt;x &lt; m-&gt;wax)
</a><a href="#h1-31-28" id="h1-31-28" class="d">-			c-&gt;x = m-&gt;wax;
</a><a href="#h1-31-29" id="h1-31-29" class="d">-		if(c-&gt;y &lt; m-&gt;way)
</a><a href="#h1-31-30" id="h1-31-30" class="d">-			c-&gt;y = m-&gt;way;
</a><a href="#h1-31-31" id="h1-31-31" class="i">+		if(c-&gt;x + c-&gt;w + 2 * c-&gt;border &gt; v-&gt;wax + v-&gt;waw)
</a><a href="#h1-31-32" id="h1-31-32" class="i">+			c-&gt;x = v-&gt;wax + v-&gt;waw - c-&gt;w - 2 * c-&gt;border;
</a><a href="#h1-31-33" id="h1-31-33" class="i">+		if(c-&gt;y + c-&gt;h + 2 * c-&gt;border &gt; v-&gt;way + v-&gt;wah)
</a><a href="#h1-31-34" id="h1-31-34" class="i">+			c-&gt;y = v-&gt;way + v-&gt;wah - c-&gt;h - 2 * c-&gt;border;
</a><a href="#h1-31-35" id="h1-31-35" class="i">+		if(c-&gt;x &lt; v-&gt;wax)
</a><a href="#h1-31-36" id="h1-31-36" class="i">+			c-&gt;x = v-&gt;wax;
</a><a href="#h1-31-37" id="h1-31-37" class="i">+		if(c-&gt;y &lt; v-&gt;way)
</a><a href="#h1-31-38" id="h1-31-38" class="i">+			c-&gt;y = v-&gt;way;
</a> 		c-&gt;border = BORDERPX;
 	}
 	wc.border_width = c-&gt;border;
<a href="#h1-32" id="h1-32" class="h">@@ -1111,7 +1107,7 @@ manage(Window w, XWindowAttributes *wa) {
</a> 	XSetWindowBorder(dpy, w, dc.norm[ColBorder]);
 	configure(c); /* propagates border_width, if size doesn&#39;t change */
 	updatesizehints(c);
<a href="#h1-32-3" id="h1-32-3" class="d">-	XSelectInput(dpy, w, EnterWindowMask | FocusChangeMask | PropertyChangeMask | StructureNotifyMask);
</a><a href="#h1-32-4" id="h1-32-4" class="i">+	XSelectInput(dpy, w, EnterWindowMask|FocusChangeMask|PropertyChangeMask|StructureNotifyMask);
</a> 	grabbuttons(c, False);
 	updatetitle(c);
 	if((rettrans = XGetTransientForHint(dpy, w, &amp;trans) == Success))
<a href="#h1-33" id="h1-33" class="h">@@ -1126,7 +1122,7 @@ manage(Window w, XWindowAttributes *wa) {
</a> 	ban(c);
 	XMapWindow(dpy, c-&gt;win);
 	setclientstate(c, NormalState);
<a href="#h1-33-3" id="h1-33-3" class="d">-	arrange(m);
</a><a href="#h1-33-4" id="h1-33-4" class="i">+	arrange();
</a> }
 
 void
<a href="#h1-34" id="h1-34" class="h">@@ -1151,17 +1147,17 @@ maprequest(XEvent *e) {
</a> 		manage(ev-&gt;window, &amp;wa);
 }
 
<a href="#h1-34-3" id="h1-34-3" class="d">-Monitor *
</a><a href="#h1-34-4" id="h1-34-4" class="d">-monitorat() {
</a><a href="#h1-34-5" id="h1-34-5" class="i">+View *
</a><a href="#h1-34-6" id="h1-34-6" class="i">+viewat() {
</a> 	int i, x, y;
 	Window win;
 	unsigned int mask;
 
 	XQueryPointer(dpy, root, &amp;win, &amp;win, &amp;x, &amp;y, &amp;i, &amp;i, &amp;mask);
<a href="#h1-34-12" id="h1-34-12" class="d">-	for(i = 0; i &lt; mcount; i++) {
</a><a href="#h1-34-13" id="h1-34-13" class="d">-		if((x &gt;= monitors[i].sx &amp;&amp; x &lt; monitors[i].sx + monitors[i].sw)
</a><a href="#h1-34-14" id="h1-34-14" class="d">-		&amp;&amp; (y &gt;= monitors[i].sy &amp;&amp; y &lt; monitors[i].sy + monitors[i].sh)) {
</a><a href="#h1-34-15" id="h1-34-15" class="d">-			return &amp;monitors[i];
</a><a href="#h1-34-16" id="h1-34-16" class="i">+	for(i = 0; i &lt; nviews; i++) {
</a><a href="#h1-34-17" id="h1-34-17" class="i">+		if((x &gt;= views[i].x &amp;&amp; x &lt; views[i].x + views[i].w)
</a><a href="#h1-34-18" id="h1-34-18" class="i">+		&amp;&amp; (y &gt;= views[i].y &amp;&amp; y &lt; views[i].y + views[i].h)) {
</a><a href="#h1-34-19" id="h1-34-19" class="i">+			return &amp;views[i];
</a> 		}
 	}
 	return NULL;
<a href="#h1-35" id="h1-35" class="h">@@ -1171,19 +1167,19 @@ void
</a> movemouse(Client *c) {
 	int x1, y1, ocx, ocy, di, nx, ny;
 	unsigned int dui;
<a href="#h1-35-3" id="h1-35-3" class="d">-	Monitor *m;
</a><a href="#h1-35-4" id="h1-35-4" class="i">+	View *v;
</a> 	Window dummy;
 	XEvent ev;
 
 	ocx = nx = c-&gt;x;
 	ocy = ny = c-&gt;y;
<a href="#h1-35-10" id="h1-35-10" class="d">-	m = c-&gt;monitor;
</a><a href="#h1-35-11" id="h1-35-11" class="i">+	v = getview(c);
</a> 	if(XGrabPointer(dpy, root, False, MOUSEMASK, GrabModeAsync, GrabModeAsync,
 			None, cursor[CurMove], CurrentTime) != GrabSuccess)
 		return;
 	XQueryPointer(dpy, root, &amp;dummy, &amp;dummy, &amp;x1, &amp;y1, &amp;di, &amp;di, &amp;dui);
 	for(;;) {
<a href="#h1-35-17" id="h1-35-17" class="d">-		XMaskEvent(dpy, MOUSEMASK | ExposureMask | SubstructureRedirectMask, &amp;ev);
</a><a href="#h1-35-18" id="h1-35-18" class="i">+		XMaskEvent(dpy, MOUSEMASK|ExposureMask|SubstructureRedirectMask, &amp;ev);
</a> 		switch (ev.type) {
 		case ButtonRelease:
 			XUngrabPointer(dpy, CurrentTime);
<a href="#h1-36" id="h1-36" class="h">@@ -1197,17 +1193,17 @@ movemouse(Client *c) {
</a> 			XSync(dpy, False);
 			nx = ocx + (ev.xmotion.x - x1);
 			ny = ocy + (ev.xmotion.y - y1);
<a href="#h1-36-3" id="h1-36-3" class="d">-			if(abs(m-&gt;wax - nx) &lt; SNAP)
</a><a href="#h1-36-4" id="h1-36-4" class="d">-				nx = m-&gt;wax;
</a><a href="#h1-36-5" id="h1-36-5" class="d">-			else if(abs((m-&gt;wax + m-&gt;waw) - (nx + c-&gt;w + 2 * c-&gt;border)) &lt; SNAP)
</a><a href="#h1-36-6" id="h1-36-6" class="d">-				nx = m-&gt;wax + m-&gt;waw - c-&gt;w - 2 * c-&gt;border;
</a><a href="#h1-36-7" id="h1-36-7" class="d">-			if(abs(m-&gt;way - ny) &lt; SNAP)
</a><a href="#h1-36-8" id="h1-36-8" class="d">-				ny = m-&gt;way;
</a><a href="#h1-36-9" id="h1-36-9" class="d">-			else if(abs((m-&gt;way + m-&gt;wah) - (ny + c-&gt;h + 2 * c-&gt;border)) &lt; SNAP)
</a><a href="#h1-36-10" id="h1-36-10" class="d">-				ny = m-&gt;way + m-&gt;wah - c-&gt;h - 2 * c-&gt;border;
</a><a href="#h1-36-11" id="h1-36-11" class="d">-			if(!c-&gt;isfloating &amp;&amp; (m-&gt;layout-&gt;arrange != floating) &amp;&amp; (abs(nx - c-&gt;x) &gt; SNAP || abs(ny - c-&gt;y) &gt; SNAP))
</a><a href="#h1-36-12" id="h1-36-12" class="i">+			if(abs(v-&gt;wax - nx) &lt; SNAP)
</a><a href="#h1-36-13" id="h1-36-13" class="i">+				nx = v-&gt;wax;
</a><a href="#h1-36-14" id="h1-36-14" class="i">+			else if(abs((v-&gt;wax + v-&gt;waw) - (nx + c-&gt;w + 2 * c-&gt;border)) &lt; SNAP)
</a><a href="#h1-36-15" id="h1-36-15" class="i">+				nx = v-&gt;wax + v-&gt;waw - c-&gt;w - 2 * c-&gt;border;
</a><a href="#h1-36-16" id="h1-36-16" class="i">+			if(abs(v-&gt;way - ny) &lt; SNAP)
</a><a href="#h1-36-17" id="h1-36-17" class="i">+				ny = v-&gt;way;
</a><a href="#h1-36-18" id="h1-36-18" class="i">+			else if(abs((v-&gt;way + v-&gt;wah) - (ny + c-&gt;h + 2 * c-&gt;border)) &lt; SNAP)
</a><a href="#h1-36-19" id="h1-36-19" class="i">+				ny = v-&gt;way + v-&gt;wah - c-&gt;h - 2 * c-&gt;border;
</a><a href="#h1-36-20" id="h1-36-20" class="i">+			if(!c-&gt;isfloating &amp;&amp; (v-&gt;layout-&gt;arrange != floating) &amp;&amp; (abs(nx - c-&gt;x) &gt; SNAP || abs(ny - c-&gt;y) &gt; SNAP))
</a> 				togglefloating(NULL);
<a href="#h1-36-22" id="h1-36-22" class="d">-			if((m-&gt;layout-&gt;arrange == floating) || c-&gt;isfloating)
</a><a href="#h1-36-23" id="h1-36-23" class="i">+			if((v-&gt;layout-&gt;arrange == floating) || c-&gt;isfloating)
</a> 				resize(c, nx, ny, c-&gt;w, c-&gt;h, False);
 			break;
 		}
<a href="#h1-37" id="h1-37" class="h">@@ -1215,8 +1211,8 @@ movemouse(Client *c) {
</a> }
 
 Client *
<a href="#h1-37-3" id="h1-37-3" class="d">-nexttiled(Client *c, Monitor *monitor) {
</a><a href="#h1-37-4" id="h1-37-4" class="d">-	for(; c &amp;&amp; (c-&gt;isfloating || !isvisible(c, monitor)); c = c-&gt;next);
</a><a href="#h1-37-5" id="h1-37-5" class="i">+nexttiled(Client *c, View *v) {
</a><a href="#h1-37-6" id="h1-37-6" class="i">+	for(; c &amp;&amp; (c-&gt;isfloating || getview(c) != v || !isvisible(c)); c = c-&gt;next);
</a> 	return c;
 }
 
<a href="#h1-38" id="h1-38" class="h">@@ -1234,20 +1230,20 @@ propertynotify(XEvent *e) {
</a> 		case XA_WM_TRANSIENT_FOR:
 			XGetTransientForHint(dpy, c-&gt;win, &amp;trans);
 			if(!c-&gt;isfloating &amp;&amp; (c-&gt;isfloating = (getclient(trans) != NULL)))
<a href="#h1-38-3" id="h1-38-3" class="d">-				arrange(c-&gt;monitor);
</a><a href="#h1-38-4" id="h1-38-4" class="i">+				arrange();
</a> 			break;
 		case XA_WM_NORMAL_HINTS:
 			updatesizehints(c);
 			break;
 		case XA_WM_HINTS:
 			updatewmhints(c);
<a href="#h1-38-11" id="h1-38-11" class="d">-			drawbar(c-&gt;monitor);
</a><a href="#h1-38-12" id="h1-38-12" class="i">+			drawbar(getview(c));
</a> 			break;
 		}
 		if(ev-&gt;atom == XA_WM_NAME || ev-&gt;atom == netatom[NetWMName]) {
 			updatetitle(c);
 			if(c == sel)
<a href="#h1-38-18" id="h1-38-18" class="d">-				drawbar(c-&gt;monitor);
</a><a href="#h1-38-19" id="h1-38-19" class="i">+				drawbar(selview);
</a> 		}
 	}
 }
<a href="#h1-39" id="h1-39" class="h">@@ -1266,15 +1262,15 @@ reapply(const char *arg) {
</a> 		memcpy(c-&gt;tags, zerotags, sizeof zerotags);
 		applyrules(c);
 	}
<a href="#h1-39-3" id="h1-39-3" class="d">-	arrange(NULL);
</a><a href="#h1-39-4" id="h1-39-4" class="i">+	arrange();
</a> }
 
 void
 resize(Client *c, int x, int y, int w, int h, Bool sizehints) {
<a href="#h1-39-9" id="h1-39-9" class="d">-	Monitor *m;
</a><a href="#h1-39-10" id="h1-39-10" class="i">+	View *v;
</a> 	XWindowChanges wc;
 
<a href="#h1-39-13" id="h1-39-13" class="d">-	m = c-&gt;monitor;
</a><a href="#h1-39-14" id="h1-39-14" class="i">+	v = getview(c);
</a> 	if(sizehints) {
 		/* set minimum possible */
 		if (w &lt; 1)
<a href="#h1-40" id="h1-40" class="h">@@ -1315,22 +1311,22 @@ resize(Client *c, int x, int y, int w, int h, Bool sizehints) {
</a> 	}
 	if(w &lt;= 0 || h &lt;= 0)
 		return;
<a href="#h1-40-3" id="h1-40-3" class="d">-	if(x &gt; m-&gt;sw)
</a><a href="#h1-40-4" id="h1-40-4" class="d">-		x = m-&gt;sw - w - 2 * c-&gt;border;
</a><a href="#h1-40-5" id="h1-40-5" class="d">-	if(y &gt; m-&gt;sh)
</a><a href="#h1-40-6" id="h1-40-6" class="d">-		y = m-&gt;sh - h - 2 * c-&gt;border;
</a><a href="#h1-40-7" id="h1-40-7" class="d">-	if(x + w + 2 * c-&gt;border &lt; m-&gt;sx)
</a><a href="#h1-40-8" id="h1-40-8" class="d">-		x = m-&gt;sx;
</a><a href="#h1-40-9" id="h1-40-9" class="d">-	if(y + h + 2 * c-&gt;border &lt; m-&gt;sy)
</a><a href="#h1-40-10" id="h1-40-10" class="d">-		y = m-&gt;sy;
</a><a href="#h1-40-11" id="h1-40-11" class="d">-	fprintf(stderr, &quot;resize %d %d %d %d (%d %d %d %d)\n&quot;, x, y , w, h, m-&gt;sx, m-&gt;sy, m-&gt;sw, m-&gt;sh);
</a><a href="#h1-40-12" id="h1-40-12" class="i">+	if(x &gt; v-&gt;x + v-&gt;w)
</a><a href="#h1-40-13" id="h1-40-13" class="i">+		x = v-&gt;w - w - 2 * c-&gt;border;
</a><a href="#h1-40-14" id="h1-40-14" class="i">+	if(y &gt; v-&gt;y + v-&gt;h)
</a><a href="#h1-40-15" id="h1-40-15" class="i">+		y = v-&gt;h - h - 2 * c-&gt;border;
</a><a href="#h1-40-16" id="h1-40-16" class="i">+	if(x + w + 2 * c-&gt;border &lt; v-&gt;x)
</a><a href="#h1-40-17" id="h1-40-17" class="i">+		x = v-&gt;x;
</a><a href="#h1-40-18" id="h1-40-18" class="i">+	if(y + h + 2 * c-&gt;border &lt; v-&gt;y)
</a><a href="#h1-40-19" id="h1-40-19" class="i">+		y = v-&gt;y;
</a> 	if(c-&gt;x != x || c-&gt;y != y || c-&gt;w != w || c-&gt;h != h) {
 		c-&gt;x = wc.x = x;
 		c-&gt;y = wc.y = y;
 		c-&gt;w = wc.width = w;
 		c-&gt;h = wc.height = h;
 		wc.border_width = c-&gt;border;
<a href="#h1-40-26" id="h1-40-26" class="d">-		XConfigureWindow(dpy, c-&gt;win, CWX | CWY | CWWidth | CWHeight | CWBorderWidth, &amp;wc);
</a><a href="#h1-40-27" id="h1-40-27" class="i">+		XConfigureWindow(dpy, c-&gt;win,
</a><a href="#h1-40-28" id="h1-40-28" class="i">+				CWX|CWY|CWWidth|CWHeight|CWBorderWidth, &amp;wc);
</a> 		configure(c);
 		XSync(dpy, False);
 	}
<a href="#h1-41" id="h1-41" class="h">@@ -1340,18 +1336,18 @@ void
</a> resizemouse(Client *c) {
 	int ocx, ocy;
 	int nw, nh;
<a href="#h1-41-3" id="h1-41-3" class="d">-	Monitor *m;
</a><a href="#h1-41-4" id="h1-41-4" class="i">+	View *v;
</a> 	XEvent ev;
 
 	ocx = c-&gt;x;
 	ocy = c-&gt;y;
<a href="#h1-41-9" id="h1-41-9" class="d">-	m = c-&gt;monitor;
</a><a href="#h1-41-10" id="h1-41-10" class="i">+	v = getview(c);
</a> 	if(XGrabPointer(dpy, root, False, MOUSEMASK, GrabModeAsync, GrabModeAsync,
 			None, cursor[CurResize], CurrentTime) != GrabSuccess)
 		return;
 	XWarpPointer(dpy, None, c-&gt;win, 0, 0, 0, 0, c-&gt;w + c-&gt;border - 1, c-&gt;h + c-&gt;border - 1);
 	for(;;) {
<a href="#h1-41-16" id="h1-41-16" class="d">-		XMaskEvent(dpy, MOUSEMASK | ExposureMask | SubstructureRedirectMask , &amp;ev);
</a><a href="#h1-41-17" id="h1-41-17" class="i">+		XMaskEvent(dpy, MOUSEMASK|ExposureMask|SubstructureRedirectMask , &amp;ev);
</a> 		switch(ev.type) {
 		case ButtonRelease:
 			XWarpPointer(dpy, None, c-&gt;win, 0, 0, 0, 0,
<a href="#h1-42" id="h1-42" class="h">@@ -1370,9 +1366,9 @@ resizemouse(Client *c) {
</a> 				nw = 1;
 			if((nh = ev.xmotion.y - ocy - 2 * c-&gt;border + 1) &lt;= 0)
 				nh = 1;
<a href="#h1-42-3" id="h1-42-3" class="d">-			if(!c-&gt;isfloating &amp;&amp; (m-&gt;layout-&gt;arrange != floating) &amp;&amp; (abs(nw - c-&gt;w) &gt; SNAP || abs(nh - c-&gt;h) &gt; SNAP))
</a><a href="#h1-42-4" id="h1-42-4" class="i">+			if(!c-&gt;isfloating &amp;&amp; (v-&gt;layout-&gt;arrange != floating) &amp;&amp; (abs(nw - c-&gt;w) &gt; SNAP || abs(nh - c-&gt;h) &gt; SNAP))
</a> 				togglefloating(NULL);
<a href="#h1-42-6" id="h1-42-6" class="d">-			if((m-&gt;layout-&gt;arrange == floating) || c-&gt;isfloating)
</a><a href="#h1-42-7" id="h1-42-7" class="i">+			if((v-&gt;layout-&gt;arrange == floating) || c-&gt;isfloating)
</a> 				resize(c, c-&gt;x, c-&gt;y, nw, nh, True);
 			break;
 		}
<a href="#h1-43" id="h1-43" class="h">@@ -1380,27 +1376,27 @@ resizemouse(Client *c) {
</a> }
 
 void
<a href="#h1-43-3" id="h1-43-3" class="d">-restack(Monitor *m) {
</a><a href="#h1-43-4" id="h1-43-4" class="i">+restack(View *v) {
</a> 	Client *c;
 	XEvent ev;
 	XWindowChanges wc;
 
<a href="#h1-43-9" id="h1-43-9" class="d">-	drawbar(m);
</a><a href="#h1-43-10" id="h1-43-10" class="i">+	drawbar(v);
</a> 	if(!sel)
 		return;
<a href="#h1-43-13" id="h1-43-13" class="d">-	if(sel-&gt;isfloating || (m-&gt;layout-&gt;arrange == floating))
</a><a href="#h1-43-14" id="h1-43-14" class="i">+	if(sel-&gt;isfloating || (v-&gt;layout-&gt;arrange == floating))
</a> 		XRaiseWindow(dpy, sel-&gt;win);
<a href="#h1-43-16" id="h1-43-16" class="d">-	if(m-&gt;layout-&gt;arrange != floating) {
</a><a href="#h1-43-17" id="h1-43-17" class="i">+	if(v-&gt;layout-&gt;arrange != floating) {
</a> 		wc.stack_mode = Below;
<a href="#h1-43-19" id="h1-43-19" class="d">-		wc.sibling = m-&gt;barwin;
</a><a href="#h1-43-20" id="h1-43-20" class="i">+		wc.sibling = v-&gt;barwin;
</a> 		if(!sel-&gt;isfloating) {
<a href="#h1-43-22" id="h1-43-22" class="d">-			XConfigureWindow(dpy, sel-&gt;win, CWSibling | CWStackMode, &amp;wc);
</a><a href="#h1-43-23" id="h1-43-23" class="i">+			XConfigureWindow(dpy, sel-&gt;win, CWSibling|CWStackMode, &amp;wc);
</a> 			wc.sibling = sel-&gt;win;
 		}
<a href="#h1-43-26" id="h1-43-26" class="d">-		for(c = nexttiled(clients, m); c; c = nexttiled(c-&gt;next, m)) {
</a><a href="#h1-43-27" id="h1-43-27" class="i">+		for(c = nexttiled(clients, v); c; c = nexttiled(c-&gt;next, v)) {
</a> 			if(c == sel)
 				continue;
<a href="#h1-43-30" id="h1-43-30" class="d">-			XConfigureWindow(dpy, c-&gt;win, CWSibling | CWStackMode, &amp;wc);
</a><a href="#h1-43-31" id="h1-43-31" class="i">+			XConfigureWindow(dpy, c-&gt;win, CWSibling|CWStackMode, &amp;wc);
</a> 			wc.sibling = c-&gt;win;
 		}
 	}
<a href="#h1-44" id="h1-44" class="h">@@ -1458,7 +1454,7 @@ run(void) {
</a> 					}
 				break;
 			}
<a href="#h1-44-3" id="h1-44-3" class="d">-			drawbar(selmonitor);
</a><a href="#h1-44-4" id="h1-44-4" class="i">+			drawbar(selview);
</a> 		}
 		while(XPending(dpy)) {
 			XNextEvent(dpy, &amp;ev);
<a href="#h1-45" id="h1-45" class="h">@@ -1506,12 +1502,12 @@ setclientstate(Client *c, long state) {
</a> void
 setlayout(const char *arg) {
 	unsigned int i;
<a href="#h1-45-3" id="h1-45-3" class="d">-	Monitor *m = monitorat();
</a><a href="#h1-45-4" id="h1-45-4" class="i">+	View *v = selview;
</a> 
 	if(!arg) {
<a href="#h1-45-7" id="h1-45-7" class="d">-		m-&gt;layout++;
</a><a href="#h1-45-8" id="h1-45-8" class="d">-		if(m-&gt;layout == &amp;layouts[LENGTH(layouts)])
</a><a href="#h1-45-9" id="h1-45-9" class="d">-			m-&gt;layout = &amp;layouts[0];
</a><a href="#h1-45-10" id="h1-45-10" class="i">+		v-&gt;layout++;
</a><a href="#h1-45-11" id="h1-45-11" class="i">+		if(v-&gt;layout == &amp;layouts[LENGTH(layouts)])
</a><a href="#h1-45-12" id="h1-45-12" class="i">+			v-&gt;layout = &amp;layouts[0];
</a> 	}
 	else {
 		for(i = 0; i &lt; LENGTH(layouts); i++)
<a href="#h1-46" id="h1-46" class="h">@@ -1519,42 +1515,42 @@ setlayout(const char *arg) {
</a> 				break;
 		if(i == LENGTH(layouts))
 			return;
<a href="#h1-46-3" id="h1-46-3" class="d">-		m-&gt;layout = &amp;layouts[i];
</a><a href="#h1-46-4" id="h1-46-4" class="i">+		v-&gt;layout = &amp;layouts[i];
</a> 	}
 	if(sel)
<a href="#h1-46-7" id="h1-46-7" class="d">-		arrange(m);
</a><a href="#h1-46-8" id="h1-46-8" class="i">+		arrange();
</a> 	else
<a href="#h1-46-10" id="h1-46-10" class="d">-		drawbar(m);
</a><a href="#h1-46-11" id="h1-46-11" class="i">+		drawbar(v);
</a> }
 
 void
 setmwfact(const char *arg) {
 	double delta;
 
<a href="#h1-46-18" id="h1-46-18" class="d">-	Monitor *m = monitorat();
</a><a href="#h1-46-19" id="h1-46-19" class="i">+	View *v = selview;
</a> 
 	if(!domwfact)
 		return;
 	/* arg handling, manipulate mwfact */
 	if(arg == NULL)
<a href="#h1-46-25" id="h1-46-25" class="d">-		m-&gt;mwfact = MWFACT;
</a><a href="#h1-46-26" id="h1-46-26" class="i">+		v-&gt;mwfact = MWFACT;
</a> 	else if(sscanf(arg, &quot;%lf&quot;, &amp;delta) == 1) {
 		if(arg[0] == &#39;+&#39; || arg[0] == &#39;-&#39;)
<a href="#h1-46-29" id="h1-46-29" class="d">-			m-&gt;mwfact += delta;
</a><a href="#h1-46-30" id="h1-46-30" class="i">+			v-&gt;mwfact += delta;
</a> 		else
<a href="#h1-46-32" id="h1-46-32" class="d">-			m-&gt;mwfact = delta;
</a><a href="#h1-46-33" id="h1-46-33" class="d">-		if(m-&gt;mwfact &lt; 0.1)
</a><a href="#h1-46-34" id="h1-46-34" class="d">-			m-&gt;mwfact = 0.1;
</a><a href="#h1-46-35" id="h1-46-35" class="d">-		else if(m-&gt;mwfact &gt; 0.9)
</a><a href="#h1-46-36" id="h1-46-36" class="d">-			m-&gt;mwfact = 0.9;
</a><a href="#h1-46-37" id="h1-46-37" class="i">+			v-&gt;mwfact = delta;
</a><a href="#h1-46-38" id="h1-46-38" class="i">+		if(v-&gt;mwfact &lt; 0.1)
</a><a href="#h1-46-39" id="h1-46-39" class="i">+			v-&gt;mwfact = 0.1;
</a><a href="#h1-46-40" id="h1-46-40" class="i">+		else if(v-&gt;mwfact &gt; 0.9)
</a><a href="#h1-46-41" id="h1-46-41" class="i">+			v-&gt;mwfact = 0.9;
</a> 	}
<a href="#h1-46-43" id="h1-46-43" class="d">-	arrange(m);
</a><a href="#h1-46-44" id="h1-46-44" class="i">+	arrange();
</a> }
 
 void
 setup(void) {
 	unsigned int i;
<a href="#h1-46-50" id="h1-46-50" class="d">-	Monitor *m;
</a><a href="#h1-46-51" id="h1-46-51" class="i">+	View *v;
</a> 	XSetWindowAttributes wa;
 	XineramaScreenInfo *info = NULL;
 
<a href="#h1-47" id="h1-47" class="h">@@ -1571,10 +1567,13 @@ setup(void) {
</a> 	cursor[CurResize] = XCreateFontCursor(dpy, XC_sizing);
 	cursor[CurMove] = XCreateFontCursor(dpy, XC_fleur);
 
<a href="#h1-47-3" id="h1-47-3" class="d">-	// init screens/monitors first
</a> 	if((isxinerama = XineramaIsActive(dpy)))
<a href="#h1-47-5" id="h1-47-5" class="d">-		info = XineramaQueryScreens(dpy, &amp;mcount);
</a><a href="#h1-47-6" id="h1-47-6" class="d">-	selmonitor = monitors = emallocz(mcount * sizeof(Monitor));
</a><a href="#h1-47-7" id="h1-47-7" class="i">+		info = XineramaQueryScreens(dpy, &amp;nviews);
</a><a href="#h1-47-8" id="h1-47-8" class="i">+#if defined(AIM_XINERAMA)
</a><a href="#h1-47-9" id="h1-47-9" class="i">+isxinerama = True;
</a><a href="#h1-47-10" id="h1-47-10" class="i">+nviews = 2; /* aim Xinerama */
</a><a href="#h1-47-11" id="h1-47-11" class="i">+#endif
</a><a href="#h1-47-12" id="h1-47-12" class="i">+	selview = views = emallocz(nviews * sizeof(View));
</a> 
 	screen = DefaultScreen(dpy);
 	root = RootWindow(dpy, screen);
<a href="#h1-48" id="h1-48" class="h">@@ -1599,60 +1598,68 @@ setup(void) {
</a> 		if(i &gt; blw)
 			blw = i;
 	}
<a href="#h1-48-3" id="h1-48-3" class="d">-	for(i = 0; i &lt; mcount; i++) {
</a><a href="#h1-48-4" id="h1-48-4" class="i">+
</a><a href="#h1-48-5" id="h1-48-5" class="i">+	seltags = emallocz(sizeof initags);
</a><a href="#h1-48-6" id="h1-48-6" class="i">+	prevtags = emallocz(sizeof initags);
</a><a href="#h1-48-7" id="h1-48-7" class="i">+	memcpy(seltags, initags, sizeof initags);
</a><a href="#h1-48-8" id="h1-48-8" class="i">+	memcpy(prevtags, initags, sizeof initags);
</a><a href="#h1-48-9" id="h1-48-9" class="i">+
</a><a href="#h1-48-10" id="h1-48-10" class="i">+	for(i = 0; i &lt; nviews; i++) {
</a> 		/* init geometry */
<a href="#h1-48-12" id="h1-48-12" class="d">-		m = &amp;monitors[i];
</a><a href="#h1-48-13" id="h1-48-13" class="d">-
</a><a href="#h1-48-14" id="h1-48-14" class="d">-		if(mcount != 1 &amp;&amp; isxinerama) {
</a><a href="#h1-48-15" id="h1-48-15" class="d">-			m-&gt;sx = info[i].x_org;
</a><a href="#h1-48-16" id="h1-48-16" class="d">-			m-&gt;sy = info[i].y_org;
</a><a href="#h1-48-17" id="h1-48-17" class="d">-			m-&gt;sw = info[i].width;
</a><a href="#h1-48-18" id="h1-48-18" class="d">-			m-&gt;sh = info[i].height;
</a><a href="#h1-48-19" id="h1-48-19" class="d">-			fprintf(stderr, &quot;monitor[%d]: %d,%d,%d,%d\n&quot;, i, m-&gt;sx, m-&gt;sy, m-&gt;sw, m-&gt;sh);
</a><a href="#h1-48-20" id="h1-48-20" class="i">+		v = &amp;views[i];
</a><a href="#h1-48-21" id="h1-48-21" class="i">+		v-&gt;id = i + 1;
</a><a href="#h1-48-22" id="h1-48-22" class="i">+
</a><a href="#h1-48-23" id="h1-48-23" class="i">+		if(nviews != 1 &amp;&amp; isxinerama) {
</a><a href="#h1-48-24" id="h1-48-24" class="i">+
</a><a href="#h1-48-25" id="h1-48-25" class="i">+#if defined(AIM_XINERAMA)
</a><a href="#h1-48-26" id="h1-48-26" class="i">+v-&gt;w = DisplayWidth(dpy, screen) / 2;
</a><a href="#h1-48-27" id="h1-48-27" class="i">+v-&gt;x = (i == 0) ? 0 : v-&gt;w;
</a><a href="#h1-48-28" id="h1-48-28" class="i">+v-&gt;y = 0;
</a><a href="#h1-48-29" id="h1-48-29" class="i">+v-&gt;h = DisplayHeight(dpy, screen);
</a><a href="#h1-48-30" id="h1-48-30" class="i">+#else
</a><a href="#h1-48-31" id="h1-48-31" class="i">+			v-&gt;x = info[i].x_org;
</a><a href="#h1-48-32" id="h1-48-32" class="i">+			v-&gt;y = info[i].y_org;
</a><a href="#h1-48-33" id="h1-48-33" class="i">+			v-&gt;w = info[i].width;
</a><a href="#h1-48-34" id="h1-48-34" class="i">+			v-&gt;h = info[i].height;
</a><a href="#h1-48-35" id="h1-48-35" class="i">+#endif
</a> 		}
 		else {
<a href="#h1-48-38" id="h1-48-38" class="d">-			m-&gt;sx = 0;
</a><a href="#h1-48-39" id="h1-48-39" class="d">-			m-&gt;sy = 0;
</a><a href="#h1-48-40" id="h1-48-40" class="d">-			m-&gt;sw = DisplayWidth(dpy, screen);
</a><a href="#h1-48-41" id="h1-48-41" class="d">-			m-&gt;sh = DisplayHeight(dpy, screen);
</a><a href="#h1-48-42" id="h1-48-42" class="i">+			v-&gt;x = 0;
</a><a href="#h1-48-43" id="h1-48-43" class="i">+			v-&gt;y = 0;
</a><a href="#h1-48-44" id="h1-48-44" class="i">+			v-&gt;w = DisplayWidth(dpy, screen);
</a><a href="#h1-48-45" id="h1-48-45" class="i">+			v-&gt;h = DisplayHeight(dpy, screen);
</a> 		}
 
<a href="#h1-48-48" id="h1-48-48" class="d">-		m-&gt;seltags = emallocz(sizeof initags);
</a><a href="#h1-48-49" id="h1-48-49" class="d">-		m-&gt;prevtags = emallocz(sizeof initags);
</a><a href="#h1-48-50" id="h1-48-50" class="d">-
</a><a href="#h1-48-51" id="h1-48-51" class="d">-		memcpy(m-&gt;seltags, initags, sizeof initags);
</a><a href="#h1-48-52" id="h1-48-52" class="d">-		memcpy(m-&gt;prevtags, initags, sizeof initags);
</a><a href="#h1-48-53" id="h1-48-53" class="d">-
</a> 		/* init layouts */
<a href="#h1-48-55" id="h1-48-55" class="d">-		m-&gt;mwfact = MWFACT;
</a><a href="#h1-48-56" id="h1-48-56" class="d">-		m-&gt;layout = &amp;layouts[0];
</a><a href="#h1-48-57" id="h1-48-57" class="i">+		v-&gt;mwfact = MWFACT;
</a><a href="#h1-48-58" id="h1-48-58" class="i">+		v-&gt;layout = &amp;layouts[0];
</a> 
 		// TODO: bpos per screen?
 		bpos = BARPOS;
 		wa.override_redirect = 1;
 		wa.background_pixmap = ParentRelative;
<a href="#h1-48-64" id="h1-48-64" class="d">-		wa.event_mask = ButtonPressMask | ExposureMask;
</a><a href="#h1-48-65" id="h1-48-65" class="i">+		wa.event_mask = ButtonPressMask|ExposureMask;
</a> 
 		/* init bars */
<a href="#h1-48-68" id="h1-48-68" class="d">-		m-&gt;barwin = XCreateWindow(dpy, root, m-&gt;sx, m-&gt;sy, m-&gt;sw, bh, 0,
</a><a href="#h1-48-69" id="h1-48-69" class="i">+		v-&gt;barwin = XCreateWindow(dpy, root, v-&gt;x, v-&gt;y, v-&gt;w, bh, 0,
</a> 				DefaultDepth(dpy, screen), CopyFromParent, DefaultVisual(dpy, screen),
<a href="#h1-48-71" id="h1-48-71" class="d">-				CWOverrideRedirect | CWBackPixmap | CWEventMask, &amp;wa);
</a><a href="#h1-48-72" id="h1-48-72" class="d">-		XDefineCursor(dpy, m-&gt;barwin, cursor[CurNormal]);
</a><a href="#h1-48-73" id="h1-48-73" class="d">-		updatebarpos(m);
</a><a href="#h1-48-74" id="h1-48-74" class="d">-		XMapRaised(dpy, m-&gt;barwin);
</a><a href="#h1-48-75" id="h1-48-75" class="i">+				CWOverrideRedirect|CWBackPixmap|CWEventMask, &amp;wa);
</a><a href="#h1-48-76" id="h1-48-76" class="i">+		XDefineCursor(dpy, v-&gt;barwin, cursor[CurNormal]);
</a><a href="#h1-48-77" id="h1-48-77" class="i">+		updatebarpos(v);
</a><a href="#h1-48-78" id="h1-48-78" class="i">+		XMapRaised(dpy, v-&gt;barwin);
</a> 		strcpy(stext, &quot;dwm-&quot;VERSION);
 
<a href="#h1-48-81" id="h1-48-81" class="d">-		/* EWMH support per monitor */
</a><a href="#h1-48-82" id="h1-48-82" class="i">+		/* EWMH support per view */
</a> 		XChangeProperty(dpy, root, netatom[NetSupported], XA_ATOM, 32,
 				PropModeReplace, (unsigned char *) netatom, NetLast);
 
 		/* select for events */
<a href="#h1-48-87" id="h1-48-87" class="d">-		wa.event_mask = SubstructureRedirectMask | SubstructureNotifyMask
</a><a href="#h1-48-88" id="h1-48-88" class="d">-				| EnterWindowMask | LeaveWindowMask | StructureNotifyMask;
</a><a href="#h1-48-89" id="h1-48-89" class="d">-		XChangeWindowAttributes(dpy, root, CWEventMask | CWCursor, &amp;wa);
</a><a href="#h1-48-90" id="h1-48-90" class="i">+		wa.event_mask = SubstructureRedirectMask|SubstructureNotifyMask
</a><a href="#h1-48-91" id="h1-48-91" class="i">+				|EnterWindowMask|LeaveWindowMask|StructureNotifyMask;
</a><a href="#h1-48-92" id="h1-48-92" class="i">+		XChangeWindowAttributes(dpy, root, CWEventMask|CWCursor, &amp;wa);
</a> 		XSelectInput(dpy, root, wa.event_mask);
 
<a href="#h1-48-95" id="h1-48-95" class="d">-		drawbar(m);
</a><a href="#h1-48-96" id="h1-48-96" class="i">+		drawbar(v);
</a> 	}
 	if(info)
 		XFree(info);
<a href="#h1-49" id="h1-49" class="h">@@ -1663,8 +1670,7 @@ setup(void) {
</a> 	/* init tags */
 	compileregs();
 
<a href="#h1-49-3" id="h1-49-3" class="d">-	selmonitor = monitorat();
</a><a href="#h1-49-4" id="h1-49-4" class="d">-	fprintf(stderr, &quot;selmonitor == %d\n&quot;, selmonitor - monitors);
</a><a href="#h1-49-5" id="h1-49-5" class="i">+	selview = &amp;views[0];
</a> }
 
 void
<a href="#h1-50" id="h1-50" class="h">@@ -1698,9 +1704,9 @@ tag(const char *arg) {
</a> 	if(!sel)
 		return;
 	for(i = 0; i &lt; LENGTH(tags); i++)
<a href="#h1-50-3" id="h1-50-3" class="d">-		sel-&gt;tags[i] = (NULL == arg);
</a><a href="#h1-50-4" id="h1-50-4" class="d">-	sel-&gt;tags[idxoftag(arg)] = True;
</a><a href="#h1-50-5" id="h1-50-5" class="d">-	arrange(sel-&gt;monitor);
</a><a href="#h1-50-6" id="h1-50-6" class="i">+		sel-&gt;tags[i] = (NULL == arg) ? selview-&gt;id : 0;
</a><a href="#h1-50-7" id="h1-50-7" class="i">+	sel-&gt;tags[idxoftag(arg)] = selview-&gt;id;
</a><a href="#h1-50-8" id="h1-50-8" class="i">+	arrange();
</a> }
 
 unsigned int
<a href="#h1-51" id="h1-51" class="h">@@ -1720,38 +1726,38 @@ textw(const char *text) {
</a> }
 
 void
<a href="#h1-51-3" id="h1-51-3" class="d">-tile(Monitor *m) {
</a><a href="#h1-51-4" id="h1-51-4" class="i">+tile(View *v) {
</a> 	unsigned int i, n, nx, ny, nw, nh, mw, th;
 	Client *c, *mc;
 
 	domwfact = dozoom = True;
<a href="#h1-51-9" id="h1-51-9" class="d">-	nx = m-&gt;wax;
</a><a href="#h1-51-10" id="h1-51-10" class="d">-	ny = m-&gt;way;
</a><a href="#h1-51-11" id="h1-51-11" class="i">+	nx = v-&gt;wax;
</a><a href="#h1-51-12" id="h1-51-12" class="i">+	ny = v-&gt;way;
</a> 	nw = 0;
<a href="#h1-51-14" id="h1-51-14" class="d">-	for(n = 0, c = nexttiled(clients, m); c; c = nexttiled(c-&gt;next, m))
</a><a href="#h1-51-15" id="h1-51-15" class="i">+	for(n = 0, c = nexttiled(clients, v); c; c = nexttiled(c-&gt;next, v))
</a> 		n++;
 
 	/* window geoms */
<a href="#h1-51-19" id="h1-51-19" class="d">-	mw = (n == 1) ? m-&gt;waw : m-&gt;mwfact * m-&gt;waw;
</a><a href="#h1-51-20" id="h1-51-20" class="d">-	th = (n &gt; 1) ? m-&gt;wah / (n - 1) : 0;
</a><a href="#h1-51-21" id="h1-51-21" class="i">+	mw = (n == 1) ? v-&gt;waw : v-&gt;mwfact * v-&gt;waw;
</a><a href="#h1-51-22" id="h1-51-22" class="i">+	th = (n &gt; 1) ? v-&gt;wah / (n - 1) : 0;
</a> 	if(n &gt; 1 &amp;&amp; th &lt; bh)
<a href="#h1-51-24" id="h1-51-24" class="d">-		th = m-&gt;wah;
</a><a href="#h1-51-25" id="h1-51-25" class="i">+		th = v-&gt;wah;
</a> 
<a href="#h1-51-27" id="h1-51-27" class="d">-	for(i = 0, c = mc = nexttiled(clients, m); c; c = nexttiled(c-&gt;next, m)) {
</a><a href="#h1-51-28" id="h1-51-28" class="i">+	for(i = 0, c = mc = nexttiled(clients, v); c; c = nexttiled(c-&gt;next, v)) {
</a> 		if(i == 0) { /* master */
<a href="#h1-51-30" id="h1-51-30" class="d">-			nx = m-&gt;wax;
</a><a href="#h1-51-31" id="h1-51-31" class="d">-			ny = m-&gt;way;
</a><a href="#h1-51-32" id="h1-51-32" class="i">+			nx = v-&gt;wax;
</a><a href="#h1-51-33" id="h1-51-33" class="i">+			ny = v-&gt;way;
</a> 			nw = mw - 2 * c-&gt;border;
<a href="#h1-51-35" id="h1-51-35" class="d">-			nh = m-&gt;wah - 2 * c-&gt;border;
</a><a href="#h1-51-36" id="h1-51-36" class="i">+			nh = v-&gt;wah - 2 * c-&gt;border;
</a> 		}
 		else {  /* tile window */
 			if(i == 1) {
<a href="#h1-51-40" id="h1-51-40" class="d">-				ny = m-&gt;way;
</a><a href="#h1-51-41" id="h1-51-41" class="i">+				ny = v-&gt;way;
</a> 				nx += mc-&gt;w + 2 * mc-&gt;border;
<a href="#h1-51-43" id="h1-51-43" class="d">-				nw = m-&gt;waw - mw - 2 * c-&gt;border;
</a><a href="#h1-51-44" id="h1-51-44" class="i">+				nw = v-&gt;waw - mw - 2 * c-&gt;border;
</a> 			}
 			if(i + 1 == n) /* remainder */
<a href="#h1-51-47" id="h1-51-47" class="d">-				nh = (m-&gt;way + m-&gt;wah) - ny - 2 * c-&gt;border;
</a><a href="#h1-51-48" id="h1-51-48" class="i">+				nh = (v-&gt;way + v-&gt;wah) - ny - 2 * c-&gt;border;
</a> 			else
 				nh = th - 2 * c-&gt;border;
 		}
<a href="#h1-52" id="h1-52" class="h">@@ -1760,7 +1766,7 @@ tile(Monitor *m) {
</a> 		if((RESIZEHINTS) &amp;&amp; ((c-&gt;h &lt; bh) || (c-&gt;h &gt; nh) || (c-&gt;w &lt; bh) || (c-&gt;w &gt; nw)))
 			/* client doesn&#39;t accept size constraints */
 			resize(c, nx, ny, nw, nh, False);
<a href="#h1-52-3" id="h1-52-3" class="d">-		if(n &gt; 1 &amp;&amp; th != m-&gt;wah)
</a><a href="#h1-52-4" id="h1-52-4" class="i">+		if(n &gt; 1 &amp;&amp; th != v-&gt;wah)
</a> 			ny = c-&gt;y + c-&gt;h + 2 * c-&gt;border;
 		i++;
 	}
<a href="#h1-53" id="h1-53" class="h">@@ -1772,8 +1778,8 @@ togglebar(const char *arg) {
</a> 		bpos = (BARPOS == BarOff) ? BarTop : BARPOS;
 	else
 		bpos = BarOff;
<a href="#h1-53-3" id="h1-53-3" class="d">-	updatebarpos(monitorat());
</a><a href="#h1-53-4" id="h1-53-4" class="d">-	arrange(monitorat());
</a><a href="#h1-53-5" id="h1-53-5" class="i">+	updatebarpos(selview);
</a><a href="#h1-53-6" id="h1-53-6" class="i">+	arrange();
</a> }
 
 void
<a href="#h1-54" id="h1-54" class="h">@@ -1783,7 +1789,7 @@ togglefloating(const char *arg) {
</a> 	sel-&gt;isfloating = !sel-&gt;isfloating;
 	if(sel-&gt;isfloating)
 		resize(sel, sel-&gt;x, sel-&gt;y, sel-&gt;w, sel-&gt;h, True);
<a href="#h1-54-3" id="h1-54-3" class="d">-	arrange(sel-&gt;monitor);
</a><a href="#h1-54-4" id="h1-54-4" class="i">+	arrange();
</a> }
 
 void
<a href="#h1-55" id="h1-55" class="h">@@ -1796,21 +1802,20 @@ toggletag(const char *arg) {
</a> 	sel-&gt;tags[i] = !sel-&gt;tags[i];
 	for(j = 0; j &lt; LENGTH(tags) &amp;&amp; !sel-&gt;tags[j]; j++);
 	if(j == LENGTH(tags))
<a href="#h1-55-3" id="h1-55-3" class="d">-		sel-&gt;tags[i] = True; /* at least one tag must be enabled */
</a><a href="#h1-55-4" id="h1-55-4" class="d">-	arrange(sel-&gt;monitor);
</a><a href="#h1-55-5" id="h1-55-5" class="i">+		sel-&gt;tags[i] = selview-&gt;id; /* at least one tag must be enabled */
</a><a href="#h1-55-6" id="h1-55-6" class="i">+	arrange();
</a> }
 
 void
 toggleview(const char *arg) {
 	unsigned int i, j;
<a href="#h1-55-12" id="h1-55-12" class="d">-	Monitor *m = monitorat();
</a> 
 	i = idxoftag(arg);
<a href="#h1-55-15" id="h1-55-15" class="d">-	m-&gt;seltags[i] = !m-&gt;seltags[i];
</a><a href="#h1-55-16" id="h1-55-16" class="d">-	for(j = 0; j &lt; LENGTH(tags) &amp;&amp; !m-&gt;seltags[j]; j++);
</a><a href="#h1-55-17" id="h1-55-17" class="i">+	seltags[i] = !seltags[i];
</a><a href="#h1-55-18" id="h1-55-18" class="i">+	for(j = 0; j &lt; LENGTH(tags) &amp;&amp; !seltags[j]; j++);
</a> 	if(j == LENGTH(tags))
<a href="#h1-55-20" id="h1-55-20" class="d">-		m-&gt;seltags[i] = True; /* at least one tag must be viewed */
</a><a href="#h1-55-21" id="h1-55-21" class="d">-	arrange(m);
</a><a href="#h1-55-22" id="h1-55-22" class="i">+		seltags[i] = selview-&gt;id; /* at least one tag must be viewed */
</a><a href="#h1-55-23" id="h1-55-23" class="i">+	arrange();
</a> }
 
 void
<a href="#h1-56" id="h1-56" class="h">@@ -1823,7 +1828,6 @@ unban(Client *c) {
</a> 
 void
 unmanage(Client *c) {
<a href="#h1-56-3" id="h1-56-3" class="d">-	Monitor *m = c-&gt;monitor;
</a> 	XWindowChanges wc;
 
 	wc.border_width = c-&gt;oldborder;
<a href="#h1-57" id="h1-57" class="h">@@ -1842,7 +1846,7 @@ unmanage(Client *c) {
</a> 	XSync(dpy, False);
 	XSetErrorHandler(xerror);
 	XUngrabServer(dpy);
<a href="#h1-57-3" id="h1-57-3" class="d">-	arrange(m);
</a><a href="#h1-57-4" id="h1-57-4" class="i">+	arrange();
</a> }
 
 void
<a href="#h1-58" id="h1-58" class="h">@@ -1855,25 +1859,25 @@ unmapnotify(XEvent *e) {
</a> }
 
 void
<a href="#h1-58-3" id="h1-58-3" class="d">-updatebarpos(Monitor *m) {
</a><a href="#h1-58-4" id="h1-58-4" class="i">+updatebarpos(View *v) {
</a> 	XEvent ev;
 
<a href="#h1-58-7" id="h1-58-7" class="d">-	m-&gt;wax = m-&gt;sx;
</a><a href="#h1-58-8" id="h1-58-8" class="d">-	m-&gt;way = m-&gt;sy;
</a><a href="#h1-58-9" id="h1-58-9" class="d">-	m-&gt;wah = m-&gt;sh;
</a><a href="#h1-58-10" id="h1-58-10" class="d">-	m-&gt;waw = m-&gt;sw;
</a><a href="#h1-58-11" id="h1-58-11" class="i">+	v-&gt;wax = v-&gt;x;
</a><a href="#h1-58-12" id="h1-58-12" class="i">+	v-&gt;way = v-&gt;y;
</a><a href="#h1-58-13" id="h1-58-13" class="i">+	v-&gt;wah = v-&gt;h;
</a><a href="#h1-58-14" id="h1-58-14" class="i">+	v-&gt;waw = v-&gt;w;
</a> 	switch(bpos) {
 	default:
<a href="#h1-58-17" id="h1-58-17" class="d">-		m-&gt;wah -= bh;
</a><a href="#h1-58-18" id="h1-58-18" class="d">-		m-&gt;way += bh;
</a><a href="#h1-58-19" id="h1-58-19" class="d">-		XMoveWindow(dpy, m-&gt;barwin, m-&gt;sx, m-&gt;sy);
</a><a href="#h1-58-20" id="h1-58-20" class="i">+		v-&gt;wah -= bh;
</a><a href="#h1-58-21" id="h1-58-21" class="i">+		v-&gt;way += bh;
</a><a href="#h1-58-22" id="h1-58-22" class="i">+		XMoveWindow(dpy, v-&gt;barwin, v-&gt;x, v-&gt;y);
</a> 		break;
 	case BarBot:
<a href="#h1-58-25" id="h1-58-25" class="d">-		m-&gt;wah -= bh;
</a><a href="#h1-58-26" id="h1-58-26" class="d">-		XMoveWindow(dpy, m-&gt;barwin, m-&gt;sx, m-&gt;sy + m-&gt;wah);
</a><a href="#h1-58-27" id="h1-58-27" class="i">+		v-&gt;wah -= bh;
</a><a href="#h1-58-28" id="h1-58-28" class="i">+		XMoveWindow(dpy, v-&gt;barwin, v-&gt;x, v-&gt;y + v-&gt;wah);
</a> 		break;
 	case BarOff:
<a href="#h1-58-31" id="h1-58-31" class="d">-		XMoveWindow(dpy, m-&gt;barwin, m-&gt;sx, m-&gt;sy - bh);
</a><a href="#h1-58-32" id="h1-58-32" class="i">+		XMoveWindow(dpy, v-&gt;barwin, v-&gt;x, v-&gt;y - bh);
</a> 		break;
 	}
 	XSync(dpy, False);
<a href="#h1-59" id="h1-59" class="h">@@ -1968,14 +1972,14 @@ xerror(Display *dpy, XErrorEvent *ee) {
</a> }
 
 int
<a href="#h1-59-3" id="h1-59-3" class="d">-xerrordummy(Display *dsply, XErrorEvent *ee) {
</a><a href="#h1-59-4" id="h1-59-4" class="i">+xerrordummy(Display *dpy, XErrorEvent *ee) {
</a> 	return 0;
 }
 
 /* Startup Error handler to check if another window manager
  * is already running. */
 int
<a href="#h1-59-11" id="h1-59-11" class="d">-xerrorstart(Display *dsply, XErrorEvent *ee) {
</a><a href="#h1-59-12" id="h1-59-12" class="i">+xerrorstart(Display *dpy, XErrorEvent *ee) {
</a> 	otherwm = True;
 	return -1;
 }
<a href="#h1-60" id="h1-60" class="h">@@ -1983,16 +1987,15 @@ xerrorstart(Display *dsply, XErrorEvent *ee) {
</a> void
 view(const char *arg) {
 	unsigned int i;
<a href="#h1-60-3" id="h1-60-3" class="d">-	Bool tmp[LENGTH(tags)];
</a><a href="#h1-60-4" id="h1-60-4" class="d">-	Monitor *m = monitorat();
</a><a href="#h1-60-5" id="h1-60-5" class="i">+	int tmp[LENGTH(tags)];
</a> 
 	for(i = 0; i &lt; LENGTH(tags); i++)
<a href="#h1-60-8" id="h1-60-8" class="d">-		tmp[i] = (NULL == arg);
</a><a href="#h1-60-9" id="h1-60-9" class="d">-	tmp[idxoftag(arg)] = True;
</a><a href="#h1-60-10" id="h1-60-10" class="d">-	if(memcmp(m-&gt;seltags, tmp, sizeof initags) != 0) {
</a><a href="#h1-60-11" id="h1-60-11" class="d">-		memcpy(m-&gt;prevtags, m-&gt;seltags, sizeof initags);
</a><a href="#h1-60-12" id="h1-60-12" class="d">-		memcpy(m-&gt;seltags, tmp, sizeof initags);
</a><a href="#h1-60-13" id="h1-60-13" class="d">-		arrange(m);
</a><a href="#h1-60-14" id="h1-60-14" class="i">+		tmp[i] = (NULL == arg) ? selview-&gt;id : 0;
</a><a href="#h1-60-15" id="h1-60-15" class="i">+	tmp[idxoftag(arg)] = selview-&gt;id;
</a><a href="#h1-60-16" id="h1-60-16" class="i">+	if(memcmp(seltags, tmp, sizeof initags) != 0) {
</a><a href="#h1-60-17" id="h1-60-17" class="i">+		memcpy(prevtags, seltags, sizeof initags);
</a><a href="#h1-60-18" id="h1-60-18" class="i">+		memcpy(seltags, tmp, sizeof initags);
</a><a href="#h1-60-19" id="h1-60-19" class="i">+		arrange();
</a> 	}
 }
 
<a href="#h1-61" id="h1-61" class="h">@@ -2000,12 +2003,10 @@ void
</a> viewprevtag(const char *arg) {
 	static Bool tmp[LENGTH(tags)];
 
<a href="#h1-61-3" id="h1-61-3" class="d">-	Monitor *m = monitorat();
</a><a href="#h1-61-4" id="h1-61-4" class="d">-
</a><a href="#h1-61-5" id="h1-61-5" class="d">-	memcpy(tmp, m-&gt;seltags, sizeof initags);
</a><a href="#h1-61-6" id="h1-61-6" class="d">-	memcpy(m-&gt;seltags, m-&gt;prevtags, sizeof initags);
</a><a href="#h1-61-7" id="h1-61-7" class="d">-	memcpy(m-&gt;prevtags, tmp, sizeof initags);
</a><a href="#h1-61-8" id="h1-61-8" class="d">-	arrange(m);
</a><a href="#h1-61-9" id="h1-61-9" class="i">+	memcpy(tmp, seltags, sizeof initags);
</a><a href="#h1-61-10" id="h1-61-10" class="i">+	memcpy(seltags, prevtags, sizeof initags);
</a><a href="#h1-61-11" id="h1-61-11" class="i">+	memcpy(prevtags, tmp, sizeof initags);
</a><a href="#h1-61-12" id="h1-61-12" class="i">+	arrange();
</a> }
 
 void
<a href="#h1-62" id="h1-62" class="h">@@ -2014,54 +2015,32 @@ zoom(const char *arg) {
</a> 
 	if(!sel || !dozoom || sel-&gt;isfloating)
 		return;
<a href="#h1-62-3" id="h1-62-3" class="d">-	if(c == nexttiled(clients, c-&gt;monitor))
</a><a href="#h1-62-4" id="h1-62-4" class="d">-		if(!(c = nexttiled(c-&gt;next, c-&gt;monitor)))
</a><a href="#h1-62-5" id="h1-62-5" class="i">+	if(c == nexttiled(clients, getview(c)))
</a><a href="#h1-62-6" id="h1-62-6" class="i">+		if(!(c = nexttiled(c-&gt;next, getview(c))))
</a> 			return;
 	detach(c);
 	attach(c);
 	focus(c);
<a href="#h1-62-11" id="h1-62-11" class="d">-	arrange(c-&gt;monitor);
</a><a href="#h1-62-12" id="h1-62-12" class="i">+	arrange();
</a> }
 
 void
<a href="#h1-62-16" id="h1-62-16" class="d">-movetomonitor(const char *arg) {
</a><a href="#h1-62-17" id="h1-62-17" class="i">+selectview(const char *arg) {
</a> 	int i;
<a href="#h1-62-19" id="h1-62-19" class="i">+	View *v;
</a> 
<a href="#h1-62-21" id="h1-62-21" class="d">-	if (sel)
</a><a href="#h1-62-22" id="h1-62-22" class="i">+	if(!arg)
</a> 		return;
 	if(arg)
 		i = atoi(arg);
<a href="#h1-62-26" id="h1-62-26" class="d">-	else {
</a><a href="#h1-62-27" id="h1-62-27" class="d">-		for(i = 0; &amp;monitors[i] != sel-&gt;monitor &amp;&amp; i &lt; mcount; i++);
</a><a href="#h1-62-28" id="h1-62-28" class="d">-		i++;
</a><a href="#h1-62-29" id="h1-62-29" class="d">-	}
</a><a href="#h1-62-30" id="h1-62-30" class="d">-	sel-&gt;monitor = &amp;monitors[i % mcount];
</a><a href="#h1-62-31" id="h1-62-31" class="d">-
</a><a href="#h1-62-32" id="h1-62-32" class="d">-	memcpy(sel-&gt;tags, sel-&gt;monitor-&gt;seltags, sizeof initags);
</a><a href="#h1-62-33" id="h1-62-33" class="d">-	resize(sel, sel-&gt;monitor-&gt;wax, sel-&gt;monitor-&gt;way, sel-&gt;w, sel-&gt;h, True);
</a><a href="#h1-62-34" id="h1-62-34" class="d">-	arrange(sel-&gt;monitor);
</a><a href="#h1-62-35" id="h1-62-35" class="d">-}
</a><a href="#h1-62-36" id="h1-62-36" class="d">-
</a><a href="#h1-62-37" id="h1-62-37" class="d">-void
</a><a href="#h1-62-38" id="h1-62-38" class="d">-selectmonitor(const char *arg) {
</a><a href="#h1-62-39" id="h1-62-39" class="d">-	int i;
</a><a href="#h1-62-40" id="h1-62-40" class="d">-	Monitor *m;
</a><a href="#h1-62-41" id="h1-62-41" class="d">-
</a><a href="#h1-62-42" id="h1-62-42" class="d">-	if(arg)
</a><a href="#h1-62-43" id="h1-62-43" class="d">-		i = atoi(arg);
</a><a href="#h1-62-44" id="h1-62-44" class="d">-	else {
</a><a href="#h1-62-45" id="h1-62-45" class="d">-		for(i = 0; &amp;monitors[i] != sel-&gt;monitor &amp;&amp; i &lt; mcount; i++);
</a><a href="#h1-62-46" id="h1-62-46" class="d">-		i++;
</a><a href="#h1-62-47" id="h1-62-47" class="d">-	}
</a><a href="#h1-62-48" id="h1-62-48" class="d">-	m = &amp;monitors[i % mcount];
</a><a href="#h1-62-49" id="h1-62-49" class="d">-	XWarpPointer(dpy, None, root, 0, 0, 0, 0, m-&gt;wax+m-&gt;waw/2, m-&gt;way+m-&gt;wah/2);
</a><a href="#h1-62-50" id="h1-62-50" class="i">+	v = &amp;views[i % nviews];
</a><a href="#h1-62-51" id="h1-62-51" class="i">+	XWarpPointer(dpy, None, root, 0, 0, 0, 0, v-&gt;wax+v-&gt;waw/2, v-&gt;way+v-&gt;wah/2);
</a> 	focus(NULL);
 }
 
 
 int
 main(int argc, char *argv[]) {
<a href="#h1-62-58" id="h1-62-58" class="d">-	fprintf(stderr, &quot;%u\n&quot;, sizeof(&quot;jsjsjsjsjssjsj&quot;));
</a> 	if(argc == 2 &amp;&amp; !strcmp(&quot;-v&quot;, argv[1]))
 		eprint(&quot;dwm-&quot;VERSION&quot;, © 2006-2008 dwm engineers, see LICENSE for details\n&quot;);
 	else if(argc != 1)
</pre>
</div>
</body>
</html>
