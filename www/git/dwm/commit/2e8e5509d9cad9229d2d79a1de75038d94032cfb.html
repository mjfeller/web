<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>changed arrange functions to contain the Monitor as first argument - dwm - dynamic window manager
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="dwm Atom Feed" href="../atom.xml" />
<link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="/logo.png" alt="" width="32" height="32" /></a></td><td><h1>dwm</h1><span class="desc">dynamic window manager
</span></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/2e8e5509d9cad9229d2d79a1de75038d94032cfb.html">2e8e5509d9cad9229d2d79a1de75038d94032cfb</a>
<b>parent</b> <a href="../commit/4426032450777e63ac9a8967cd67382497954c51.html">4426032450777e63ac9a8967cd67382497954c51</a>
<b>Author:</b> Anselm R Garbe &lt;<a href="mailto:garbeam@gmail.com">garbeam@gmail.com</a>&gt;
<b>Date:</b>   Thu, 21 Feb 2008 10:14:42 +0000

changed arrange functions to contain the Monitor as first argument
<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">LICENSE</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">config.def.h</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">dwm.c</a></td><td> | </td><td class="num">100</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------------</span></td></tr>
</table></pre><pre>3 files changed, 51 insertions(+), 53 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/LICENSE.html">LICENSE</a> b/<a href="../file/LICENSE.html">LICENSE</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -1,6 +1,6 @@
</a> MIT/X Consortium License
 
<a href="#h0-0-2" id="h0-0-2" class="d">-© 2006-2007 Anselm R. Garbe &lt;garbeam at gmail dot com&gt;
</a><a href="#h0-0-3" id="h0-0-3" class="i">+© 2006-2008 Anselm R. Garbe &lt;garbeam at gmail dot com&gt;
</a> © 2006-2007 Sander van Dijk &lt;a dot h dot vandijk at gmail dot com&gt;
 © 2006-2007 Jukka Salmi &lt;jukka at salmi dot ch&gt;
 © 2007 Premysl Hruby &lt;dfenze at gmail dot com&gt;
<b>diff --git a/<a id="h1" href="../file/config.def.h.html">config.def.h</a> b/<a href="../file/config.def.h.html">config.def.h</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -3,7 +3,7 @@
</a> /* appearance */
 #define BARPOS			BarTop /* BarBot, BarOff */
 #define BORDERPX		1
<a href="#h1-0-3" id="h1-0-3" class="d">-#define FONT			&quot;-*-terminus-medium-*-*-*-*-*-*-*-*-*-*-*&quot;
</a><a href="#h1-0-4" id="h1-0-4" class="i">+#define FONT			&quot;-*-terminus-medium-r-normal-*-14-*-*-*-*-*-*-*&quot;
</a> #define NORMBORDERCOLOR		&quot;#cccccc&quot;
 #define NORMBGCOLOR		&quot;#cccccc&quot;
 #define NORMFGCOLOR		&quot;#000000&quot;
<b>diff --git a/<a id="h2" href="../file/dwm.c.html">dwm.c</a> b/<a href="../file/dwm.c.html">dwm.c</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -99,9 +99,10 @@ typedef struct {
</a> 	const char *arg;
 } Key;
 
<a href="#h2-0-3" id="h2-0-3" class="i">+typedef struct Monitor Monitor;
</a> typedef struct {
 	const char *symbol;
<a href="#h2-0-6" id="h2-0-6" class="d">-	void (*arrange)(void);
</a><a href="#h2-0-7" id="h2-0-7" class="i">+	void (*arrange)(Monitor *);
</a> } Layout;
 
 typedef struct {
<a href="#h2-1" id="h2-1" class="h">@@ -116,14 +117,16 @@ typedef struct {
</a> 	regex_t *tagregex;
 } Regs;
 
<a href="#h2-1-3" id="h2-1-3" class="d">-typedef struct {
</a><a href="#h2-1-4" id="h2-1-4" class="d">-	Window barwin;
</a><a href="#h2-1-5" id="h2-1-5" class="i">+struct Monitor {
</a><a href="#h2-1-6" id="h2-1-6" class="i">+	unsigned int id;
</a> 	int sx, sy, sw, sh, wax, way, wah, waw;
<a href="#h2-1-8" id="h2-1-8" class="i">+	double mwfact;
</a> 	Bool *seltags;
 	Bool *prevtags;
 	Layout *layout;
<a href="#h2-1-12" id="h2-1-12" class="d">-	double mwfact;
</a><a href="#h2-1-13" id="h2-1-13" class="d">-} Monitor;
</a><a href="#h2-1-14" id="h2-1-14" class="i">+	Window barwin;
</a><a href="#h2-1-15" id="h2-1-15" class="i">+};
</a><a href="#h2-1-16" id="h2-1-16" class="i">+
</a> 
 /* function declarations */
 void applyrules(Client *c);
<a href="#h2-2" id="h2-2" class="h">@@ -148,7 +151,7 @@ void *emallocz(unsigned int size);
</a> void enternotify(XEvent *e);
 void eprint(const char *errstr, ...);
 void expose(XEvent *e);
<a href="#h2-2-3" id="h2-2-3" class="d">-void floating(void); /* default floating layout */
</a><a href="#h2-2-4" id="h2-2-4" class="i">+void floating(Monitor *m); /* default floating layout */
</a> void focus(Client *c);
 void focusin(XEvent *e);
 void focusnext(const char *arg);
<a href="#h2-3" id="h2-3" class="h">@@ -188,7 +191,7 @@ void spawn(const char *arg);
</a> void tag(const char *arg);
 unsigned int textnw(const char *text, unsigned int len);
 unsigned int textw(const char *text);
<a href="#h2-3-3" id="h2-3-3" class="d">-void tile(void);
</a><a href="#h2-3-4" id="h2-3-4" class="i">+void tile(Monitor *m);
</a> void togglebar(const char *arg);
 void togglefloating(const char *arg);
 void toggletag(const char *arg);
<a href="#h2-4" id="h2-4" class="h">@@ -304,7 +307,7 @@ arrange(void) {
</a> 		else
 			ban(c);
 
<a href="#h2-4-3" id="h2-4-3" class="d">-	monitors[selmonitor].layout-&gt;arrange();
</a><a href="#h2-4-4" id="h2-4-4" class="i">+	monitors[selmonitor].layout-&gt;arrange(&amp;monitors[selmonitor]);
</a> 	focus(NULL);
 	restack();
 }
<a href="#h2-5" id="h2-5" class="h">@@ -719,12 +722,12 @@ expose(XEvent *e) {
</a> }
 
 void
<a href="#h2-5-3" id="h2-5-3" class="d">-floating(void) { /* default floating layout */
</a><a href="#h2-5-4" id="h2-5-4" class="i">+floating(Monitor *m) { /* default floating layout */
</a> 	Client *c;
 
 	domwfact = dozoom = False;
 	for(c = clients; c; c = c-&gt;next)
<a href="#h2-5-9" id="h2-5-9" class="d">-		if(isvisible(c, selmonitor))
</a><a href="#h2-5-10" id="h2-5-10" class="i">+		if(isvisible(c, m-&gt;id))
</a> 			resize(c, c-&gt;x, c-&gt;y, c-&gt;w, c-&gt;h, True);
 }
 
<a href="#h2-6" id="h2-6" class="h">@@ -1598,6 +1601,7 @@ setup(void) {
</a> 	for(i = 0; i &lt; mcount; i++) {
 		/* init geometry */
 		m = &amp;monitors[i];
<a href="#h2-6-3" id="h2-6-3" class="i">+		m-&gt;id = i;
</a> 
 		if (mcount != 1 &amp;&amp; isxinerama) {
 			m-&gt;sx = info[i].x_org;
<a href="#h2-7" id="h2-7" class="h">@@ -1714,56 +1718,50 @@ textw(const char *text) {
</a> }
 
 void
<a href="#h2-7-3" id="h2-7-3" class="d">-tile(void) {
</a><a href="#h2-7-4" id="h2-7-4" class="d">-	unsigned int i, j, n, nx, ny, nw, nh, mw, th;
</a><a href="#h2-7-5" id="h2-7-5" class="i">+tile(Monitor *m) {
</a><a href="#h2-7-6" id="h2-7-6" class="i">+	unsigned int i, n, nx, ny, nw, nh, mw, th;
</a> 	Client *c, *mc;
 
 	domwfact = dozoom = True;
 
 	nx = ny = nw = 0; /* gcc stupidity requires this */
 
<a href="#h2-7-13" id="h2-7-13" class="d">-	for (i = 0; i &lt; mcount; i++) {
</a><a href="#h2-7-14" id="h2-7-14" class="d">-		Monitor *m = &amp;monitors[i];
</a><a href="#h2-7-15" id="h2-7-15" class="d">-
</a><a href="#h2-7-16" id="h2-7-16" class="d">-		for(n = 0, c = nexttiled(clients, i); c; c = nexttiled(c-&gt;next, i))
</a><a href="#h2-7-17" id="h2-7-17" class="d">-			n++;
</a><a href="#h2-7-18" id="h2-7-18" class="d">-
</a><a href="#h2-7-19" id="h2-7-19" class="d">-		/* window geoms */
</a><a href="#h2-7-20" id="h2-7-20" class="d">-		mw = (n == 1) ? m-&gt;waw : m-&gt;mwfact * m-&gt;waw;
</a><a href="#h2-7-21" id="h2-7-21" class="d">-		th = (n &gt; 1) ? m-&gt;wah / (n - 1) : 0;
</a><a href="#h2-7-22" id="h2-7-22" class="d">-		if(n &gt; 1 &amp;&amp; th &lt; bh)
</a><a href="#h2-7-23" id="h2-7-23" class="d">-			th = m-&gt;wah;
</a><a href="#h2-7-24" id="h2-7-24" class="d">-
</a><a href="#h2-7-25" id="h2-7-25" class="d">-		for(j = 0, c = mc = nexttiled(clients, i); c; c = nexttiled(c-&gt;next, i)) {
</a><a href="#h2-7-26" id="h2-7-26" class="d">-			if(j == 0) { /* master */
</a><a href="#h2-7-27" id="h2-7-27" class="d">-				nx = m-&gt;wax;
</a><a href="#h2-7-28" id="h2-7-28" class="i">+	for(n = 0, c = nexttiled(clients, m-&gt;id); c; c = nexttiled(c-&gt;next, m-&gt;id))
</a><a href="#h2-7-29" id="h2-7-29" class="i">+		n++;
</a><a href="#h2-7-30" id="h2-7-30" class="i">+
</a><a href="#h2-7-31" id="h2-7-31" class="i">+	/* window geoms */
</a><a href="#h2-7-32" id="h2-7-32" class="i">+	mw = (n == 1) ? m-&gt;waw : m-&gt;mwfact * m-&gt;waw;
</a><a href="#h2-7-33" id="h2-7-33" class="i">+	th = (n &gt; 1) ? m-&gt;wah / (n - 1) : 0;
</a><a href="#h2-7-34" id="h2-7-34" class="i">+	if(n &gt; 1 &amp;&amp; th &lt; bh)
</a><a href="#h2-7-35" id="h2-7-35" class="i">+		th = m-&gt;wah;
</a><a href="#h2-7-36" id="h2-7-36" class="i">+
</a><a href="#h2-7-37" id="h2-7-37" class="i">+	for(i = 0, c = mc = nexttiled(clients, m-&gt;id); c; c = nexttiled(c-&gt;next, m-&gt;id)) {
</a><a href="#h2-7-38" id="h2-7-38" class="i">+		if(i == 0) { /* master */
</a><a href="#h2-7-39" id="h2-7-39" class="i">+			nx = m-&gt;wax;
</a><a href="#h2-7-40" id="h2-7-40" class="i">+			ny = m-&gt;way;
</a><a href="#h2-7-41" id="h2-7-41" class="i">+			nw = mw - 2 * c-&gt;border;
</a><a href="#h2-7-42" id="h2-7-42" class="i">+			nh = m-&gt;wah - 2 * c-&gt;border;
</a><a href="#h2-7-43" id="h2-7-43" class="i">+		}
</a><a href="#h2-7-44" id="h2-7-44" class="i">+		else {  /* tile window */
</a><a href="#h2-7-45" id="h2-7-45" class="i">+			if(i == 1) {
</a> 				ny = m-&gt;way;
<a href="#h2-7-47" id="h2-7-47" class="d">-				nw = mw - 2 * c-&gt;border;
</a><a href="#h2-7-48" id="h2-7-48" class="d">-				nh = m-&gt;wah - 2 * c-&gt;border;
</a><a href="#h2-7-49" id="h2-7-49" class="d">-			}
</a><a href="#h2-7-50" id="h2-7-50" class="d">-			else {  /* tile window */
</a><a href="#h2-7-51" id="h2-7-51" class="d">-				if(j == 1) {
</a><a href="#h2-7-52" id="h2-7-52" class="d">-					ny = m-&gt;way;
</a><a href="#h2-7-53" id="h2-7-53" class="d">-					nx += mc-&gt;w + 2 * mc-&gt;border;
</a><a href="#h2-7-54" id="h2-7-54" class="d">-					nw = m-&gt;waw - mw - 2 * c-&gt;border;
</a><a href="#h2-7-55" id="h2-7-55" class="d">-				}
</a><a href="#h2-7-56" id="h2-7-56" class="d">-				if(j + 1 == n) /* remainder */
</a><a href="#h2-7-57" id="h2-7-57" class="d">-					nh = (m-&gt;way + m-&gt;wah) - ny - 2 * c-&gt;border;
</a><a href="#h2-7-58" id="h2-7-58" class="d">-				else
</a><a href="#h2-7-59" id="h2-7-59" class="d">-					nh = th - 2 * c-&gt;border;
</a><a href="#h2-7-60" id="h2-7-60" class="i">+				nx += mc-&gt;w + 2 * mc-&gt;border;
</a><a href="#h2-7-61" id="h2-7-61" class="i">+				nw = m-&gt;waw - mw - 2 * c-&gt;border;
</a> 			}
<a href="#h2-7-63" id="h2-7-63" class="d">-			fprintf(stderr, &quot;tile(%d, %d, %d, %d)\n&quot;, nx, ny, nw, nh);
</a><a href="#h2-7-64" id="h2-7-64" class="d">-			resize(c, nx, ny, nw, nh, RESIZEHINTS);
</a><a href="#h2-7-65" id="h2-7-65" class="d">-			if((RESIZEHINTS) &amp;&amp; ((c-&gt;h &lt; bh) || (c-&gt;h &gt; nh) || (c-&gt;w &lt; bh) || (c-&gt;w &gt; nw)))
</a><a href="#h2-7-66" id="h2-7-66" class="d">-				/* client doesn&#39;t accept size constraints */
</a><a href="#h2-7-67" id="h2-7-67" class="d">-				resize(c, nx, ny, nw, nh, False);
</a><a href="#h2-7-68" id="h2-7-68" class="d">-			if(n &gt; 1 &amp;&amp; th != m-&gt;wah)
</a><a href="#h2-7-69" id="h2-7-69" class="d">-				ny = c-&gt;y + c-&gt;h + 2 * c-&gt;border;
</a><a href="#h2-7-70" id="h2-7-70" class="d">-
</a><a href="#h2-7-71" id="h2-7-71" class="d">-			j++;
</a><a href="#h2-7-72" id="h2-7-72" class="i">+			if(i + 1 == n) /* remainder */
</a><a href="#h2-7-73" id="h2-7-73" class="i">+				nh = (m-&gt;way + m-&gt;wah) - ny - 2 * c-&gt;border;
</a><a href="#h2-7-74" id="h2-7-74" class="i">+			else
</a><a href="#h2-7-75" id="h2-7-75" class="i">+				nh = th - 2 * c-&gt;border;
</a> 		}
<a href="#h2-7-77" id="h2-7-77" class="i">+		resize(c, nx, ny, nw, nh, RESIZEHINTS);
</a><a href="#h2-7-78" id="h2-7-78" class="i">+		if((RESIZEHINTS) &amp;&amp; ((c-&gt;h &lt; bh) || (c-&gt;h &gt; nh) || (c-&gt;w &lt; bh) || (c-&gt;w &gt; nw)))
</a><a href="#h2-7-79" id="h2-7-79" class="i">+			/* client doesn&#39;t accept size constraints */
</a><a href="#h2-7-80" id="h2-7-80" class="i">+			resize(c, nx, ny, nw, nh, False);
</a><a href="#h2-7-81" id="h2-7-81" class="i">+		if(n &gt; 1 &amp;&amp; th != m-&gt;wah)
</a><a href="#h2-7-82" id="h2-7-82" class="i">+			ny = c-&gt;y + c-&gt;h + 2 * c-&gt;border;
</a><a href="#h2-7-83" id="h2-7-83" class="i">+
</a><a href="#h2-7-84" id="h2-7-84" class="i">+		i++;
</a> 	}
<a href="#h2-7-86" id="h2-7-86" class="d">-	fprintf(stderr, &quot;done\n&quot;);
</a> }
 void
 togglebar(const char *arg) {
<a href="#h2-8" id="h2-8" class="h">@@ -2045,7 +2043,7 @@ selectmonitor(const char *arg) {
</a> int
 main(int argc, char *argv[]) {
 	if(argc == 2 &amp;&amp; !strcmp(&quot;-v&quot;, argv[1]))
<a href="#h2-8-3" id="h2-8-3" class="d">-		eprint(&quot;dwm-&quot;VERSION&quot;, © 2006-2007 Anselm R. Garbe, Sander van Dijk, &quot;
</a><a href="#h2-8-4" id="h2-8-4" class="i">+		eprint(&quot;dwm-&quot;VERSION&quot;, © 2006-2008 Anselm R. Garbe, Sander van Dijk, &quot;
</a> 		       &quot;Jukka Salmi, Premysl Hruby, Szabolcs Nagy, Christof Musik\n&quot;);
 	else if(argc != 1)
 		eprint(&quot;usage: dwm [-v]\n&quot;);
</pre>
</div>
</body>
</html>
