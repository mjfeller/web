<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>micromizing dwm step 1 - dwm - dynamic window manager
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="dwm Atom Feed" href="../atom.xml" />
<link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="/logo.png" alt="" width="32" height="32" /></a></td><td><h1>dwm</h1><span class="desc">dynamic window manager
</span></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/0235a84ef286db5c97239615ae525ce973641941.html">0235a84ef286db5c97239615ae525ce973641941</a>
<b>parent</b> <a href="../commit/2091200c957783deed032380d56c4199a23c6b81.html">2091200c957783deed032380d56c4199a23c6b81</a>
<b>Author:</b> Anselm R. Garbe &lt;<a href="mailto:garbeam@gmail.com">garbeam@gmail.com</a>&gt;
<b>Date:</b>   Sat, 15 Sep 2007 22:25:27 +0200

micromizing dwm step 1
<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">Makefile</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="D">D</td><td><a href="#h1">bar.c</a></td><td> | </td><td class="num">263</td><td><span class="i"></span><span class="d">-------------------------------------------------------------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h2">client.c</a></td><td> | </td><td class="num">386</td><td><span class="i"></span><span class="d">-------------------------------------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">config.h</a></td><td> | </td><td class="num">26</td><td><span class="i">+++++++++++</span><span class="d">---------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">config.mk</a></td><td> | </td><td class="num">3</td><td><span class="i"></span><span class="d">---</span></td></tr>
<tr><td class="A">A</td><td><a href="#h5">dwm.c</a></td><td> | </td><td class="num">1847</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="D">D</td><td><a href="#h6">dwm.h</a></td><td> | </td><td class="num">147</td><td><span class="i"></span><span class="d">-------------------------------------------------------------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h7">event.c</a></td><td> | </td><td class="num">375</td><td><span class="i"></span><span class="d">-------------------------------------------------------------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h8">main.c</a></td><td> | </td><td class="num">296</td><td><span class="i"></span><span class="d">-------------------------------------------------------------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h9">screen.c</a></td><td> | </td><td class="num">340</td><td><span class="i"></span><span class="d">-------------------------------------------------------------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h10">tile.c</a></td><td> | </td><td class="num">85</td><td><span class="i"></span><span class="d">-------------------------------------------------------------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h11">tile.h</a></td><td> | </td><td class="num">6</td><td><span class="i"></span><span class="d">------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h12">util.c</a></td><td> | </td><td class="num">52</td><td><span class="i"></span><span class="d">----------------------------------------------------</span></td></tr>
</table></pre><pre>13 files changed, 1861 insertions(+), 1971 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/Makefile.html">Makefile</a> b/<a href="../file/Makefile.html">Makefile</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -3,7 +3,7 @@
</a> 
 include config.mk
 
<a href="#h0-0-3" id="h0-0-3" class="d">-SRC += bar.c client.c event.c main.c screen.c util.c
</a><a href="#h0-0-4" id="h0-0-4" class="i">+SRC = dwm.c
</a> OBJ = ${SRC:.c=.o}
 
 all: options dwm
<a href="#h0-1" id="h0-1" class="h">@@ -18,7 +18,7 @@ options:
</a> 	@echo CC $&lt;
 	@${CC} -c ${CFLAGS} $&lt;
 
<a href="#h0-1-3" id="h0-1-3" class="d">-${OBJ}: dwm.h config.h config.mk
</a><a href="#h0-1-4" id="h0-1-4" class="i">+${OBJ}: config.h config.mk
</a> 
 dwm: ${OBJ}
 	@echo CC -o $@
<a href="#h0-2" id="h0-2" class="h">@@ -32,7 +32,7 @@ dist: clean
</a> 	@echo creating dist tarball
 	@mkdir -p dwm-${VERSION}
 	@cp -R LICENSE Makefile README config.h config.mk \
<a href="#h0-2-3" id="h0-2-3" class="d">-		dwm.1 dwm.h tile.h ${SRC} dwm-${VERSION}
</a><a href="#h0-2-4" id="h0-2-4" class="i">+		dwm.1 ${SRC} dwm-${VERSION}
</a> 	@tar -cf dwm-${VERSION}.tar dwm-${VERSION}
 	@gzip dwm-${VERSION}.tar
 	@rm -rf dwm-${VERSION}
<b>diff --git a/<a id="h1" href="../file/bar.c.html">bar.c</a> b/<a href="../file/bar.c.html">bar.c</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -1,263 +0,0 @@
</a><a href="#h1-0-0" id="h1-0-0" class="d">-/* See LICENSE file for copyright and license details. */
</a><a href="#h1-0-1" id="h1-0-1" class="d">-#include &quot;dwm.h&quot;
</a><a href="#h1-0-2" id="h1-0-2" class="d">-#include &lt;string.h&gt;
</a><a href="#h1-0-3" id="h1-0-3" class="d">-#include &lt;stdio.h&gt;
</a><a href="#h1-0-4" id="h1-0-4" class="d">-
</a><a href="#h1-0-5" id="h1-0-5" class="d">-/* static */
</a><a href="#h1-0-6" id="h1-0-6" class="d">-
</a><a href="#h1-0-7" id="h1-0-7" class="d">-static void
</a><a href="#h1-0-8" id="h1-0-8" class="d">-drawsquare(Bool filled, Bool empty, unsigned long col[ColLast]) {
</a><a href="#h1-0-9" id="h1-0-9" class="d">-	int x;
</a><a href="#h1-0-10" id="h1-0-10" class="d">-	XGCValues gcv;
</a><a href="#h1-0-11" id="h1-0-11" class="d">-	XRectangle r = { dc.x, dc.y, dc.w, dc.h };
</a><a href="#h1-0-12" id="h1-0-12" class="d">-
</a><a href="#h1-0-13" id="h1-0-13" class="d">-	gcv.foreground = col[ColFG];
</a><a href="#h1-0-14" id="h1-0-14" class="d">-	XChangeGC(dpy, dc.gc, GCForeground, &amp;gcv);
</a><a href="#h1-0-15" id="h1-0-15" class="d">-	x = (dc.font.ascent + dc.font.descent + 2) / 4;
</a><a href="#h1-0-16" id="h1-0-16" class="d">-	r.x = dc.x + 1;
</a><a href="#h1-0-17" id="h1-0-17" class="d">-	r.y = dc.y + 1;
</a><a href="#h1-0-18" id="h1-0-18" class="d">-	if(filled) {
</a><a href="#h1-0-19" id="h1-0-19" class="d">-		r.width = r.height = x + 1;
</a><a href="#h1-0-20" id="h1-0-20" class="d">-		XFillRectangles(dpy, dc.drawable, dc.gc, &amp;r, 1);
</a><a href="#h1-0-21" id="h1-0-21" class="d">-	}
</a><a href="#h1-0-22" id="h1-0-22" class="d">-	else if(empty) {
</a><a href="#h1-0-23" id="h1-0-23" class="d">-		r.width = r.height = x;
</a><a href="#h1-0-24" id="h1-0-24" class="d">-		XDrawRectangles(dpy, dc.drawable, dc.gc, &amp;r, 1);
</a><a href="#h1-0-25" id="h1-0-25" class="d">-	}
</a><a href="#h1-0-26" id="h1-0-26" class="d">-}
</a><a href="#h1-0-27" id="h1-0-27" class="d">-
</a><a href="#h1-0-28" id="h1-0-28" class="d">-static unsigned long
</a><a href="#h1-0-29" id="h1-0-29" class="d">-initcolor(const char *colstr) {
</a><a href="#h1-0-30" id="h1-0-30" class="d">-	Colormap cmap = DefaultColormap(dpy, screen);
</a><a href="#h1-0-31" id="h1-0-31" class="d">-	XColor color;
</a><a href="#h1-0-32" id="h1-0-32" class="d">-
</a><a href="#h1-0-33" id="h1-0-33" class="d">-	if(!XAllocNamedColor(dpy, cmap, colstr, &amp;color, &amp;color))
</a><a href="#h1-0-34" id="h1-0-34" class="d">-		eprint(&quot;error, cannot allocate color &#39;%s&#39;\n&quot;, colstr);
</a><a href="#h1-0-35" id="h1-0-35" class="d">-	return color.pixel;
</a><a href="#h1-0-36" id="h1-0-36" class="d">-}
</a><a href="#h1-0-37" id="h1-0-37" class="d">-
</a><a href="#h1-0-38" id="h1-0-38" class="d">-static void
</a><a href="#h1-0-39" id="h1-0-39" class="d">-initfont(const char *fontstr) {
</a><a href="#h1-0-40" id="h1-0-40" class="d">-	char *def, **missing;
</a><a href="#h1-0-41" id="h1-0-41" class="d">-	int i, n;
</a><a href="#h1-0-42" id="h1-0-42" class="d">-
</a><a href="#h1-0-43" id="h1-0-43" class="d">-	missing = NULL;
</a><a href="#h1-0-44" id="h1-0-44" class="d">-	if(dc.font.set)
</a><a href="#h1-0-45" id="h1-0-45" class="d">-		XFreeFontSet(dpy, dc.font.set);
</a><a href="#h1-0-46" id="h1-0-46" class="d">-	dc.font.set = XCreateFontSet(dpy, fontstr, &amp;missing, &amp;n, &amp;def);
</a><a href="#h1-0-47" id="h1-0-47" class="d">-	if(missing) {
</a><a href="#h1-0-48" id="h1-0-48" class="d">-		while(n--)
</a><a href="#h1-0-49" id="h1-0-49" class="d">-			fprintf(stderr, &quot;dwm: missing fontset: %s\n&quot;, missing[n]);
</a><a href="#h1-0-50" id="h1-0-50" class="d">-		XFreeStringList(missing);
</a><a href="#h1-0-51" id="h1-0-51" class="d">-	}
</a><a href="#h1-0-52" id="h1-0-52" class="d">-	if(dc.font.set) {
</a><a href="#h1-0-53" id="h1-0-53" class="d">-		XFontSetExtents *font_extents;
</a><a href="#h1-0-54" id="h1-0-54" class="d">-		XFontStruct **xfonts;
</a><a href="#h1-0-55" id="h1-0-55" class="d">-		char **font_names;
</a><a href="#h1-0-56" id="h1-0-56" class="d">-		dc.font.ascent = dc.font.descent = 0;
</a><a href="#h1-0-57" id="h1-0-57" class="d">-		font_extents = XExtentsOfFontSet(dc.font.set);
</a><a href="#h1-0-58" id="h1-0-58" class="d">-		n = XFontsOfFontSet(dc.font.set, &amp;xfonts, &amp;font_names);
</a><a href="#h1-0-59" id="h1-0-59" class="d">-		for(i = 0, dc.font.ascent = 0, dc.font.descent = 0; i &lt; n; i++) {
</a><a href="#h1-0-60" id="h1-0-60" class="d">-			if(dc.font.ascent &lt; (*xfonts)-&gt;ascent)
</a><a href="#h1-0-61" id="h1-0-61" class="d">-				dc.font.ascent = (*xfonts)-&gt;ascent;
</a><a href="#h1-0-62" id="h1-0-62" class="d">-			if(dc.font.descent &lt; (*xfonts)-&gt;descent)
</a><a href="#h1-0-63" id="h1-0-63" class="d">-				dc.font.descent = (*xfonts)-&gt;descent;
</a><a href="#h1-0-64" id="h1-0-64" class="d">-			xfonts++;
</a><a href="#h1-0-65" id="h1-0-65" class="d">-		}
</a><a href="#h1-0-66" id="h1-0-66" class="d">-	}
</a><a href="#h1-0-67" id="h1-0-67" class="d">-	else {
</a><a href="#h1-0-68" id="h1-0-68" class="d">-		if(dc.font.xfont)
</a><a href="#h1-0-69" id="h1-0-69" class="d">-			XFreeFont(dpy, dc.font.xfont);
</a><a href="#h1-0-70" id="h1-0-70" class="d">-		dc.font.xfont = NULL;
</a><a href="#h1-0-71" id="h1-0-71" class="d">-		if(!(dc.font.xfont = XLoadQueryFont(dpy, fontstr))
</a><a href="#h1-0-72" id="h1-0-72" class="d">-		|| !(dc.font.xfont = XLoadQueryFont(dpy, &quot;fixed&quot;)))
</a><a href="#h1-0-73" id="h1-0-73" class="d">-			eprint(&quot;error, cannot load font: &#39;%s&#39;\n&quot;, fontstr);
</a><a href="#h1-0-74" id="h1-0-74" class="d">-		dc.font.ascent = dc.font.xfont-&gt;ascent;
</a><a href="#h1-0-75" id="h1-0-75" class="d">-		dc.font.descent = dc.font.xfont-&gt;descent;
</a><a href="#h1-0-76" id="h1-0-76" class="d">-	}
</a><a href="#h1-0-77" id="h1-0-77" class="d">-	dc.font.height = dc.font.ascent + dc.font.descent;
</a><a href="#h1-0-78" id="h1-0-78" class="d">-}
</a><a href="#h1-0-79" id="h1-0-79" class="d">-
</a><a href="#h1-0-80" id="h1-0-80" class="d">-static Bool
</a><a href="#h1-0-81" id="h1-0-81" class="d">-isoccupied(unsigned int t) {
</a><a href="#h1-0-82" id="h1-0-82" class="d">-	Client *c;
</a><a href="#h1-0-83" id="h1-0-83" class="d">-
</a><a href="#h1-0-84" id="h1-0-84" class="d">-	for(c = clients; c; c = c-&gt;next)
</a><a href="#h1-0-85" id="h1-0-85" class="d">-		if(c-&gt;tags[t])
</a><a href="#h1-0-86" id="h1-0-86" class="d">-			return True;
</a><a href="#h1-0-87" id="h1-0-87" class="d">-	return False;
</a><a href="#h1-0-88" id="h1-0-88" class="d">-}
</a><a href="#h1-0-89" id="h1-0-89" class="d">-
</a><a href="#h1-0-90" id="h1-0-90" class="d">-static unsigned int
</a><a href="#h1-0-91" id="h1-0-91" class="d">-textnw(const char *text, unsigned int len) {
</a><a href="#h1-0-92" id="h1-0-92" class="d">-	XRectangle r;
</a><a href="#h1-0-93" id="h1-0-93" class="d">-
</a><a href="#h1-0-94" id="h1-0-94" class="d">-	if(dc.font.set) {
</a><a href="#h1-0-95" id="h1-0-95" class="d">-		XmbTextExtents(dc.font.set, text, len, NULL, &amp;r);
</a><a href="#h1-0-96" id="h1-0-96" class="d">-		return r.width;
</a><a href="#h1-0-97" id="h1-0-97" class="d">-	}
</a><a href="#h1-0-98" id="h1-0-98" class="d">-	return XTextWidth(dc.font.xfont, text, len);
</a><a href="#h1-0-99" id="h1-0-99" class="d">-}
</a><a href="#h1-0-100" id="h1-0-100" class="d">-
</a><a href="#h1-0-101" id="h1-0-101" class="d">-static void
</a><a href="#h1-0-102" id="h1-0-102" class="d">-drawtext(const char *text, unsigned long col[ColLast]) {
</a><a href="#h1-0-103" id="h1-0-103" class="d">-	int x, y, w, h;
</a><a href="#h1-0-104" id="h1-0-104" class="d">-	static char buf[256];
</a><a href="#h1-0-105" id="h1-0-105" class="d">-	unsigned int len, olen;
</a><a href="#h1-0-106" id="h1-0-106" class="d">-	XRectangle r = { dc.x, dc.y, dc.w, dc.h };
</a><a href="#h1-0-107" id="h1-0-107" class="d">-
</a><a href="#h1-0-108" id="h1-0-108" class="d">-	XSetForeground(dpy, dc.gc, col[ColBG]);
</a><a href="#h1-0-109" id="h1-0-109" class="d">-	XFillRectangles(dpy, dc.drawable, dc.gc, &amp;r, 1);
</a><a href="#h1-0-110" id="h1-0-110" class="d">-	if(!text)
</a><a href="#h1-0-111" id="h1-0-111" class="d">-		return;
</a><a href="#h1-0-112" id="h1-0-112" class="d">-	w = 0;
</a><a href="#h1-0-113" id="h1-0-113" class="d">-	olen = len = strlen(text);
</a><a href="#h1-0-114" id="h1-0-114" class="d">-	if(len &gt;= sizeof buf)
</a><a href="#h1-0-115" id="h1-0-115" class="d">-		len = sizeof buf - 1;
</a><a href="#h1-0-116" id="h1-0-116" class="d">-	memcpy(buf, text, len);
</a><a href="#h1-0-117" id="h1-0-117" class="d">-	buf[len] = 0;
</a><a href="#h1-0-118" id="h1-0-118" class="d">-	h = dc.font.ascent + dc.font.descent;
</a><a href="#h1-0-119" id="h1-0-119" class="d">-	y = dc.y + (dc.h / 2) - (h / 2) + dc.font.ascent;
</a><a href="#h1-0-120" id="h1-0-120" class="d">-	x = dc.x + (h / 2);
</a><a href="#h1-0-121" id="h1-0-121" class="d">-	/* shorten text if necessary */
</a><a href="#h1-0-122" id="h1-0-122" class="d">-	while(len &amp;&amp; (w = textnw(buf, len)) &gt; dc.w - h)
</a><a href="#h1-0-123" id="h1-0-123" class="d">-		buf[--len] = 0;
</a><a href="#h1-0-124" id="h1-0-124" class="d">-	if(len &lt; olen) {
</a><a href="#h1-0-125" id="h1-0-125" class="d">-		if(len &gt; 1)
</a><a href="#h1-0-126" id="h1-0-126" class="d">-			buf[len - 1] = &#39;.&#39;;
</a><a href="#h1-0-127" id="h1-0-127" class="d">-		if(len &gt; 2)
</a><a href="#h1-0-128" id="h1-0-128" class="d">-			buf[len - 2] = &#39;.&#39;;
</a><a href="#h1-0-129" id="h1-0-129" class="d">-		if(len &gt; 3)
</a><a href="#h1-0-130" id="h1-0-130" class="d">-			buf[len - 3] = &#39;.&#39;;
</a><a href="#h1-0-131" id="h1-0-131" class="d">-	}
</a><a href="#h1-0-132" id="h1-0-132" class="d">-	if(w &gt; dc.w)
</a><a href="#h1-0-133" id="h1-0-133" class="d">-		return; /* too long */
</a><a href="#h1-0-134" id="h1-0-134" class="d">-	XSetForeground(dpy, dc.gc, col[ColFG]);
</a><a href="#h1-0-135" id="h1-0-135" class="d">-	if(dc.font.set)
</a><a href="#h1-0-136" id="h1-0-136" class="d">-		XmbDrawString(dpy, dc.drawable, dc.font.set, dc.gc, x, y, buf, len);
</a><a href="#h1-0-137" id="h1-0-137" class="d">-	else
</a><a href="#h1-0-138" id="h1-0-138" class="d">-		XDrawString(dpy, dc.drawable, dc.gc, x, y, buf, len);
</a><a href="#h1-0-139" id="h1-0-139" class="d">-}
</a><a href="#h1-0-140" id="h1-0-140" class="d">-
</a><a href="#h1-0-141" id="h1-0-141" class="d">-/* extern */
</a><a href="#h1-0-142" id="h1-0-142" class="d">-
</a><a href="#h1-0-143" id="h1-0-143" class="d">-unsigned int bh;
</a><a href="#h1-0-144" id="h1-0-144" class="d">-unsigned int bpos = BARPOS;
</a><a href="#h1-0-145" id="h1-0-145" class="d">-DC dc = {0};
</a><a href="#h1-0-146" id="h1-0-146" class="d">-Window barwin;
</a><a href="#h1-0-147" id="h1-0-147" class="d">-
</a><a href="#h1-0-148" id="h1-0-148" class="d">-void
</a><a href="#h1-0-149" id="h1-0-149" class="d">-drawbar(void) {
</a><a href="#h1-0-150" id="h1-0-150" class="d">-	int i, x;
</a><a href="#h1-0-151" id="h1-0-151" class="d">-
</a><a href="#h1-0-152" id="h1-0-152" class="d">-	dc.x = dc.y = 0;
</a><a href="#h1-0-153" id="h1-0-153" class="d">-	for(i = 0; i &lt; ntags; i++) {
</a><a href="#h1-0-154" id="h1-0-154" class="d">-		dc.w = textw(tags[i]);
</a><a href="#h1-0-155" id="h1-0-155" class="d">-		if(seltags[i]) {
</a><a href="#h1-0-156" id="h1-0-156" class="d">-			drawtext(tags[i], dc.sel);
</a><a href="#h1-0-157" id="h1-0-157" class="d">-			drawsquare(sel &amp;&amp; sel-&gt;tags[i], isoccupied(i), dc.sel);
</a><a href="#h1-0-158" id="h1-0-158" class="d">-		}
</a><a href="#h1-0-159" id="h1-0-159" class="d">-		else {
</a><a href="#h1-0-160" id="h1-0-160" class="d">-			drawtext(tags[i], dc.norm);
</a><a href="#h1-0-161" id="h1-0-161" class="d">-			drawsquare(sel &amp;&amp; sel-&gt;tags[i], isoccupied(i), dc.norm);
</a><a href="#h1-0-162" id="h1-0-162" class="d">-		}
</a><a href="#h1-0-163" id="h1-0-163" class="d">-		dc.x += dc.w;
</a><a href="#h1-0-164" id="h1-0-164" class="d">-	}
</a><a href="#h1-0-165" id="h1-0-165" class="d">-	dc.w = blw;
</a><a href="#h1-0-166" id="h1-0-166" class="d">-	drawtext(getsymbol(), dc.norm);
</a><a href="#h1-0-167" id="h1-0-167" class="d">-	x = dc.x + dc.w;
</a><a href="#h1-0-168" id="h1-0-168" class="d">-	dc.w = textw(stext);
</a><a href="#h1-0-169" id="h1-0-169" class="d">-	dc.x = sw - dc.w;
</a><a href="#h1-0-170" id="h1-0-170" class="d">-	if(dc.x &lt; x) {
</a><a href="#h1-0-171" id="h1-0-171" class="d">-		dc.x = x;
</a><a href="#h1-0-172" id="h1-0-172" class="d">-		dc.w = sw - x;
</a><a href="#h1-0-173" id="h1-0-173" class="d">-	}
</a><a href="#h1-0-174" id="h1-0-174" class="d">-	drawtext(stext, dc.norm);
</a><a href="#h1-0-175" id="h1-0-175" class="d">-	if((dc.w = dc.x - x) &gt; bh) {
</a><a href="#h1-0-176" id="h1-0-176" class="d">-		dc.x = x;
</a><a href="#h1-0-177" id="h1-0-177" class="d">-		if(sel) {
</a><a href="#h1-0-178" id="h1-0-178" class="d">-			drawtext(sel-&gt;name, dc.sel);
</a><a href="#h1-0-179" id="h1-0-179" class="d">-			drawsquare(sel-&gt;ismax, sel-&gt;isfloating, dc.sel);
</a><a href="#h1-0-180" id="h1-0-180" class="d">-		}
</a><a href="#h1-0-181" id="h1-0-181" class="d">-		else
</a><a href="#h1-0-182" id="h1-0-182" class="d">-			drawtext(NULL, dc.norm);
</a><a href="#h1-0-183" id="h1-0-183" class="d">-	}
</a><a href="#h1-0-184" id="h1-0-184" class="d">-	XCopyArea(dpy, dc.drawable, barwin, dc.gc, 0, 0, sw, bh, 0, 0);
</a><a href="#h1-0-185" id="h1-0-185" class="d">-	XSync(dpy, False);
</a><a href="#h1-0-186" id="h1-0-186" class="d">-}
</a><a href="#h1-0-187" id="h1-0-187" class="d">-
</a><a href="#h1-0-188" id="h1-0-188" class="d">-void
</a><a href="#h1-0-189" id="h1-0-189" class="d">-initstyle(void) {
</a><a href="#h1-0-190" id="h1-0-190" class="d">-	dc.norm[ColBorder] = initcolor(NORMBORDERCOLOR);
</a><a href="#h1-0-191" id="h1-0-191" class="d">-	dc.norm[ColBG] = initcolor(NORMBGCOLOR);
</a><a href="#h1-0-192" id="h1-0-192" class="d">-	dc.norm[ColFG] = initcolor(NORMFGCOLOR);
</a><a href="#h1-0-193" id="h1-0-193" class="d">-	dc.sel[ColBorder] = initcolor(SELBORDERCOLOR);
</a><a href="#h1-0-194" id="h1-0-194" class="d">-	dc.sel[ColBG] = initcolor(SELBGCOLOR);
</a><a href="#h1-0-195" id="h1-0-195" class="d">-	dc.sel[ColFG] = initcolor(SELFGCOLOR);
</a><a href="#h1-0-196" id="h1-0-196" class="d">-	initfont(FONT);
</a><a href="#h1-0-197" id="h1-0-197" class="d">-	dc.h = bh = dc.font.height + 2;
</a><a href="#h1-0-198" id="h1-0-198" class="d">-}
</a><a href="#h1-0-199" id="h1-0-199" class="d">-
</a><a href="#h1-0-200" id="h1-0-200" class="d">-void
</a><a href="#h1-0-201" id="h1-0-201" class="d">-initbar(void) {
</a><a href="#h1-0-202" id="h1-0-202" class="d">-	XSetWindowAttributes wa;
</a><a href="#h1-0-203" id="h1-0-203" class="d">-
</a><a href="#h1-0-204" id="h1-0-204" class="d">-	wa.override_redirect = 1;
</a><a href="#h1-0-205" id="h1-0-205" class="d">-	wa.background_pixmap = ParentRelative;
</a><a href="#h1-0-206" id="h1-0-206" class="d">-	wa.event_mask = ButtonPressMask | ExposureMask;
</a><a href="#h1-0-207" id="h1-0-207" class="d">-	barwin = XCreateWindow(dpy, root, sx, sy, sw, bh, 0,
</a><a href="#h1-0-208" id="h1-0-208" class="d">-			DefaultDepth(dpy, screen), CopyFromParent, DefaultVisual(dpy, screen),
</a><a href="#h1-0-209" id="h1-0-209" class="d">-			CWOverrideRedirect | CWBackPixmap | CWEventMask, &amp;wa);
</a><a href="#h1-0-210" id="h1-0-210" class="d">-	XDefineCursor(dpy, barwin, cursor[CurNormal]);
</a><a href="#h1-0-211" id="h1-0-211" class="d">-	updatebarpos();
</a><a href="#h1-0-212" id="h1-0-212" class="d">-	XMapRaised(dpy, barwin);
</a><a href="#h1-0-213" id="h1-0-213" class="d">-	strcpy(stext, &quot;dwm-&quot;VERSION);
</a><a href="#h1-0-214" id="h1-0-214" class="d">-	dc.drawable = XCreatePixmap(dpy, root, sw, bh, DefaultDepth(dpy, screen));
</a><a href="#h1-0-215" id="h1-0-215" class="d">-	dc.gc = XCreateGC(dpy, root, 0, 0);
</a><a href="#h1-0-216" id="h1-0-216" class="d">-	XSetLineAttributes(dpy, dc.gc, 1, LineSolid, CapButt, JoinMiter);
</a><a href="#h1-0-217" id="h1-0-217" class="d">-	if(!dc.font.set)
</a><a href="#h1-0-218" id="h1-0-218" class="d">-		XSetFont(dpy, dc.gc, dc.font.xfont-&gt;fid);
</a><a href="#h1-0-219" id="h1-0-219" class="d">-}
</a><a href="#h1-0-220" id="h1-0-220" class="d">-
</a><a href="#h1-0-221" id="h1-0-221" class="d">-unsigned int
</a><a href="#h1-0-222" id="h1-0-222" class="d">-textw(const char *text) {
</a><a href="#h1-0-223" id="h1-0-223" class="d">-	return textnw(text, strlen(text)) + dc.font.height;
</a><a href="#h1-0-224" id="h1-0-224" class="d">-}
</a><a href="#h1-0-225" id="h1-0-225" class="d">-
</a><a href="#h1-0-226" id="h1-0-226" class="d">-void
</a><a href="#h1-0-227" id="h1-0-227" class="d">-togglebar(const char *arg) {
</a><a href="#h1-0-228" id="h1-0-228" class="d">-	if(bpos == BarOff)
</a><a href="#h1-0-229" id="h1-0-229" class="d">-		bpos = (BARPOS == BarOff) ? BarTop : BARPOS;
</a><a href="#h1-0-230" id="h1-0-230" class="d">-	else
</a><a href="#h1-0-231" id="h1-0-231" class="d">-		bpos = BarOff;
</a><a href="#h1-0-232" id="h1-0-232" class="d">-	updatebarpos();
</a><a href="#h1-0-233" id="h1-0-233" class="d">-	arrange();
</a><a href="#h1-0-234" id="h1-0-234" class="d">-}
</a><a href="#h1-0-235" id="h1-0-235" class="d">-
</a><a href="#h1-0-236" id="h1-0-236" class="d">-void
</a><a href="#h1-0-237" id="h1-0-237" class="d">-updatebarpos(void) {
</a><a href="#h1-0-238" id="h1-0-238" class="d">-	XEvent ev;
</a><a href="#h1-0-239" id="h1-0-239" class="d">-
</a><a href="#h1-0-240" id="h1-0-240" class="d">-	wax = sx;
</a><a href="#h1-0-241" id="h1-0-241" class="d">-	way = sy;
</a><a href="#h1-0-242" id="h1-0-242" class="d">-	wah = sh;
</a><a href="#h1-0-243" id="h1-0-243" class="d">-	waw = sw;
</a><a href="#h1-0-244" id="h1-0-244" class="d">-	switch(bpos) {
</a><a href="#h1-0-245" id="h1-0-245" class="d">-	default:
</a><a href="#h1-0-246" id="h1-0-246" class="d">-		wah -= bh;
</a><a href="#h1-0-247" id="h1-0-247" class="d">-		way += bh;
</a><a href="#h1-0-248" id="h1-0-248" class="d">-		XMoveWindow(dpy, barwin, sx, sy);
</a><a href="#h1-0-249" id="h1-0-249" class="d">-		break;
</a><a href="#h1-0-250" id="h1-0-250" class="d">-	case BarBot:
</a><a href="#h1-0-251" id="h1-0-251" class="d">-		wah -= bh;
</a><a href="#h1-0-252" id="h1-0-252" class="d">-		XMoveWindow(dpy, barwin, sx, sy + wah);
</a><a href="#h1-0-253" id="h1-0-253" class="d">-		break;
</a><a href="#h1-0-254" id="h1-0-254" class="d">-	case BarOff:
</a><a href="#h1-0-255" id="h1-0-255" class="d">-		XMoveWindow(dpy, barwin, sx, sy - bh);
</a><a href="#h1-0-256" id="h1-0-256" class="d">-		break;
</a><a href="#h1-0-257" id="h1-0-257" class="d">-	}
</a><a href="#h1-0-258" id="h1-0-258" class="d">-	XSync(dpy, False);
</a><a href="#h1-0-259" id="h1-0-259" class="d">-	while(XCheckMaskEvent(dpy, EnterWindowMask, &amp;ev));
</a><a href="#h1-0-260" id="h1-0-260" class="d">-}
</a><a href="#h1-0-261" id="h1-0-261" class="d">-
</a><a href="#h1-0-262" id="h1-0-262" class="d">-
</a><b>diff --git a/<a id="h2" href="../file/client.c.html">client.c</a> b/<a href="../file/client.c.html">client.c</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -1,386 +0,0 @@
</a><a href="#h2-0-0" id="h2-0-0" class="d">-/* See LICENSE file for copyright and license details. */
</a><a href="#h2-0-1" id="h2-0-1" class="d">-#include &quot;dwm.h&quot;
</a><a href="#h2-0-2" id="h2-0-2" class="d">-#include &lt;stdlib.h&gt;
</a><a href="#h2-0-3" id="h2-0-3" class="d">-#include &lt;X11/Xutil.h&gt;
</a><a href="#h2-0-4" id="h2-0-4" class="d">-
</a><a href="#h2-0-5" id="h2-0-5" class="d">-/* static */
</a><a href="#h2-0-6" id="h2-0-6" class="d">-
</a><a href="#h2-0-7" id="h2-0-7" class="d">-static void
</a><a href="#h2-0-8" id="h2-0-8" class="d">-attachstack(Client *c) {
</a><a href="#h2-0-9" id="h2-0-9" class="d">-	c-&gt;snext = stack;
</a><a href="#h2-0-10" id="h2-0-10" class="d">-	stack = c;
</a><a href="#h2-0-11" id="h2-0-11" class="d">-}
</a><a href="#h2-0-12" id="h2-0-12" class="d">-
</a><a href="#h2-0-13" id="h2-0-13" class="d">-static void
</a><a href="#h2-0-14" id="h2-0-14" class="d">-detachstack(Client *c) {
</a><a href="#h2-0-15" id="h2-0-15" class="d">-	Client **tc;
</a><a href="#h2-0-16" id="h2-0-16" class="d">-
</a><a href="#h2-0-17" id="h2-0-17" class="d">-	for(tc=&amp;stack; *tc &amp;&amp; *tc != c; tc=&amp;(*tc)-&gt;snext);
</a><a href="#h2-0-18" id="h2-0-18" class="d">-	*tc = c-&gt;snext;
</a><a href="#h2-0-19" id="h2-0-19" class="d">-}
</a><a href="#h2-0-20" id="h2-0-20" class="d">-
</a><a href="#h2-0-21" id="h2-0-21" class="d">-static void
</a><a href="#h2-0-22" id="h2-0-22" class="d">-grabbuttons(Client *c, Bool focused) {
</a><a href="#h2-0-23" id="h2-0-23" class="d">-	XUngrabButton(dpy, AnyButton, AnyModifier, c-&gt;win);
</a><a href="#h2-0-24" id="h2-0-24" class="d">-
</a><a href="#h2-0-25" id="h2-0-25" class="d">-	if(focused) {
</a><a href="#h2-0-26" id="h2-0-26" class="d">-		XGrabButton(dpy, Button1, MODKEY, c-&gt;win, False, BUTTONMASK,
</a><a href="#h2-0-27" id="h2-0-27" class="d">-				GrabModeAsync, GrabModeSync, None, None);
</a><a href="#h2-0-28" id="h2-0-28" class="d">-		XGrabButton(dpy, Button1, MODKEY | LockMask, c-&gt;win, False, BUTTONMASK,
</a><a href="#h2-0-29" id="h2-0-29" class="d">-				GrabModeAsync, GrabModeSync, None, None);
</a><a href="#h2-0-30" id="h2-0-30" class="d">-		XGrabButton(dpy, Button1, MODKEY | numlockmask, c-&gt;win, False, BUTTONMASK,
</a><a href="#h2-0-31" id="h2-0-31" class="d">-				GrabModeAsync, GrabModeSync, None, None);
</a><a href="#h2-0-32" id="h2-0-32" class="d">-		XGrabButton(dpy, Button1, MODKEY | numlockmask | LockMask, c-&gt;win, False, BUTTONMASK,
</a><a href="#h2-0-33" id="h2-0-33" class="d">-				GrabModeAsync, GrabModeSync, None, None);
</a><a href="#h2-0-34" id="h2-0-34" class="d">-
</a><a href="#h2-0-35" id="h2-0-35" class="d">-		XGrabButton(dpy, Button2, MODKEY, c-&gt;win, False, BUTTONMASK,
</a><a href="#h2-0-36" id="h2-0-36" class="d">-				GrabModeAsync, GrabModeSync, None, None);
</a><a href="#h2-0-37" id="h2-0-37" class="d">-		XGrabButton(dpy, Button2, MODKEY | LockMask, c-&gt;win, False, BUTTONMASK,
</a><a href="#h2-0-38" id="h2-0-38" class="d">-				GrabModeAsync, GrabModeSync, None, None);
</a><a href="#h2-0-39" id="h2-0-39" class="d">-		XGrabButton(dpy, Button2, MODKEY | numlockmask, c-&gt;win, False, BUTTONMASK,
</a><a href="#h2-0-40" id="h2-0-40" class="d">-				GrabModeAsync, GrabModeSync, None, None);
</a><a href="#h2-0-41" id="h2-0-41" class="d">-		XGrabButton(dpy, Button2, MODKEY | numlockmask | LockMask, c-&gt;win, False, BUTTONMASK,
</a><a href="#h2-0-42" id="h2-0-42" class="d">-				GrabModeAsync, GrabModeSync, None, None);
</a><a href="#h2-0-43" id="h2-0-43" class="d">-
</a><a href="#h2-0-44" id="h2-0-44" class="d">-		XGrabButton(dpy, Button3, MODKEY, c-&gt;win, False, BUTTONMASK,
</a><a href="#h2-0-45" id="h2-0-45" class="d">-				GrabModeAsync, GrabModeSync, None, None);
</a><a href="#h2-0-46" id="h2-0-46" class="d">-		XGrabButton(dpy, Button3, MODKEY | LockMask, c-&gt;win, False, BUTTONMASK,
</a><a href="#h2-0-47" id="h2-0-47" class="d">-				GrabModeAsync, GrabModeSync, None, None);
</a><a href="#h2-0-48" id="h2-0-48" class="d">-		XGrabButton(dpy, Button3, MODKEY | numlockmask, c-&gt;win, False, BUTTONMASK,
</a><a href="#h2-0-49" id="h2-0-49" class="d">-				GrabModeAsync, GrabModeSync, None, None);
</a><a href="#h2-0-50" id="h2-0-50" class="d">-		XGrabButton(dpy, Button3, MODKEY | numlockmask | LockMask, c-&gt;win, False, BUTTONMASK,
</a><a href="#h2-0-51" id="h2-0-51" class="d">-				GrabModeAsync, GrabModeSync, None, None);
</a><a href="#h2-0-52" id="h2-0-52" class="d">-	}
</a><a href="#h2-0-53" id="h2-0-53" class="d">-	else
</a><a href="#h2-0-54" id="h2-0-54" class="d">-		XGrabButton(dpy, AnyButton, AnyModifier, c-&gt;win, False, BUTTONMASK,
</a><a href="#h2-0-55" id="h2-0-55" class="d">-				GrabModeAsync, GrabModeSync, None, None);
</a><a href="#h2-0-56" id="h2-0-56" class="d">-}
</a><a href="#h2-0-57" id="h2-0-57" class="d">-
</a><a href="#h2-0-58" id="h2-0-58" class="d">-static Bool
</a><a href="#h2-0-59" id="h2-0-59" class="d">-isprotodel(Client *c) {
</a><a href="#h2-0-60" id="h2-0-60" class="d">-	int i, n;
</a><a href="#h2-0-61" id="h2-0-61" class="d">-	Atom *protocols;
</a><a href="#h2-0-62" id="h2-0-62" class="d">-	Bool ret = False;
</a><a href="#h2-0-63" id="h2-0-63" class="d">-
</a><a href="#h2-0-64" id="h2-0-64" class="d">-	if(XGetWMProtocols(dpy, c-&gt;win, &amp;protocols, &amp;n)) {
</a><a href="#h2-0-65" id="h2-0-65" class="d">-		for(i = 0; !ret &amp;&amp; i &lt; n; i++)
</a><a href="#h2-0-66" id="h2-0-66" class="d">-			if(protocols[i] == wmatom[WMDelete])
</a><a href="#h2-0-67" id="h2-0-67" class="d">-				ret = True;
</a><a href="#h2-0-68" id="h2-0-68" class="d">-		XFree(protocols);
</a><a href="#h2-0-69" id="h2-0-69" class="d">-	}
</a><a href="#h2-0-70" id="h2-0-70" class="d">-	return ret;
</a><a href="#h2-0-71" id="h2-0-71" class="d">-}
</a><a href="#h2-0-72" id="h2-0-72" class="d">-
</a><a href="#h2-0-73" id="h2-0-73" class="d">-static void
</a><a href="#h2-0-74" id="h2-0-74" class="d">-setclientstate(Client *c, long state) {
</a><a href="#h2-0-75" id="h2-0-75" class="d">-	long data[] = {state, None};
</a><a href="#h2-0-76" id="h2-0-76" class="d">-
</a><a href="#h2-0-77" id="h2-0-77" class="d">-	XChangeProperty(dpy, c-&gt;win, wmatom[WMState], wmatom[WMState], 32,
</a><a href="#h2-0-78" id="h2-0-78" class="d">-			PropModeReplace, (unsigned char *)data, 2);
</a><a href="#h2-0-79" id="h2-0-79" class="d">-}
</a><a href="#h2-0-80" id="h2-0-80" class="d">-
</a><a href="#h2-0-81" id="h2-0-81" class="d">-static int
</a><a href="#h2-0-82" id="h2-0-82" class="d">-xerrordummy(Display *dsply, XErrorEvent *ee) {
</a><a href="#h2-0-83" id="h2-0-83" class="d">-	return 0;
</a><a href="#h2-0-84" id="h2-0-84" class="d">-}
</a><a href="#h2-0-85" id="h2-0-85" class="d">-
</a><a href="#h2-0-86" id="h2-0-86" class="d">-/* extern */
</a><a href="#h2-0-87" id="h2-0-87" class="d">-
</a><a href="#h2-0-88" id="h2-0-88" class="d">-void
</a><a href="#h2-0-89" id="h2-0-89" class="d">-attach(Client *c) {
</a><a href="#h2-0-90" id="h2-0-90" class="d">-	if(clients)
</a><a href="#h2-0-91" id="h2-0-91" class="d">-		clients-&gt;prev = c;
</a><a href="#h2-0-92" id="h2-0-92" class="d">-	c-&gt;next = clients;
</a><a href="#h2-0-93" id="h2-0-93" class="d">-	clients = c;
</a><a href="#h2-0-94" id="h2-0-94" class="d">-}
</a><a href="#h2-0-95" id="h2-0-95" class="d">-
</a><a href="#h2-0-96" id="h2-0-96" class="d">-void
</a><a href="#h2-0-97" id="h2-0-97" class="d">-ban(Client *c) {
</a><a href="#h2-0-98" id="h2-0-98" class="d">-	if(c-&gt;isbanned)
</a><a href="#h2-0-99" id="h2-0-99" class="d">-		return;
</a><a href="#h2-0-100" id="h2-0-100" class="d">-	XMoveWindow(dpy, c-&gt;win, c-&gt;x + 2 * sw, c-&gt;y);
</a><a href="#h2-0-101" id="h2-0-101" class="d">-	c-&gt;isbanned = True;
</a><a href="#h2-0-102" id="h2-0-102" class="d">-}
</a><a href="#h2-0-103" id="h2-0-103" class="d">-
</a><a href="#h2-0-104" id="h2-0-104" class="d">-void
</a><a href="#h2-0-105" id="h2-0-105" class="d">-configure(Client *c) {
</a><a href="#h2-0-106" id="h2-0-106" class="d">-	XConfigureEvent ce;
</a><a href="#h2-0-107" id="h2-0-107" class="d">-
</a><a href="#h2-0-108" id="h2-0-108" class="d">-	ce.type = ConfigureNotify;
</a><a href="#h2-0-109" id="h2-0-109" class="d">-	ce.display = dpy;
</a><a href="#h2-0-110" id="h2-0-110" class="d">-	ce.event = c-&gt;win;
</a><a href="#h2-0-111" id="h2-0-111" class="d">-	ce.window = c-&gt;win;
</a><a href="#h2-0-112" id="h2-0-112" class="d">-	ce.x = c-&gt;x;
</a><a href="#h2-0-113" id="h2-0-113" class="d">-	ce.y = c-&gt;y;
</a><a href="#h2-0-114" id="h2-0-114" class="d">-	ce.width = c-&gt;w;
</a><a href="#h2-0-115" id="h2-0-115" class="d">-	ce.height = c-&gt;h;
</a><a href="#h2-0-116" id="h2-0-116" class="d">-	ce.border_width = c-&gt;border;
</a><a href="#h2-0-117" id="h2-0-117" class="d">-	ce.above = None;
</a><a href="#h2-0-118" id="h2-0-118" class="d">-	ce.override_redirect = False;
</a><a href="#h2-0-119" id="h2-0-119" class="d">-	XSendEvent(dpy, c-&gt;win, False, StructureNotifyMask, (XEvent *)&amp;ce);
</a><a href="#h2-0-120" id="h2-0-120" class="d">-}
</a><a href="#h2-0-121" id="h2-0-121" class="d">-
</a><a href="#h2-0-122" id="h2-0-122" class="d">-void
</a><a href="#h2-0-123" id="h2-0-123" class="d">-detach(Client *c) {
</a><a href="#h2-0-124" id="h2-0-124" class="d">-	if(c-&gt;prev)
</a><a href="#h2-0-125" id="h2-0-125" class="d">-		c-&gt;prev-&gt;next = c-&gt;next;
</a><a href="#h2-0-126" id="h2-0-126" class="d">-	if(c-&gt;next)
</a><a href="#h2-0-127" id="h2-0-127" class="d">-		c-&gt;next-&gt;prev = c-&gt;prev;
</a><a href="#h2-0-128" id="h2-0-128" class="d">-	if(c == clients)
</a><a href="#h2-0-129" id="h2-0-129" class="d">-		clients = c-&gt;next;
</a><a href="#h2-0-130" id="h2-0-130" class="d">-	c-&gt;next = c-&gt;prev = NULL;
</a><a href="#h2-0-131" id="h2-0-131" class="d">-}
</a><a href="#h2-0-132" id="h2-0-132" class="d">-
</a><a href="#h2-0-133" id="h2-0-133" class="d">-void
</a><a href="#h2-0-134" id="h2-0-134" class="d">-focus(Client *c) {
</a><a href="#h2-0-135" id="h2-0-135" class="d">-	if((!c &amp;&amp; selscreen) || (c &amp;&amp; !isvisible(c)))
</a><a href="#h2-0-136" id="h2-0-136" class="d">-		for(c = stack; c &amp;&amp; !isvisible(c); c = c-&gt;snext);
</a><a href="#h2-0-137" id="h2-0-137" class="d">-	if(sel &amp;&amp; sel != c) {
</a><a href="#h2-0-138" id="h2-0-138" class="d">-		grabbuttons(sel, False);
</a><a href="#h2-0-139" id="h2-0-139" class="d">-		XSetWindowBorder(dpy, sel-&gt;win, dc.norm[ColBorder]);
</a><a href="#h2-0-140" id="h2-0-140" class="d">-	}
</a><a href="#h2-0-141" id="h2-0-141" class="d">-	if(c) {
</a><a href="#h2-0-142" id="h2-0-142" class="d">-		detachstack(c);
</a><a href="#h2-0-143" id="h2-0-143" class="d">-		attachstack(c);
</a><a href="#h2-0-144" id="h2-0-144" class="d">-		grabbuttons(c, True);
</a><a href="#h2-0-145" id="h2-0-145" class="d">-	}
</a><a href="#h2-0-146" id="h2-0-146" class="d">-	sel = c;
</a><a href="#h2-0-147" id="h2-0-147" class="d">-	drawbar();
</a><a href="#h2-0-148" id="h2-0-148" class="d">-	if(!selscreen)
</a><a href="#h2-0-149" id="h2-0-149" class="d">-		return;
</a><a href="#h2-0-150" id="h2-0-150" class="d">-	if(c) {
</a><a href="#h2-0-151" id="h2-0-151" class="d">-		XSetWindowBorder(dpy, c-&gt;win, dc.sel[ColBorder]);
</a><a href="#h2-0-152" id="h2-0-152" class="d">-		XSetInputFocus(dpy, c-&gt;win, RevertToPointerRoot, CurrentTime);
</a><a href="#h2-0-153" id="h2-0-153" class="d">-	}
</a><a href="#h2-0-154" id="h2-0-154" class="d">-	else
</a><a href="#h2-0-155" id="h2-0-155" class="d">-		XSetInputFocus(dpy, root, RevertToPointerRoot, CurrentTime);
</a><a href="#h2-0-156" id="h2-0-156" class="d">-}
</a><a href="#h2-0-157" id="h2-0-157" class="d">-
</a><a href="#h2-0-158" id="h2-0-158" class="d">-void
</a><a href="#h2-0-159" id="h2-0-159" class="d">-killclient(const char *arg) {
</a><a href="#h2-0-160" id="h2-0-160" class="d">-	XEvent ev;
</a><a href="#h2-0-161" id="h2-0-161" class="d">-
</a><a href="#h2-0-162" id="h2-0-162" class="d">-	if(!sel)
</a><a href="#h2-0-163" id="h2-0-163" class="d">-		return;
</a><a href="#h2-0-164" id="h2-0-164" class="d">-	if(isprotodel(sel)) {
</a><a href="#h2-0-165" id="h2-0-165" class="d">-		ev.type = ClientMessage;
</a><a href="#h2-0-166" id="h2-0-166" class="d">-		ev.xclient.window = sel-&gt;win;
</a><a href="#h2-0-167" id="h2-0-167" class="d">-		ev.xclient.message_type = wmatom[WMProtocols];
</a><a href="#h2-0-168" id="h2-0-168" class="d">-		ev.xclient.format = 32;
</a><a href="#h2-0-169" id="h2-0-169" class="d">-		ev.xclient.data.l[0] = wmatom[WMDelete];
</a><a href="#h2-0-170" id="h2-0-170" class="d">-		ev.xclient.data.l[1] = CurrentTime;
</a><a href="#h2-0-171" id="h2-0-171" class="d">-		XSendEvent(dpy, sel-&gt;win, False, NoEventMask, &amp;ev);
</a><a href="#h2-0-172" id="h2-0-172" class="d">-	}
</a><a href="#h2-0-173" id="h2-0-173" class="d">-	else
</a><a href="#h2-0-174" id="h2-0-174" class="d">-		XKillClient(dpy, sel-&gt;win);
</a><a href="#h2-0-175" id="h2-0-175" class="d">-}
</a><a href="#h2-0-176" id="h2-0-176" class="d">-
</a><a href="#h2-0-177" id="h2-0-177" class="d">-void
</a><a href="#h2-0-178" id="h2-0-178" class="d">-manage(Window w, XWindowAttributes *wa) {
</a><a href="#h2-0-179" id="h2-0-179" class="d">-	unsigned int i;
</a><a href="#h2-0-180" id="h2-0-180" class="d">-	Client *c, *t = NULL;
</a><a href="#h2-0-181" id="h2-0-181" class="d">-	Window trans;
</a><a href="#h2-0-182" id="h2-0-182" class="d">-	Status rettrans;
</a><a href="#h2-0-183" id="h2-0-183" class="d">-	XWindowChanges wc;
</a><a href="#h2-0-184" id="h2-0-184" class="d">-
</a><a href="#h2-0-185" id="h2-0-185" class="d">-	c = emallocz(sizeof(Client));
</a><a href="#h2-0-186" id="h2-0-186" class="d">-	c-&gt;tags = emallocz(ntags * sizeof(Bool));
</a><a href="#h2-0-187" id="h2-0-187" class="d">-	c-&gt;win = w;
</a><a href="#h2-0-188" id="h2-0-188" class="d">-	c-&gt;x = wa-&gt;x;
</a><a href="#h2-0-189" id="h2-0-189" class="d">-	c-&gt;y = wa-&gt;y;
</a><a href="#h2-0-190" id="h2-0-190" class="d">-	c-&gt;w = wa-&gt;width;
</a><a href="#h2-0-191" id="h2-0-191" class="d">-	c-&gt;h = wa-&gt;height;
</a><a href="#h2-0-192" id="h2-0-192" class="d">-	c-&gt;oldborder = wa-&gt;border_width;
</a><a href="#h2-0-193" id="h2-0-193" class="d">-	if(c-&gt;w == sw &amp;&amp; c-&gt;h == sh) {
</a><a href="#h2-0-194" id="h2-0-194" class="d">-		c-&gt;x = sx;
</a><a href="#h2-0-195" id="h2-0-195" class="d">-		c-&gt;y = sy;
</a><a href="#h2-0-196" id="h2-0-196" class="d">-		c-&gt;border = wa-&gt;border_width;
</a><a href="#h2-0-197" id="h2-0-197" class="d">-	}
</a><a href="#h2-0-198" id="h2-0-198" class="d">-	else {
</a><a href="#h2-0-199" id="h2-0-199" class="d">-		if(c-&gt;x + c-&gt;w + 2 * c-&gt;border &gt; wax + waw)
</a><a href="#h2-0-200" id="h2-0-200" class="d">-			c-&gt;x = wax + waw - c-&gt;w - 2 * c-&gt;border;
</a><a href="#h2-0-201" id="h2-0-201" class="d">-		if(c-&gt;y + c-&gt;h + 2 * c-&gt;border &gt; way + wah)
</a><a href="#h2-0-202" id="h2-0-202" class="d">-			c-&gt;y = way + wah - c-&gt;h - 2 * c-&gt;border;
</a><a href="#h2-0-203" id="h2-0-203" class="d">-		if(c-&gt;x &lt; wax)
</a><a href="#h2-0-204" id="h2-0-204" class="d">-			c-&gt;x = wax;
</a><a href="#h2-0-205" id="h2-0-205" class="d">-		if(c-&gt;y &lt; way)
</a><a href="#h2-0-206" id="h2-0-206" class="d">-			c-&gt;y = way;
</a><a href="#h2-0-207" id="h2-0-207" class="d">-		c-&gt;border = BORDERPX;
</a><a href="#h2-0-208" id="h2-0-208" class="d">-	}
</a><a href="#h2-0-209" id="h2-0-209" class="d">-	wc.border_width = c-&gt;border;
</a><a href="#h2-0-210" id="h2-0-210" class="d">-	XConfigureWindow(dpy, w, CWBorderWidth, &amp;wc);
</a><a href="#h2-0-211" id="h2-0-211" class="d">-	XSetWindowBorder(dpy, w, dc.norm[ColBorder]);
</a><a href="#h2-0-212" id="h2-0-212" class="d">-	configure(c); /* propagates border_width, if size doesn&#39;t change */
</a><a href="#h2-0-213" id="h2-0-213" class="d">-	updatesizehints(c);
</a><a href="#h2-0-214" id="h2-0-214" class="d">-	XSelectInput(dpy, w,
</a><a href="#h2-0-215" id="h2-0-215" class="d">-		StructureNotifyMask | PropertyChangeMask | EnterWindowMask);
</a><a href="#h2-0-216" id="h2-0-216" class="d">-	grabbuttons(c, False);
</a><a href="#h2-0-217" id="h2-0-217" class="d">-	updatetitle(c);
</a><a href="#h2-0-218" id="h2-0-218" class="d">-	if((rettrans = XGetTransientForHint(dpy, w, &amp;trans) == Success))
</a><a href="#h2-0-219" id="h2-0-219" class="d">-		for(t = clients; t &amp;&amp; t-&gt;win != trans; t = t-&gt;next);
</a><a href="#h2-0-220" id="h2-0-220" class="d">-	if(t)
</a><a href="#h2-0-221" id="h2-0-221" class="d">-		for(i = 0; i &lt; ntags; i++)
</a><a href="#h2-0-222" id="h2-0-222" class="d">-			c-&gt;tags[i] = t-&gt;tags[i];
</a><a href="#h2-0-223" id="h2-0-223" class="d">-	applyrules(c);
</a><a href="#h2-0-224" id="h2-0-224" class="d">-	if(!c-&gt;isfloating)
</a><a href="#h2-0-225" id="h2-0-225" class="d">-		c-&gt;isfloating = (rettrans == Success) || c-&gt;isfixed;
</a><a href="#h2-0-226" id="h2-0-226" class="d">-	attach(c);
</a><a href="#h2-0-227" id="h2-0-227" class="d">-	attachstack(c);
</a><a href="#h2-0-228" id="h2-0-228" class="d">-	XMoveResizeWindow(dpy, c-&gt;win, c-&gt;x, c-&gt;y, c-&gt;w, c-&gt;h); /* some windows require this */
</a><a href="#h2-0-229" id="h2-0-229" class="d">-	ban(c);
</a><a href="#h2-0-230" id="h2-0-230" class="d">-	XMapWindow(dpy, c-&gt;win);
</a><a href="#h2-0-231" id="h2-0-231" class="d">-	setclientstate(c, NormalState);
</a><a href="#h2-0-232" id="h2-0-232" class="d">-	arrange();
</a><a href="#h2-0-233" id="h2-0-233" class="d">-}
</a><a href="#h2-0-234" id="h2-0-234" class="d">-
</a><a href="#h2-0-235" id="h2-0-235" class="d">-void
</a><a href="#h2-0-236" id="h2-0-236" class="d">-resize(Client *c, int x, int y, int w, int h, Bool sizehints) {
</a><a href="#h2-0-237" id="h2-0-237" class="d">-	double dx, dy, max, min, ratio;
</a><a href="#h2-0-238" id="h2-0-238" class="d">-	XWindowChanges wc; 
</a><a href="#h2-0-239" id="h2-0-239" class="d">-
</a><a href="#h2-0-240" id="h2-0-240" class="d">-	if(sizehints) {
</a><a href="#h2-0-241" id="h2-0-241" class="d">-		if(c-&gt;minay &gt; 0 &amp;&amp; c-&gt;maxay &gt; 0 &amp;&amp; (h - c-&gt;baseh) &gt; 0 &amp;&amp; (w - c-&gt;basew) &gt; 0) {
</a><a href="#h2-0-242" id="h2-0-242" class="d">-			dx = (double)(w - c-&gt;basew);
</a><a href="#h2-0-243" id="h2-0-243" class="d">-			dy = (double)(h - c-&gt;baseh);
</a><a href="#h2-0-244" id="h2-0-244" class="d">-			min = (double)(c-&gt;minax) / (double)(c-&gt;minay);
</a><a href="#h2-0-245" id="h2-0-245" class="d">-			max = (double)(c-&gt;maxax) / (double)(c-&gt;maxay);
</a><a href="#h2-0-246" id="h2-0-246" class="d">-			ratio = dx / dy;
</a><a href="#h2-0-247" id="h2-0-247" class="d">-			if(max &gt; 0 &amp;&amp; min &gt; 0 &amp;&amp; ratio &gt; 0) {
</a><a href="#h2-0-248" id="h2-0-248" class="d">-				if(ratio &lt; min) {
</a><a href="#h2-0-249" id="h2-0-249" class="d">-					dy = (dx * min + dy) / (min * min + 1);
</a><a href="#h2-0-250" id="h2-0-250" class="d">-					dx = dy * min;
</a><a href="#h2-0-251" id="h2-0-251" class="d">-					w = (int)dx + c-&gt;basew;
</a><a href="#h2-0-252" id="h2-0-252" class="d">-					h = (int)dy + c-&gt;baseh;
</a><a href="#h2-0-253" id="h2-0-253" class="d">-				}
</a><a href="#h2-0-254" id="h2-0-254" class="d">-				else if(ratio &gt; max) {
</a><a href="#h2-0-255" id="h2-0-255" class="d">-					dy = (dx * min + dy) / (max * max + 1);
</a><a href="#h2-0-256" id="h2-0-256" class="d">-					dx = dy * min;
</a><a href="#h2-0-257" id="h2-0-257" class="d">-					w = (int)dx + c-&gt;basew;
</a><a href="#h2-0-258" id="h2-0-258" class="d">-					h = (int)dy + c-&gt;baseh;
</a><a href="#h2-0-259" id="h2-0-259" class="d">-				}
</a><a href="#h2-0-260" id="h2-0-260" class="d">-			}
</a><a href="#h2-0-261" id="h2-0-261" class="d">-		}
</a><a href="#h2-0-262" id="h2-0-262" class="d">-		if(c-&gt;minw &amp;&amp; w &lt; c-&gt;minw)
</a><a href="#h2-0-263" id="h2-0-263" class="d">-			w = c-&gt;minw;
</a><a href="#h2-0-264" id="h2-0-264" class="d">-		if(c-&gt;minh &amp;&amp; h &lt; c-&gt;minh)
</a><a href="#h2-0-265" id="h2-0-265" class="d">-			h = c-&gt;minh;
</a><a href="#h2-0-266" id="h2-0-266" class="d">-		if(c-&gt;maxw &amp;&amp; w &gt; c-&gt;maxw)
</a><a href="#h2-0-267" id="h2-0-267" class="d">-			w = c-&gt;maxw;
</a><a href="#h2-0-268" id="h2-0-268" class="d">-		if(c-&gt;maxh &amp;&amp; h &gt; c-&gt;maxh)
</a><a href="#h2-0-269" id="h2-0-269" class="d">-			h = c-&gt;maxh;
</a><a href="#h2-0-270" id="h2-0-270" class="d">-		if(c-&gt;incw)
</a><a href="#h2-0-271" id="h2-0-271" class="d">-			w -= (w - c-&gt;basew) % c-&gt;incw;
</a><a href="#h2-0-272" id="h2-0-272" class="d">-		if(c-&gt;inch)
</a><a href="#h2-0-273" id="h2-0-273" class="d">-			h -= (h - c-&gt;baseh) % c-&gt;inch;
</a><a href="#h2-0-274" id="h2-0-274" class="d">-	}
</a><a href="#h2-0-275" id="h2-0-275" class="d">-	if(w &lt;= 0 || h &lt;= 0)
</a><a href="#h2-0-276" id="h2-0-276" class="d">-		return;
</a><a href="#h2-0-277" id="h2-0-277" class="d">-	/* offscreen appearance fixes */
</a><a href="#h2-0-278" id="h2-0-278" class="d">-	if(x &gt; sw)
</a><a href="#h2-0-279" id="h2-0-279" class="d">-		x = sw - w - 2 * c-&gt;border;
</a><a href="#h2-0-280" id="h2-0-280" class="d">-	if(y &gt; sh)
</a><a href="#h2-0-281" id="h2-0-281" class="d">-		y = sh - h - 2 * c-&gt;border;
</a><a href="#h2-0-282" id="h2-0-282" class="d">-	if(x + w + 2 * c-&gt;border &lt; sx)
</a><a href="#h2-0-283" id="h2-0-283" class="d">-		x = sx;
</a><a href="#h2-0-284" id="h2-0-284" class="d">-	if(y + h + 2 * c-&gt;border &lt; sy)
</a><a href="#h2-0-285" id="h2-0-285" class="d">-		y = sy;
</a><a href="#h2-0-286" id="h2-0-286" class="d">-	if(c-&gt;x != x || c-&gt;y != y || c-&gt;w != w || c-&gt;h != h) {
</a><a href="#h2-0-287" id="h2-0-287" class="d">-		c-&gt;x = wc.x = x;
</a><a href="#h2-0-288" id="h2-0-288" class="d">-		c-&gt;y = wc.y = y;
</a><a href="#h2-0-289" id="h2-0-289" class="d">-		c-&gt;w = wc.width = w;
</a><a href="#h2-0-290" id="h2-0-290" class="d">-		c-&gt;h = wc.height = h;
</a><a href="#h2-0-291" id="h2-0-291" class="d">-		wc.border_width = c-&gt;border;
</a><a href="#h2-0-292" id="h2-0-292" class="d">-		XConfigureWindow(dpy, c-&gt;win, CWX | CWY | CWWidth | CWHeight | CWBorderWidth, &amp;wc);
</a><a href="#h2-0-293" id="h2-0-293" class="d">-		configure(c);
</a><a href="#h2-0-294" id="h2-0-294" class="d">-		XSync(dpy, False);
</a><a href="#h2-0-295" id="h2-0-295" class="d">-	}
</a><a href="#h2-0-296" id="h2-0-296" class="d">-}
</a><a href="#h2-0-297" id="h2-0-297" class="d">-
</a><a href="#h2-0-298" id="h2-0-298" class="d">-void
</a><a href="#h2-0-299" id="h2-0-299" class="d">-unban(Client *c) {
</a><a href="#h2-0-300" id="h2-0-300" class="d">-	if(!c-&gt;isbanned)
</a><a href="#h2-0-301" id="h2-0-301" class="d">-		return;
</a><a href="#h2-0-302" id="h2-0-302" class="d">-	XMoveWindow(dpy, c-&gt;win, c-&gt;x, c-&gt;y);
</a><a href="#h2-0-303" id="h2-0-303" class="d">-	c-&gt;isbanned = False;
</a><a href="#h2-0-304" id="h2-0-304" class="d">-}
</a><a href="#h2-0-305" id="h2-0-305" class="d">-
</a><a href="#h2-0-306" id="h2-0-306" class="d">-void
</a><a href="#h2-0-307" id="h2-0-307" class="d">-unmanage(Client *c) {
</a><a href="#h2-0-308" id="h2-0-308" class="d">-	XWindowChanges wc;
</a><a href="#h2-0-309" id="h2-0-309" class="d">-
</a><a href="#h2-0-310" id="h2-0-310" class="d">-	wc.border_width = c-&gt;oldborder;
</a><a href="#h2-0-311" id="h2-0-311" class="d">-	/* The server grab construct avoids race conditions. */
</a><a href="#h2-0-312" id="h2-0-312" class="d">-	XGrabServer(dpy);
</a><a href="#h2-0-313" id="h2-0-313" class="d">-	XSetErrorHandler(xerrordummy);
</a><a href="#h2-0-314" id="h2-0-314" class="d">-	XConfigureWindow(dpy, c-&gt;win, CWBorderWidth, &amp;wc); /* restore border */
</a><a href="#h2-0-315" id="h2-0-315" class="d">-	detach(c);
</a><a href="#h2-0-316" id="h2-0-316" class="d">-	detachstack(c);
</a><a href="#h2-0-317" id="h2-0-317" class="d">-	if(sel == c)
</a><a href="#h2-0-318" id="h2-0-318" class="d">-		focus(NULL);
</a><a href="#h2-0-319" id="h2-0-319" class="d">-	XUngrabButton(dpy, AnyButton, AnyModifier, c-&gt;win);
</a><a href="#h2-0-320" id="h2-0-320" class="d">-	setclientstate(c, WithdrawnState);
</a><a href="#h2-0-321" id="h2-0-321" class="d">-	free(c-&gt;tags);
</a><a href="#h2-0-322" id="h2-0-322" class="d">-	free(c);
</a><a href="#h2-0-323" id="h2-0-323" class="d">-	XSync(dpy, False);
</a><a href="#h2-0-324" id="h2-0-324" class="d">-	XSetErrorHandler(xerror);
</a><a href="#h2-0-325" id="h2-0-325" class="d">-	XUngrabServer(dpy);
</a><a href="#h2-0-326" id="h2-0-326" class="d">-	arrange();
</a><a href="#h2-0-327" id="h2-0-327" class="d">-}
</a><a href="#h2-0-328" id="h2-0-328" class="d">-
</a><a href="#h2-0-329" id="h2-0-329" class="d">-void
</a><a href="#h2-0-330" id="h2-0-330" class="d">-updatesizehints(Client *c) {
</a><a href="#h2-0-331" id="h2-0-331" class="d">-	long msize;
</a><a href="#h2-0-332" id="h2-0-332" class="d">-	XSizeHints size;
</a><a href="#h2-0-333" id="h2-0-333" class="d">-
</a><a href="#h2-0-334" id="h2-0-334" class="d">-	if(!XGetWMNormalHints(dpy, c-&gt;win, &amp;size, &amp;msize) || !size.flags)
</a><a href="#h2-0-335" id="h2-0-335" class="d">-		size.flags = PSize;
</a><a href="#h2-0-336" id="h2-0-336" class="d">-	c-&gt;flags = size.flags;
</a><a href="#h2-0-337" id="h2-0-337" class="d">-	if(c-&gt;flags &amp; PBaseSize) {
</a><a href="#h2-0-338" id="h2-0-338" class="d">-		c-&gt;basew = size.base_width;
</a><a href="#h2-0-339" id="h2-0-339" class="d">-		c-&gt;baseh = size.base_height;
</a><a href="#h2-0-340" id="h2-0-340" class="d">-	}
</a><a href="#h2-0-341" id="h2-0-341" class="d">-	else if(c-&gt;flags &amp; PMinSize) {
</a><a href="#h2-0-342" id="h2-0-342" class="d">-		c-&gt;basew = size.min_width;
</a><a href="#h2-0-343" id="h2-0-343" class="d">-		c-&gt;baseh = size.min_height;
</a><a href="#h2-0-344" id="h2-0-344" class="d">-	}
</a><a href="#h2-0-345" id="h2-0-345" class="d">-	else
</a><a href="#h2-0-346" id="h2-0-346" class="d">-		c-&gt;basew = c-&gt;baseh = 0;
</a><a href="#h2-0-347" id="h2-0-347" class="d">-	if(c-&gt;flags &amp; PResizeInc) {
</a><a href="#h2-0-348" id="h2-0-348" class="d">-		c-&gt;incw = size.width_inc;
</a><a href="#h2-0-349" id="h2-0-349" class="d">-		c-&gt;inch = size.height_inc;
</a><a href="#h2-0-350" id="h2-0-350" class="d">-	}
</a><a href="#h2-0-351" id="h2-0-351" class="d">-	else
</a><a href="#h2-0-352" id="h2-0-352" class="d">-		c-&gt;incw = c-&gt;inch = 0;
</a><a href="#h2-0-353" id="h2-0-353" class="d">-	if(c-&gt;flags &amp; PMaxSize) {
</a><a href="#h2-0-354" id="h2-0-354" class="d">-		c-&gt;maxw = size.max_width;
</a><a href="#h2-0-355" id="h2-0-355" class="d">-		c-&gt;maxh = size.max_height;
</a><a href="#h2-0-356" id="h2-0-356" class="d">-	}
</a><a href="#h2-0-357" id="h2-0-357" class="d">-	else
</a><a href="#h2-0-358" id="h2-0-358" class="d">-		c-&gt;maxw = c-&gt;maxh = 0;
</a><a href="#h2-0-359" id="h2-0-359" class="d">-	if(c-&gt;flags &amp; PMinSize) {
</a><a href="#h2-0-360" id="h2-0-360" class="d">-		c-&gt;minw = size.min_width;
</a><a href="#h2-0-361" id="h2-0-361" class="d">-		c-&gt;minh = size.min_height;
</a><a href="#h2-0-362" id="h2-0-362" class="d">-	}
</a><a href="#h2-0-363" id="h2-0-363" class="d">-	else if(c-&gt;flags &amp; PBaseSize) {
</a><a href="#h2-0-364" id="h2-0-364" class="d">-		c-&gt;minw = size.base_width;
</a><a href="#h2-0-365" id="h2-0-365" class="d">-		c-&gt;minh = size.base_height;
</a><a href="#h2-0-366" id="h2-0-366" class="d">-	}
</a><a href="#h2-0-367" id="h2-0-367" class="d">-	else
</a><a href="#h2-0-368" id="h2-0-368" class="d">-		c-&gt;minw = c-&gt;minh = 0;
</a><a href="#h2-0-369" id="h2-0-369" class="d">-	if(c-&gt;flags &amp; PAspect) {
</a><a href="#h2-0-370" id="h2-0-370" class="d">-		c-&gt;minax = size.min_aspect.x;
</a><a href="#h2-0-371" id="h2-0-371" class="d">-		c-&gt;maxax = size.max_aspect.x;
</a><a href="#h2-0-372" id="h2-0-372" class="d">-		c-&gt;minay = size.min_aspect.y;
</a><a href="#h2-0-373" id="h2-0-373" class="d">-		c-&gt;maxay = size.max_aspect.y;
</a><a href="#h2-0-374" id="h2-0-374" class="d">-	}
</a><a href="#h2-0-375" id="h2-0-375" class="d">-	else
</a><a href="#h2-0-376" id="h2-0-376" class="d">-		c-&gt;minax = c-&gt;maxax = c-&gt;minay = c-&gt;maxay = 0;
</a><a href="#h2-0-377" id="h2-0-377" class="d">-	c-&gt;isfixed = (c-&gt;maxw &amp;&amp; c-&gt;minw &amp;&amp; c-&gt;maxh &amp;&amp; c-&gt;minh
</a><a href="#h2-0-378" id="h2-0-378" class="d">-			&amp;&amp; c-&gt;maxw == c-&gt;minw &amp;&amp; c-&gt;maxh == c-&gt;minh);
</a><a href="#h2-0-379" id="h2-0-379" class="d">-}
</a><a href="#h2-0-380" id="h2-0-380" class="d">-
</a><a href="#h2-0-381" id="h2-0-381" class="d">-void
</a><a href="#h2-0-382" id="h2-0-382" class="d">-updatetitle(Client *c) {
</a><a href="#h2-0-383" id="h2-0-383" class="d">-	if(!gettextprop(c-&gt;win, netatom[NetWMName], c-&gt;name, sizeof c-&gt;name))
</a><a href="#h2-0-384" id="h2-0-384" class="d">-		gettextprop(c-&gt;win, wmatom[WMName], c-&gt;name, sizeof c-&gt;name);
</a><a href="#h2-0-385" id="h2-0-385" class="d">-}
</a><b>diff --git a/<a id="h3" href="../file/config.h.html">config.h</a> b/<a href="../file/config.h.html">config.h</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -12,24 +12,20 @@
</a> #define SELFGCOLOR		&quot;#fff&quot;
 
 /* tagging */
<a href="#h3-0-3" id="h3-0-3" class="d">-#define TAGS \
</a><a href="#h3-0-4" id="h3-0-4" class="d">-const char *tags[] = { &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, NULL };
</a><a href="#h3-0-5" id="h3-0-5" class="d">-#define RULES \
</a><a href="#h3-0-6" id="h3-0-6" class="d">-static Rule rules[] = { \
</a><a href="#h3-0-7" id="h3-0-7" class="d">-	/* class:instance:title regex	tags regex	isfloating */ \
</a><a href="#h3-0-8" id="h3-0-8" class="d">-	{ &quot;Firefox&quot;,			&quot;3&quot;,		False }, \
</a><a href="#h3-0-9" id="h3-0-9" class="d">-	{ &quot;Gimp&quot;,			NULL,		True }, \
</a><a href="#h3-0-10" id="h3-0-10" class="d">-	{ &quot;MPlayer&quot;,			NULL,		True }, \
</a><a href="#h3-0-11" id="h3-0-11" class="d">-	{ &quot;Acroread&quot;,			NULL,		True }, \
</a><a href="#h3-0-12" id="h3-0-12" class="i">+static const char *tags[] = { &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, NULL };
</a><a href="#h3-0-13" id="h3-0-13" class="i">+static Rule rules[] = {
</a><a href="#h3-0-14" id="h3-0-14" class="i">+	/* class:instance:title regex	tags regex	isfloating */
</a><a href="#h3-0-15" id="h3-0-15" class="i">+	{ &quot;Firefox&quot;,			&quot;3&quot;,		False },
</a><a href="#h3-0-16" id="h3-0-16" class="i">+	{ &quot;Gimp&quot;,			NULL,		True },
</a><a href="#h3-0-17" id="h3-0-17" class="i">+	{ &quot;MPlayer&quot;,			NULL,		True },
</a><a href="#h3-0-18" id="h3-0-18" class="i">+	{ &quot;Acroread&quot;,			NULL,		True },
</a> };
 
 /* layout(s) */
<a href="#h3-0-22" id="h3-0-22" class="d">-#include &quot;tile.h&quot;
</a><a href="#h3-0-23" id="h3-0-23" class="d">-#define LAYOUTS \
</a><a href="#h3-0-24" id="h3-0-24" class="d">-static Layout layouts[] = { \
</a><a href="#h3-0-25" id="h3-0-25" class="d">-	/* symbol		function */ \
</a><a href="#h3-0-26" id="h3-0-26" class="d">-	{ &quot;[]=&quot;,		tile }, /* first entry is default */ \
</a><a href="#h3-0-27" id="h3-0-27" class="d">-	{ &quot;&gt;&lt;&gt;&quot;,		floating }, \
</a><a href="#h3-0-28" id="h3-0-28" class="i">+static Layout layouts[] = {
</a><a href="#h3-0-29" id="h3-0-29" class="i">+	/* symbol		function */
</a><a href="#h3-0-30" id="h3-0-30" class="i">+	{ &quot;[]=&quot;,		tile }, /* first entry is default */
</a><a href="#h3-0-31" id="h3-0-31" class="i">+	{ &quot;&gt;&lt;&gt;&quot;,		floating },
</a> };
 #define RESIZEHINTS		True	/* False - respect size hints in tiled resizals */
 #define MWFACT			0.6	/* master width factor [0.1 .. 0.9] */
<b>diff --git a/<a id="h4" href="../file/config.mk.html">config.mk</a> b/<a href="../file/config.mk.html">config.mk</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -3,9 +3,6 @@ VERSION = 4.5
</a> 
 # Customize below to fit your system
 
<a href="#h4-0-3" id="h4-0-3" class="d">-# additional layouts beside floating
</a><a href="#h4-0-4" id="h4-0-4" class="d">-SRC = tile.c
</a><a href="#h4-0-5" id="h4-0-5" class="d">-
</a> # paths
 PREFIX = /usr/local
 MANPREFIX = ${PREFIX}/share/man
<b>diff --git a/<a id="h5" href="../file/dwm.c.html">dwm.c</a> b/<a href="../file/dwm.c.html">dwm.c</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -0,0 +1,1847 @@
</a><a href="#h5-0-0" id="h5-0-0" class="i">+/* See LICENSE file for copyright and license details. */
</a><a href="#h5-0-1" id="h5-0-1" class="i">+#include &lt;errno.h&gt;
</a><a href="#h5-0-2" id="h5-0-2" class="i">+#include &lt;locale.h&gt;
</a><a href="#h5-0-3" id="h5-0-3" class="i">+#include &lt;regex.h&gt;
</a><a href="#h5-0-4" id="h5-0-4" class="i">+#include &lt;stdarg.h&gt;
</a><a href="#h5-0-5" id="h5-0-5" class="i">+#include &lt;stdio.h&gt;
</a><a href="#h5-0-6" id="h5-0-6" class="i">+#include &lt;stdlib.h&gt;
</a><a href="#h5-0-7" id="h5-0-7" class="i">+#include &lt;string.h&gt;
</a><a href="#h5-0-8" id="h5-0-8" class="i">+#include &lt;unistd.h&gt;
</a><a href="#h5-0-9" id="h5-0-9" class="i">+#include &lt;sys/select.h&gt;
</a><a href="#h5-0-10" id="h5-0-10" class="i">+#include &lt;sys/wait.h&gt;
</a><a href="#h5-0-11" id="h5-0-11" class="i">+#include &lt;X11/cursorfont.h&gt;
</a><a href="#h5-0-12" id="h5-0-12" class="i">+#include &lt;X11/keysym.h&gt;
</a><a href="#h5-0-13" id="h5-0-13" class="i">+#include &lt;X11/Xatom.h&gt;
</a><a href="#h5-0-14" id="h5-0-14" class="i">+#include &lt;X11/Xproto.h&gt;
</a><a href="#h5-0-15" id="h5-0-15" class="i">+#include &lt;X11/Xutil.h&gt;
</a><a href="#h5-0-16" id="h5-0-16" class="i">+
</a><a href="#h5-0-17" id="h5-0-17" class="i">+/* macros */
</a><a href="#h5-0-18" id="h5-0-18" class="i">+#define BUTTONMASK		(ButtonPressMask | ButtonReleaseMask)
</a><a href="#h5-0-19" id="h5-0-19" class="i">+#define CLEANMASK(mask)		(mask &amp; ~(numlockmask | LockMask))
</a><a href="#h5-0-20" id="h5-0-20" class="i">+#define MOUSEMASK		(BUTTONMASK | PointerMotionMask)
</a><a href="#h5-0-21" id="h5-0-21" class="i">+
</a><a href="#h5-0-22" id="h5-0-22" class="i">+/* enums */
</a><a href="#h5-0-23" id="h5-0-23" class="i">+enum { BarTop, BarBot, BarOff };			/* bar position */
</a><a href="#h5-0-24" id="h5-0-24" class="i">+enum { CurNormal, CurResize, CurMove, CurLast };	/* cursor */
</a><a href="#h5-0-25" id="h5-0-25" class="i">+enum { ColBorder, ColFG, ColBG, ColLast };		/* color */
</a><a href="#h5-0-26" id="h5-0-26" class="i">+enum { NetSupported, NetWMName, NetLast };		/* EWMH atoms */
</a><a href="#h5-0-27" id="h5-0-27" class="i">+enum { WMProtocols, WMDelete, WMName, WMState, WMLast };/* default atoms */
</a><a href="#h5-0-28" id="h5-0-28" class="i">+
</a><a href="#h5-0-29" id="h5-0-29" class="i">+/* typedefs */
</a><a href="#h5-0-30" id="h5-0-30" class="i">+typedef struct Client Client;
</a><a href="#h5-0-31" id="h5-0-31" class="i">+struct Client {
</a><a href="#h5-0-32" id="h5-0-32" class="i">+	char name[256];
</a><a href="#h5-0-33" id="h5-0-33" class="i">+	int x, y, w, h;
</a><a href="#h5-0-34" id="h5-0-34" class="i">+	int rx, ry, rw, rh; /* revert geometry */
</a><a href="#h5-0-35" id="h5-0-35" class="i">+	int basew, baseh, incw, inch, maxw, maxh, minw, minh;
</a><a href="#h5-0-36" id="h5-0-36" class="i">+	int minax, maxax, minay, maxay;
</a><a href="#h5-0-37" id="h5-0-37" class="i">+	long flags; 
</a><a href="#h5-0-38" id="h5-0-38" class="i">+	unsigned int border, oldborder;
</a><a href="#h5-0-39" id="h5-0-39" class="i">+	Bool isbanned, isfixed, ismax, isfloating;
</a><a href="#h5-0-40" id="h5-0-40" class="i">+	Bool *tags;
</a><a href="#h5-0-41" id="h5-0-41" class="i">+	Client *next;
</a><a href="#h5-0-42" id="h5-0-42" class="i">+	Client *prev;
</a><a href="#h5-0-43" id="h5-0-43" class="i">+	Client *snext;
</a><a href="#h5-0-44" id="h5-0-44" class="i">+	Window win;
</a><a href="#h5-0-45" id="h5-0-45" class="i">+};
</a><a href="#h5-0-46" id="h5-0-46" class="i">+
</a><a href="#h5-0-47" id="h5-0-47" class="i">+typedef struct {
</a><a href="#h5-0-48" id="h5-0-48" class="i">+	int x, y, w, h;
</a><a href="#h5-0-49" id="h5-0-49" class="i">+	unsigned long norm[ColLast];
</a><a href="#h5-0-50" id="h5-0-50" class="i">+	unsigned long sel[ColLast];
</a><a href="#h5-0-51" id="h5-0-51" class="i">+	Drawable drawable;
</a><a href="#h5-0-52" id="h5-0-52" class="i">+	GC gc;
</a><a href="#h5-0-53" id="h5-0-53" class="i">+	struct {
</a><a href="#h5-0-54" id="h5-0-54" class="i">+		int ascent;
</a><a href="#h5-0-55" id="h5-0-55" class="i">+		int descent;
</a><a href="#h5-0-56" id="h5-0-56" class="i">+		int height;
</a><a href="#h5-0-57" id="h5-0-57" class="i">+		XFontSet set;
</a><a href="#h5-0-58" id="h5-0-58" class="i">+		XFontStruct *xfont;
</a><a href="#h5-0-59" id="h5-0-59" class="i">+	} font;
</a><a href="#h5-0-60" id="h5-0-60" class="i">+} DC; /* draw context */
</a><a href="#h5-0-61" id="h5-0-61" class="i">+
</a><a href="#h5-0-62" id="h5-0-62" class="i">+typedef struct {
</a><a href="#h5-0-63" id="h5-0-63" class="i">+	unsigned long mod;
</a><a href="#h5-0-64" id="h5-0-64" class="i">+	KeySym keysym;
</a><a href="#h5-0-65" id="h5-0-65" class="i">+	void (*func)(const char *arg);
</a><a href="#h5-0-66" id="h5-0-66" class="i">+	const char *arg;
</a><a href="#h5-0-67" id="h5-0-67" class="i">+} Key;
</a><a href="#h5-0-68" id="h5-0-68" class="i">+
</a><a href="#h5-0-69" id="h5-0-69" class="i">+typedef struct {
</a><a href="#h5-0-70" id="h5-0-70" class="i">+	const char *symbol;
</a><a href="#h5-0-71" id="h5-0-71" class="i">+	void (*arrange)(void);
</a><a href="#h5-0-72" id="h5-0-72" class="i">+} Layout;
</a><a href="#h5-0-73" id="h5-0-73" class="i">+
</a><a href="#h5-0-74" id="h5-0-74" class="i">+typedef struct {
</a><a href="#h5-0-75" id="h5-0-75" class="i">+	const char *prop;
</a><a href="#h5-0-76" id="h5-0-76" class="i">+	const char *tags;
</a><a href="#h5-0-77" id="h5-0-77" class="i">+	Bool isfloating;
</a><a href="#h5-0-78" id="h5-0-78" class="i">+} Rule;
</a><a href="#h5-0-79" id="h5-0-79" class="i">+
</a><a href="#h5-0-80" id="h5-0-80" class="i">+typedef struct {
</a><a href="#h5-0-81" id="h5-0-81" class="i">+	regex_t *propregex;
</a><a href="#h5-0-82" id="h5-0-82" class="i">+	regex_t *tagregex;
</a><a href="#h5-0-83" id="h5-0-83" class="i">+} Regs;
</a><a href="#h5-0-84" id="h5-0-84" class="i">+
</a><a href="#h5-0-85" id="h5-0-85" class="i">+/* functions */
</a><a href="#h5-0-86" id="h5-0-86" class="i">+static void eprint(const char *errstr, ...);
</a><a href="#h5-0-87" id="h5-0-87" class="i">+static void *emallocz(unsigned int size);
</a><a href="#h5-0-88" id="h5-0-88" class="i">+static void spawn(const char *arg);
</a><a href="#h5-0-89" id="h5-0-89" class="i">+static void drawsquare(Bool filled, Bool empty, unsigned long col[ColLast]);
</a><a href="#h5-0-90" id="h5-0-90" class="i">+static unsigned long initcolor(const char *colstr);
</a><a href="#h5-0-91" id="h5-0-91" class="i">+static void initfont(const char *fontstr);
</a><a href="#h5-0-92" id="h5-0-92" class="i">+static Bool isoccupied(unsigned int t);
</a><a href="#h5-0-93" id="h5-0-93" class="i">+static unsigned int textnw(const char *text, unsigned int len);
</a><a href="#h5-0-94" id="h5-0-94" class="i">+static void drawtext(const char *text, unsigned long col[ColLast]);
</a><a href="#h5-0-95" id="h5-0-95" class="i">+static void drawbar(void);
</a><a href="#h5-0-96" id="h5-0-96" class="i">+static void initstyle(void);
</a><a href="#h5-0-97" id="h5-0-97" class="i">+static void initbar(void);
</a><a href="#h5-0-98" id="h5-0-98" class="i">+static unsigned int textw(const char *text);
</a><a href="#h5-0-99" id="h5-0-99" class="i">+static void togglebar(const char *arg);
</a><a href="#h5-0-100" id="h5-0-100" class="i">+static void updatebarpos(void);
</a><a href="#h5-0-101" id="h5-0-101" class="i">+static void attachstack(Client *c);
</a><a href="#h5-0-102" id="h5-0-102" class="i">+static void detachstack(Client *c);
</a><a href="#h5-0-103" id="h5-0-103" class="i">+static void grabbuttons(Client *c, Bool focused);
</a><a href="#h5-0-104" id="h5-0-104" class="i">+static Bool isprotodel(Client *c);
</a><a href="#h5-0-105" id="h5-0-105" class="i">+static void setclientstate(Client *c, long state);
</a><a href="#h5-0-106" id="h5-0-106" class="i">+static int xerrordummy(Display *dsply, XErrorEvent *ee);
</a><a href="#h5-0-107" id="h5-0-107" class="i">+static void ban(Client *c);
</a><a href="#h5-0-108" id="h5-0-108" class="i">+static void configure(Client *c);
</a><a href="#h5-0-109" id="h5-0-109" class="i">+static void killclient(const char *arg);
</a><a href="#h5-0-110" id="h5-0-110" class="i">+static void manage(Window w, XWindowAttributes *wa);
</a><a href="#h5-0-111" id="h5-0-111" class="i">+static void resize(Client *c, int x, int y, int w, int h, Bool sizehints);
</a><a href="#h5-0-112" id="h5-0-112" class="i">+static void unban(Client *c);
</a><a href="#h5-0-113" id="h5-0-113" class="i">+static void unmanage(Client *c);
</a><a href="#h5-0-114" id="h5-0-114" class="i">+static void updatesizehints(Client *c);
</a><a href="#h5-0-115" id="h5-0-115" class="i">+static void updatetitle(Client *c);
</a><a href="#h5-0-116" id="h5-0-116" class="i">+static Client *getclient(Window w);
</a><a href="#h5-0-117" id="h5-0-117" class="i">+static void movemouse(Client *c);
</a><a href="#h5-0-118" id="h5-0-118" class="i">+static void resizemouse(Client *c);
</a><a href="#h5-0-119" id="h5-0-119" class="i">+static void buttonpress(XEvent *e);
</a><a href="#h5-0-120" id="h5-0-120" class="i">+static void configurerequest(XEvent *e);
</a><a href="#h5-0-121" id="h5-0-121" class="i">+static void configurenotify(XEvent *e);
</a><a href="#h5-0-122" id="h5-0-122" class="i">+static void destroynotify(XEvent *e);
</a><a href="#h5-0-123" id="h5-0-123" class="i">+static void enternotify(XEvent *e);
</a><a href="#h5-0-124" id="h5-0-124" class="i">+static void expose(XEvent *e);
</a><a href="#h5-0-125" id="h5-0-125" class="i">+static void keypress(XEvent *e);
</a><a href="#h5-0-126" id="h5-0-126" class="i">+static void leavenotify(XEvent *e);
</a><a href="#h5-0-127" id="h5-0-127" class="i">+static void mappingnotify(XEvent *e);
</a><a href="#h5-0-128" id="h5-0-128" class="i">+static void maprequest(XEvent *e);
</a><a href="#h5-0-129" id="h5-0-129" class="i">+static void propertynotify(XEvent *e);
</a><a href="#h5-0-130" id="h5-0-130" class="i">+static void unmapnotify(XEvent *e);
</a><a href="#h5-0-131" id="h5-0-131" class="i">+static void grabkeys(void);
</a><a href="#h5-0-132" id="h5-0-132" class="i">+static unsigned int idxoftag(const char *tag);
</a><a href="#h5-0-133" id="h5-0-133" class="i">+static void floating(void); /* default floating layout */
</a><a href="#h5-0-134" id="h5-0-134" class="i">+static void applyrules(Client *c);
</a><a href="#h5-0-135" id="h5-0-135" class="i">+static void compileregs(void);
</a><a href="#h5-0-136" id="h5-0-136" class="i">+static void focusnext(const char *arg);
</a><a href="#h5-0-137" id="h5-0-137" class="i">+static void focusprev(const char *arg);
</a><a href="#h5-0-138" id="h5-0-138" class="i">+static void initlayouts(void);
</a><a href="#h5-0-139" id="h5-0-139" class="i">+static Bool isfloating(void);
</a><a href="#h5-0-140" id="h5-0-140" class="i">+static Bool isvisible(Client *c);
</a><a href="#h5-0-141" id="h5-0-141" class="i">+static void restack(void);
</a><a href="#h5-0-142" id="h5-0-142" class="i">+static void setlayout(const char *arg);
</a><a href="#h5-0-143" id="h5-0-143" class="i">+static void tag(const char *arg);
</a><a href="#h5-0-144" id="h5-0-144" class="i">+static void togglefloating(const char *arg);
</a><a href="#h5-0-145" id="h5-0-145" class="i">+static void togglemax(const char *arg);
</a><a href="#h5-0-146" id="h5-0-146" class="i">+static void toggletag(const char *arg);
</a><a href="#h5-0-147" id="h5-0-147" class="i">+static void toggleview(const char *arg);
</a><a href="#h5-0-148" id="h5-0-148" class="i">+static void view(const char *arg);
</a><a href="#h5-0-149" id="h5-0-149" class="i">+static void cleanup(void);
</a><a href="#h5-0-150" id="h5-0-150" class="i">+static long getstate(Window w);
</a><a href="#h5-0-151" id="h5-0-151" class="i">+static void scan(void);
</a><a href="#h5-0-152" id="h5-0-152" class="i">+static void setup(void);
</a><a href="#h5-0-153" id="h5-0-153" class="i">+static int xerrorstart(Display *dsply, XErrorEvent *ee);
</a><a href="#h5-0-154" id="h5-0-154" class="i">+static Bool gettextprop(Window w, Atom atom, char *text, unsigned int size);
</a><a href="#h5-0-155" id="h5-0-155" class="i">+static void quit(const char *arg);
</a><a href="#h5-0-156" id="h5-0-156" class="i">+static int xerror(Display *dpy, XErrorEvent *ee);
</a><a href="#h5-0-157" id="h5-0-157" class="i">+static void arrange(void);
</a><a href="#h5-0-158" id="h5-0-158" class="i">+static void attach(Client *c);
</a><a href="#h5-0-159" id="h5-0-159" class="i">+static void detach(Client *c);
</a><a href="#h5-0-160" id="h5-0-160" class="i">+static void focus(Client *c);
</a><a href="#h5-0-161" id="h5-0-161" class="i">+static Bool isarrange(void (*func)());
</a><a href="#h5-0-162" id="h5-0-162" class="i">+static Client *nexttiled(Client *c);
</a><a href="#h5-0-163" id="h5-0-163" class="i">+static void setmwfact(const char *arg);
</a><a href="#h5-0-164" id="h5-0-164" class="i">+static void tile(void);
</a><a href="#h5-0-165" id="h5-0-165" class="i">+static void zoom(const char *arg);
</a><a href="#h5-0-166" id="h5-0-166" class="i">+
</a><a href="#h5-0-167" id="h5-0-167" class="i">+#include &quot;config.h&quot;
</a><a href="#h5-0-168" id="h5-0-168" class="i">+
</a><a href="#h5-0-169" id="h5-0-169" class="i">+/* variables */
</a><a href="#h5-0-170" id="h5-0-170" class="i">+static char stext[256];
</a><a href="#h5-0-171" id="h5-0-171" class="i">+static double mwfact = MWFACT;
</a><a href="#h5-0-172" id="h5-0-172" class="i">+static int screen, sx, sy, sw, sh, wax, way, waw, wah;
</a><a href="#h5-0-173" id="h5-0-173" class="i">+static int (*xerrorxlib)(Display *, XErrorEvent *);
</a><a href="#h5-0-174" id="h5-0-174" class="i">+static unsigned int bh;
</a><a href="#h5-0-175" id="h5-0-175" class="i">+static unsigned int blw = 0;
</a><a href="#h5-0-176" id="h5-0-176" class="i">+static unsigned int bpos = BARPOS;
</a><a href="#h5-0-177" id="h5-0-177" class="i">+static unsigned int ltidx = 0; /* default */
</a><a href="#h5-0-178" id="h5-0-178" class="i">+static unsigned int nlayouts = 0;
</a><a href="#h5-0-179" id="h5-0-179" class="i">+static unsigned int nrules = 0;
</a><a href="#h5-0-180" id="h5-0-180" class="i">+static unsigned int ntags;
</a><a href="#h5-0-181" id="h5-0-181" class="i">+static unsigned int numlockmask = 0;
</a><a href="#h5-0-182" id="h5-0-182" class="i">+static void (*handler[LASTEvent]) (XEvent *) = {
</a><a href="#h5-0-183" id="h5-0-183" class="i">+	[ButtonPress] = buttonpress,
</a><a href="#h5-0-184" id="h5-0-184" class="i">+	[ConfigureRequest] = configurerequest,
</a><a href="#h5-0-185" id="h5-0-185" class="i">+	[ConfigureNotify] = configurenotify,
</a><a href="#h5-0-186" id="h5-0-186" class="i">+	[DestroyNotify] = destroynotify,
</a><a href="#h5-0-187" id="h5-0-187" class="i">+	[EnterNotify] = enternotify,
</a><a href="#h5-0-188" id="h5-0-188" class="i">+	[LeaveNotify] = leavenotify,
</a><a href="#h5-0-189" id="h5-0-189" class="i">+	[Expose] = expose,
</a><a href="#h5-0-190" id="h5-0-190" class="i">+	[KeyPress] = keypress,
</a><a href="#h5-0-191" id="h5-0-191" class="i">+	[MappingNotify] = mappingnotify,
</a><a href="#h5-0-192" id="h5-0-192" class="i">+	[MapRequest] = maprequest,
</a><a href="#h5-0-193" id="h5-0-193" class="i">+	[PropertyNotify] = propertynotify,
</a><a href="#h5-0-194" id="h5-0-194" class="i">+	[UnmapNotify] = unmapnotify
</a><a href="#h5-0-195" id="h5-0-195" class="i">+};
</a><a href="#h5-0-196" id="h5-0-196" class="i">+static Atom wmatom[WMLast], netatom[NetLast];
</a><a href="#h5-0-197" id="h5-0-197" class="i">+static Bool otherwm, readin;
</a><a href="#h5-0-198" id="h5-0-198" class="i">+static Bool running = True;
</a><a href="#h5-0-199" id="h5-0-199" class="i">+static Bool *seltags;
</a><a href="#h5-0-200" id="h5-0-200" class="i">+static Bool selscreen = True;
</a><a href="#h5-0-201" id="h5-0-201" class="i">+static Client *clients = NULL;
</a><a href="#h5-0-202" id="h5-0-202" class="i">+static Client *sel = NULL;
</a><a href="#h5-0-203" id="h5-0-203" class="i">+static Client *stack = NULL;
</a><a href="#h5-0-204" id="h5-0-204" class="i">+static Cursor cursor[CurLast];
</a><a href="#h5-0-205" id="h5-0-205" class="i">+static Display *dpy;
</a><a href="#h5-0-206" id="h5-0-206" class="i">+static DC dc = {0};
</a><a href="#h5-0-207" id="h5-0-207" class="i">+static Window barwin, root;
</a><a href="#h5-0-208" id="h5-0-208" class="i">+static Regs *regs = NULL;
</a><a href="#h5-0-209" id="h5-0-209" class="i">+
</a><a href="#h5-0-210" id="h5-0-210" class="i">+static void
</a><a href="#h5-0-211" id="h5-0-211" class="i">+eprint(const char *errstr, ...) {
</a><a href="#h5-0-212" id="h5-0-212" class="i">+	va_list ap;
</a><a href="#h5-0-213" id="h5-0-213" class="i">+
</a><a href="#h5-0-214" id="h5-0-214" class="i">+	va_start(ap, errstr);
</a><a href="#h5-0-215" id="h5-0-215" class="i">+	vfprintf(stderr, errstr, ap);
</a><a href="#h5-0-216" id="h5-0-216" class="i">+	va_end(ap);
</a><a href="#h5-0-217" id="h5-0-217" class="i">+	exit(EXIT_FAILURE);
</a><a href="#h5-0-218" id="h5-0-218" class="i">+}
</a><a href="#h5-0-219" id="h5-0-219" class="i">+
</a><a href="#h5-0-220" id="h5-0-220" class="i">+static void *
</a><a href="#h5-0-221" id="h5-0-221" class="i">+emallocz(unsigned int size) {
</a><a href="#h5-0-222" id="h5-0-222" class="i">+	void *res = calloc(1, size);
</a><a href="#h5-0-223" id="h5-0-223" class="i">+
</a><a href="#h5-0-224" id="h5-0-224" class="i">+	if(!res)
</a><a href="#h5-0-225" id="h5-0-225" class="i">+		eprint(&quot;fatal: could not malloc() %u bytes\n&quot;, size);
</a><a href="#h5-0-226" id="h5-0-226" class="i">+	return res;
</a><a href="#h5-0-227" id="h5-0-227" class="i">+}
</a><a href="#h5-0-228" id="h5-0-228" class="i">+
</a><a href="#h5-0-229" id="h5-0-229" class="i">+static void
</a><a href="#h5-0-230" id="h5-0-230" class="i">+spawn(const char *arg) {
</a><a href="#h5-0-231" id="h5-0-231" class="i">+	static char *shell = NULL;
</a><a href="#h5-0-232" id="h5-0-232" class="i">+
</a><a href="#h5-0-233" id="h5-0-233" class="i">+	if(!shell &amp;&amp; !(shell = getenv(&quot;SHELL&quot;)))
</a><a href="#h5-0-234" id="h5-0-234" class="i">+		shell = &quot;/bin/sh&quot;;
</a><a href="#h5-0-235" id="h5-0-235" class="i">+	if(!arg)
</a><a href="#h5-0-236" id="h5-0-236" class="i">+		return;
</a><a href="#h5-0-237" id="h5-0-237" class="i">+	/* The double-fork construct avoids zombie processes and keeps the code
</a><a href="#h5-0-238" id="h5-0-238" class="i">+	 * clean from stupid signal handlers. */
</a><a href="#h5-0-239" id="h5-0-239" class="i">+	if(fork() == 0) {
</a><a href="#h5-0-240" id="h5-0-240" class="i">+		if(fork() == 0) {
</a><a href="#h5-0-241" id="h5-0-241" class="i">+			if(dpy)
</a><a href="#h5-0-242" id="h5-0-242" class="i">+				close(ConnectionNumber(dpy));
</a><a href="#h5-0-243" id="h5-0-243" class="i">+			setsid();
</a><a href="#h5-0-244" id="h5-0-244" class="i">+			execl(shell, shell, &quot;-c&quot;, arg, (char *)NULL);
</a><a href="#h5-0-245" id="h5-0-245" class="i">+			fprintf(stderr, &quot;dwm: execl &#39;%s -c %s&#39;&quot;, shell, arg);
</a><a href="#h5-0-246" id="h5-0-246" class="i">+			perror(&quot; failed&quot;);
</a><a href="#h5-0-247" id="h5-0-247" class="i">+		}
</a><a href="#h5-0-248" id="h5-0-248" class="i">+		exit(0);
</a><a href="#h5-0-249" id="h5-0-249" class="i">+	}
</a><a href="#h5-0-250" id="h5-0-250" class="i">+	wait(0);
</a><a href="#h5-0-251" id="h5-0-251" class="i">+}
</a><a href="#h5-0-252" id="h5-0-252" class="i">+
</a><a href="#h5-0-253" id="h5-0-253" class="i">+static void
</a><a href="#h5-0-254" id="h5-0-254" class="i">+drawsquare(Bool filled, Bool empty, unsigned long col[ColLast]) {
</a><a href="#h5-0-255" id="h5-0-255" class="i">+	int x;
</a><a href="#h5-0-256" id="h5-0-256" class="i">+	XGCValues gcv;
</a><a href="#h5-0-257" id="h5-0-257" class="i">+	XRectangle r = { dc.x, dc.y, dc.w, dc.h };
</a><a href="#h5-0-258" id="h5-0-258" class="i">+
</a><a href="#h5-0-259" id="h5-0-259" class="i">+	gcv.foreground = col[ColFG];
</a><a href="#h5-0-260" id="h5-0-260" class="i">+	XChangeGC(dpy, dc.gc, GCForeground, &amp;gcv);
</a><a href="#h5-0-261" id="h5-0-261" class="i">+	x = (dc.font.ascent + dc.font.descent + 2) / 4;
</a><a href="#h5-0-262" id="h5-0-262" class="i">+	r.x = dc.x + 1;
</a><a href="#h5-0-263" id="h5-0-263" class="i">+	r.y = dc.y + 1;
</a><a href="#h5-0-264" id="h5-0-264" class="i">+	if(filled) {
</a><a href="#h5-0-265" id="h5-0-265" class="i">+		r.width = r.height = x + 1;
</a><a href="#h5-0-266" id="h5-0-266" class="i">+		XFillRectangles(dpy, dc.drawable, dc.gc, &amp;r, 1);
</a><a href="#h5-0-267" id="h5-0-267" class="i">+	}
</a><a href="#h5-0-268" id="h5-0-268" class="i">+	else if(empty) {
</a><a href="#h5-0-269" id="h5-0-269" class="i">+		r.width = r.height = x;
</a><a href="#h5-0-270" id="h5-0-270" class="i">+		XDrawRectangles(dpy, dc.drawable, dc.gc, &amp;r, 1);
</a><a href="#h5-0-271" id="h5-0-271" class="i">+	}
</a><a href="#h5-0-272" id="h5-0-272" class="i">+}
</a><a href="#h5-0-273" id="h5-0-273" class="i">+
</a><a href="#h5-0-274" id="h5-0-274" class="i">+static unsigned long
</a><a href="#h5-0-275" id="h5-0-275" class="i">+initcolor(const char *colstr) {
</a><a href="#h5-0-276" id="h5-0-276" class="i">+	Colormap cmap = DefaultColormap(dpy, screen);
</a><a href="#h5-0-277" id="h5-0-277" class="i">+	XColor color;
</a><a href="#h5-0-278" id="h5-0-278" class="i">+
</a><a href="#h5-0-279" id="h5-0-279" class="i">+	if(!XAllocNamedColor(dpy, cmap, colstr, &amp;color, &amp;color))
</a><a href="#h5-0-280" id="h5-0-280" class="i">+		eprint(&quot;error, cannot allocate color &#39;%s&#39;\n&quot;, colstr);
</a><a href="#h5-0-281" id="h5-0-281" class="i">+	return color.pixel;
</a><a href="#h5-0-282" id="h5-0-282" class="i">+}
</a><a href="#h5-0-283" id="h5-0-283" class="i">+
</a><a href="#h5-0-284" id="h5-0-284" class="i">+static void
</a><a href="#h5-0-285" id="h5-0-285" class="i">+initfont(const char *fontstr) {
</a><a href="#h5-0-286" id="h5-0-286" class="i">+	char *def, **missing;
</a><a href="#h5-0-287" id="h5-0-287" class="i">+	int i, n;
</a><a href="#h5-0-288" id="h5-0-288" class="i">+
</a><a href="#h5-0-289" id="h5-0-289" class="i">+	missing = NULL;
</a><a href="#h5-0-290" id="h5-0-290" class="i">+	if(dc.font.set)
</a><a href="#h5-0-291" id="h5-0-291" class="i">+		XFreeFontSet(dpy, dc.font.set);
</a><a href="#h5-0-292" id="h5-0-292" class="i">+	dc.font.set = XCreateFontSet(dpy, fontstr, &amp;missing, &amp;n, &amp;def);
</a><a href="#h5-0-293" id="h5-0-293" class="i">+	if(missing) {
</a><a href="#h5-0-294" id="h5-0-294" class="i">+		while(n--)
</a><a href="#h5-0-295" id="h5-0-295" class="i">+			fprintf(stderr, &quot;dwm: missing fontset: %s\n&quot;, missing[n]);
</a><a href="#h5-0-296" id="h5-0-296" class="i">+		XFreeStringList(missing);
</a><a href="#h5-0-297" id="h5-0-297" class="i">+	}
</a><a href="#h5-0-298" id="h5-0-298" class="i">+	if(dc.font.set) {
</a><a href="#h5-0-299" id="h5-0-299" class="i">+		XFontSetExtents *font_extents;
</a><a href="#h5-0-300" id="h5-0-300" class="i">+		XFontStruct **xfonts;
</a><a href="#h5-0-301" id="h5-0-301" class="i">+		char **font_names;
</a><a href="#h5-0-302" id="h5-0-302" class="i">+		dc.font.ascent = dc.font.descent = 0;
</a><a href="#h5-0-303" id="h5-0-303" class="i">+		font_extents = XExtentsOfFontSet(dc.font.set);
</a><a href="#h5-0-304" id="h5-0-304" class="i">+		n = XFontsOfFontSet(dc.font.set, &amp;xfonts, &amp;font_names);
</a><a href="#h5-0-305" id="h5-0-305" class="i">+		for(i = 0, dc.font.ascent = 0, dc.font.descent = 0; i &lt; n; i++) {
</a><a href="#h5-0-306" id="h5-0-306" class="i">+			if(dc.font.ascent &lt; (*xfonts)-&gt;ascent)
</a><a href="#h5-0-307" id="h5-0-307" class="i">+				dc.font.ascent = (*xfonts)-&gt;ascent;
</a><a href="#h5-0-308" id="h5-0-308" class="i">+			if(dc.font.descent &lt; (*xfonts)-&gt;descent)
</a><a href="#h5-0-309" id="h5-0-309" class="i">+				dc.font.descent = (*xfonts)-&gt;descent;
</a><a href="#h5-0-310" id="h5-0-310" class="i">+			xfonts++;
</a><a href="#h5-0-311" id="h5-0-311" class="i">+		}
</a><a href="#h5-0-312" id="h5-0-312" class="i">+	}
</a><a href="#h5-0-313" id="h5-0-313" class="i">+	else {
</a><a href="#h5-0-314" id="h5-0-314" class="i">+		if(dc.font.xfont)
</a><a href="#h5-0-315" id="h5-0-315" class="i">+			XFreeFont(dpy, dc.font.xfont);
</a><a href="#h5-0-316" id="h5-0-316" class="i">+		dc.font.xfont = NULL;
</a><a href="#h5-0-317" id="h5-0-317" class="i">+		if(!(dc.font.xfont = XLoadQueryFont(dpy, fontstr))
</a><a href="#h5-0-318" id="h5-0-318" class="i">+		|| !(dc.font.xfont = XLoadQueryFont(dpy, &quot;fixed&quot;)))
</a><a href="#h5-0-319" id="h5-0-319" class="i">+			eprint(&quot;error, cannot load font: &#39;%s&#39;\n&quot;, fontstr);
</a><a href="#h5-0-320" id="h5-0-320" class="i">+		dc.font.ascent = dc.font.xfont-&gt;ascent;
</a><a href="#h5-0-321" id="h5-0-321" class="i">+		dc.font.descent = dc.font.xfont-&gt;descent;
</a><a href="#h5-0-322" id="h5-0-322" class="i">+	}
</a><a href="#h5-0-323" id="h5-0-323" class="i">+	dc.font.height = dc.font.ascent + dc.font.descent;
</a><a href="#h5-0-324" id="h5-0-324" class="i">+}
</a><a href="#h5-0-325" id="h5-0-325" class="i">+
</a><a href="#h5-0-326" id="h5-0-326" class="i">+static Bool
</a><a href="#h5-0-327" id="h5-0-327" class="i">+isoccupied(unsigned int t) {
</a><a href="#h5-0-328" id="h5-0-328" class="i">+	Client *c;
</a><a href="#h5-0-329" id="h5-0-329" class="i">+
</a><a href="#h5-0-330" id="h5-0-330" class="i">+	for(c = clients; c; c = c-&gt;next)
</a><a href="#h5-0-331" id="h5-0-331" class="i">+		if(c-&gt;tags[t])
</a><a href="#h5-0-332" id="h5-0-332" class="i">+			return True;
</a><a href="#h5-0-333" id="h5-0-333" class="i">+	return False;
</a><a href="#h5-0-334" id="h5-0-334" class="i">+}
</a><a href="#h5-0-335" id="h5-0-335" class="i">+
</a><a href="#h5-0-336" id="h5-0-336" class="i">+static unsigned int
</a><a href="#h5-0-337" id="h5-0-337" class="i">+textnw(const char *text, unsigned int len) {
</a><a href="#h5-0-338" id="h5-0-338" class="i">+	XRectangle r;
</a><a href="#h5-0-339" id="h5-0-339" class="i">+
</a><a href="#h5-0-340" id="h5-0-340" class="i">+	if(dc.font.set) {
</a><a href="#h5-0-341" id="h5-0-341" class="i">+		XmbTextExtents(dc.font.set, text, len, NULL, &amp;r);
</a><a href="#h5-0-342" id="h5-0-342" class="i">+		return r.width;
</a><a href="#h5-0-343" id="h5-0-343" class="i">+	}
</a><a href="#h5-0-344" id="h5-0-344" class="i">+	return XTextWidth(dc.font.xfont, text, len);
</a><a href="#h5-0-345" id="h5-0-345" class="i">+}
</a><a href="#h5-0-346" id="h5-0-346" class="i">+
</a><a href="#h5-0-347" id="h5-0-347" class="i">+static void
</a><a href="#h5-0-348" id="h5-0-348" class="i">+drawtext(const char *text, unsigned long col[ColLast]) {
</a><a href="#h5-0-349" id="h5-0-349" class="i">+	int x, y, w, h;
</a><a href="#h5-0-350" id="h5-0-350" class="i">+	static char buf[256];
</a><a href="#h5-0-351" id="h5-0-351" class="i">+	unsigned int len, olen;
</a><a href="#h5-0-352" id="h5-0-352" class="i">+	XRectangle r = { dc.x, dc.y, dc.w, dc.h };
</a><a href="#h5-0-353" id="h5-0-353" class="i">+
</a><a href="#h5-0-354" id="h5-0-354" class="i">+	XSetForeground(dpy, dc.gc, col[ColBG]);
</a><a href="#h5-0-355" id="h5-0-355" class="i">+	XFillRectangles(dpy, dc.drawable, dc.gc, &amp;r, 1);
</a><a href="#h5-0-356" id="h5-0-356" class="i">+	if(!text)
</a><a href="#h5-0-357" id="h5-0-357" class="i">+		return;
</a><a href="#h5-0-358" id="h5-0-358" class="i">+	w = 0;
</a><a href="#h5-0-359" id="h5-0-359" class="i">+	olen = len = strlen(text);
</a><a href="#h5-0-360" id="h5-0-360" class="i">+	if(len &gt;= sizeof buf)
</a><a href="#h5-0-361" id="h5-0-361" class="i">+		len = sizeof buf - 1;
</a><a href="#h5-0-362" id="h5-0-362" class="i">+	memcpy(buf, text, len);
</a><a href="#h5-0-363" id="h5-0-363" class="i">+	buf[len] = 0;
</a><a href="#h5-0-364" id="h5-0-364" class="i">+	h = dc.font.ascent + dc.font.descent;
</a><a href="#h5-0-365" id="h5-0-365" class="i">+	y = dc.y + (dc.h / 2) - (h / 2) + dc.font.ascent;
</a><a href="#h5-0-366" id="h5-0-366" class="i">+	x = dc.x + (h / 2);
</a><a href="#h5-0-367" id="h5-0-367" class="i">+	/* shorten text if necessary */
</a><a href="#h5-0-368" id="h5-0-368" class="i">+	while(len &amp;&amp; (w = textnw(buf, len)) &gt; dc.w - h)
</a><a href="#h5-0-369" id="h5-0-369" class="i">+		buf[--len] = 0;
</a><a href="#h5-0-370" id="h5-0-370" class="i">+	if(len &lt; olen) {
</a><a href="#h5-0-371" id="h5-0-371" class="i">+		if(len &gt; 1)
</a><a href="#h5-0-372" id="h5-0-372" class="i">+			buf[len - 1] = &#39;.&#39;;
</a><a href="#h5-0-373" id="h5-0-373" class="i">+		if(len &gt; 2)
</a><a href="#h5-0-374" id="h5-0-374" class="i">+			buf[len - 2] = &#39;.&#39;;
</a><a href="#h5-0-375" id="h5-0-375" class="i">+		if(len &gt; 3)
</a><a href="#h5-0-376" id="h5-0-376" class="i">+			buf[len - 3] = &#39;.&#39;;
</a><a href="#h5-0-377" id="h5-0-377" class="i">+	}
</a><a href="#h5-0-378" id="h5-0-378" class="i">+	if(w &gt; dc.w)
</a><a href="#h5-0-379" id="h5-0-379" class="i">+		return; /* too long */
</a><a href="#h5-0-380" id="h5-0-380" class="i">+	XSetForeground(dpy, dc.gc, col[ColFG]);
</a><a href="#h5-0-381" id="h5-0-381" class="i">+	if(dc.font.set)
</a><a href="#h5-0-382" id="h5-0-382" class="i">+		XmbDrawString(dpy, dc.drawable, dc.font.set, dc.gc, x, y, buf, len);
</a><a href="#h5-0-383" id="h5-0-383" class="i">+	else
</a><a href="#h5-0-384" id="h5-0-384" class="i">+		XDrawString(dpy, dc.drawable, dc.gc, x, y, buf, len);
</a><a href="#h5-0-385" id="h5-0-385" class="i">+}
</a><a href="#h5-0-386" id="h5-0-386" class="i">+
</a><a href="#h5-0-387" id="h5-0-387" class="i">+static void
</a><a href="#h5-0-388" id="h5-0-388" class="i">+drawbar(void) {
</a><a href="#h5-0-389" id="h5-0-389" class="i">+	int i, x;
</a><a href="#h5-0-390" id="h5-0-390" class="i">+
</a><a href="#h5-0-391" id="h5-0-391" class="i">+	dc.x = dc.y = 0;
</a><a href="#h5-0-392" id="h5-0-392" class="i">+	for(i = 0; i &lt; ntags; i++) {
</a><a href="#h5-0-393" id="h5-0-393" class="i">+		dc.w = textw(tags[i]);
</a><a href="#h5-0-394" id="h5-0-394" class="i">+		if(seltags[i]) {
</a><a href="#h5-0-395" id="h5-0-395" class="i">+			drawtext(tags[i], dc.sel);
</a><a href="#h5-0-396" id="h5-0-396" class="i">+			drawsquare(sel &amp;&amp; sel-&gt;tags[i], isoccupied(i), dc.sel);
</a><a href="#h5-0-397" id="h5-0-397" class="i">+		}
</a><a href="#h5-0-398" id="h5-0-398" class="i">+		else {
</a><a href="#h5-0-399" id="h5-0-399" class="i">+			drawtext(tags[i], dc.norm);
</a><a href="#h5-0-400" id="h5-0-400" class="i">+			drawsquare(sel &amp;&amp; sel-&gt;tags[i], isoccupied(i), dc.norm);
</a><a href="#h5-0-401" id="h5-0-401" class="i">+		}
</a><a href="#h5-0-402" id="h5-0-402" class="i">+		dc.x += dc.w;
</a><a href="#h5-0-403" id="h5-0-403" class="i">+	}
</a><a href="#h5-0-404" id="h5-0-404" class="i">+	dc.w = blw;
</a><a href="#h5-0-405" id="h5-0-405" class="i">+	drawtext(layouts[ltidx].symbol, dc.norm);
</a><a href="#h5-0-406" id="h5-0-406" class="i">+	x = dc.x + dc.w;
</a><a href="#h5-0-407" id="h5-0-407" class="i">+	dc.w = textw(stext);
</a><a href="#h5-0-408" id="h5-0-408" class="i">+	dc.x = sw - dc.w;
</a><a href="#h5-0-409" id="h5-0-409" class="i">+	if(dc.x &lt; x) {
</a><a href="#h5-0-410" id="h5-0-410" class="i">+		dc.x = x;
</a><a href="#h5-0-411" id="h5-0-411" class="i">+		dc.w = sw - x;
</a><a href="#h5-0-412" id="h5-0-412" class="i">+	}
</a><a href="#h5-0-413" id="h5-0-413" class="i">+	drawtext(stext, dc.norm);
</a><a href="#h5-0-414" id="h5-0-414" class="i">+	if((dc.w = dc.x - x) &gt; bh) {
</a><a href="#h5-0-415" id="h5-0-415" class="i">+		dc.x = x;
</a><a href="#h5-0-416" id="h5-0-416" class="i">+		if(sel) {
</a><a href="#h5-0-417" id="h5-0-417" class="i">+			drawtext(sel-&gt;name, dc.sel);
</a><a href="#h5-0-418" id="h5-0-418" class="i">+			drawsquare(sel-&gt;ismax, sel-&gt;isfloating, dc.sel);
</a><a href="#h5-0-419" id="h5-0-419" class="i">+		}
</a><a href="#h5-0-420" id="h5-0-420" class="i">+		else
</a><a href="#h5-0-421" id="h5-0-421" class="i">+			drawtext(NULL, dc.norm);
</a><a href="#h5-0-422" id="h5-0-422" class="i">+	}
</a><a href="#h5-0-423" id="h5-0-423" class="i">+	XCopyArea(dpy, dc.drawable, barwin, dc.gc, 0, 0, sw, bh, 0, 0);
</a><a href="#h5-0-424" id="h5-0-424" class="i">+	XSync(dpy, False);
</a><a href="#h5-0-425" id="h5-0-425" class="i">+}
</a><a href="#h5-0-426" id="h5-0-426" class="i">+
</a><a href="#h5-0-427" id="h5-0-427" class="i">+static void
</a><a href="#h5-0-428" id="h5-0-428" class="i">+initstyle(void) {
</a><a href="#h5-0-429" id="h5-0-429" class="i">+	dc.norm[ColBorder] = initcolor(NORMBORDERCOLOR);
</a><a href="#h5-0-430" id="h5-0-430" class="i">+	dc.norm[ColBG] = initcolor(NORMBGCOLOR);
</a><a href="#h5-0-431" id="h5-0-431" class="i">+	dc.norm[ColFG] = initcolor(NORMFGCOLOR);
</a><a href="#h5-0-432" id="h5-0-432" class="i">+	dc.sel[ColBorder] = initcolor(SELBORDERCOLOR);
</a><a href="#h5-0-433" id="h5-0-433" class="i">+	dc.sel[ColBG] = initcolor(SELBGCOLOR);
</a><a href="#h5-0-434" id="h5-0-434" class="i">+	dc.sel[ColFG] = initcolor(SELFGCOLOR);
</a><a href="#h5-0-435" id="h5-0-435" class="i">+	initfont(FONT);
</a><a href="#h5-0-436" id="h5-0-436" class="i">+	dc.h = bh = dc.font.height + 2;
</a><a href="#h5-0-437" id="h5-0-437" class="i">+}
</a><a href="#h5-0-438" id="h5-0-438" class="i">+
</a><a href="#h5-0-439" id="h5-0-439" class="i">+static void
</a><a href="#h5-0-440" id="h5-0-440" class="i">+initbar(void) {
</a><a href="#h5-0-441" id="h5-0-441" class="i">+	XSetWindowAttributes wa;
</a><a href="#h5-0-442" id="h5-0-442" class="i">+
</a><a href="#h5-0-443" id="h5-0-443" class="i">+	wa.override_redirect = 1;
</a><a href="#h5-0-444" id="h5-0-444" class="i">+	wa.background_pixmap = ParentRelative;
</a><a href="#h5-0-445" id="h5-0-445" class="i">+	wa.event_mask = ButtonPressMask | ExposureMask;
</a><a href="#h5-0-446" id="h5-0-446" class="i">+	barwin = XCreateWindow(dpy, root, sx, sy, sw, bh, 0,
</a><a href="#h5-0-447" id="h5-0-447" class="i">+			DefaultDepth(dpy, screen), CopyFromParent, DefaultVisual(dpy, screen),
</a><a href="#h5-0-448" id="h5-0-448" class="i">+			CWOverrideRedirect | CWBackPixmap | CWEventMask, &amp;wa);
</a><a href="#h5-0-449" id="h5-0-449" class="i">+	XDefineCursor(dpy, barwin, cursor[CurNormal]);
</a><a href="#h5-0-450" id="h5-0-450" class="i">+	updatebarpos();
</a><a href="#h5-0-451" id="h5-0-451" class="i">+	XMapRaised(dpy, barwin);
</a><a href="#h5-0-452" id="h5-0-452" class="i">+	strcpy(stext, &quot;dwm-&quot;VERSION);
</a><a href="#h5-0-453" id="h5-0-453" class="i">+	dc.drawable = XCreatePixmap(dpy, root, sw, bh, DefaultDepth(dpy, screen));
</a><a href="#h5-0-454" id="h5-0-454" class="i">+	dc.gc = XCreateGC(dpy, root, 0, 0);
</a><a href="#h5-0-455" id="h5-0-455" class="i">+	XSetLineAttributes(dpy, dc.gc, 1, LineSolid, CapButt, JoinMiter);
</a><a href="#h5-0-456" id="h5-0-456" class="i">+	if(!dc.font.set)
</a><a href="#h5-0-457" id="h5-0-457" class="i">+		XSetFont(dpy, dc.gc, dc.font.xfont-&gt;fid);
</a><a href="#h5-0-458" id="h5-0-458" class="i">+}
</a><a href="#h5-0-459" id="h5-0-459" class="i">+
</a><a href="#h5-0-460" id="h5-0-460" class="i">+static unsigned int
</a><a href="#h5-0-461" id="h5-0-461" class="i">+textw(const char *text) {
</a><a href="#h5-0-462" id="h5-0-462" class="i">+	return textnw(text, strlen(text)) + dc.font.height;
</a><a href="#h5-0-463" id="h5-0-463" class="i">+}
</a><a href="#h5-0-464" id="h5-0-464" class="i">+
</a><a href="#h5-0-465" id="h5-0-465" class="i">+static void
</a><a href="#h5-0-466" id="h5-0-466" class="i">+togglebar(const char *arg) {
</a><a href="#h5-0-467" id="h5-0-467" class="i">+	if(bpos == BarOff)
</a><a href="#h5-0-468" id="h5-0-468" class="i">+		bpos = (BARPOS == BarOff) ? BarTop : BARPOS;
</a><a href="#h5-0-469" id="h5-0-469" class="i">+	else
</a><a href="#h5-0-470" id="h5-0-470" class="i">+		bpos = BarOff;
</a><a href="#h5-0-471" id="h5-0-471" class="i">+	updatebarpos();
</a><a href="#h5-0-472" id="h5-0-472" class="i">+	arrange();
</a><a href="#h5-0-473" id="h5-0-473" class="i">+}
</a><a href="#h5-0-474" id="h5-0-474" class="i">+
</a><a href="#h5-0-475" id="h5-0-475" class="i">+static void
</a><a href="#h5-0-476" id="h5-0-476" class="i">+updatebarpos(void) {
</a><a href="#h5-0-477" id="h5-0-477" class="i">+	XEvent ev;
</a><a href="#h5-0-478" id="h5-0-478" class="i">+
</a><a href="#h5-0-479" id="h5-0-479" class="i">+	wax = sx;
</a><a href="#h5-0-480" id="h5-0-480" class="i">+	way = sy;
</a><a href="#h5-0-481" id="h5-0-481" class="i">+	wah = sh;
</a><a href="#h5-0-482" id="h5-0-482" class="i">+	waw = sw;
</a><a href="#h5-0-483" id="h5-0-483" class="i">+	switch(bpos) {
</a><a href="#h5-0-484" id="h5-0-484" class="i">+	default:
</a><a href="#h5-0-485" id="h5-0-485" class="i">+		wah -= bh;
</a><a href="#h5-0-486" id="h5-0-486" class="i">+		way += bh;
</a><a href="#h5-0-487" id="h5-0-487" class="i">+		XMoveWindow(dpy, barwin, sx, sy);
</a><a href="#h5-0-488" id="h5-0-488" class="i">+		break;
</a><a href="#h5-0-489" id="h5-0-489" class="i">+	case BarBot:
</a><a href="#h5-0-490" id="h5-0-490" class="i">+		wah -= bh;
</a><a href="#h5-0-491" id="h5-0-491" class="i">+		XMoveWindow(dpy, barwin, sx, sy + wah);
</a><a href="#h5-0-492" id="h5-0-492" class="i">+		break;
</a><a href="#h5-0-493" id="h5-0-493" class="i">+	case BarOff:
</a><a href="#h5-0-494" id="h5-0-494" class="i">+		XMoveWindow(dpy, barwin, sx, sy - bh);
</a><a href="#h5-0-495" id="h5-0-495" class="i">+		break;
</a><a href="#h5-0-496" id="h5-0-496" class="i">+	}
</a><a href="#h5-0-497" id="h5-0-497" class="i">+	XSync(dpy, False);
</a><a href="#h5-0-498" id="h5-0-498" class="i">+	while(XCheckMaskEvent(dpy, EnterWindowMask, &amp;ev));
</a><a href="#h5-0-499" id="h5-0-499" class="i">+}
</a><a href="#h5-0-500" id="h5-0-500" class="i">+
</a><a href="#h5-0-501" id="h5-0-501" class="i">+static void
</a><a href="#h5-0-502" id="h5-0-502" class="i">+attachstack(Client *c) {
</a><a href="#h5-0-503" id="h5-0-503" class="i">+	c-&gt;snext = stack;
</a><a href="#h5-0-504" id="h5-0-504" class="i">+	stack = c;
</a><a href="#h5-0-505" id="h5-0-505" class="i">+}
</a><a href="#h5-0-506" id="h5-0-506" class="i">+
</a><a href="#h5-0-507" id="h5-0-507" class="i">+static void
</a><a href="#h5-0-508" id="h5-0-508" class="i">+detachstack(Client *c) {
</a><a href="#h5-0-509" id="h5-0-509" class="i">+	Client **tc;
</a><a href="#h5-0-510" id="h5-0-510" class="i">+
</a><a href="#h5-0-511" id="h5-0-511" class="i">+	for(tc=&amp;stack; *tc &amp;&amp; *tc != c; tc=&amp;(*tc)-&gt;snext);
</a><a href="#h5-0-512" id="h5-0-512" class="i">+	*tc = c-&gt;snext;
</a><a href="#h5-0-513" id="h5-0-513" class="i">+}
</a><a href="#h5-0-514" id="h5-0-514" class="i">+
</a><a href="#h5-0-515" id="h5-0-515" class="i">+static void
</a><a href="#h5-0-516" id="h5-0-516" class="i">+grabbuttons(Client *c, Bool focused) {
</a><a href="#h5-0-517" id="h5-0-517" class="i">+	XUngrabButton(dpy, AnyButton, AnyModifier, c-&gt;win);
</a><a href="#h5-0-518" id="h5-0-518" class="i">+
</a><a href="#h5-0-519" id="h5-0-519" class="i">+	if(focused) {
</a><a href="#h5-0-520" id="h5-0-520" class="i">+		XGrabButton(dpy, Button1, MODKEY, c-&gt;win, False, BUTTONMASK,
</a><a href="#h5-0-521" id="h5-0-521" class="i">+				GrabModeAsync, GrabModeSync, None, None);
</a><a href="#h5-0-522" id="h5-0-522" class="i">+		XGrabButton(dpy, Button1, MODKEY | LockMask, c-&gt;win, False, BUTTONMASK,
</a><a href="#h5-0-523" id="h5-0-523" class="i">+				GrabModeAsync, GrabModeSync, None, None);
</a><a href="#h5-0-524" id="h5-0-524" class="i">+		XGrabButton(dpy, Button1, MODKEY | numlockmask, c-&gt;win, False, BUTTONMASK,
</a><a href="#h5-0-525" id="h5-0-525" class="i">+				GrabModeAsync, GrabModeSync, None, None);
</a><a href="#h5-0-526" id="h5-0-526" class="i">+		XGrabButton(dpy, Button1, MODKEY | numlockmask | LockMask, c-&gt;win, False, BUTTONMASK,
</a><a href="#h5-0-527" id="h5-0-527" class="i">+				GrabModeAsync, GrabModeSync, None, None);
</a><a href="#h5-0-528" id="h5-0-528" class="i">+
</a><a href="#h5-0-529" id="h5-0-529" class="i">+		XGrabButton(dpy, Button2, MODKEY, c-&gt;win, False, BUTTONMASK,
</a><a href="#h5-0-530" id="h5-0-530" class="i">+				GrabModeAsync, GrabModeSync, None, None);
</a><a href="#h5-0-531" id="h5-0-531" class="i">+		XGrabButton(dpy, Button2, MODKEY | LockMask, c-&gt;win, False, BUTTONMASK,
</a><a href="#h5-0-532" id="h5-0-532" class="i">+				GrabModeAsync, GrabModeSync, None, None);
</a><a href="#h5-0-533" id="h5-0-533" class="i">+		XGrabButton(dpy, Button2, MODKEY | numlockmask, c-&gt;win, False, BUTTONMASK,
</a><a href="#h5-0-534" id="h5-0-534" class="i">+				GrabModeAsync, GrabModeSync, None, None);
</a><a href="#h5-0-535" id="h5-0-535" class="i">+		XGrabButton(dpy, Button2, MODKEY | numlockmask | LockMask, c-&gt;win, False, BUTTONMASK,
</a><a href="#h5-0-536" id="h5-0-536" class="i">+				GrabModeAsync, GrabModeSync, None, None);
</a><a href="#h5-0-537" id="h5-0-537" class="i">+
</a><a href="#h5-0-538" id="h5-0-538" class="i">+		XGrabButton(dpy, Button3, MODKEY, c-&gt;win, False, BUTTONMASK,
</a><a href="#h5-0-539" id="h5-0-539" class="i">+				GrabModeAsync, GrabModeSync, None, None);
</a><a href="#h5-0-540" id="h5-0-540" class="i">+		XGrabButton(dpy, Button3, MODKEY | LockMask, c-&gt;win, False, BUTTONMASK,
</a><a href="#h5-0-541" id="h5-0-541" class="i">+				GrabModeAsync, GrabModeSync, None, None);
</a><a href="#h5-0-542" id="h5-0-542" class="i">+		XGrabButton(dpy, Button3, MODKEY | numlockmask, c-&gt;win, False, BUTTONMASK,
</a><a href="#h5-0-543" id="h5-0-543" class="i">+				GrabModeAsync, GrabModeSync, None, None);
</a><a href="#h5-0-544" id="h5-0-544" class="i">+		XGrabButton(dpy, Button3, MODKEY | numlockmask | LockMask, c-&gt;win, False, BUTTONMASK,
</a><a href="#h5-0-545" id="h5-0-545" class="i">+				GrabModeAsync, GrabModeSync, None, None);
</a><a href="#h5-0-546" id="h5-0-546" class="i">+	}
</a><a href="#h5-0-547" id="h5-0-547" class="i">+	else
</a><a href="#h5-0-548" id="h5-0-548" class="i">+		XGrabButton(dpy, AnyButton, AnyModifier, c-&gt;win, False, BUTTONMASK,
</a><a href="#h5-0-549" id="h5-0-549" class="i">+				GrabModeAsync, GrabModeSync, None, None);
</a><a href="#h5-0-550" id="h5-0-550" class="i">+}
</a><a href="#h5-0-551" id="h5-0-551" class="i">+
</a><a href="#h5-0-552" id="h5-0-552" class="i">+static Bool
</a><a href="#h5-0-553" id="h5-0-553" class="i">+isprotodel(Client *c) {
</a><a href="#h5-0-554" id="h5-0-554" class="i">+	int i, n;
</a><a href="#h5-0-555" id="h5-0-555" class="i">+	Atom *protocols;
</a><a href="#h5-0-556" id="h5-0-556" class="i">+	Bool ret = False;
</a><a href="#h5-0-557" id="h5-0-557" class="i">+
</a><a href="#h5-0-558" id="h5-0-558" class="i">+	if(XGetWMProtocols(dpy, c-&gt;win, &amp;protocols, &amp;n)) {
</a><a href="#h5-0-559" id="h5-0-559" class="i">+		for(i = 0; !ret &amp;&amp; i &lt; n; i++)
</a><a href="#h5-0-560" id="h5-0-560" class="i">+			if(protocols[i] == wmatom[WMDelete])
</a><a href="#h5-0-561" id="h5-0-561" class="i">+				ret = True;
</a><a href="#h5-0-562" id="h5-0-562" class="i">+		XFree(protocols);
</a><a href="#h5-0-563" id="h5-0-563" class="i">+	}
</a><a href="#h5-0-564" id="h5-0-564" class="i">+	return ret;
</a><a href="#h5-0-565" id="h5-0-565" class="i">+}
</a><a href="#h5-0-566" id="h5-0-566" class="i">+
</a><a href="#h5-0-567" id="h5-0-567" class="i">+static void
</a><a href="#h5-0-568" id="h5-0-568" class="i">+setclientstate(Client *c, long state) {
</a><a href="#h5-0-569" id="h5-0-569" class="i">+	long data[] = {state, None};
</a><a href="#h5-0-570" id="h5-0-570" class="i">+
</a><a href="#h5-0-571" id="h5-0-571" class="i">+	XChangeProperty(dpy, c-&gt;win, wmatom[WMState], wmatom[WMState], 32,
</a><a href="#h5-0-572" id="h5-0-572" class="i">+			PropModeReplace, (unsigned char *)data, 2);
</a><a href="#h5-0-573" id="h5-0-573" class="i">+}
</a><a href="#h5-0-574" id="h5-0-574" class="i">+
</a><a href="#h5-0-575" id="h5-0-575" class="i">+static int
</a><a href="#h5-0-576" id="h5-0-576" class="i">+xerrordummy(Display *dsply, XErrorEvent *ee) {
</a><a href="#h5-0-577" id="h5-0-577" class="i">+	return 0;
</a><a href="#h5-0-578" id="h5-0-578" class="i">+}
</a><a href="#h5-0-579" id="h5-0-579" class="i">+
</a><a href="#h5-0-580" id="h5-0-580" class="i">+static void
</a><a href="#h5-0-581" id="h5-0-581" class="i">+ban(Client *c) {
</a><a href="#h5-0-582" id="h5-0-582" class="i">+	if(c-&gt;isbanned)
</a><a href="#h5-0-583" id="h5-0-583" class="i">+		return;
</a><a href="#h5-0-584" id="h5-0-584" class="i">+	XMoveWindow(dpy, c-&gt;win, c-&gt;x + 2 * sw, c-&gt;y);
</a><a href="#h5-0-585" id="h5-0-585" class="i">+	c-&gt;isbanned = True;
</a><a href="#h5-0-586" id="h5-0-586" class="i">+}
</a><a href="#h5-0-587" id="h5-0-587" class="i">+
</a><a href="#h5-0-588" id="h5-0-588" class="i">+static void
</a><a href="#h5-0-589" id="h5-0-589" class="i">+configure(Client *c) {
</a><a href="#h5-0-590" id="h5-0-590" class="i">+	XConfigureEvent ce;
</a><a href="#h5-0-591" id="h5-0-591" class="i">+
</a><a href="#h5-0-592" id="h5-0-592" class="i">+	ce.type = ConfigureNotify;
</a><a href="#h5-0-593" id="h5-0-593" class="i">+	ce.display = dpy;
</a><a href="#h5-0-594" id="h5-0-594" class="i">+	ce.event = c-&gt;win;
</a><a href="#h5-0-595" id="h5-0-595" class="i">+	ce.window = c-&gt;win;
</a><a href="#h5-0-596" id="h5-0-596" class="i">+	ce.x = c-&gt;x;
</a><a href="#h5-0-597" id="h5-0-597" class="i">+	ce.y = c-&gt;y;
</a><a href="#h5-0-598" id="h5-0-598" class="i">+	ce.width = c-&gt;w;
</a><a href="#h5-0-599" id="h5-0-599" class="i">+	ce.height = c-&gt;h;
</a><a href="#h5-0-600" id="h5-0-600" class="i">+	ce.border_width = c-&gt;border;
</a><a href="#h5-0-601" id="h5-0-601" class="i">+	ce.above = None;
</a><a href="#h5-0-602" id="h5-0-602" class="i">+	ce.override_redirect = False;
</a><a href="#h5-0-603" id="h5-0-603" class="i">+	XSendEvent(dpy, c-&gt;win, False, StructureNotifyMask, (XEvent *)&amp;ce);
</a><a href="#h5-0-604" id="h5-0-604" class="i">+}
</a><a href="#h5-0-605" id="h5-0-605" class="i">+
</a><a href="#h5-0-606" id="h5-0-606" class="i">+static void
</a><a href="#h5-0-607" id="h5-0-607" class="i">+killclient(const char *arg) {
</a><a href="#h5-0-608" id="h5-0-608" class="i">+	XEvent ev;
</a><a href="#h5-0-609" id="h5-0-609" class="i">+
</a><a href="#h5-0-610" id="h5-0-610" class="i">+	if(!sel)
</a><a href="#h5-0-611" id="h5-0-611" class="i">+		return;
</a><a href="#h5-0-612" id="h5-0-612" class="i">+	if(isprotodel(sel)) {
</a><a href="#h5-0-613" id="h5-0-613" class="i">+		ev.type = ClientMessage;
</a><a href="#h5-0-614" id="h5-0-614" class="i">+		ev.xclient.window = sel-&gt;win;
</a><a href="#h5-0-615" id="h5-0-615" class="i">+		ev.xclient.message_type = wmatom[WMProtocols];
</a><a href="#h5-0-616" id="h5-0-616" class="i">+		ev.xclient.format = 32;
</a><a href="#h5-0-617" id="h5-0-617" class="i">+		ev.xclient.data.l[0] = wmatom[WMDelete];
</a><a href="#h5-0-618" id="h5-0-618" class="i">+		ev.xclient.data.l[1] = CurrentTime;
</a><a href="#h5-0-619" id="h5-0-619" class="i">+		XSendEvent(dpy, sel-&gt;win, False, NoEventMask, &amp;ev);
</a><a href="#h5-0-620" id="h5-0-620" class="i">+	}
</a><a href="#h5-0-621" id="h5-0-621" class="i">+	else
</a><a href="#h5-0-622" id="h5-0-622" class="i">+		XKillClient(dpy, sel-&gt;win);
</a><a href="#h5-0-623" id="h5-0-623" class="i">+}
</a><a href="#h5-0-624" id="h5-0-624" class="i">+
</a><a href="#h5-0-625" id="h5-0-625" class="i">+static void
</a><a href="#h5-0-626" id="h5-0-626" class="i">+manage(Window w, XWindowAttributes *wa) {
</a><a href="#h5-0-627" id="h5-0-627" class="i">+	unsigned int i;
</a><a href="#h5-0-628" id="h5-0-628" class="i">+	Client *c, *t = NULL;
</a><a href="#h5-0-629" id="h5-0-629" class="i">+	Window trans;
</a><a href="#h5-0-630" id="h5-0-630" class="i">+	Status rettrans;
</a><a href="#h5-0-631" id="h5-0-631" class="i">+	XWindowChanges wc;
</a><a href="#h5-0-632" id="h5-0-632" class="i">+
</a><a href="#h5-0-633" id="h5-0-633" class="i">+	c = emallocz(sizeof(Client));
</a><a href="#h5-0-634" id="h5-0-634" class="i">+	c-&gt;tags = emallocz(ntags * sizeof(Bool));
</a><a href="#h5-0-635" id="h5-0-635" class="i">+	c-&gt;win = w;
</a><a href="#h5-0-636" id="h5-0-636" class="i">+	c-&gt;x = wa-&gt;x;
</a><a href="#h5-0-637" id="h5-0-637" class="i">+	c-&gt;y = wa-&gt;y;
</a><a href="#h5-0-638" id="h5-0-638" class="i">+	c-&gt;w = wa-&gt;width;
</a><a href="#h5-0-639" id="h5-0-639" class="i">+	c-&gt;h = wa-&gt;height;
</a><a href="#h5-0-640" id="h5-0-640" class="i">+	c-&gt;oldborder = wa-&gt;border_width;
</a><a href="#h5-0-641" id="h5-0-641" class="i">+	if(c-&gt;w == sw &amp;&amp; c-&gt;h == sh) {
</a><a href="#h5-0-642" id="h5-0-642" class="i">+		c-&gt;x = sx;
</a><a href="#h5-0-643" id="h5-0-643" class="i">+		c-&gt;y = sy;
</a><a href="#h5-0-644" id="h5-0-644" class="i">+		c-&gt;border = wa-&gt;border_width;
</a><a href="#h5-0-645" id="h5-0-645" class="i">+	}
</a><a href="#h5-0-646" id="h5-0-646" class="i">+	else {
</a><a href="#h5-0-647" id="h5-0-647" class="i">+		if(c-&gt;x + c-&gt;w + 2 * c-&gt;border &gt; wax + waw)
</a><a href="#h5-0-648" id="h5-0-648" class="i">+			c-&gt;x = wax + waw - c-&gt;w - 2 * c-&gt;border;
</a><a href="#h5-0-649" id="h5-0-649" class="i">+		if(c-&gt;y + c-&gt;h + 2 * c-&gt;border &gt; way + wah)
</a><a href="#h5-0-650" id="h5-0-650" class="i">+			c-&gt;y = way + wah - c-&gt;h - 2 * c-&gt;border;
</a><a href="#h5-0-651" id="h5-0-651" class="i">+		if(c-&gt;x &lt; wax)
</a><a href="#h5-0-652" id="h5-0-652" class="i">+			c-&gt;x = wax;
</a><a href="#h5-0-653" id="h5-0-653" class="i">+		if(c-&gt;y &lt; way)
</a><a href="#h5-0-654" id="h5-0-654" class="i">+			c-&gt;y = way;
</a><a href="#h5-0-655" id="h5-0-655" class="i">+		c-&gt;border = BORDERPX;
</a><a href="#h5-0-656" id="h5-0-656" class="i">+	}
</a><a href="#h5-0-657" id="h5-0-657" class="i">+	wc.border_width = c-&gt;border;
</a><a href="#h5-0-658" id="h5-0-658" class="i">+	XConfigureWindow(dpy, w, CWBorderWidth, &amp;wc);
</a><a href="#h5-0-659" id="h5-0-659" class="i">+	XSetWindowBorder(dpy, w, dc.norm[ColBorder]);
</a><a href="#h5-0-660" id="h5-0-660" class="i">+	configure(c); /* propagates border_width, if size doesn&#39;t change */
</a><a href="#h5-0-661" id="h5-0-661" class="i">+	updatesizehints(c);
</a><a href="#h5-0-662" id="h5-0-662" class="i">+	XSelectInput(dpy, w,
</a><a href="#h5-0-663" id="h5-0-663" class="i">+		StructureNotifyMask | PropertyChangeMask | EnterWindowMask);
</a><a href="#h5-0-664" id="h5-0-664" class="i">+	grabbuttons(c, False);
</a><a href="#h5-0-665" id="h5-0-665" class="i">+	updatetitle(c);
</a><a href="#h5-0-666" id="h5-0-666" class="i">+	if((rettrans = XGetTransientForHint(dpy, w, &amp;trans) == Success))
</a><a href="#h5-0-667" id="h5-0-667" class="i">+		for(t = clients; t &amp;&amp; t-&gt;win != trans; t = t-&gt;next);
</a><a href="#h5-0-668" id="h5-0-668" class="i">+	if(t)
</a><a href="#h5-0-669" id="h5-0-669" class="i">+		for(i = 0; i &lt; ntags; i++)
</a><a href="#h5-0-670" id="h5-0-670" class="i">+			c-&gt;tags[i] = t-&gt;tags[i];
</a><a href="#h5-0-671" id="h5-0-671" class="i">+	applyrules(c);
</a><a href="#h5-0-672" id="h5-0-672" class="i">+	if(!c-&gt;isfloating)
</a><a href="#h5-0-673" id="h5-0-673" class="i">+		c-&gt;isfloating = (rettrans == Success) || c-&gt;isfixed;
</a><a href="#h5-0-674" id="h5-0-674" class="i">+	attach(c);
</a><a href="#h5-0-675" id="h5-0-675" class="i">+	attachstack(c);
</a><a href="#h5-0-676" id="h5-0-676" class="i">+	XMoveResizeWindow(dpy, c-&gt;win, c-&gt;x, c-&gt;y, c-&gt;w, c-&gt;h); /* some windows require this */
</a><a href="#h5-0-677" id="h5-0-677" class="i">+	ban(c);
</a><a href="#h5-0-678" id="h5-0-678" class="i">+	XMapWindow(dpy, c-&gt;win);
</a><a href="#h5-0-679" id="h5-0-679" class="i">+	setclientstate(c, NormalState);
</a><a href="#h5-0-680" id="h5-0-680" class="i">+	arrange();
</a><a href="#h5-0-681" id="h5-0-681" class="i">+}
</a><a href="#h5-0-682" id="h5-0-682" class="i">+
</a><a href="#h5-0-683" id="h5-0-683" class="i">+static void
</a><a href="#h5-0-684" id="h5-0-684" class="i">+resize(Client *c, int x, int y, int w, int h, Bool sizehints) {
</a><a href="#h5-0-685" id="h5-0-685" class="i">+	double dx, dy, max, min, ratio;
</a><a href="#h5-0-686" id="h5-0-686" class="i">+	XWindowChanges wc; 
</a><a href="#h5-0-687" id="h5-0-687" class="i">+
</a><a href="#h5-0-688" id="h5-0-688" class="i">+	if(sizehints) {
</a><a href="#h5-0-689" id="h5-0-689" class="i">+		if(c-&gt;minay &gt; 0 &amp;&amp; c-&gt;maxay &gt; 0 &amp;&amp; (h - c-&gt;baseh) &gt; 0 &amp;&amp; (w - c-&gt;basew) &gt; 0) {
</a><a href="#h5-0-690" id="h5-0-690" class="i">+			dx = (double)(w - c-&gt;basew);
</a><a href="#h5-0-691" id="h5-0-691" class="i">+			dy = (double)(h - c-&gt;baseh);
</a><a href="#h5-0-692" id="h5-0-692" class="i">+			min = (double)(c-&gt;minax) / (double)(c-&gt;minay);
</a><a href="#h5-0-693" id="h5-0-693" class="i">+			max = (double)(c-&gt;maxax) / (double)(c-&gt;maxay);
</a><a href="#h5-0-694" id="h5-0-694" class="i">+			ratio = dx / dy;
</a><a href="#h5-0-695" id="h5-0-695" class="i">+			if(max &gt; 0 &amp;&amp; min &gt; 0 &amp;&amp; ratio &gt; 0) {
</a><a href="#h5-0-696" id="h5-0-696" class="i">+				if(ratio &lt; min) {
</a><a href="#h5-0-697" id="h5-0-697" class="i">+					dy = (dx * min + dy) / (min * min + 1);
</a><a href="#h5-0-698" id="h5-0-698" class="i">+					dx = dy * min;
</a><a href="#h5-0-699" id="h5-0-699" class="i">+					w = (int)dx + c-&gt;basew;
</a><a href="#h5-0-700" id="h5-0-700" class="i">+					h = (int)dy + c-&gt;baseh;
</a><a href="#h5-0-701" id="h5-0-701" class="i">+				}
</a><a href="#h5-0-702" id="h5-0-702" class="i">+				else if(ratio &gt; max) {
</a><a href="#h5-0-703" id="h5-0-703" class="i">+					dy = (dx * min + dy) / (max * max + 1);
</a><a href="#h5-0-704" id="h5-0-704" class="i">+					dx = dy * min;
</a><a href="#h5-0-705" id="h5-0-705" class="i">+					w = (int)dx + c-&gt;basew;
</a><a href="#h5-0-706" id="h5-0-706" class="i">+					h = (int)dy + c-&gt;baseh;
</a><a href="#h5-0-707" id="h5-0-707" class="i">+				}
</a><a href="#h5-0-708" id="h5-0-708" class="i">+			}
</a><a href="#h5-0-709" id="h5-0-709" class="i">+		}
</a><a href="#h5-0-710" id="h5-0-710" class="i">+		if(c-&gt;minw &amp;&amp; w &lt; c-&gt;minw)
</a><a href="#h5-0-711" id="h5-0-711" class="i">+			w = c-&gt;minw;
</a><a href="#h5-0-712" id="h5-0-712" class="i">+		if(c-&gt;minh &amp;&amp; h &lt; c-&gt;minh)
</a><a href="#h5-0-713" id="h5-0-713" class="i">+			h = c-&gt;minh;
</a><a href="#h5-0-714" id="h5-0-714" class="i">+		if(c-&gt;maxw &amp;&amp; w &gt; c-&gt;maxw)
</a><a href="#h5-0-715" id="h5-0-715" class="i">+			w = c-&gt;maxw;
</a><a href="#h5-0-716" id="h5-0-716" class="i">+		if(c-&gt;maxh &amp;&amp; h &gt; c-&gt;maxh)
</a><a href="#h5-0-717" id="h5-0-717" class="i">+			h = c-&gt;maxh;
</a><a href="#h5-0-718" id="h5-0-718" class="i">+		if(c-&gt;incw)
</a><a href="#h5-0-719" id="h5-0-719" class="i">+			w -= (w - c-&gt;basew) % c-&gt;incw;
</a><a href="#h5-0-720" id="h5-0-720" class="i">+		if(c-&gt;inch)
</a><a href="#h5-0-721" id="h5-0-721" class="i">+			h -= (h - c-&gt;baseh) % c-&gt;inch;
</a><a href="#h5-0-722" id="h5-0-722" class="i">+	}
</a><a href="#h5-0-723" id="h5-0-723" class="i">+	if(w &lt;= 0 || h &lt;= 0)
</a><a href="#h5-0-724" id="h5-0-724" class="i">+		return;
</a><a href="#h5-0-725" id="h5-0-725" class="i">+	/* offscreen appearance fixes */
</a><a href="#h5-0-726" id="h5-0-726" class="i">+	if(x &gt; sw)
</a><a href="#h5-0-727" id="h5-0-727" class="i">+		x = sw - w - 2 * c-&gt;border;
</a><a href="#h5-0-728" id="h5-0-728" class="i">+	if(y &gt; sh)
</a><a href="#h5-0-729" id="h5-0-729" class="i">+		y = sh - h - 2 * c-&gt;border;
</a><a href="#h5-0-730" id="h5-0-730" class="i">+	if(x + w + 2 * c-&gt;border &lt; sx)
</a><a href="#h5-0-731" id="h5-0-731" class="i">+		x = sx;
</a><a href="#h5-0-732" id="h5-0-732" class="i">+	if(y + h + 2 * c-&gt;border &lt; sy)
</a><a href="#h5-0-733" id="h5-0-733" class="i">+		y = sy;
</a><a href="#h5-0-734" id="h5-0-734" class="i">+	if(c-&gt;x != x || c-&gt;y != y || c-&gt;w != w || c-&gt;h != h) {
</a><a href="#h5-0-735" id="h5-0-735" class="i">+		c-&gt;x = wc.x = x;
</a><a href="#h5-0-736" id="h5-0-736" class="i">+		c-&gt;y = wc.y = y;
</a><a href="#h5-0-737" id="h5-0-737" class="i">+		c-&gt;w = wc.width = w;
</a><a href="#h5-0-738" id="h5-0-738" class="i">+		c-&gt;h = wc.height = h;
</a><a href="#h5-0-739" id="h5-0-739" class="i">+		wc.border_width = c-&gt;border;
</a><a href="#h5-0-740" id="h5-0-740" class="i">+		XConfigureWindow(dpy, c-&gt;win, CWX | CWY | CWWidth | CWHeight | CWBorderWidth, &amp;wc);
</a><a href="#h5-0-741" id="h5-0-741" class="i">+		configure(c);
</a><a href="#h5-0-742" id="h5-0-742" class="i">+		XSync(dpy, False);
</a><a href="#h5-0-743" id="h5-0-743" class="i">+	}
</a><a href="#h5-0-744" id="h5-0-744" class="i">+}
</a><a href="#h5-0-745" id="h5-0-745" class="i">+
</a><a href="#h5-0-746" id="h5-0-746" class="i">+static void
</a><a href="#h5-0-747" id="h5-0-747" class="i">+unban(Client *c) {
</a><a href="#h5-0-748" id="h5-0-748" class="i">+	if(!c-&gt;isbanned)
</a><a href="#h5-0-749" id="h5-0-749" class="i">+		return;
</a><a href="#h5-0-750" id="h5-0-750" class="i">+	XMoveWindow(dpy, c-&gt;win, c-&gt;x, c-&gt;y);
</a><a href="#h5-0-751" id="h5-0-751" class="i">+	c-&gt;isbanned = False;
</a><a href="#h5-0-752" id="h5-0-752" class="i">+}
</a><a href="#h5-0-753" id="h5-0-753" class="i">+
</a><a href="#h5-0-754" id="h5-0-754" class="i">+static void
</a><a href="#h5-0-755" id="h5-0-755" class="i">+unmanage(Client *c) {
</a><a href="#h5-0-756" id="h5-0-756" class="i">+	XWindowChanges wc;
</a><a href="#h5-0-757" id="h5-0-757" class="i">+
</a><a href="#h5-0-758" id="h5-0-758" class="i">+	wc.border_width = c-&gt;oldborder;
</a><a href="#h5-0-759" id="h5-0-759" class="i">+	/* The server grab construct avoids race conditions. */
</a><a href="#h5-0-760" id="h5-0-760" class="i">+	XGrabServer(dpy);
</a><a href="#h5-0-761" id="h5-0-761" class="i">+	XSetErrorHandler(xerrordummy);
</a><a href="#h5-0-762" id="h5-0-762" class="i">+	XConfigureWindow(dpy, c-&gt;win, CWBorderWidth, &amp;wc); /* restore border */
</a><a href="#h5-0-763" id="h5-0-763" class="i">+	detach(c);
</a><a href="#h5-0-764" id="h5-0-764" class="i">+	detachstack(c);
</a><a href="#h5-0-765" id="h5-0-765" class="i">+	if(sel == c)
</a><a href="#h5-0-766" id="h5-0-766" class="i">+		focus(NULL);
</a><a href="#h5-0-767" id="h5-0-767" class="i">+	XUngrabButton(dpy, AnyButton, AnyModifier, c-&gt;win);
</a><a href="#h5-0-768" id="h5-0-768" class="i">+	setclientstate(c, WithdrawnState);
</a><a href="#h5-0-769" id="h5-0-769" class="i">+	free(c-&gt;tags);
</a><a href="#h5-0-770" id="h5-0-770" class="i">+	free(c);
</a><a href="#h5-0-771" id="h5-0-771" class="i">+	XSync(dpy, False);
</a><a href="#h5-0-772" id="h5-0-772" class="i">+	XSetErrorHandler(xerror);
</a><a href="#h5-0-773" id="h5-0-773" class="i">+	XUngrabServer(dpy);
</a><a href="#h5-0-774" id="h5-0-774" class="i">+	arrange();
</a><a href="#h5-0-775" id="h5-0-775" class="i">+}
</a><a href="#h5-0-776" id="h5-0-776" class="i">+
</a><a href="#h5-0-777" id="h5-0-777" class="i">+static void
</a><a href="#h5-0-778" id="h5-0-778" class="i">+updatesizehints(Client *c) {
</a><a href="#h5-0-779" id="h5-0-779" class="i">+	long msize;
</a><a href="#h5-0-780" id="h5-0-780" class="i">+	XSizeHints size;
</a><a href="#h5-0-781" id="h5-0-781" class="i">+
</a><a href="#h5-0-782" id="h5-0-782" class="i">+	if(!XGetWMNormalHints(dpy, c-&gt;win, &amp;size, &amp;msize) || !size.flags)
</a><a href="#h5-0-783" id="h5-0-783" class="i">+		size.flags = PSize;
</a><a href="#h5-0-784" id="h5-0-784" class="i">+	c-&gt;flags = size.flags;
</a><a href="#h5-0-785" id="h5-0-785" class="i">+	if(c-&gt;flags &amp; PBaseSize) {
</a><a href="#h5-0-786" id="h5-0-786" class="i">+		c-&gt;basew = size.base_width;
</a><a href="#h5-0-787" id="h5-0-787" class="i">+		c-&gt;baseh = size.base_height;
</a><a href="#h5-0-788" id="h5-0-788" class="i">+	}
</a><a href="#h5-0-789" id="h5-0-789" class="i">+	else if(c-&gt;flags &amp; PMinSize) {
</a><a href="#h5-0-790" id="h5-0-790" class="i">+		c-&gt;basew = size.min_width;
</a><a href="#h5-0-791" id="h5-0-791" class="i">+		c-&gt;baseh = size.min_height;
</a><a href="#h5-0-792" id="h5-0-792" class="i">+	}
</a><a href="#h5-0-793" id="h5-0-793" class="i">+	else
</a><a href="#h5-0-794" id="h5-0-794" class="i">+		c-&gt;basew = c-&gt;baseh = 0;
</a><a href="#h5-0-795" id="h5-0-795" class="i">+	if(c-&gt;flags &amp; PResizeInc) {
</a><a href="#h5-0-796" id="h5-0-796" class="i">+		c-&gt;incw = size.width_inc;
</a><a href="#h5-0-797" id="h5-0-797" class="i">+		c-&gt;inch = size.height_inc;
</a><a href="#h5-0-798" id="h5-0-798" class="i">+	}
</a><a href="#h5-0-799" id="h5-0-799" class="i">+	else
</a><a href="#h5-0-800" id="h5-0-800" class="i">+		c-&gt;incw = c-&gt;inch = 0;
</a><a href="#h5-0-801" id="h5-0-801" class="i">+	if(c-&gt;flags &amp; PMaxSize) {
</a><a href="#h5-0-802" id="h5-0-802" class="i">+		c-&gt;maxw = size.max_width;
</a><a href="#h5-0-803" id="h5-0-803" class="i">+		c-&gt;maxh = size.max_height;
</a><a href="#h5-0-804" id="h5-0-804" class="i">+	}
</a><a href="#h5-0-805" id="h5-0-805" class="i">+	else
</a><a href="#h5-0-806" id="h5-0-806" class="i">+		c-&gt;maxw = c-&gt;maxh = 0;
</a><a href="#h5-0-807" id="h5-0-807" class="i">+	if(c-&gt;flags &amp; PMinSize) {
</a><a href="#h5-0-808" id="h5-0-808" class="i">+		c-&gt;minw = size.min_width;
</a><a href="#h5-0-809" id="h5-0-809" class="i">+		c-&gt;minh = size.min_height;
</a><a href="#h5-0-810" id="h5-0-810" class="i">+	}
</a><a href="#h5-0-811" id="h5-0-811" class="i">+	else if(c-&gt;flags &amp; PBaseSize) {
</a><a href="#h5-0-812" id="h5-0-812" class="i">+		c-&gt;minw = size.base_width;
</a><a href="#h5-0-813" id="h5-0-813" class="i">+		c-&gt;minh = size.base_height;
</a><a href="#h5-0-814" id="h5-0-814" class="i">+	}
</a><a href="#h5-0-815" id="h5-0-815" class="i">+	else
</a><a href="#h5-0-816" id="h5-0-816" class="i">+		c-&gt;minw = c-&gt;minh = 0;
</a><a href="#h5-0-817" id="h5-0-817" class="i">+	if(c-&gt;flags &amp; PAspect) {
</a><a href="#h5-0-818" id="h5-0-818" class="i">+		c-&gt;minax = size.min_aspect.x;
</a><a href="#h5-0-819" id="h5-0-819" class="i">+		c-&gt;maxax = size.max_aspect.x;
</a><a href="#h5-0-820" id="h5-0-820" class="i">+		c-&gt;minay = size.min_aspect.y;
</a><a href="#h5-0-821" id="h5-0-821" class="i">+		c-&gt;maxay = size.max_aspect.y;
</a><a href="#h5-0-822" id="h5-0-822" class="i">+	}
</a><a href="#h5-0-823" id="h5-0-823" class="i">+	else
</a><a href="#h5-0-824" id="h5-0-824" class="i">+		c-&gt;minax = c-&gt;maxax = c-&gt;minay = c-&gt;maxay = 0;
</a><a href="#h5-0-825" id="h5-0-825" class="i">+	c-&gt;isfixed = (c-&gt;maxw &amp;&amp; c-&gt;minw &amp;&amp; c-&gt;maxh &amp;&amp; c-&gt;minh
</a><a href="#h5-0-826" id="h5-0-826" class="i">+			&amp;&amp; c-&gt;maxw == c-&gt;minw &amp;&amp; c-&gt;maxh == c-&gt;minh);
</a><a href="#h5-0-827" id="h5-0-827" class="i">+}
</a><a href="#h5-0-828" id="h5-0-828" class="i">+
</a><a href="#h5-0-829" id="h5-0-829" class="i">+static void
</a><a href="#h5-0-830" id="h5-0-830" class="i">+updatetitle(Client *c) {
</a><a href="#h5-0-831" id="h5-0-831" class="i">+	if(!gettextprop(c-&gt;win, netatom[NetWMName], c-&gt;name, sizeof c-&gt;name))
</a><a href="#h5-0-832" id="h5-0-832" class="i">+		gettextprop(c-&gt;win, wmatom[WMName], c-&gt;name, sizeof c-&gt;name);
</a><a href="#h5-0-833" id="h5-0-833" class="i">+}
</a><a href="#h5-0-834" id="h5-0-834" class="i">+
</a><a href="#h5-0-835" id="h5-0-835" class="i">+static Client *
</a><a href="#h5-0-836" id="h5-0-836" class="i">+getclient(Window w) {
</a><a href="#h5-0-837" id="h5-0-837" class="i">+	Client *c;
</a><a href="#h5-0-838" id="h5-0-838" class="i">+
</a><a href="#h5-0-839" id="h5-0-839" class="i">+	for(c = clients; c &amp;&amp; c-&gt;win != w; c = c-&gt;next);
</a><a href="#h5-0-840" id="h5-0-840" class="i">+	return c;
</a><a href="#h5-0-841" id="h5-0-841" class="i">+}
</a><a href="#h5-0-842" id="h5-0-842" class="i">+
</a><a href="#h5-0-843" id="h5-0-843" class="i">+static void
</a><a href="#h5-0-844" id="h5-0-844" class="i">+movemouse(Client *c) {
</a><a href="#h5-0-845" id="h5-0-845" class="i">+	int x1, y1, ocx, ocy, di, nx, ny;
</a><a href="#h5-0-846" id="h5-0-846" class="i">+	unsigned int dui;
</a><a href="#h5-0-847" id="h5-0-847" class="i">+	Window dummy;
</a><a href="#h5-0-848" id="h5-0-848" class="i">+	XEvent ev;
</a><a href="#h5-0-849" id="h5-0-849" class="i">+
</a><a href="#h5-0-850" id="h5-0-850" class="i">+	ocx = nx = c-&gt;x;
</a><a href="#h5-0-851" id="h5-0-851" class="i">+	ocy = ny = c-&gt;y;
</a><a href="#h5-0-852" id="h5-0-852" class="i">+	if(XGrabPointer(dpy, root, False, MOUSEMASK, GrabModeAsync, GrabModeAsync,
</a><a href="#h5-0-853" id="h5-0-853" class="i">+			None, cursor[CurMove], CurrentTime) != GrabSuccess)
</a><a href="#h5-0-854" id="h5-0-854" class="i">+		return;
</a><a href="#h5-0-855" id="h5-0-855" class="i">+	c-&gt;ismax = False;
</a><a href="#h5-0-856" id="h5-0-856" class="i">+	XQueryPointer(dpy, root, &amp;dummy, &amp;dummy, &amp;x1, &amp;y1, &amp;di, &amp;di, &amp;dui);
</a><a href="#h5-0-857" id="h5-0-857" class="i">+	for(;;) {
</a><a href="#h5-0-858" id="h5-0-858" class="i">+		XMaskEvent(dpy, MOUSEMASK | ExposureMask | SubstructureRedirectMask, &amp;ev);
</a><a href="#h5-0-859" id="h5-0-859" class="i">+		switch (ev.type) {
</a><a href="#h5-0-860" id="h5-0-860" class="i">+		case ButtonRelease:
</a><a href="#h5-0-861" id="h5-0-861" class="i">+			XUngrabPointer(dpy, CurrentTime);
</a><a href="#h5-0-862" id="h5-0-862" class="i">+			return;
</a><a href="#h5-0-863" id="h5-0-863" class="i">+		case ConfigureRequest:
</a><a href="#h5-0-864" id="h5-0-864" class="i">+		case Expose:
</a><a href="#h5-0-865" id="h5-0-865" class="i">+		case MapRequest:
</a><a href="#h5-0-866" id="h5-0-866" class="i">+			handler[ev.type](&amp;ev);
</a><a href="#h5-0-867" id="h5-0-867" class="i">+			break;
</a><a href="#h5-0-868" id="h5-0-868" class="i">+		case MotionNotify:
</a><a href="#h5-0-869" id="h5-0-869" class="i">+			XSync(dpy, False);
</a><a href="#h5-0-870" id="h5-0-870" class="i">+			nx = ocx + (ev.xmotion.x - x1);
</a><a href="#h5-0-871" id="h5-0-871" class="i">+			ny = ocy + (ev.xmotion.y - y1);
</a><a href="#h5-0-872" id="h5-0-872" class="i">+			if(abs(wax + nx) &lt; SNAP)
</a><a href="#h5-0-873" id="h5-0-873" class="i">+				nx = wax;
</a><a href="#h5-0-874" id="h5-0-874" class="i">+			else if(abs((wax + waw) - (nx + c-&gt;w + 2 * c-&gt;border)) &lt; SNAP)
</a><a href="#h5-0-875" id="h5-0-875" class="i">+				nx = wax + waw - c-&gt;w - 2 * c-&gt;border;
</a><a href="#h5-0-876" id="h5-0-876" class="i">+			if(abs(way - ny) &lt; SNAP)
</a><a href="#h5-0-877" id="h5-0-877" class="i">+				ny = way;
</a><a href="#h5-0-878" id="h5-0-878" class="i">+			else if(abs((way + wah) - (ny + c-&gt;h + 2 * c-&gt;border)) &lt; SNAP)
</a><a href="#h5-0-879" id="h5-0-879" class="i">+				ny = way + wah - c-&gt;h - 2 * c-&gt;border;
</a><a href="#h5-0-880" id="h5-0-880" class="i">+			resize(c, nx, ny, c-&gt;w, c-&gt;h, False);
</a><a href="#h5-0-881" id="h5-0-881" class="i">+			break;
</a><a href="#h5-0-882" id="h5-0-882" class="i">+		}
</a><a href="#h5-0-883" id="h5-0-883" class="i">+	}
</a><a href="#h5-0-884" id="h5-0-884" class="i">+}
</a><a href="#h5-0-885" id="h5-0-885" class="i">+
</a><a href="#h5-0-886" id="h5-0-886" class="i">+static void
</a><a href="#h5-0-887" id="h5-0-887" class="i">+resizemouse(Client *c) {
</a><a href="#h5-0-888" id="h5-0-888" class="i">+	int ocx, ocy;
</a><a href="#h5-0-889" id="h5-0-889" class="i">+	int nw, nh;
</a><a href="#h5-0-890" id="h5-0-890" class="i">+	XEvent ev;
</a><a href="#h5-0-891" id="h5-0-891" class="i">+
</a><a href="#h5-0-892" id="h5-0-892" class="i">+	ocx = c-&gt;x;
</a><a href="#h5-0-893" id="h5-0-893" class="i">+	ocy = c-&gt;y;
</a><a href="#h5-0-894" id="h5-0-894" class="i">+	if(XGrabPointer(dpy, root, False, MOUSEMASK, GrabModeAsync, GrabModeAsync,
</a><a href="#h5-0-895" id="h5-0-895" class="i">+			None, cursor[CurResize], CurrentTime) != GrabSuccess)
</a><a href="#h5-0-896" id="h5-0-896" class="i">+		return;
</a><a href="#h5-0-897" id="h5-0-897" class="i">+	c-&gt;ismax = False;
</a><a href="#h5-0-898" id="h5-0-898" class="i">+	XWarpPointer(dpy, None, c-&gt;win, 0, 0, 0, 0, c-&gt;w + c-&gt;border - 1, c-&gt;h + c-&gt;border - 1);
</a><a href="#h5-0-899" id="h5-0-899" class="i">+	for(;;) {
</a><a href="#h5-0-900" id="h5-0-900" class="i">+		XMaskEvent(dpy, MOUSEMASK | ExposureMask | SubstructureRedirectMask , &amp;ev);
</a><a href="#h5-0-901" id="h5-0-901" class="i">+		switch(ev.type) {
</a><a href="#h5-0-902" id="h5-0-902" class="i">+		case ButtonRelease:
</a><a href="#h5-0-903" id="h5-0-903" class="i">+			XWarpPointer(dpy, None, c-&gt;win, 0, 0, 0, 0,
</a><a href="#h5-0-904" id="h5-0-904" class="i">+					c-&gt;w + c-&gt;border - 1, c-&gt;h + c-&gt;border - 1);
</a><a href="#h5-0-905" id="h5-0-905" class="i">+			XUngrabPointer(dpy, CurrentTime);
</a><a href="#h5-0-906" id="h5-0-906" class="i">+			while(XCheckMaskEvent(dpy, EnterWindowMask, &amp;ev));
</a><a href="#h5-0-907" id="h5-0-907" class="i">+			return;
</a><a href="#h5-0-908" id="h5-0-908" class="i">+		case ConfigureRequest:
</a><a href="#h5-0-909" id="h5-0-909" class="i">+		case Expose:
</a><a href="#h5-0-910" id="h5-0-910" class="i">+		case MapRequest:
</a><a href="#h5-0-911" id="h5-0-911" class="i">+			handler[ev.type](&amp;ev);
</a><a href="#h5-0-912" id="h5-0-912" class="i">+			break;
</a><a href="#h5-0-913" id="h5-0-913" class="i">+		case MotionNotify:
</a><a href="#h5-0-914" id="h5-0-914" class="i">+			XSync(dpy, False);
</a><a href="#h5-0-915" id="h5-0-915" class="i">+			if((nw = ev.xmotion.x - ocx - 2 * c-&gt;border + 1) &lt;= 0)
</a><a href="#h5-0-916" id="h5-0-916" class="i">+				nw = 1;
</a><a href="#h5-0-917" id="h5-0-917" class="i">+			if((nh = ev.xmotion.y - ocy - 2 * c-&gt;border + 1) &lt;= 0)
</a><a href="#h5-0-918" id="h5-0-918" class="i">+				nh = 1;
</a><a href="#h5-0-919" id="h5-0-919" class="i">+			resize(c, c-&gt;x, c-&gt;y, nw, nh, True);
</a><a href="#h5-0-920" id="h5-0-920" class="i">+			break;
</a><a href="#h5-0-921" id="h5-0-921" class="i">+		}
</a><a href="#h5-0-922" id="h5-0-922" class="i">+	}
</a><a href="#h5-0-923" id="h5-0-923" class="i">+}
</a><a href="#h5-0-924" id="h5-0-924" class="i">+
</a><a href="#h5-0-925" id="h5-0-925" class="i">+static void
</a><a href="#h5-0-926" id="h5-0-926" class="i">+buttonpress(XEvent *e) {
</a><a href="#h5-0-927" id="h5-0-927" class="i">+	unsigned int i, x;
</a><a href="#h5-0-928" id="h5-0-928" class="i">+	Client *c;
</a><a href="#h5-0-929" id="h5-0-929" class="i">+	XButtonPressedEvent *ev = &amp;e-&gt;xbutton;
</a><a href="#h5-0-930" id="h5-0-930" class="i">+
</a><a href="#h5-0-931" id="h5-0-931" class="i">+	if(barwin == ev-&gt;window) {
</a><a href="#h5-0-932" id="h5-0-932" class="i">+		x = 0;
</a><a href="#h5-0-933" id="h5-0-933" class="i">+		for(i = 0; i &lt; ntags; i++) {
</a><a href="#h5-0-934" id="h5-0-934" class="i">+			x += textw(tags[i]);
</a><a href="#h5-0-935" id="h5-0-935" class="i">+			if(ev-&gt;x &lt; x) {
</a><a href="#h5-0-936" id="h5-0-936" class="i">+				if(ev-&gt;button == Button1) {
</a><a href="#h5-0-937" id="h5-0-937" class="i">+					if(ev-&gt;state &amp; MODKEY)
</a><a href="#h5-0-938" id="h5-0-938" class="i">+						tag(tags[i]);
</a><a href="#h5-0-939" id="h5-0-939" class="i">+					else
</a><a href="#h5-0-940" id="h5-0-940" class="i">+						view(tags[i]);
</a><a href="#h5-0-941" id="h5-0-941" class="i">+				}
</a><a href="#h5-0-942" id="h5-0-942" class="i">+				else if(ev-&gt;button == Button3) {
</a><a href="#h5-0-943" id="h5-0-943" class="i">+					if(ev-&gt;state &amp; MODKEY)
</a><a href="#h5-0-944" id="h5-0-944" class="i">+						toggletag(tags[i]);
</a><a href="#h5-0-945" id="h5-0-945" class="i">+					else
</a><a href="#h5-0-946" id="h5-0-946" class="i">+						toggleview(tags[i]);
</a><a href="#h5-0-947" id="h5-0-947" class="i">+				}
</a><a href="#h5-0-948" id="h5-0-948" class="i">+				return;
</a><a href="#h5-0-949" id="h5-0-949" class="i">+			}
</a><a href="#h5-0-950" id="h5-0-950" class="i">+		}
</a><a href="#h5-0-951" id="h5-0-951" class="i">+		if((ev-&gt;x &lt; x + blw) &amp;&amp; ev-&gt;button == Button1)
</a><a href="#h5-0-952" id="h5-0-952" class="i">+			setlayout(NULL);
</a><a href="#h5-0-953" id="h5-0-953" class="i">+	}
</a><a href="#h5-0-954" id="h5-0-954" class="i">+	else if((c = getclient(ev-&gt;window))) {
</a><a href="#h5-0-955" id="h5-0-955" class="i">+		focus(c);
</a><a href="#h5-0-956" id="h5-0-956" class="i">+		if(CLEANMASK(ev-&gt;state) != MODKEY)
</a><a href="#h5-0-957" id="h5-0-957" class="i">+			return;
</a><a href="#h5-0-958" id="h5-0-958" class="i">+		if(ev-&gt;button == Button1 &amp;&amp; (isfloating() || c-&gt;isfloating)) {
</a><a href="#h5-0-959" id="h5-0-959" class="i">+			restack();
</a><a href="#h5-0-960" id="h5-0-960" class="i">+			movemouse(c);
</a><a href="#h5-0-961" id="h5-0-961" class="i">+		}
</a><a href="#h5-0-962" id="h5-0-962" class="i">+		else if(ev-&gt;button == Button2)
</a><a href="#h5-0-963" id="h5-0-963" class="i">+			zoom(NULL);
</a><a href="#h5-0-964" id="h5-0-964" class="i">+		else if(ev-&gt;button == Button3
</a><a href="#h5-0-965" id="h5-0-965" class="i">+		&amp;&amp; (isfloating() || c-&gt;isfloating) &amp;&amp; !c-&gt;isfixed)
</a><a href="#h5-0-966" id="h5-0-966" class="i">+		{
</a><a href="#h5-0-967" id="h5-0-967" class="i">+			restack();
</a><a href="#h5-0-968" id="h5-0-968" class="i">+			resizemouse(c);
</a><a href="#h5-0-969" id="h5-0-969" class="i">+		}
</a><a href="#h5-0-970" id="h5-0-970" class="i">+	}
</a><a href="#h5-0-971" id="h5-0-971" class="i">+}
</a><a href="#h5-0-972" id="h5-0-972" class="i">+
</a><a href="#h5-0-973" id="h5-0-973" class="i">+static void
</a><a href="#h5-0-974" id="h5-0-974" class="i">+configurerequest(XEvent *e) {
</a><a href="#h5-0-975" id="h5-0-975" class="i">+	Client *c;
</a><a href="#h5-0-976" id="h5-0-976" class="i">+	XConfigureRequestEvent *ev = &amp;e-&gt;xconfigurerequest;
</a><a href="#h5-0-977" id="h5-0-977" class="i">+	XWindowChanges wc;
</a><a href="#h5-0-978" id="h5-0-978" class="i">+
</a><a href="#h5-0-979" id="h5-0-979" class="i">+	if((c = getclient(ev-&gt;window))) {
</a><a href="#h5-0-980" id="h5-0-980" class="i">+		c-&gt;ismax = False;
</a><a href="#h5-0-981" id="h5-0-981" class="i">+		if(ev-&gt;value_mask &amp; CWBorderWidth)
</a><a href="#h5-0-982" id="h5-0-982" class="i">+			c-&gt;border = ev-&gt;border_width;
</a><a href="#h5-0-983" id="h5-0-983" class="i">+		if(c-&gt;isfixed || c-&gt;isfloating || isfloating()) {
</a><a href="#h5-0-984" id="h5-0-984" class="i">+			if(ev-&gt;value_mask &amp; CWX)
</a><a href="#h5-0-985" id="h5-0-985" class="i">+				c-&gt;x = ev-&gt;x;
</a><a href="#h5-0-986" id="h5-0-986" class="i">+			if(ev-&gt;value_mask &amp; CWY)
</a><a href="#h5-0-987" id="h5-0-987" class="i">+				c-&gt;y = ev-&gt;y;
</a><a href="#h5-0-988" id="h5-0-988" class="i">+			if(ev-&gt;value_mask &amp; CWWidth)
</a><a href="#h5-0-989" id="h5-0-989" class="i">+				c-&gt;w = ev-&gt;width;
</a><a href="#h5-0-990" id="h5-0-990" class="i">+			if(ev-&gt;value_mask &amp; CWHeight)
</a><a href="#h5-0-991" id="h5-0-991" class="i">+				c-&gt;h = ev-&gt;height;
</a><a href="#h5-0-992" id="h5-0-992" class="i">+			if((c-&gt;x + c-&gt;w) &gt; sw &amp;&amp; c-&gt;isfloating)
</a><a href="#h5-0-993" id="h5-0-993" class="i">+				c-&gt;x = sw / 2 - c-&gt;w / 2; /* center in x direction */
</a><a href="#h5-0-994" id="h5-0-994" class="i">+			if((c-&gt;y + c-&gt;h) &gt; sh &amp;&amp; c-&gt;isfloating)
</a><a href="#h5-0-995" id="h5-0-995" class="i">+				c-&gt;y = sh / 2 - c-&gt;h / 2; /* center in y direction */
</a><a href="#h5-0-996" id="h5-0-996" class="i">+			if((ev-&gt;value_mask &amp; (CWX | CWY))
</a><a href="#h5-0-997" id="h5-0-997" class="i">+			&amp;&amp; !(ev-&gt;value_mask &amp; (CWWidth | CWHeight)))
</a><a href="#h5-0-998" id="h5-0-998" class="i">+				configure(c);
</a><a href="#h5-0-999" id="h5-0-999" class="i">+			if(isvisible(c))
</a><a href="#h5-0-1000" id="h5-0-1000" class="i">+				XMoveResizeWindow(dpy, c-&gt;win, c-&gt;x, c-&gt;y, c-&gt;w, c-&gt;h);
</a><a href="#h5-0-1001" id="h5-0-1001" class="i">+		}
</a><a href="#h5-0-1002" id="h5-0-1002" class="i">+		else
</a><a href="#h5-0-1003" id="h5-0-1003" class="i">+			configure(c);
</a><a href="#h5-0-1004" id="h5-0-1004" class="i">+	}
</a><a href="#h5-0-1005" id="h5-0-1005" class="i">+	else {
</a><a href="#h5-0-1006" id="h5-0-1006" class="i">+		wc.x = ev-&gt;x;
</a><a href="#h5-0-1007" id="h5-0-1007" class="i">+		wc.y = ev-&gt;y;
</a><a href="#h5-0-1008" id="h5-0-1008" class="i">+		wc.width = ev-&gt;width;
</a><a href="#h5-0-1009" id="h5-0-1009" class="i">+		wc.height = ev-&gt;height;
</a><a href="#h5-0-1010" id="h5-0-1010" class="i">+		wc.border_width = ev-&gt;border_width;
</a><a href="#h5-0-1011" id="h5-0-1011" class="i">+		wc.sibling = ev-&gt;above;
</a><a href="#h5-0-1012" id="h5-0-1012" class="i">+		wc.stack_mode = ev-&gt;detail;
</a><a href="#h5-0-1013" id="h5-0-1013" class="i">+		XConfigureWindow(dpy, ev-&gt;window, ev-&gt;value_mask, &amp;wc);
</a><a href="#h5-0-1014" id="h5-0-1014" class="i">+	}
</a><a href="#h5-0-1015" id="h5-0-1015" class="i">+	XSync(dpy, False);
</a><a href="#h5-0-1016" id="h5-0-1016" class="i">+}
</a><a href="#h5-0-1017" id="h5-0-1017" class="i">+
</a><a href="#h5-0-1018" id="h5-0-1018" class="i">+static void
</a><a href="#h5-0-1019" id="h5-0-1019" class="i">+configurenotify(XEvent *e) {
</a><a href="#h5-0-1020" id="h5-0-1020" class="i">+	XConfigureEvent *ev = &amp;e-&gt;xconfigure;
</a><a href="#h5-0-1021" id="h5-0-1021" class="i">+
</a><a href="#h5-0-1022" id="h5-0-1022" class="i">+	if (ev-&gt;window == root &amp;&amp; (ev-&gt;width != sw || ev-&gt;height != sh)) {
</a><a href="#h5-0-1023" id="h5-0-1023" class="i">+		sw = ev-&gt;width;
</a><a href="#h5-0-1024" id="h5-0-1024" class="i">+		sh = ev-&gt;height;
</a><a href="#h5-0-1025" id="h5-0-1025" class="i">+		XFreePixmap(dpy, dc.drawable);
</a><a href="#h5-0-1026" id="h5-0-1026" class="i">+		dc.drawable = XCreatePixmap(dpy, root, sw, bh, DefaultDepth(dpy, screen));
</a><a href="#h5-0-1027" id="h5-0-1027" class="i">+		XResizeWindow(dpy, barwin, sw, bh);
</a><a href="#h5-0-1028" id="h5-0-1028" class="i">+		updatebarpos();
</a><a href="#h5-0-1029" id="h5-0-1029" class="i">+		arrange();
</a><a href="#h5-0-1030" id="h5-0-1030" class="i">+	}
</a><a href="#h5-0-1031" id="h5-0-1031" class="i">+}
</a><a href="#h5-0-1032" id="h5-0-1032" class="i">+
</a><a href="#h5-0-1033" id="h5-0-1033" class="i">+static void
</a><a href="#h5-0-1034" id="h5-0-1034" class="i">+destroynotify(XEvent *e) {
</a><a href="#h5-0-1035" id="h5-0-1035" class="i">+	Client *c;
</a><a href="#h5-0-1036" id="h5-0-1036" class="i">+	XDestroyWindowEvent *ev = &amp;e-&gt;xdestroywindow;
</a><a href="#h5-0-1037" id="h5-0-1037" class="i">+
</a><a href="#h5-0-1038" id="h5-0-1038" class="i">+	if((c = getclient(ev-&gt;window)))
</a><a href="#h5-0-1039" id="h5-0-1039" class="i">+		unmanage(c);
</a><a href="#h5-0-1040" id="h5-0-1040" class="i">+}
</a><a href="#h5-0-1041" id="h5-0-1041" class="i">+
</a><a href="#h5-0-1042" id="h5-0-1042" class="i">+static void
</a><a href="#h5-0-1043" id="h5-0-1043" class="i">+enternotify(XEvent *e) {
</a><a href="#h5-0-1044" id="h5-0-1044" class="i">+	Client *c;
</a><a href="#h5-0-1045" id="h5-0-1045" class="i">+	XCrossingEvent *ev = &amp;e-&gt;xcrossing;
</a><a href="#h5-0-1046" id="h5-0-1046" class="i">+
</a><a href="#h5-0-1047" id="h5-0-1047" class="i">+	if(ev-&gt;mode != NotifyNormal || ev-&gt;detail == NotifyInferior)
</a><a href="#h5-0-1048" id="h5-0-1048" class="i">+		return;
</a><a href="#h5-0-1049" id="h5-0-1049" class="i">+	if((c = getclient(ev-&gt;window)))
</a><a href="#h5-0-1050" id="h5-0-1050" class="i">+		focus(c);
</a><a href="#h5-0-1051" id="h5-0-1051" class="i">+	else if(ev-&gt;window == root) {
</a><a href="#h5-0-1052" id="h5-0-1052" class="i">+		selscreen = True;
</a><a href="#h5-0-1053" id="h5-0-1053" class="i">+		focus(NULL);
</a><a href="#h5-0-1054" id="h5-0-1054" class="i">+	}
</a><a href="#h5-0-1055" id="h5-0-1055" class="i">+}
</a><a href="#h5-0-1056" id="h5-0-1056" class="i">+
</a><a href="#h5-0-1057" id="h5-0-1057" class="i">+static void
</a><a href="#h5-0-1058" id="h5-0-1058" class="i">+expose(XEvent *e) {
</a><a href="#h5-0-1059" id="h5-0-1059" class="i">+	XExposeEvent *ev = &amp;e-&gt;xexpose;
</a><a href="#h5-0-1060" id="h5-0-1060" class="i">+
</a><a href="#h5-0-1061" id="h5-0-1061" class="i">+	if(ev-&gt;count == 0) {
</a><a href="#h5-0-1062" id="h5-0-1062" class="i">+		if(barwin == ev-&gt;window)
</a><a href="#h5-0-1063" id="h5-0-1063" class="i">+			drawbar();
</a><a href="#h5-0-1064" id="h5-0-1064" class="i">+	}
</a><a href="#h5-0-1065" id="h5-0-1065" class="i">+}
</a><a href="#h5-0-1066" id="h5-0-1066" class="i">+
</a><a href="#h5-0-1067" id="h5-0-1067" class="i">+static void
</a><a href="#h5-0-1068" id="h5-0-1068" class="i">+keypress(XEvent *e) {
</a><a href="#h5-0-1069" id="h5-0-1069" class="i">+	KEYS
</a><a href="#h5-0-1070" id="h5-0-1070" class="i">+	unsigned int len = sizeof keys / sizeof keys[0];
</a><a href="#h5-0-1071" id="h5-0-1071" class="i">+	unsigned int i;
</a><a href="#h5-0-1072" id="h5-0-1072" class="i">+	KeySym keysym;
</a><a href="#h5-0-1073" id="h5-0-1073" class="i">+	XKeyEvent *ev = &amp;e-&gt;xkey;
</a><a href="#h5-0-1074" id="h5-0-1074" class="i">+
</a><a href="#h5-0-1075" id="h5-0-1075" class="i">+	keysym = XKeycodeToKeysym(dpy, (KeyCode)ev-&gt;keycode, 0);
</a><a href="#h5-0-1076" id="h5-0-1076" class="i">+	for(i = 0; i &lt; len; i++)
</a><a href="#h5-0-1077" id="h5-0-1077" class="i">+		if(keysym == keys[i].keysym
</a><a href="#h5-0-1078" id="h5-0-1078" class="i">+		&amp;&amp; CLEANMASK(keys[i].mod) == CLEANMASK(ev-&gt;state))
</a><a href="#h5-0-1079" id="h5-0-1079" class="i">+		{
</a><a href="#h5-0-1080" id="h5-0-1080" class="i">+			if(keys[i].func)
</a><a href="#h5-0-1081" id="h5-0-1081" class="i">+				keys[i].func(keys[i].arg);
</a><a href="#h5-0-1082" id="h5-0-1082" class="i">+		}
</a><a href="#h5-0-1083" id="h5-0-1083" class="i">+}
</a><a href="#h5-0-1084" id="h5-0-1084" class="i">+
</a><a href="#h5-0-1085" id="h5-0-1085" class="i">+static void
</a><a href="#h5-0-1086" id="h5-0-1086" class="i">+leavenotify(XEvent *e) {
</a><a href="#h5-0-1087" id="h5-0-1087" class="i">+	XCrossingEvent *ev = &amp;e-&gt;xcrossing;
</a><a href="#h5-0-1088" id="h5-0-1088" class="i">+
</a><a href="#h5-0-1089" id="h5-0-1089" class="i">+	if((ev-&gt;window == root) &amp;&amp; !ev-&gt;same_screen) {
</a><a href="#h5-0-1090" id="h5-0-1090" class="i">+		selscreen = False;
</a><a href="#h5-0-1091" id="h5-0-1091" class="i">+		focus(NULL);
</a><a href="#h5-0-1092" id="h5-0-1092" class="i">+	}
</a><a href="#h5-0-1093" id="h5-0-1093" class="i">+}
</a><a href="#h5-0-1094" id="h5-0-1094" class="i">+
</a><a href="#h5-0-1095" id="h5-0-1095" class="i">+static void
</a><a href="#h5-0-1096" id="h5-0-1096" class="i">+mappingnotify(XEvent *e) {
</a><a href="#h5-0-1097" id="h5-0-1097" class="i">+	XMappingEvent *ev = &amp;e-&gt;xmapping;
</a><a href="#h5-0-1098" id="h5-0-1098" class="i">+
</a><a href="#h5-0-1099" id="h5-0-1099" class="i">+	XRefreshKeyboardMapping(ev);
</a><a href="#h5-0-1100" id="h5-0-1100" class="i">+	if(ev-&gt;request == MappingKeyboard)
</a><a href="#h5-0-1101" id="h5-0-1101" class="i">+		grabkeys();
</a><a href="#h5-0-1102" id="h5-0-1102" class="i">+}
</a><a href="#h5-0-1103" id="h5-0-1103" class="i">+
</a><a href="#h5-0-1104" id="h5-0-1104" class="i">+static void
</a><a href="#h5-0-1105" id="h5-0-1105" class="i">+maprequest(XEvent *e) {
</a><a href="#h5-0-1106" id="h5-0-1106" class="i">+	static XWindowAttributes wa;
</a><a href="#h5-0-1107" id="h5-0-1107" class="i">+	XMapRequestEvent *ev = &amp;e-&gt;xmaprequest;
</a><a href="#h5-0-1108" id="h5-0-1108" class="i">+
</a><a href="#h5-0-1109" id="h5-0-1109" class="i">+	if(!XGetWindowAttributes(dpy, ev-&gt;window, &amp;wa))
</a><a href="#h5-0-1110" id="h5-0-1110" class="i">+		return;
</a><a href="#h5-0-1111" id="h5-0-1111" class="i">+	if(wa.override_redirect)
</a><a href="#h5-0-1112" id="h5-0-1112" class="i">+		return;
</a><a href="#h5-0-1113" id="h5-0-1113" class="i">+	if(!getclient(ev-&gt;window))
</a><a href="#h5-0-1114" id="h5-0-1114" class="i">+		manage(ev-&gt;window, &amp;wa);
</a><a href="#h5-0-1115" id="h5-0-1115" class="i">+}
</a><a href="#h5-0-1116" id="h5-0-1116" class="i">+
</a><a href="#h5-0-1117" id="h5-0-1117" class="i">+static void
</a><a href="#h5-0-1118" id="h5-0-1118" class="i">+propertynotify(XEvent *e) {
</a><a href="#h5-0-1119" id="h5-0-1119" class="i">+	Client *c;
</a><a href="#h5-0-1120" id="h5-0-1120" class="i">+	Window trans;
</a><a href="#h5-0-1121" id="h5-0-1121" class="i">+	XPropertyEvent *ev = &amp;e-&gt;xproperty;
</a><a href="#h5-0-1122" id="h5-0-1122" class="i">+
</a><a href="#h5-0-1123" id="h5-0-1123" class="i">+	if(ev-&gt;state == PropertyDelete)
</a><a href="#h5-0-1124" id="h5-0-1124" class="i">+		return; /* ignore */
</a><a href="#h5-0-1125" id="h5-0-1125" class="i">+	if((c = getclient(ev-&gt;window))) {
</a><a href="#h5-0-1126" id="h5-0-1126" class="i">+		switch (ev-&gt;atom) {
</a><a href="#h5-0-1127" id="h5-0-1127" class="i">+			default: break;
</a><a href="#h5-0-1128" id="h5-0-1128" class="i">+			case XA_WM_TRANSIENT_FOR:
</a><a href="#h5-0-1129" id="h5-0-1129" class="i">+				XGetTransientForHint(dpy, c-&gt;win, &amp;trans);
</a><a href="#h5-0-1130" id="h5-0-1130" class="i">+				if(!c-&gt;isfloating &amp;&amp; (c-&gt;isfloating = (getclient(trans) != NULL)))
</a><a href="#h5-0-1131" id="h5-0-1131" class="i">+					arrange();
</a><a href="#h5-0-1132" id="h5-0-1132" class="i">+				break;
</a><a href="#h5-0-1133" id="h5-0-1133" class="i">+			case XA_WM_NORMAL_HINTS:
</a><a href="#h5-0-1134" id="h5-0-1134" class="i">+				updatesizehints(c);
</a><a href="#h5-0-1135" id="h5-0-1135" class="i">+				break;
</a><a href="#h5-0-1136" id="h5-0-1136" class="i">+		}
</a><a href="#h5-0-1137" id="h5-0-1137" class="i">+		if(ev-&gt;atom == XA_WM_NAME || ev-&gt;atom == netatom[NetWMName]) {
</a><a href="#h5-0-1138" id="h5-0-1138" class="i">+			updatetitle(c);
</a><a href="#h5-0-1139" id="h5-0-1139" class="i">+			if(c == sel)
</a><a href="#h5-0-1140" id="h5-0-1140" class="i">+				drawbar();
</a><a href="#h5-0-1141" id="h5-0-1141" class="i">+		}
</a><a href="#h5-0-1142" id="h5-0-1142" class="i">+	}
</a><a href="#h5-0-1143" id="h5-0-1143" class="i">+}
</a><a href="#h5-0-1144" id="h5-0-1144" class="i">+
</a><a href="#h5-0-1145" id="h5-0-1145" class="i">+static void
</a><a href="#h5-0-1146" id="h5-0-1146" class="i">+unmapnotify(XEvent *e) {
</a><a href="#h5-0-1147" id="h5-0-1147" class="i">+	Client *c;
</a><a href="#h5-0-1148" id="h5-0-1148" class="i">+	XUnmapEvent *ev = &amp;e-&gt;xunmap;
</a><a href="#h5-0-1149" id="h5-0-1149" class="i">+
</a><a href="#h5-0-1150" id="h5-0-1150" class="i">+	if((c = getclient(ev-&gt;window)))
</a><a href="#h5-0-1151" id="h5-0-1151" class="i">+		unmanage(c);
</a><a href="#h5-0-1152" id="h5-0-1152" class="i">+}
</a><a href="#h5-0-1153" id="h5-0-1153" class="i">+
</a><a href="#h5-0-1154" id="h5-0-1154" class="i">+static void
</a><a href="#h5-0-1155" id="h5-0-1155" class="i">+grabkeys(void) {
</a><a href="#h5-0-1156" id="h5-0-1156" class="i">+	KEYS
</a><a href="#h5-0-1157" id="h5-0-1157" class="i">+	unsigned int len = sizeof keys / sizeof keys[0];
</a><a href="#h5-0-1158" id="h5-0-1158" class="i">+	unsigned int i;
</a><a href="#h5-0-1159" id="h5-0-1159" class="i">+	KeyCode code;
</a><a href="#h5-0-1160" id="h5-0-1160" class="i">+
</a><a href="#h5-0-1161" id="h5-0-1161" class="i">+	XUngrabKey(dpy, AnyKey, AnyModifier, root);
</a><a href="#h5-0-1162" id="h5-0-1162" class="i">+	for(i = 0; i &lt; len; i++) {
</a><a href="#h5-0-1163" id="h5-0-1163" class="i">+		code = XKeysymToKeycode(dpy, keys[i].keysym);
</a><a href="#h5-0-1164" id="h5-0-1164" class="i">+		XGrabKey(dpy, code, keys[i].mod, root, True,
</a><a href="#h5-0-1165" id="h5-0-1165" class="i">+				GrabModeAsync, GrabModeAsync);
</a><a href="#h5-0-1166" id="h5-0-1166" class="i">+		XGrabKey(dpy, code, keys[i].mod | LockMask, root, True,
</a><a href="#h5-0-1167" id="h5-0-1167" class="i">+				GrabModeAsync, GrabModeAsync);
</a><a href="#h5-0-1168" id="h5-0-1168" class="i">+		XGrabKey(dpy, code, keys[i].mod | numlockmask, root, True,
</a><a href="#h5-0-1169" id="h5-0-1169" class="i">+				GrabModeAsync, GrabModeAsync);
</a><a href="#h5-0-1170" id="h5-0-1170" class="i">+		XGrabKey(dpy, code, keys[i].mod | numlockmask | LockMask, root, True,
</a><a href="#h5-0-1171" id="h5-0-1171" class="i">+				GrabModeAsync, GrabModeAsync);
</a><a href="#h5-0-1172" id="h5-0-1172" class="i">+	}
</a><a href="#h5-0-1173" id="h5-0-1173" class="i">+}
</a><a href="#h5-0-1174" id="h5-0-1174" class="i">+
</a><a href="#h5-0-1175" id="h5-0-1175" class="i">+static unsigned int
</a><a href="#h5-0-1176" id="h5-0-1176" class="i">+idxoftag(const char *tag) {
</a><a href="#h5-0-1177" id="h5-0-1177" class="i">+	unsigned int i;
</a><a href="#h5-0-1178" id="h5-0-1178" class="i">+
</a><a href="#h5-0-1179" id="h5-0-1179" class="i">+	for(i = 0; i &lt; ntags; i++)
</a><a href="#h5-0-1180" id="h5-0-1180" class="i">+		if(tags[i] == tag)
</a><a href="#h5-0-1181" id="h5-0-1181" class="i">+			return i;
</a><a href="#h5-0-1182" id="h5-0-1182" class="i">+	return 0;
</a><a href="#h5-0-1183" id="h5-0-1183" class="i">+}
</a><a href="#h5-0-1184" id="h5-0-1184" class="i">+
</a><a href="#h5-0-1185" id="h5-0-1185" class="i">+static void
</a><a href="#h5-0-1186" id="h5-0-1186" class="i">+floating(void) { /* default floating layout */
</a><a href="#h5-0-1187" id="h5-0-1187" class="i">+	Client *c;
</a><a href="#h5-0-1188" id="h5-0-1188" class="i">+
</a><a href="#h5-0-1189" id="h5-0-1189" class="i">+	for(c = clients; c; c = c-&gt;next)
</a><a href="#h5-0-1190" id="h5-0-1190" class="i">+		if(isvisible(c))
</a><a href="#h5-0-1191" id="h5-0-1191" class="i">+			resize(c, c-&gt;x, c-&gt;y, c-&gt;w, c-&gt;h, True);
</a><a href="#h5-0-1192" id="h5-0-1192" class="i">+}
</a><a href="#h5-0-1193" id="h5-0-1193" class="i">+
</a><a href="#h5-0-1194" id="h5-0-1194" class="i">+static void
</a><a href="#h5-0-1195" id="h5-0-1195" class="i">+applyrules(Client *c) {
</a><a href="#h5-0-1196" id="h5-0-1196" class="i">+	static char buf[512];
</a><a href="#h5-0-1197" id="h5-0-1197" class="i">+	unsigned int i, j;
</a><a href="#h5-0-1198" id="h5-0-1198" class="i">+	regmatch_t tmp;
</a><a href="#h5-0-1199" id="h5-0-1199" class="i">+	Bool matched = False;
</a><a href="#h5-0-1200" id="h5-0-1200" class="i">+	XClassHint ch = { 0 };
</a><a href="#h5-0-1201" id="h5-0-1201" class="i">+
</a><a href="#h5-0-1202" id="h5-0-1202" class="i">+	/* rule matching */
</a><a href="#h5-0-1203" id="h5-0-1203" class="i">+	XGetClassHint(dpy, c-&gt;win, &amp;ch);
</a><a href="#h5-0-1204" id="h5-0-1204" class="i">+	snprintf(buf, sizeof buf, &quot;%s:%s:%s&quot;,
</a><a href="#h5-0-1205" id="h5-0-1205" class="i">+			ch.res_class ? ch.res_class : &quot;&quot;,
</a><a href="#h5-0-1206" id="h5-0-1206" class="i">+			ch.res_name ? ch.res_name : &quot;&quot;, c-&gt;name);
</a><a href="#h5-0-1207" id="h5-0-1207" class="i">+	for(i = 0; i &lt; nrules; i++)
</a><a href="#h5-0-1208" id="h5-0-1208" class="i">+		if(regs[i].propregex &amp;&amp; !regexec(regs[i].propregex, buf, 1, &amp;tmp, 0)) {
</a><a href="#h5-0-1209" id="h5-0-1209" class="i">+			c-&gt;isfloating = rules[i].isfloating;
</a><a href="#h5-0-1210" id="h5-0-1210" class="i">+			for(j = 0; regs[i].tagregex &amp;&amp; j &lt; ntags; j++) {
</a><a href="#h5-0-1211" id="h5-0-1211" class="i">+				if(!regexec(regs[i].tagregex, tags[j], 1, &amp;tmp, 0)) {
</a><a href="#h5-0-1212" id="h5-0-1212" class="i">+					matched = True;
</a><a href="#h5-0-1213" id="h5-0-1213" class="i">+					c-&gt;tags[j] = True;
</a><a href="#h5-0-1214" id="h5-0-1214" class="i">+				}
</a><a href="#h5-0-1215" id="h5-0-1215" class="i">+			}
</a><a href="#h5-0-1216" id="h5-0-1216" class="i">+		}
</a><a href="#h5-0-1217" id="h5-0-1217" class="i">+	if(ch.res_class)
</a><a href="#h5-0-1218" id="h5-0-1218" class="i">+		XFree(ch.res_class);
</a><a href="#h5-0-1219" id="h5-0-1219" class="i">+	if(ch.res_name)
</a><a href="#h5-0-1220" id="h5-0-1220" class="i">+		XFree(ch.res_name);
</a><a href="#h5-0-1221" id="h5-0-1221" class="i">+	if(!matched)
</a><a href="#h5-0-1222" id="h5-0-1222" class="i">+		for(i = 0; i &lt; ntags; i++)
</a><a href="#h5-0-1223" id="h5-0-1223" class="i">+			c-&gt;tags[i] = seltags[i];
</a><a href="#h5-0-1224" id="h5-0-1224" class="i">+}
</a><a href="#h5-0-1225" id="h5-0-1225" class="i">+
</a><a href="#h5-0-1226" id="h5-0-1226" class="i">+static void
</a><a href="#h5-0-1227" id="h5-0-1227" class="i">+compileregs(void) {
</a><a href="#h5-0-1228" id="h5-0-1228" class="i">+	unsigned int i;
</a><a href="#h5-0-1229" id="h5-0-1229" class="i">+	regex_t *reg;
</a><a href="#h5-0-1230" id="h5-0-1230" class="i">+
</a><a href="#h5-0-1231" id="h5-0-1231" class="i">+	if(regs)
</a><a href="#h5-0-1232" id="h5-0-1232" class="i">+		return;
</a><a href="#h5-0-1233" id="h5-0-1233" class="i">+	nrules = sizeof rules / sizeof rules[0];
</a><a href="#h5-0-1234" id="h5-0-1234" class="i">+	regs = emallocz(nrules * sizeof(Regs));
</a><a href="#h5-0-1235" id="h5-0-1235" class="i">+	for(i = 0; i &lt; nrules; i++) {
</a><a href="#h5-0-1236" id="h5-0-1236" class="i">+		if(rules[i].prop) {
</a><a href="#h5-0-1237" id="h5-0-1237" class="i">+			reg = emallocz(sizeof(regex_t));
</a><a href="#h5-0-1238" id="h5-0-1238" class="i">+			if(regcomp(reg, rules[i].prop, REG_EXTENDED))
</a><a href="#h5-0-1239" id="h5-0-1239" class="i">+				free(reg);
</a><a href="#h5-0-1240" id="h5-0-1240" class="i">+			else
</a><a href="#h5-0-1241" id="h5-0-1241" class="i">+				regs[i].propregex = reg;
</a><a href="#h5-0-1242" id="h5-0-1242" class="i">+		}
</a><a href="#h5-0-1243" id="h5-0-1243" class="i">+		if(rules[i].tags) {
</a><a href="#h5-0-1244" id="h5-0-1244" class="i">+			reg = emallocz(sizeof(regex_t));
</a><a href="#h5-0-1245" id="h5-0-1245" class="i">+			if(regcomp(reg, rules[i].tags, REG_EXTENDED))
</a><a href="#h5-0-1246" id="h5-0-1246" class="i">+				free(reg);
</a><a href="#h5-0-1247" id="h5-0-1247" class="i">+			else
</a><a href="#h5-0-1248" id="h5-0-1248" class="i">+				regs[i].tagregex = reg;
</a><a href="#h5-0-1249" id="h5-0-1249" class="i">+		}
</a><a href="#h5-0-1250" id="h5-0-1250" class="i">+	}
</a><a href="#h5-0-1251" id="h5-0-1251" class="i">+}
</a><a href="#h5-0-1252" id="h5-0-1252" class="i">+
</a><a href="#h5-0-1253" id="h5-0-1253" class="i">+static void
</a><a href="#h5-0-1254" id="h5-0-1254" class="i">+focusnext(const char *arg) {
</a><a href="#h5-0-1255" id="h5-0-1255" class="i">+	Client *c;
</a><a href="#h5-0-1256" id="h5-0-1256" class="i">+
</a><a href="#h5-0-1257" id="h5-0-1257" class="i">+	if(!sel)
</a><a href="#h5-0-1258" id="h5-0-1258" class="i">+		return;
</a><a href="#h5-0-1259" id="h5-0-1259" class="i">+	for(c = sel-&gt;next; c &amp;&amp; !isvisible(c); c = c-&gt;next);
</a><a href="#h5-0-1260" id="h5-0-1260" class="i">+	if(!c)
</a><a href="#h5-0-1261" id="h5-0-1261" class="i">+		for(c = clients; c &amp;&amp; !isvisible(c); c = c-&gt;next);
</a><a href="#h5-0-1262" id="h5-0-1262" class="i">+	if(c) {
</a><a href="#h5-0-1263" id="h5-0-1263" class="i">+		focus(c);
</a><a href="#h5-0-1264" id="h5-0-1264" class="i">+		restack();
</a><a href="#h5-0-1265" id="h5-0-1265" class="i">+	}
</a><a href="#h5-0-1266" id="h5-0-1266" class="i">+}
</a><a href="#h5-0-1267" id="h5-0-1267" class="i">+
</a><a href="#h5-0-1268" id="h5-0-1268" class="i">+static void
</a><a href="#h5-0-1269" id="h5-0-1269" class="i">+focusprev(const char *arg) {
</a><a href="#h5-0-1270" id="h5-0-1270" class="i">+	Client *c;
</a><a href="#h5-0-1271" id="h5-0-1271" class="i">+
</a><a href="#h5-0-1272" id="h5-0-1272" class="i">+	if(!sel)
</a><a href="#h5-0-1273" id="h5-0-1273" class="i">+		return;
</a><a href="#h5-0-1274" id="h5-0-1274" class="i">+	for(c = sel-&gt;prev; c &amp;&amp; !isvisible(c); c = c-&gt;prev);
</a><a href="#h5-0-1275" id="h5-0-1275" class="i">+	if(!c) {
</a><a href="#h5-0-1276" id="h5-0-1276" class="i">+		for(c = clients; c &amp;&amp; c-&gt;next; c = c-&gt;next);
</a><a href="#h5-0-1277" id="h5-0-1277" class="i">+		for(; c &amp;&amp; !isvisible(c); c = c-&gt;prev);
</a><a href="#h5-0-1278" id="h5-0-1278" class="i">+	}
</a><a href="#h5-0-1279" id="h5-0-1279" class="i">+	if(c) {
</a><a href="#h5-0-1280" id="h5-0-1280" class="i">+		focus(c);
</a><a href="#h5-0-1281" id="h5-0-1281" class="i">+		restack();
</a><a href="#h5-0-1282" id="h5-0-1282" class="i">+	}
</a><a href="#h5-0-1283" id="h5-0-1283" class="i">+}
</a><a href="#h5-0-1284" id="h5-0-1284" class="i">+
</a><a href="#h5-0-1285" id="h5-0-1285" class="i">+static void
</a><a href="#h5-0-1286" id="h5-0-1286" class="i">+initlayouts(void) {
</a><a href="#h5-0-1287" id="h5-0-1287" class="i">+	unsigned int i, w;
</a><a href="#h5-0-1288" id="h5-0-1288" class="i">+
</a><a href="#h5-0-1289" id="h5-0-1289" class="i">+	nlayouts = sizeof layouts / sizeof layouts[0];
</a><a href="#h5-0-1290" id="h5-0-1290" class="i">+	for(blw = i = 0; i &lt; nlayouts; i++) {
</a><a href="#h5-0-1291" id="h5-0-1291" class="i">+		w = textw(layouts[i].symbol);
</a><a href="#h5-0-1292" id="h5-0-1292" class="i">+		if(w &gt; blw)
</a><a href="#h5-0-1293" id="h5-0-1293" class="i">+			blw = w;
</a><a href="#h5-0-1294" id="h5-0-1294" class="i">+	}
</a><a href="#h5-0-1295" id="h5-0-1295" class="i">+}
</a><a href="#h5-0-1296" id="h5-0-1296" class="i">+
</a><a href="#h5-0-1297" id="h5-0-1297" class="i">+static Bool
</a><a href="#h5-0-1298" id="h5-0-1298" class="i">+isfloating(void) {
</a><a href="#h5-0-1299" id="h5-0-1299" class="i">+	return layouts[ltidx].arrange == floating;
</a><a href="#h5-0-1300" id="h5-0-1300" class="i">+}
</a><a href="#h5-0-1301" id="h5-0-1301" class="i">+
</a><a href="#h5-0-1302" id="h5-0-1302" class="i">+static Bool
</a><a href="#h5-0-1303" id="h5-0-1303" class="i">+isvisible(Client *c) {
</a><a href="#h5-0-1304" id="h5-0-1304" class="i">+	unsigned int i;
</a><a href="#h5-0-1305" id="h5-0-1305" class="i">+
</a><a href="#h5-0-1306" id="h5-0-1306" class="i">+	for(i = 0; i &lt; ntags; i++)
</a><a href="#h5-0-1307" id="h5-0-1307" class="i">+		if(c-&gt;tags[i] &amp;&amp; seltags[i])
</a><a href="#h5-0-1308" id="h5-0-1308" class="i">+			return True;
</a><a href="#h5-0-1309" id="h5-0-1309" class="i">+	return False;
</a><a href="#h5-0-1310" id="h5-0-1310" class="i">+}
</a><a href="#h5-0-1311" id="h5-0-1311" class="i">+
</a><a href="#h5-0-1312" id="h5-0-1312" class="i">+static void
</a><a href="#h5-0-1313" id="h5-0-1313" class="i">+restack(void) {
</a><a href="#h5-0-1314" id="h5-0-1314" class="i">+	Client *c;
</a><a href="#h5-0-1315" id="h5-0-1315" class="i">+	XEvent ev;
</a><a href="#h5-0-1316" id="h5-0-1316" class="i">+	XWindowChanges wc;
</a><a href="#h5-0-1317" id="h5-0-1317" class="i">+
</a><a href="#h5-0-1318" id="h5-0-1318" class="i">+	drawbar();
</a><a href="#h5-0-1319" id="h5-0-1319" class="i">+	if(!sel)
</a><a href="#h5-0-1320" id="h5-0-1320" class="i">+		return;
</a><a href="#h5-0-1321" id="h5-0-1321" class="i">+	if(sel-&gt;isfloating || isfloating())
</a><a href="#h5-0-1322" id="h5-0-1322" class="i">+		XRaiseWindow(dpy, sel-&gt;win);
</a><a href="#h5-0-1323" id="h5-0-1323" class="i">+	if(!isfloating()) {
</a><a href="#h5-0-1324" id="h5-0-1324" class="i">+		wc.stack_mode = Below;
</a><a href="#h5-0-1325" id="h5-0-1325" class="i">+		wc.sibling = barwin;
</a><a href="#h5-0-1326" id="h5-0-1326" class="i">+		if(!sel-&gt;isfloating) {
</a><a href="#h5-0-1327" id="h5-0-1327" class="i">+			XConfigureWindow(dpy, sel-&gt;win, CWSibling | CWStackMode, &amp;wc);
</a><a href="#h5-0-1328" id="h5-0-1328" class="i">+			wc.sibling = sel-&gt;win;
</a><a href="#h5-0-1329" id="h5-0-1329" class="i">+		}
</a><a href="#h5-0-1330" id="h5-0-1330" class="i">+		for(c = nexttiled(clients); c; c = nexttiled(c-&gt;next)) {
</a><a href="#h5-0-1331" id="h5-0-1331" class="i">+			if(c == sel)
</a><a href="#h5-0-1332" id="h5-0-1332" class="i">+				continue;
</a><a href="#h5-0-1333" id="h5-0-1333" class="i">+			XConfigureWindow(dpy, c-&gt;win, CWSibling | CWStackMode, &amp;wc);
</a><a href="#h5-0-1334" id="h5-0-1334" class="i">+			wc.sibling = c-&gt;win;
</a><a href="#h5-0-1335" id="h5-0-1335" class="i">+		}
</a><a href="#h5-0-1336" id="h5-0-1336" class="i">+	}
</a><a href="#h5-0-1337" id="h5-0-1337" class="i">+	XSync(dpy, False);
</a><a href="#h5-0-1338" id="h5-0-1338" class="i">+	while(XCheckMaskEvent(dpy, EnterWindowMask, &amp;ev));
</a><a href="#h5-0-1339" id="h5-0-1339" class="i">+}
</a><a href="#h5-0-1340" id="h5-0-1340" class="i">+
</a><a href="#h5-0-1341" id="h5-0-1341" class="i">+static void
</a><a href="#h5-0-1342" id="h5-0-1342" class="i">+setlayout(const char *arg) {
</a><a href="#h5-0-1343" id="h5-0-1343" class="i">+	unsigned int i;
</a><a href="#h5-0-1344" id="h5-0-1344" class="i">+
</a><a href="#h5-0-1345" id="h5-0-1345" class="i">+	if(!arg) {
</a><a href="#h5-0-1346" id="h5-0-1346" class="i">+		if(++ltidx == nlayouts)
</a><a href="#h5-0-1347" id="h5-0-1347" class="i">+			ltidx = 0;;
</a><a href="#h5-0-1348" id="h5-0-1348" class="i">+	}
</a><a href="#h5-0-1349" id="h5-0-1349" class="i">+	else {
</a><a href="#h5-0-1350" id="h5-0-1350" class="i">+		for(i = 0; i &lt; nlayouts; i++)
</a><a href="#h5-0-1351" id="h5-0-1351" class="i">+			if(!strcmp(arg, layouts[i].symbol))
</a><a href="#h5-0-1352" id="h5-0-1352" class="i">+				break;
</a><a href="#h5-0-1353" id="h5-0-1353" class="i">+		if(i == nlayouts)
</a><a href="#h5-0-1354" id="h5-0-1354" class="i">+			return;
</a><a href="#h5-0-1355" id="h5-0-1355" class="i">+		ltidx = i;
</a><a href="#h5-0-1356" id="h5-0-1356" class="i">+	}
</a><a href="#h5-0-1357" id="h5-0-1357" class="i">+	if(sel)
</a><a href="#h5-0-1358" id="h5-0-1358" class="i">+		arrange();
</a><a href="#h5-0-1359" id="h5-0-1359" class="i">+	else
</a><a href="#h5-0-1360" id="h5-0-1360" class="i">+		drawbar();
</a><a href="#h5-0-1361" id="h5-0-1361" class="i">+}
</a><a href="#h5-0-1362" id="h5-0-1362" class="i">+
</a><a href="#h5-0-1363" id="h5-0-1363" class="i">+static void
</a><a href="#h5-0-1364" id="h5-0-1364" class="i">+tag(const char *arg) {
</a><a href="#h5-0-1365" id="h5-0-1365" class="i">+	unsigned int i;
</a><a href="#h5-0-1366" id="h5-0-1366" class="i">+
</a><a href="#h5-0-1367" id="h5-0-1367" class="i">+	if(!sel)
</a><a href="#h5-0-1368" id="h5-0-1368" class="i">+		return;
</a><a href="#h5-0-1369" id="h5-0-1369" class="i">+	for(i = 0; i &lt; ntags; i++)
</a><a href="#h5-0-1370" id="h5-0-1370" class="i">+		sel-&gt;tags[i] = arg == NULL;
</a><a href="#h5-0-1371" id="h5-0-1371" class="i">+	i = idxoftag(arg);
</a><a href="#h5-0-1372" id="h5-0-1372" class="i">+	if(i &gt;= 0 &amp;&amp; i &lt; ntags)
</a><a href="#h5-0-1373" id="h5-0-1373" class="i">+		sel-&gt;tags[i] = True;
</a><a href="#h5-0-1374" id="h5-0-1374" class="i">+	arrange();
</a><a href="#h5-0-1375" id="h5-0-1375" class="i">+}
</a><a href="#h5-0-1376" id="h5-0-1376" class="i">+
</a><a href="#h5-0-1377" id="h5-0-1377" class="i">+static void
</a><a href="#h5-0-1378" id="h5-0-1378" class="i">+togglefloating(const char *arg) {
</a><a href="#h5-0-1379" id="h5-0-1379" class="i">+	if(!sel)
</a><a href="#h5-0-1380" id="h5-0-1380" class="i">+		return;
</a><a href="#h5-0-1381" id="h5-0-1381" class="i">+	sel-&gt;isfloating = !sel-&gt;isfloating;
</a><a href="#h5-0-1382" id="h5-0-1382" class="i">+	if(sel-&gt;isfloating)
</a><a href="#h5-0-1383" id="h5-0-1383" class="i">+		resize(sel, sel-&gt;x, sel-&gt;y, sel-&gt;w, sel-&gt;h, True);
</a><a href="#h5-0-1384" id="h5-0-1384" class="i">+	arrange();
</a><a href="#h5-0-1385" id="h5-0-1385" class="i">+}
</a><a href="#h5-0-1386" id="h5-0-1386" class="i">+
</a><a href="#h5-0-1387" id="h5-0-1387" class="i">+static void
</a><a href="#h5-0-1388" id="h5-0-1388" class="i">+togglemax(const char *arg) {
</a><a href="#h5-0-1389" id="h5-0-1389" class="i">+	XEvent ev;
</a><a href="#h5-0-1390" id="h5-0-1390" class="i">+
</a><a href="#h5-0-1391" id="h5-0-1391" class="i">+	if(!sel || (!isfloating() &amp;&amp; !sel-&gt;isfloating) || sel-&gt;isfixed)
</a><a href="#h5-0-1392" id="h5-0-1392" class="i">+		return;
</a><a href="#h5-0-1393" id="h5-0-1393" class="i">+	if((sel-&gt;ismax = !sel-&gt;ismax)) {
</a><a href="#h5-0-1394" id="h5-0-1394" class="i">+		sel-&gt;rx = sel-&gt;x;
</a><a href="#h5-0-1395" id="h5-0-1395" class="i">+		sel-&gt;ry = sel-&gt;y;
</a><a href="#h5-0-1396" id="h5-0-1396" class="i">+		sel-&gt;rw = sel-&gt;w;
</a><a href="#h5-0-1397" id="h5-0-1397" class="i">+		sel-&gt;rh = sel-&gt;h;
</a><a href="#h5-0-1398" id="h5-0-1398" class="i">+		resize(sel, wax, way, waw - 2 * sel-&gt;border, wah - 2 * sel-&gt;border, True);
</a><a href="#h5-0-1399" id="h5-0-1399" class="i">+	}
</a><a href="#h5-0-1400" id="h5-0-1400" class="i">+	else
</a><a href="#h5-0-1401" id="h5-0-1401" class="i">+		resize(sel, sel-&gt;rx, sel-&gt;ry, sel-&gt;rw, sel-&gt;rh, True);
</a><a href="#h5-0-1402" id="h5-0-1402" class="i">+	drawbar();
</a><a href="#h5-0-1403" id="h5-0-1403" class="i">+	while(XCheckMaskEvent(dpy, EnterWindowMask, &amp;ev));
</a><a href="#h5-0-1404" id="h5-0-1404" class="i">+}
</a><a href="#h5-0-1405" id="h5-0-1405" class="i">+
</a><a href="#h5-0-1406" id="h5-0-1406" class="i">+static void
</a><a href="#h5-0-1407" id="h5-0-1407" class="i">+toggletag(const char *arg) {
</a><a href="#h5-0-1408" id="h5-0-1408" class="i">+	unsigned int i, j;
</a><a href="#h5-0-1409" id="h5-0-1409" class="i">+
</a><a href="#h5-0-1410" id="h5-0-1410" class="i">+	if(!sel)
</a><a href="#h5-0-1411" id="h5-0-1411" class="i">+		return;
</a><a href="#h5-0-1412" id="h5-0-1412" class="i">+	i = idxoftag(arg);
</a><a href="#h5-0-1413" id="h5-0-1413" class="i">+	sel-&gt;tags[i] = !sel-&gt;tags[i];
</a><a href="#h5-0-1414" id="h5-0-1414" class="i">+	for(j = 0; j &lt; ntags &amp;&amp; !sel-&gt;tags[j]; j++);
</a><a href="#h5-0-1415" id="h5-0-1415" class="i">+	if(j == ntags)
</a><a href="#h5-0-1416" id="h5-0-1416" class="i">+		sel-&gt;tags[i] = True;
</a><a href="#h5-0-1417" id="h5-0-1417" class="i">+	arrange();
</a><a href="#h5-0-1418" id="h5-0-1418" class="i">+}
</a><a href="#h5-0-1419" id="h5-0-1419" class="i">+
</a><a href="#h5-0-1420" id="h5-0-1420" class="i">+static void
</a><a href="#h5-0-1421" id="h5-0-1421" class="i">+toggleview(const char *arg) {
</a><a href="#h5-0-1422" id="h5-0-1422" class="i">+	unsigned int i, j;
</a><a href="#h5-0-1423" id="h5-0-1423" class="i">+
</a><a href="#h5-0-1424" id="h5-0-1424" class="i">+	i = idxoftag(arg);
</a><a href="#h5-0-1425" id="h5-0-1425" class="i">+	seltags[i] = !seltags[i];
</a><a href="#h5-0-1426" id="h5-0-1426" class="i">+	for(j = 0; j &lt; ntags &amp;&amp; !seltags[j]; j++);
</a><a href="#h5-0-1427" id="h5-0-1427" class="i">+	if(j == ntags)
</a><a href="#h5-0-1428" id="h5-0-1428" class="i">+		seltags[i] = True; /* cannot toggle last view */
</a><a href="#h5-0-1429" id="h5-0-1429" class="i">+	arrange();
</a><a href="#h5-0-1430" id="h5-0-1430" class="i">+}
</a><a href="#h5-0-1431" id="h5-0-1431" class="i">+
</a><a href="#h5-0-1432" id="h5-0-1432" class="i">+static void
</a><a href="#h5-0-1433" id="h5-0-1433" class="i">+view(const char *arg) {
</a><a href="#h5-0-1434" id="h5-0-1434" class="i">+	unsigned int i;
</a><a href="#h5-0-1435" id="h5-0-1435" class="i">+
</a><a href="#h5-0-1436" id="h5-0-1436" class="i">+	for(i = 0; i &lt; ntags; i++)
</a><a href="#h5-0-1437" id="h5-0-1437" class="i">+		seltags[i] = arg == NULL;
</a><a href="#h5-0-1438" id="h5-0-1438" class="i">+	i = idxoftag(arg);
</a><a href="#h5-0-1439" id="h5-0-1439" class="i">+	if(i &gt;= 0 &amp;&amp; i &lt; ntags)
</a><a href="#h5-0-1440" id="h5-0-1440" class="i">+		seltags[i] = True;
</a><a href="#h5-0-1441" id="h5-0-1441" class="i">+	arrange();
</a><a href="#h5-0-1442" id="h5-0-1442" class="i">+}
</a><a href="#h5-0-1443" id="h5-0-1443" class="i">+
</a><a href="#h5-0-1444" id="h5-0-1444" class="i">+static void
</a><a href="#h5-0-1445" id="h5-0-1445" class="i">+cleanup(void) {
</a><a href="#h5-0-1446" id="h5-0-1446" class="i">+	close(STDIN_FILENO);
</a><a href="#h5-0-1447" id="h5-0-1447" class="i">+	while(stack) {
</a><a href="#h5-0-1448" id="h5-0-1448" class="i">+		unban(stack);
</a><a href="#h5-0-1449" id="h5-0-1449" class="i">+		unmanage(stack);
</a><a href="#h5-0-1450" id="h5-0-1450" class="i">+	}
</a><a href="#h5-0-1451" id="h5-0-1451" class="i">+	if(dc.font.set)
</a><a href="#h5-0-1452" id="h5-0-1452" class="i">+		XFreeFontSet(dpy, dc.font.set);
</a><a href="#h5-0-1453" id="h5-0-1453" class="i">+	else
</a><a href="#h5-0-1454" id="h5-0-1454" class="i">+		XFreeFont(dpy, dc.font.xfont);
</a><a href="#h5-0-1455" id="h5-0-1455" class="i">+	XUngrabKey(dpy, AnyKey, AnyModifier, root);
</a><a href="#h5-0-1456" id="h5-0-1456" class="i">+	XFreePixmap(dpy, dc.drawable);
</a><a href="#h5-0-1457" id="h5-0-1457" class="i">+	XFreeGC(dpy, dc.gc);
</a><a href="#h5-0-1458" id="h5-0-1458" class="i">+	XDestroyWindow(dpy, barwin);
</a><a href="#h5-0-1459" id="h5-0-1459" class="i">+	XFreeCursor(dpy, cursor[CurNormal]);
</a><a href="#h5-0-1460" id="h5-0-1460" class="i">+	XFreeCursor(dpy, cursor[CurResize]);
</a><a href="#h5-0-1461" id="h5-0-1461" class="i">+	XFreeCursor(dpy, cursor[CurMove]);
</a><a href="#h5-0-1462" id="h5-0-1462" class="i">+	XSetInputFocus(dpy, PointerRoot, RevertToPointerRoot, CurrentTime);
</a><a href="#h5-0-1463" id="h5-0-1463" class="i">+	XSync(dpy, False);
</a><a href="#h5-0-1464" id="h5-0-1464" class="i">+	free(seltags);
</a><a href="#h5-0-1465" id="h5-0-1465" class="i">+}
</a><a href="#h5-0-1466" id="h5-0-1466" class="i">+
</a><a href="#h5-0-1467" id="h5-0-1467" class="i">+static long
</a><a href="#h5-0-1468" id="h5-0-1468" class="i">+getstate(Window w) {
</a><a href="#h5-0-1469" id="h5-0-1469" class="i">+	int format, status;
</a><a href="#h5-0-1470" id="h5-0-1470" class="i">+	long result = -1;
</a><a href="#h5-0-1471" id="h5-0-1471" class="i">+	unsigned char *p = NULL;
</a><a href="#h5-0-1472" id="h5-0-1472" class="i">+	unsigned long n, extra;
</a><a href="#h5-0-1473" id="h5-0-1473" class="i">+	Atom real;
</a><a href="#h5-0-1474" id="h5-0-1474" class="i">+
</a><a href="#h5-0-1475" id="h5-0-1475" class="i">+	status = XGetWindowProperty(dpy, w, wmatom[WMState], 0L, 2L, False, wmatom[WMState],
</a><a href="#h5-0-1476" id="h5-0-1476" class="i">+			&amp;real, &amp;format, &amp;n, &amp;extra, (unsigned char **)&amp;p);
</a><a href="#h5-0-1477" id="h5-0-1477" class="i">+	if(status != Success)
</a><a href="#h5-0-1478" id="h5-0-1478" class="i">+		return -1;
</a><a href="#h5-0-1479" id="h5-0-1479" class="i">+	if(n != 0)
</a><a href="#h5-0-1480" id="h5-0-1480" class="i">+		result = *p;
</a><a href="#h5-0-1481" id="h5-0-1481" class="i">+	XFree(p);
</a><a href="#h5-0-1482" id="h5-0-1482" class="i">+	return result;
</a><a href="#h5-0-1483" id="h5-0-1483" class="i">+}
</a><a href="#h5-0-1484" id="h5-0-1484" class="i">+
</a><a href="#h5-0-1485" id="h5-0-1485" class="i">+static void
</a><a href="#h5-0-1486" id="h5-0-1486" class="i">+scan(void) {
</a><a href="#h5-0-1487" id="h5-0-1487" class="i">+	unsigned int i, num;
</a><a href="#h5-0-1488" id="h5-0-1488" class="i">+	Window *wins, d1, d2;
</a><a href="#h5-0-1489" id="h5-0-1489" class="i">+	XWindowAttributes wa;
</a><a href="#h5-0-1490" id="h5-0-1490" class="i">+
</a><a href="#h5-0-1491" id="h5-0-1491" class="i">+	wins = NULL;
</a><a href="#h5-0-1492" id="h5-0-1492" class="i">+	if(XQueryTree(dpy, root, &amp;d1, &amp;d2, &amp;wins, &amp;num)) {
</a><a href="#h5-0-1493" id="h5-0-1493" class="i">+		for(i = 0; i &lt; num; i++) {
</a><a href="#h5-0-1494" id="h5-0-1494" class="i">+			if(!XGetWindowAttributes(dpy, wins[i], &amp;wa)
</a><a href="#h5-0-1495" id="h5-0-1495" class="i">+			|| wa.override_redirect || XGetTransientForHint(dpy, wins[i], &amp;d1))
</a><a href="#h5-0-1496" id="h5-0-1496" class="i">+				continue;
</a><a href="#h5-0-1497" id="h5-0-1497" class="i">+			if(wa.map_state == IsViewable || getstate(wins[i]) == IconicState)
</a><a href="#h5-0-1498" id="h5-0-1498" class="i">+				manage(wins[i], &amp;wa);
</a><a href="#h5-0-1499" id="h5-0-1499" class="i">+		}
</a><a href="#h5-0-1500" id="h5-0-1500" class="i">+		for(i = 0; i &lt; num; i++) { /* now the transients */
</a><a href="#h5-0-1501" id="h5-0-1501" class="i">+			if(!XGetWindowAttributes(dpy, wins[i], &amp;wa))
</a><a href="#h5-0-1502" id="h5-0-1502" class="i">+				continue;
</a><a href="#h5-0-1503" id="h5-0-1503" class="i">+			if(XGetTransientForHint(dpy, wins[i], &amp;d1)
</a><a href="#h5-0-1504" id="h5-0-1504" class="i">+			&amp;&amp; (wa.map_state == IsViewable || getstate(wins[i]) == IconicState))
</a><a href="#h5-0-1505" id="h5-0-1505" class="i">+				manage(wins[i], &amp;wa);
</a><a href="#h5-0-1506" id="h5-0-1506" class="i">+		}
</a><a href="#h5-0-1507" id="h5-0-1507" class="i">+	}
</a><a href="#h5-0-1508" id="h5-0-1508" class="i">+	if(wins)
</a><a href="#h5-0-1509" id="h5-0-1509" class="i">+		XFree(wins);
</a><a href="#h5-0-1510" id="h5-0-1510" class="i">+}
</a><a href="#h5-0-1511" id="h5-0-1511" class="i">+
</a><a href="#h5-0-1512" id="h5-0-1512" class="i">+static void
</a><a href="#h5-0-1513" id="h5-0-1513" class="i">+setup(void) {
</a><a href="#h5-0-1514" id="h5-0-1514" class="i">+	int i, j;
</a><a href="#h5-0-1515" id="h5-0-1515" class="i">+	unsigned int mask;
</a><a href="#h5-0-1516" id="h5-0-1516" class="i">+	Window w;
</a><a href="#h5-0-1517" id="h5-0-1517" class="i">+	XModifierKeymap *modmap;
</a><a href="#h5-0-1518" id="h5-0-1518" class="i">+	XSetWindowAttributes wa;
</a><a href="#h5-0-1519" id="h5-0-1519" class="i">+
</a><a href="#h5-0-1520" id="h5-0-1520" class="i">+	/* init atoms */
</a><a href="#h5-0-1521" id="h5-0-1521" class="i">+	wmatom[WMProtocols] = XInternAtom(dpy, &quot;WM_PROTOCOLS&quot;, False);
</a><a href="#h5-0-1522" id="h5-0-1522" class="i">+	wmatom[WMDelete] = XInternAtom(dpy, &quot;WM_DELETE_WINDOW&quot;, False);
</a><a href="#h5-0-1523" id="h5-0-1523" class="i">+	wmatom[WMName] = XInternAtom(dpy, &quot;WM_NAME&quot;, False);
</a><a href="#h5-0-1524" id="h5-0-1524" class="i">+	wmatom[WMState] = XInternAtom(dpy, &quot;WM_STATE&quot;, False);
</a><a href="#h5-0-1525" id="h5-0-1525" class="i">+	netatom[NetSupported] = XInternAtom(dpy, &quot;_NET_SUPPORTED&quot;, False);
</a><a href="#h5-0-1526" id="h5-0-1526" class="i">+	netatom[NetWMName] = XInternAtom(dpy, &quot;_NET_WM_NAME&quot;, False);
</a><a href="#h5-0-1527" id="h5-0-1527" class="i">+	XChangeProperty(dpy, root, netatom[NetSupported], XA_ATOM, 32,
</a><a href="#h5-0-1528" id="h5-0-1528" class="i">+			PropModeReplace, (unsigned char *) netatom, NetLast);
</a><a href="#h5-0-1529" id="h5-0-1529" class="i">+	/* init cursors */
</a><a href="#h5-0-1530" id="h5-0-1530" class="i">+	cursor[CurNormal] = XCreateFontCursor(dpy, XC_left_ptr);
</a><a href="#h5-0-1531" id="h5-0-1531" class="i">+	cursor[CurResize] = XCreateFontCursor(dpy, XC_sizing);
</a><a href="#h5-0-1532" id="h5-0-1532" class="i">+	cursor[CurMove] = XCreateFontCursor(dpy, XC_fleur);
</a><a href="#h5-0-1533" id="h5-0-1533" class="i">+	/* init modifier map */
</a><a href="#h5-0-1534" id="h5-0-1534" class="i">+	modmap = XGetModifierMapping(dpy);
</a><a href="#h5-0-1535" id="h5-0-1535" class="i">+	for (i = 0; i &lt; 8; i++)
</a><a href="#h5-0-1536" id="h5-0-1536" class="i">+		for (j = 0; j &lt; modmap-&gt;max_keypermod; j++) {
</a><a href="#h5-0-1537" id="h5-0-1537" class="i">+			if(modmap-&gt;modifiermap[i * modmap-&gt;max_keypermod + j]
</a><a href="#h5-0-1538" id="h5-0-1538" class="i">+					== XKeysymToKeycode(dpy, XK_Num_Lock))
</a><a href="#h5-0-1539" id="h5-0-1539" class="i">+				numlockmask = (1 &lt;&lt; i);
</a><a href="#h5-0-1540" id="h5-0-1540" class="i">+		}
</a><a href="#h5-0-1541" id="h5-0-1541" class="i">+	XFreeModifiermap(modmap);
</a><a href="#h5-0-1542" id="h5-0-1542" class="i">+	/* select for events */
</a><a href="#h5-0-1543" id="h5-0-1543" class="i">+	wa.event_mask = SubstructureRedirectMask | SubstructureNotifyMask
</a><a href="#h5-0-1544" id="h5-0-1544" class="i">+		| EnterWindowMask | LeaveWindowMask | StructureNotifyMask;
</a><a href="#h5-0-1545" id="h5-0-1545" class="i">+	wa.cursor = cursor[CurNormal];
</a><a href="#h5-0-1546" id="h5-0-1546" class="i">+	XChangeWindowAttributes(dpy, root, CWEventMask | CWCursor, &amp;wa);
</a><a href="#h5-0-1547" id="h5-0-1547" class="i">+	XSelectInput(dpy, root, wa.event_mask);
</a><a href="#h5-0-1548" id="h5-0-1548" class="i">+	grabkeys();
</a><a href="#h5-0-1549" id="h5-0-1549" class="i">+	compileregs();
</a><a href="#h5-0-1550" id="h5-0-1550" class="i">+	for(ntags = 0; tags[ntags]; ntags++);
</a><a href="#h5-0-1551" id="h5-0-1551" class="i">+	seltags = emallocz(sizeof(Bool) * ntags);
</a><a href="#h5-0-1552" id="h5-0-1552" class="i">+	seltags[0] = True;
</a><a href="#h5-0-1553" id="h5-0-1553" class="i">+	/* geometry */
</a><a href="#h5-0-1554" id="h5-0-1554" class="i">+	sx = sy = 0;
</a><a href="#h5-0-1555" id="h5-0-1555" class="i">+	sw = DisplayWidth(dpy, screen);
</a><a href="#h5-0-1556" id="h5-0-1556" class="i">+	sh = DisplayHeight(dpy, screen);
</a><a href="#h5-0-1557" id="h5-0-1557" class="i">+	initstyle();
</a><a href="#h5-0-1558" id="h5-0-1558" class="i">+	initlayouts();
</a><a href="#h5-0-1559" id="h5-0-1559" class="i">+	initbar();
</a><a href="#h5-0-1560" id="h5-0-1560" class="i">+	/* multihead support */
</a><a href="#h5-0-1561" id="h5-0-1561" class="i">+	selscreen = XQueryPointer(dpy, root, &amp;w, &amp;w, &amp;i, &amp;i, &amp;i, &amp;i, &amp;mask);
</a><a href="#h5-0-1562" id="h5-0-1562" class="i">+}
</a><a href="#h5-0-1563" id="h5-0-1563" class="i">+
</a><a href="#h5-0-1564" id="h5-0-1564" class="i">+/*
</a><a href="#h5-0-1565" id="h5-0-1565" class="i">+ * Startup Error handler to check if another window manager
</a><a href="#h5-0-1566" id="h5-0-1566" class="i">+ * is already running.
</a><a href="#h5-0-1567" id="h5-0-1567" class="i">+ */
</a><a href="#h5-0-1568" id="h5-0-1568" class="i">+static int
</a><a href="#h5-0-1569" id="h5-0-1569" class="i">+xerrorstart(Display *dsply, XErrorEvent *ee) {
</a><a href="#h5-0-1570" id="h5-0-1570" class="i">+	otherwm = True;
</a><a href="#h5-0-1571" id="h5-0-1571" class="i">+	return -1;
</a><a href="#h5-0-1572" id="h5-0-1572" class="i">+}
</a><a href="#h5-0-1573" id="h5-0-1573" class="i">+
</a><a href="#h5-0-1574" id="h5-0-1574" class="i">+static Bool
</a><a href="#h5-0-1575" id="h5-0-1575" class="i">+gettextprop(Window w, Atom atom, char *text, unsigned int size) {
</a><a href="#h5-0-1576" id="h5-0-1576" class="i">+	char **list = NULL;
</a><a href="#h5-0-1577" id="h5-0-1577" class="i">+	int n;
</a><a href="#h5-0-1578" id="h5-0-1578" class="i">+	XTextProperty name;
</a><a href="#h5-0-1579" id="h5-0-1579" class="i">+
</a><a href="#h5-0-1580" id="h5-0-1580" class="i">+	if(!text || size == 0)
</a><a href="#h5-0-1581" id="h5-0-1581" class="i">+		return False;
</a><a href="#h5-0-1582" id="h5-0-1582" class="i">+	text[0] = &#39;\0&#39;;
</a><a href="#h5-0-1583" id="h5-0-1583" class="i">+	XGetTextProperty(dpy, w, &amp;name, atom);
</a><a href="#h5-0-1584" id="h5-0-1584" class="i">+	if(!name.nitems)
</a><a href="#h5-0-1585" id="h5-0-1585" class="i">+		return False;
</a><a href="#h5-0-1586" id="h5-0-1586" class="i">+	if(name.encoding == XA_STRING)
</a><a href="#h5-0-1587" id="h5-0-1587" class="i">+		strncpy(text, (char *)name.value, size - 1);
</a><a href="#h5-0-1588" id="h5-0-1588" class="i">+	else {
</a><a href="#h5-0-1589" id="h5-0-1589" class="i">+		if(XmbTextPropertyToTextList(dpy, &amp;name, &amp;list, &amp;n) &gt;= Success
</a><a href="#h5-0-1590" id="h5-0-1590" class="i">+		&amp;&amp; n &gt; 0 &amp;&amp; *list)
</a><a href="#h5-0-1591" id="h5-0-1591" class="i">+		{
</a><a href="#h5-0-1592" id="h5-0-1592" class="i">+			strncpy(text, *list, size - 1);
</a><a href="#h5-0-1593" id="h5-0-1593" class="i">+			XFreeStringList(list);
</a><a href="#h5-0-1594" id="h5-0-1594" class="i">+		}
</a><a href="#h5-0-1595" id="h5-0-1595" class="i">+	}
</a><a href="#h5-0-1596" id="h5-0-1596" class="i">+	text[size - 1] = &#39;\0&#39;;
</a><a href="#h5-0-1597" id="h5-0-1597" class="i">+	XFree(name.value);
</a><a href="#h5-0-1598" id="h5-0-1598" class="i">+	return True;
</a><a href="#h5-0-1599" id="h5-0-1599" class="i">+}
</a><a href="#h5-0-1600" id="h5-0-1600" class="i">+
</a><a href="#h5-0-1601" id="h5-0-1601" class="i">+static void
</a><a href="#h5-0-1602" id="h5-0-1602" class="i">+quit(const char *arg) {
</a><a href="#h5-0-1603" id="h5-0-1603" class="i">+	readin = running = False;
</a><a href="#h5-0-1604" id="h5-0-1604" class="i">+}
</a><a href="#h5-0-1605" id="h5-0-1605" class="i">+
</a><a href="#h5-0-1606" id="h5-0-1606" class="i">+/* There&#39;s no way to check accesses to destroyed windows, thus those cases are
</a><a href="#h5-0-1607" id="h5-0-1607" class="i">+ * ignored (especially on UnmapNotify&#39;s).  Other types of errors call Xlibs
</a><a href="#h5-0-1608" id="h5-0-1608" class="i">+ * default error handler, which may call exit.
</a><a href="#h5-0-1609" id="h5-0-1609" class="i">+ */
</a><a href="#h5-0-1610" id="h5-0-1610" class="i">+static int
</a><a href="#h5-0-1611" id="h5-0-1611" class="i">+xerror(Display *dpy, XErrorEvent *ee) {
</a><a href="#h5-0-1612" id="h5-0-1612" class="i">+	if(ee-&gt;error_code == BadWindow
</a><a href="#h5-0-1613" id="h5-0-1613" class="i">+	|| (ee-&gt;request_code == X_SetInputFocus &amp;&amp; ee-&gt;error_code == BadMatch)
</a><a href="#h5-0-1614" id="h5-0-1614" class="i">+	|| (ee-&gt;request_code == X_PolyText8 &amp;&amp; ee-&gt;error_code == BadDrawable)
</a><a href="#h5-0-1615" id="h5-0-1615" class="i">+	|| (ee-&gt;request_code == X_PolyFillRectangle &amp;&amp; ee-&gt;error_code == BadDrawable)
</a><a href="#h5-0-1616" id="h5-0-1616" class="i">+	|| (ee-&gt;request_code == X_PolySegment &amp;&amp; ee-&gt;error_code == BadDrawable)
</a><a href="#h5-0-1617" id="h5-0-1617" class="i">+	|| (ee-&gt;request_code == X_ConfigureWindow &amp;&amp; ee-&gt;error_code == BadMatch)
</a><a href="#h5-0-1618" id="h5-0-1618" class="i">+	|| (ee-&gt;request_code == X_GrabKey &amp;&amp; ee-&gt;error_code == BadAccess)
</a><a href="#h5-0-1619" id="h5-0-1619" class="i">+	|| (ee-&gt;request_code == X_CopyArea &amp;&amp; ee-&gt;error_code == BadDrawable))
</a><a href="#h5-0-1620" id="h5-0-1620" class="i">+		return 0;
</a><a href="#h5-0-1621" id="h5-0-1621" class="i">+	fprintf(stderr, &quot;dwm: fatal error: request code=%d, error code=%d\n&quot;,
</a><a href="#h5-0-1622" id="h5-0-1622" class="i">+		ee-&gt;request_code, ee-&gt;error_code);
</a><a href="#h5-0-1623" id="h5-0-1623" class="i">+	return xerrorxlib(dpy, ee); /* may call exit */
</a><a href="#h5-0-1624" id="h5-0-1624" class="i">+}
</a><a href="#h5-0-1625" id="h5-0-1625" class="i">+
</a><a href="#h5-0-1626" id="h5-0-1626" class="i">+static void
</a><a href="#h5-0-1627" id="h5-0-1627" class="i">+arrange(void) {
</a><a href="#h5-0-1628" id="h5-0-1628" class="i">+	Client *c;
</a><a href="#h5-0-1629" id="h5-0-1629" class="i">+
</a><a href="#h5-0-1630" id="h5-0-1630" class="i">+	for(c = clients; c; c = c-&gt;next)
</a><a href="#h5-0-1631" id="h5-0-1631" class="i">+		if(isvisible(c))
</a><a href="#h5-0-1632" id="h5-0-1632" class="i">+			unban(c);
</a><a href="#h5-0-1633" id="h5-0-1633" class="i">+		else
</a><a href="#h5-0-1634" id="h5-0-1634" class="i">+			ban(c);
</a><a href="#h5-0-1635" id="h5-0-1635" class="i">+	layouts[ltidx].arrange();
</a><a href="#h5-0-1636" id="h5-0-1636" class="i">+	focus(NULL);
</a><a href="#h5-0-1637" id="h5-0-1637" class="i">+	restack();
</a><a href="#h5-0-1638" id="h5-0-1638" class="i">+}
</a><a href="#h5-0-1639" id="h5-0-1639" class="i">+
</a><a href="#h5-0-1640" id="h5-0-1640" class="i">+static void
</a><a href="#h5-0-1641" id="h5-0-1641" class="i">+attach(Client *c) {
</a><a href="#h5-0-1642" id="h5-0-1642" class="i">+	if(clients)
</a><a href="#h5-0-1643" id="h5-0-1643" class="i">+		clients-&gt;prev = c;
</a><a href="#h5-0-1644" id="h5-0-1644" class="i">+	c-&gt;next = clients;
</a><a href="#h5-0-1645" id="h5-0-1645" class="i">+	clients = c;
</a><a href="#h5-0-1646" id="h5-0-1646" class="i">+}
</a><a href="#h5-0-1647" id="h5-0-1647" class="i">+
</a><a href="#h5-0-1648" id="h5-0-1648" class="i">+static void
</a><a href="#h5-0-1649" id="h5-0-1649" class="i">+detach(Client *c) {
</a><a href="#h5-0-1650" id="h5-0-1650" class="i">+	if(c-&gt;prev)
</a><a href="#h5-0-1651" id="h5-0-1651" class="i">+		c-&gt;prev-&gt;next = c-&gt;next;
</a><a href="#h5-0-1652" id="h5-0-1652" class="i">+	if(c-&gt;next)
</a><a href="#h5-0-1653" id="h5-0-1653" class="i">+		c-&gt;next-&gt;prev = c-&gt;prev;
</a><a href="#h5-0-1654" id="h5-0-1654" class="i">+	if(c == clients)
</a><a href="#h5-0-1655" id="h5-0-1655" class="i">+		clients = c-&gt;next;
</a><a href="#h5-0-1656" id="h5-0-1656" class="i">+	c-&gt;next = c-&gt;prev = NULL;
</a><a href="#h5-0-1657" id="h5-0-1657" class="i">+}
</a><a href="#h5-0-1658" id="h5-0-1658" class="i">+
</a><a href="#h5-0-1659" id="h5-0-1659" class="i">+static void
</a><a href="#h5-0-1660" id="h5-0-1660" class="i">+focus(Client *c) {
</a><a href="#h5-0-1661" id="h5-0-1661" class="i">+	if((!c &amp;&amp; selscreen) || (c &amp;&amp; !isvisible(c)))
</a><a href="#h5-0-1662" id="h5-0-1662" class="i">+		for(c = stack; c &amp;&amp; !isvisible(c); c = c-&gt;snext);
</a><a href="#h5-0-1663" id="h5-0-1663" class="i">+	if(sel &amp;&amp; sel != c) {
</a><a href="#h5-0-1664" id="h5-0-1664" class="i">+		grabbuttons(sel, False);
</a><a href="#h5-0-1665" id="h5-0-1665" class="i">+		XSetWindowBorder(dpy, sel-&gt;win, dc.norm[ColBorder]);
</a><a href="#h5-0-1666" id="h5-0-1666" class="i">+	}
</a><a href="#h5-0-1667" id="h5-0-1667" class="i">+	if(c) {
</a><a href="#h5-0-1668" id="h5-0-1668" class="i">+		detachstack(c);
</a><a href="#h5-0-1669" id="h5-0-1669" class="i">+		attachstack(c);
</a><a href="#h5-0-1670" id="h5-0-1670" class="i">+		grabbuttons(c, True);
</a><a href="#h5-0-1671" id="h5-0-1671" class="i">+	}
</a><a href="#h5-0-1672" id="h5-0-1672" class="i">+	sel = c;
</a><a href="#h5-0-1673" id="h5-0-1673" class="i">+	drawbar();
</a><a href="#h5-0-1674" id="h5-0-1674" class="i">+	if(!selscreen)
</a><a href="#h5-0-1675" id="h5-0-1675" class="i">+		return;
</a><a href="#h5-0-1676" id="h5-0-1676" class="i">+	if(c) {
</a><a href="#h5-0-1677" id="h5-0-1677" class="i">+		XSetWindowBorder(dpy, c-&gt;win, dc.sel[ColBorder]);
</a><a href="#h5-0-1678" id="h5-0-1678" class="i">+		XSetInputFocus(dpy, c-&gt;win, RevertToPointerRoot, CurrentTime);
</a><a href="#h5-0-1679" id="h5-0-1679" class="i">+	}
</a><a href="#h5-0-1680" id="h5-0-1680" class="i">+	else
</a><a href="#h5-0-1681" id="h5-0-1681" class="i">+		XSetInputFocus(dpy, root, RevertToPointerRoot, CurrentTime);
</a><a href="#h5-0-1682" id="h5-0-1682" class="i">+}
</a><a href="#h5-0-1683" id="h5-0-1683" class="i">+
</a><a href="#h5-0-1684" id="h5-0-1684" class="i">+static Bool
</a><a href="#h5-0-1685" id="h5-0-1685" class="i">+isarrange(void (*func)())
</a><a href="#h5-0-1686" id="h5-0-1686" class="i">+{
</a><a href="#h5-0-1687" id="h5-0-1687" class="i">+	return func == layouts[ltidx].arrange;
</a><a href="#h5-0-1688" id="h5-0-1688" class="i">+}
</a><a href="#h5-0-1689" id="h5-0-1689" class="i">+
</a><a href="#h5-0-1690" id="h5-0-1690" class="i">+static Client *
</a><a href="#h5-0-1691" id="h5-0-1691" class="i">+nexttiled(Client *c) {
</a><a href="#h5-0-1692" id="h5-0-1692" class="i">+	for(; c &amp;&amp; (c-&gt;isfloating || !isvisible(c)); c = c-&gt;next);
</a><a href="#h5-0-1693" id="h5-0-1693" class="i">+	return c;
</a><a href="#h5-0-1694" id="h5-0-1694" class="i">+}
</a><a href="#h5-0-1695" id="h5-0-1695" class="i">+
</a><a href="#h5-0-1696" id="h5-0-1696" class="i">+static void
</a><a href="#h5-0-1697" id="h5-0-1697" class="i">+setmwfact(const char *arg) {
</a><a href="#h5-0-1698" id="h5-0-1698" class="i">+	double delta;
</a><a href="#h5-0-1699" id="h5-0-1699" class="i">+
</a><a href="#h5-0-1700" id="h5-0-1700" class="i">+	if(!isarrange(tile))
</a><a href="#h5-0-1701" id="h5-0-1701" class="i">+		return;
</a><a href="#h5-0-1702" id="h5-0-1702" class="i">+	/* arg handling, manipulate mwfact */
</a><a href="#h5-0-1703" id="h5-0-1703" class="i">+	if(arg == NULL)
</a><a href="#h5-0-1704" id="h5-0-1704" class="i">+		mwfact = MWFACT;
</a><a href="#h5-0-1705" id="h5-0-1705" class="i">+	else if(1 == sscanf(arg, &quot;%lf&quot;, &amp;delta)) {
</a><a href="#h5-0-1706" id="h5-0-1706" class="i">+		if(arg[0] != &#39;+&#39; &amp;&amp; arg[0] != &#39;-&#39;)
</a><a href="#h5-0-1707" id="h5-0-1707" class="i">+			mwfact = delta;
</a><a href="#h5-0-1708" id="h5-0-1708" class="i">+		else
</a><a href="#h5-0-1709" id="h5-0-1709" class="i">+			mwfact += delta;
</a><a href="#h5-0-1710" id="h5-0-1710" class="i">+		if(mwfact &lt; 0.1)
</a><a href="#h5-0-1711" id="h5-0-1711" class="i">+			mwfact = 0.1;
</a><a href="#h5-0-1712" id="h5-0-1712" class="i">+		else if(mwfact &gt; 0.9)
</a><a href="#h5-0-1713" id="h5-0-1713" class="i">+			mwfact = 0.9;
</a><a href="#h5-0-1714" id="h5-0-1714" class="i">+	}
</a><a href="#h5-0-1715" id="h5-0-1715" class="i">+	arrange();
</a><a href="#h5-0-1716" id="h5-0-1716" class="i">+}
</a><a href="#h5-0-1717" id="h5-0-1717" class="i">+
</a><a href="#h5-0-1718" id="h5-0-1718" class="i">+static void
</a><a href="#h5-0-1719" id="h5-0-1719" class="i">+tile(void) {
</a><a href="#h5-0-1720" id="h5-0-1720" class="i">+	unsigned int i, n, nx, ny, nw, nh, mw, th;
</a><a href="#h5-0-1721" id="h5-0-1721" class="i">+	Client *c;
</a><a href="#h5-0-1722" id="h5-0-1722" class="i">+
</a><a href="#h5-0-1723" id="h5-0-1723" class="i">+	for(n = 0, c = nexttiled(clients); c; c = nexttiled(c-&gt;next))
</a><a href="#h5-0-1724" id="h5-0-1724" class="i">+		n++;
</a><a href="#h5-0-1725" id="h5-0-1725" class="i">+
</a><a href="#h5-0-1726" id="h5-0-1726" class="i">+	/* window geoms */
</a><a href="#h5-0-1727" id="h5-0-1727" class="i">+	mw = (n == 1) ? waw : mwfact * waw;
</a><a href="#h5-0-1728" id="h5-0-1728" class="i">+	th = (n &gt; 1) ? wah / (n - 1) : 0;
</a><a href="#h5-0-1729" id="h5-0-1729" class="i">+	if(n &gt; 1 &amp;&amp; th &lt; bh)
</a><a href="#h5-0-1730" id="h5-0-1730" class="i">+		th = wah;
</a><a href="#h5-0-1731" id="h5-0-1731" class="i">+
</a><a href="#h5-0-1732" id="h5-0-1732" class="i">+	nx = wax;
</a><a href="#h5-0-1733" id="h5-0-1733" class="i">+	ny = way;
</a><a href="#h5-0-1734" id="h5-0-1734" class="i">+	for(i = 0, c = nexttiled(clients); c; c = nexttiled(c-&gt;next), i++) {
</a><a href="#h5-0-1735" id="h5-0-1735" class="i">+		c-&gt;ismax = False;
</a><a href="#h5-0-1736" id="h5-0-1736" class="i">+		if(i == 0) { /* master */
</a><a href="#h5-0-1737" id="h5-0-1737" class="i">+			nw = mw - 2 * c-&gt;border;
</a><a href="#h5-0-1738" id="h5-0-1738" class="i">+			nh = wah - 2 * c-&gt;border;
</a><a href="#h5-0-1739" id="h5-0-1739" class="i">+		}
</a><a href="#h5-0-1740" id="h5-0-1740" class="i">+		else {  /* tile window */
</a><a href="#h5-0-1741" id="h5-0-1741" class="i">+			if(i == 1) {
</a><a href="#h5-0-1742" id="h5-0-1742" class="i">+				ny = way;
</a><a href="#h5-0-1743" id="h5-0-1743" class="i">+				nx += mw;
</a><a href="#h5-0-1744" id="h5-0-1744" class="i">+			}
</a><a href="#h5-0-1745" id="h5-0-1745" class="i">+			nw = waw - mw - 2 * c-&gt;border;
</a><a href="#h5-0-1746" id="h5-0-1746" class="i">+			if(i + 1 == n) /* remainder */
</a><a href="#h5-0-1747" id="h5-0-1747" class="i">+				nh = (way + wah) - ny - 2 * c-&gt;border;
</a><a href="#h5-0-1748" id="h5-0-1748" class="i">+			else
</a><a href="#h5-0-1749" id="h5-0-1749" class="i">+				nh = th - 2 * c-&gt;border;
</a><a href="#h5-0-1750" id="h5-0-1750" class="i">+		}
</a><a href="#h5-0-1751" id="h5-0-1751" class="i">+		resize(c, nx, ny, nw, nh, RESIZEHINTS);
</a><a href="#h5-0-1752" id="h5-0-1752" class="i">+		if(n &gt; 1 &amp;&amp; th != wah)
</a><a href="#h5-0-1753" id="h5-0-1753" class="i">+			ny += nh + 2 * c-&gt;border;
</a><a href="#h5-0-1754" id="h5-0-1754" class="i">+	}
</a><a href="#h5-0-1755" id="h5-0-1755" class="i">+}
</a><a href="#h5-0-1756" id="h5-0-1756" class="i">+
</a><a href="#h5-0-1757" id="h5-0-1757" class="i">+static void
</a><a href="#h5-0-1758" id="h5-0-1758" class="i">+zoom(const char *arg) {
</a><a href="#h5-0-1759" id="h5-0-1759" class="i">+	Client *c;
</a><a href="#h5-0-1760" id="h5-0-1760" class="i">+
</a><a href="#h5-0-1761" id="h5-0-1761" class="i">+	if(!sel || !isarrange(tile) || sel-&gt;isfloating)
</a><a href="#h5-0-1762" id="h5-0-1762" class="i">+		return;
</a><a href="#h5-0-1763" id="h5-0-1763" class="i">+	if((c = sel) == nexttiled(clients))
</a><a href="#h5-0-1764" id="h5-0-1764" class="i">+		if(!(c = nexttiled(c-&gt;next)))
</a><a href="#h5-0-1765" id="h5-0-1765" class="i">+			return;
</a><a href="#h5-0-1766" id="h5-0-1766" class="i">+	detach(c);
</a><a href="#h5-0-1767" id="h5-0-1767" class="i">+	attach(c);
</a><a href="#h5-0-1768" id="h5-0-1768" class="i">+	focus(c);
</a><a href="#h5-0-1769" id="h5-0-1769" class="i">+	arrange();
</a><a href="#h5-0-1770" id="h5-0-1770" class="i">+}
</a><a href="#h5-0-1771" id="h5-0-1771" class="i">+
</a><a href="#h5-0-1772" id="h5-0-1772" class="i">+int
</a><a href="#h5-0-1773" id="h5-0-1773" class="i">+main(int argc, char *argv[]) {
</a><a href="#h5-0-1774" id="h5-0-1774" class="i">+	char *p;
</a><a href="#h5-0-1775" id="h5-0-1775" class="i">+	int r, xfd;
</a><a href="#h5-0-1776" id="h5-0-1776" class="i">+	fd_set rd;
</a><a href="#h5-0-1777" id="h5-0-1777" class="i">+	XEvent ev;
</a><a href="#h5-0-1778" id="h5-0-1778" class="i">+
</a><a href="#h5-0-1779" id="h5-0-1779" class="i">+	if(argc == 2 &amp;&amp; !strcmp(&quot;-v&quot;, argv[1]))
</a><a href="#h5-0-1780" id="h5-0-1780" class="i">+		eprint(&quot;dwm-&quot;VERSION&quot;, © 2006-2007 A. R. Garbe, S. van Dijk, J. Salmi, P. Hruby, S. Nagy\n&quot;);
</a><a href="#h5-0-1781" id="h5-0-1781" class="i">+	else if(argc != 1)
</a><a href="#h5-0-1782" id="h5-0-1782" class="i">+		eprint(&quot;usage: dwm [-v]\n&quot;);
</a><a href="#h5-0-1783" id="h5-0-1783" class="i">+	setlocale(LC_CTYPE, &quot;&quot;);
</a><a href="#h5-0-1784" id="h5-0-1784" class="i">+	if(!(dpy = XOpenDisplay(0)))
</a><a href="#h5-0-1785" id="h5-0-1785" class="i">+		eprint(&quot;dwm: cannot open display\n&quot;);
</a><a href="#h5-0-1786" id="h5-0-1786" class="i">+	xfd = ConnectionNumber(dpy);
</a><a href="#h5-0-1787" id="h5-0-1787" class="i">+	screen = DefaultScreen(dpy);
</a><a href="#h5-0-1788" id="h5-0-1788" class="i">+	root = RootWindow(dpy, screen);
</a><a href="#h5-0-1789" id="h5-0-1789" class="i">+	otherwm = False;
</a><a href="#h5-0-1790" id="h5-0-1790" class="i">+	XSetErrorHandler(xerrorstart);
</a><a href="#h5-0-1791" id="h5-0-1791" class="i">+	/* this causes an error if some other window manager is running */
</a><a href="#h5-0-1792" id="h5-0-1792" class="i">+	XSelectInput(dpy, root, SubstructureRedirectMask);
</a><a href="#h5-0-1793" id="h5-0-1793" class="i">+	XSync(dpy, False);
</a><a href="#h5-0-1794" id="h5-0-1794" class="i">+	if(otherwm)
</a><a href="#h5-0-1795" id="h5-0-1795" class="i">+		eprint(&quot;dwm: another window manager is already running\n&quot;);
</a><a href="#h5-0-1796" id="h5-0-1796" class="i">+
</a><a href="#h5-0-1797" id="h5-0-1797" class="i">+	XSync(dpy, False);
</a><a href="#h5-0-1798" id="h5-0-1798" class="i">+	XSetErrorHandler(NULL);
</a><a href="#h5-0-1799" id="h5-0-1799" class="i">+	xerrorxlib = XSetErrorHandler(xerror);
</a><a href="#h5-0-1800" id="h5-0-1800" class="i">+	XSync(dpy, False);
</a><a href="#h5-0-1801" id="h5-0-1801" class="i">+	setup();
</a><a href="#h5-0-1802" id="h5-0-1802" class="i">+	drawbar();
</a><a href="#h5-0-1803" id="h5-0-1803" class="i">+	scan();
</a><a href="#h5-0-1804" id="h5-0-1804" class="i">+
</a><a href="#h5-0-1805" id="h5-0-1805" class="i">+	/* main event loop, also reads status text from stdin */
</a><a href="#h5-0-1806" id="h5-0-1806" class="i">+	XSync(dpy, False);
</a><a href="#h5-0-1807" id="h5-0-1807" class="i">+	readin = True;
</a><a href="#h5-0-1808" id="h5-0-1808" class="i">+	while(running) {
</a><a href="#h5-0-1809" id="h5-0-1809" class="i">+		FD_ZERO(&amp;rd);
</a><a href="#h5-0-1810" id="h5-0-1810" class="i">+		if(readin)
</a><a href="#h5-0-1811" id="h5-0-1811" class="i">+			FD_SET(STDIN_FILENO, &amp;rd);
</a><a href="#h5-0-1812" id="h5-0-1812" class="i">+		FD_SET(xfd, &amp;rd);
</a><a href="#h5-0-1813" id="h5-0-1813" class="i">+		if(select(xfd + 1, &amp;rd, NULL, NULL, NULL) == -1) {
</a><a href="#h5-0-1814" id="h5-0-1814" class="i">+			if(errno == EINTR)
</a><a href="#h5-0-1815" id="h5-0-1815" class="i">+				continue;
</a><a href="#h5-0-1816" id="h5-0-1816" class="i">+			eprint(&quot;select failed\n&quot;);
</a><a href="#h5-0-1817" id="h5-0-1817" class="i">+		}
</a><a href="#h5-0-1818" id="h5-0-1818" class="i">+		if(FD_ISSET(STDIN_FILENO, &amp;rd)) {
</a><a href="#h5-0-1819" id="h5-0-1819" class="i">+			switch(r = read(STDIN_FILENO, stext, sizeof stext - 1)) {
</a><a href="#h5-0-1820" id="h5-0-1820" class="i">+			case -1:
</a><a href="#h5-0-1821" id="h5-0-1821" class="i">+				strncpy(stext, strerror(errno), sizeof stext - 1);
</a><a href="#h5-0-1822" id="h5-0-1822" class="i">+				stext[sizeof stext - 1] = &#39;\0&#39;;
</a><a href="#h5-0-1823" id="h5-0-1823" class="i">+				readin = False;
</a><a href="#h5-0-1824" id="h5-0-1824" class="i">+				break;
</a><a href="#h5-0-1825" id="h5-0-1825" class="i">+			case 0:
</a><a href="#h5-0-1826" id="h5-0-1826" class="i">+				strncpy(stext, &quot;EOF&quot;, 4);
</a><a href="#h5-0-1827" id="h5-0-1827" class="i">+				readin = False;
</a><a href="#h5-0-1828" id="h5-0-1828" class="i">+				break;
</a><a href="#h5-0-1829" id="h5-0-1829" class="i">+			default:
</a><a href="#h5-0-1830" id="h5-0-1830" class="i">+				for(stext[r] = &#39;\0&#39;, p = stext + strlen(stext) - 1; p &gt;= stext &amp;&amp; *p == &#39;\n&#39;; *p-- = &#39;\0&#39;);
</a><a href="#h5-0-1831" id="h5-0-1831" class="i">+				for(; p &gt;= stext &amp;&amp; *p != &#39;\n&#39;; --p);
</a><a href="#h5-0-1832" id="h5-0-1832" class="i">+				if(p &gt; stext)
</a><a href="#h5-0-1833" id="h5-0-1833" class="i">+					strncpy(stext, p + 1, sizeof stext);
</a><a href="#h5-0-1834" id="h5-0-1834" class="i">+			}
</a><a href="#h5-0-1835" id="h5-0-1835" class="i">+			drawbar();
</a><a href="#h5-0-1836" id="h5-0-1836" class="i">+		}
</a><a href="#h5-0-1837" id="h5-0-1837" class="i">+		while(XPending(dpy)) {
</a><a href="#h5-0-1838" id="h5-0-1838" class="i">+			XNextEvent(dpy, &amp;ev);
</a><a href="#h5-0-1839" id="h5-0-1839" class="i">+			if(handler[ev.type])
</a><a href="#h5-0-1840" id="h5-0-1840" class="i">+				(handler[ev.type])(&amp;ev); /* call handler */
</a><a href="#h5-0-1841" id="h5-0-1841" class="i">+		}
</a><a href="#h5-0-1842" id="h5-0-1842" class="i">+	}
</a><a href="#h5-0-1843" id="h5-0-1843" class="i">+	cleanup();
</a><a href="#h5-0-1844" id="h5-0-1844" class="i">+	XCloseDisplay(dpy);
</a><a href="#h5-0-1845" id="h5-0-1845" class="i">+	return 0;
</a><a href="#h5-0-1846" id="h5-0-1846" class="i">+}
</a><b>diff --git a/<a id="h6" href="../file/dwm.h.html">dwm.h</a> b/<a href="../file/dwm.h.html">dwm.h</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -1,147 +0,0 @@
</a><a href="#h6-0-0" id="h6-0-0" class="d">-/* See LICENSE file for copyright and license details.
</a><a href="#h6-0-1" id="h6-0-1" class="d">- *
</a><a href="#h6-0-2" id="h6-0-2" class="d">- * dynamic window manager is designed like any other X client as well. It is
</a><a href="#h6-0-3" id="h6-0-3" class="d">- * driven through handling X events. In contrast to other X clients, a window
</a><a href="#h6-0-4" id="h6-0-4" class="d">- * manager selects for SubstructureRedirectMask on the root window, to receive
</a><a href="#h6-0-5" id="h6-0-5" class="d">- * events about window (dis-)appearance.  Only one X connection at a time is
</a><a href="#h6-0-6" id="h6-0-6" class="d">- * allowed to select for this event mask.
</a><a href="#h6-0-7" id="h6-0-7" class="d">- *
</a><a href="#h6-0-8" id="h6-0-8" class="d">- * Calls to fetch an X event from the event queue are blocking.  Due reading
</a><a href="#h6-0-9" id="h6-0-9" class="d">- * status text from standard input, a select()-driven main loop has been
</a><a href="#h6-0-10" id="h6-0-10" class="d">- * implemented which selects for reads on the X connection and STDIN_FILENO to
</a><a href="#h6-0-11" id="h6-0-11" class="d">- * handle all data smoothly. The event handlers of dwm are organized in an
</a><a href="#h6-0-12" id="h6-0-12" class="d">- * array which is accessed whenever a new event has been fetched. This allows
</a><a href="#h6-0-13" id="h6-0-13" class="d">- * event dispatching in O(1) time.
</a><a href="#h6-0-14" id="h6-0-14" class="d">- *
</a><a href="#h6-0-15" id="h6-0-15" class="d">- * Each child of the root window is called a client, except windows which have
</a><a href="#h6-0-16" id="h6-0-16" class="d">- * set the override_redirect flag.  Clients are organized in a global
</a><a href="#h6-0-17" id="h6-0-17" class="d">- * doubly-linked client list, the focus history is remembered through a global
</a><a href="#h6-0-18" id="h6-0-18" class="d">- * stack list. Each client contains an array of Bools of the same size as the
</a><a href="#h6-0-19" id="h6-0-19" class="d">- * global tags array to indicate the tags of a client.  For each client dwm
</a><a href="#h6-0-20" id="h6-0-20" class="d">- * creates a small title window, which is resized whenever the (_NET_)WM_NAME
</a><a href="#h6-0-21" id="h6-0-21" class="d">- * properties are updated or the client is moved/resized.
</a><a href="#h6-0-22" id="h6-0-22" class="d">- *
</a><a href="#h6-0-23" id="h6-0-23" class="d">- * Keys and tagging rules are organized as arrays and defined in the config.h
</a><a href="#h6-0-24" id="h6-0-24" class="d">- * file. These arrays are kept static in event.o and tag.o respectively,
</a><a href="#h6-0-25" id="h6-0-25" class="d">- * because no other part of dwm needs access to them.  The current layout is
</a><a href="#h6-0-26" id="h6-0-26" class="d">- * represented by the lt pointer.
</a><a href="#h6-0-27" id="h6-0-27" class="d">- *
</a><a href="#h6-0-28" id="h6-0-28" class="d">- * To understand everything else, start reading main.c:main().
</a><a href="#h6-0-29" id="h6-0-29" class="d">- */
</a><a href="#h6-0-30" id="h6-0-30" class="d">-
</a><a href="#h6-0-31" id="h6-0-31" class="d">-#include &quot;config.h&quot;
</a><a href="#h6-0-32" id="h6-0-32" class="d">-#include &lt;X11/Xlib.h&gt;
</a><a href="#h6-0-33" id="h6-0-33" class="d">-
</a><a href="#h6-0-34" id="h6-0-34" class="d">-/* mask shorthands, used in event.c and client.c */
</a><a href="#h6-0-35" id="h6-0-35" class="d">-#define BUTTONMASK		(ButtonPressMask | ButtonReleaseMask)
</a><a href="#h6-0-36" id="h6-0-36" class="d">-
</a><a href="#h6-0-37" id="h6-0-37" class="d">-enum { BarTop, BarBot, BarOff };			/* bar position */
</a><a href="#h6-0-38" id="h6-0-38" class="d">-enum { CurNormal, CurResize, CurMove, CurLast };	/* cursor */
</a><a href="#h6-0-39" id="h6-0-39" class="d">-enum { ColBorder, ColFG, ColBG, ColLast };		/* color */
</a><a href="#h6-0-40" id="h6-0-40" class="d">-enum { NetSupported, NetWMName, NetLast };		/* EWMH atoms */
</a><a href="#h6-0-41" id="h6-0-41" class="d">-enum { WMProtocols, WMDelete, WMName, WMState, WMLast };/* default atoms */
</a><a href="#h6-0-42" id="h6-0-42" class="d">-
</a><a href="#h6-0-43" id="h6-0-43" class="d">-typedef struct Client Client;
</a><a href="#h6-0-44" id="h6-0-44" class="d">-struct Client {
</a><a href="#h6-0-45" id="h6-0-45" class="d">-	char name[256];
</a><a href="#h6-0-46" id="h6-0-46" class="d">-	int x, y, w, h;
</a><a href="#h6-0-47" id="h6-0-47" class="d">-	int rx, ry, rw, rh; /* revert geometry */
</a><a href="#h6-0-48" id="h6-0-48" class="d">-	int basew, baseh, incw, inch, maxw, maxh, minw, minh;
</a><a href="#h6-0-49" id="h6-0-49" class="d">-	int minax, maxax, minay, maxay;
</a><a href="#h6-0-50" id="h6-0-50" class="d">-	long flags; 
</a><a href="#h6-0-51" id="h6-0-51" class="d">-	unsigned int border, oldborder;
</a><a href="#h6-0-52" id="h6-0-52" class="d">-	Bool isbanned, isfixed, ismax, isfloating;
</a><a href="#h6-0-53" id="h6-0-53" class="d">-	Bool *tags;
</a><a href="#h6-0-54" id="h6-0-54" class="d">-	Client *next;
</a><a href="#h6-0-55" id="h6-0-55" class="d">-	Client *prev;
</a><a href="#h6-0-56" id="h6-0-56" class="d">-	Client *snext;
</a><a href="#h6-0-57" id="h6-0-57" class="d">-	Window win;
</a><a href="#h6-0-58" id="h6-0-58" class="d">-};
</a><a href="#h6-0-59" id="h6-0-59" class="d">-
</a><a href="#h6-0-60" id="h6-0-60" class="d">-typedef struct {
</a><a href="#h6-0-61" id="h6-0-61" class="d">-	int x, y, w, h;
</a><a href="#h6-0-62" id="h6-0-62" class="d">-	unsigned long norm[ColLast];
</a><a href="#h6-0-63" id="h6-0-63" class="d">-	unsigned long sel[ColLast];
</a><a href="#h6-0-64" id="h6-0-64" class="d">-	Drawable drawable;
</a><a href="#h6-0-65" id="h6-0-65" class="d">-	GC gc;
</a><a href="#h6-0-66" id="h6-0-66" class="d">-	struct {
</a><a href="#h6-0-67" id="h6-0-67" class="d">-		int ascent;
</a><a href="#h6-0-68" id="h6-0-68" class="d">-		int descent;
</a><a href="#h6-0-69" id="h6-0-69" class="d">-		int height;
</a><a href="#h6-0-70" id="h6-0-70" class="d">-		XFontSet set;
</a><a href="#h6-0-71" id="h6-0-71" class="d">-		XFontStruct *xfont;
</a><a href="#h6-0-72" id="h6-0-72" class="d">-	} font;
</a><a href="#h6-0-73" id="h6-0-73" class="d">-} DC; /* draw context */
</a><a href="#h6-0-74" id="h6-0-74" class="d">-
</a><a href="#h6-0-75" id="h6-0-75" class="d">-extern const char *tags[];			/* all tags */
</a><a href="#h6-0-76" id="h6-0-76" class="d">-extern char stext[256];				/* status text */
</a><a href="#h6-0-77" id="h6-0-77" class="d">-extern int screen, sx, sy, sw, sh;		/* screen geometry */
</a><a href="#h6-0-78" id="h6-0-78" class="d">-extern int wax, way, wah, waw;			/* windowarea geometry */
</a><a href="#h6-0-79" id="h6-0-79" class="d">-extern unsigned int bh, blw, bpos;		/* bar height, bar layout label width, bar position */
</a><a href="#h6-0-80" id="h6-0-80" class="d">-extern unsigned int ntags, numlockmask;		/* number of tags, numlock mask */
</a><a href="#h6-0-81" id="h6-0-81" class="d">-extern void (*handler[LASTEvent])(XEvent *);	/* event handler */
</a><a href="#h6-0-82" id="h6-0-82" class="d">-extern Atom wmatom[WMLast], netatom[NetLast];
</a><a href="#h6-0-83" id="h6-0-83" class="d">-extern Bool selscreen, *seltags;		/* seltags is array of Bool */
</a><a href="#h6-0-84" id="h6-0-84" class="d">-extern Client *clients, *sel, *stack;		/* global client list and stack */
</a><a href="#h6-0-85" id="h6-0-85" class="d">-extern Cursor cursor[CurLast];
</a><a href="#h6-0-86" id="h6-0-86" class="d">-extern DC dc;					/* global draw context */
</a><a href="#h6-0-87" id="h6-0-87" class="d">-extern Display *dpy;
</a><a href="#h6-0-88" id="h6-0-88" class="d">-extern Window root, barwin;
</a><a href="#h6-0-89" id="h6-0-89" class="d">-
</a><a href="#h6-0-90" id="h6-0-90" class="d">-/* bar.c */
</a><a href="#h6-0-91" id="h6-0-91" class="d">-void drawbar(void);			/* draw the bar */
</a><a href="#h6-0-92" id="h6-0-92" class="d">-void initbar(void);			/* initializes the bar */
</a><a href="#h6-0-93" id="h6-0-93" class="d">-void initstyle(void);			/* initializes colors and font */
</a><a href="#h6-0-94" id="h6-0-94" class="d">-unsigned int textw(const char *text);	/* return the width of text in px*/
</a><a href="#h6-0-95" id="h6-0-95" class="d">-void togglebar(const char *arg);	/* shows/hides the bar */
</a><a href="#h6-0-96" id="h6-0-96" class="d">-void updatebarpos(void);		/* updates the bar position */
</a><a href="#h6-0-97" id="h6-0-97" class="d">-
</a><a href="#h6-0-98" id="h6-0-98" class="d">-/* client.c */
</a><a href="#h6-0-99" id="h6-0-99" class="d">-void attach(Client *c);			/* attaches c to global client list */
</a><a href="#h6-0-100" id="h6-0-100" class="d">-void ban(Client *c);			/* bans c */
</a><a href="#h6-0-101" id="h6-0-101" class="d">-void configure(Client *c);		/* send synthetic configure event */
</a><a href="#h6-0-102" id="h6-0-102" class="d">-void detach(Client *c);			/* detaches c from global client list */
</a><a href="#h6-0-103" id="h6-0-103" class="d">-void focus(Client *c);			/* focus c if visible &amp;&amp; !NULL, or focus top visible */
</a><a href="#h6-0-104" id="h6-0-104" class="d">-void killclient(const char *arg);	/* kill sel  nicely */
</a><a href="#h6-0-105" id="h6-0-105" class="d">-void manage(Window w, XWindowAttributes *wa);	/* manage new client */
</a><a href="#h6-0-106" id="h6-0-106" class="d">-void resize(Client *c, int x, int y,
</a><a href="#h6-0-107" id="h6-0-107" class="d">-		int w, int h, Bool sizehints);	/* resize with given coordinates c*/
</a><a href="#h6-0-108" id="h6-0-108" class="d">-void unban(Client *c);			/* unbans c */
</a><a href="#h6-0-109" id="h6-0-109" class="d">-void unmanage(Client *c);		/* unmanage c */
</a><a href="#h6-0-110" id="h6-0-110" class="d">-void updatesizehints(Client *c);	/* update the size hint variables of c */
</a><a href="#h6-0-111" id="h6-0-111" class="d">-void updatetitle(Client *c);		/* update the name of c */
</a><a href="#h6-0-112" id="h6-0-112" class="d">-
</a><a href="#h6-0-113" id="h6-0-113" class="d">-/* event.c */
</a><a href="#h6-0-114" id="h6-0-114" class="d">-void grabkeys(void);			/* grab all keys defined in config.h */
</a><a href="#h6-0-115" id="h6-0-115" class="d">-
</a><a href="#h6-0-116" id="h6-0-116" class="d">-/* main.c */
</a><a href="#h6-0-117" id="h6-0-117" class="d">-Bool gettextprop(Window w, Atom atom,
</a><a href="#h6-0-118" id="h6-0-118" class="d">-		char *text, unsigned int size); /* return text property, UTF-8 compliant */
</a><a href="#h6-0-119" id="h6-0-119" class="d">-void quit(const char *arg);			/* quit dwm nicely */
</a><a href="#h6-0-120" id="h6-0-120" class="d">-int xerror(Display *dsply, XErrorEvent *ee);	/* dwm&#39;s X error handler */
</a><a href="#h6-0-121" id="h6-0-121" class="d">-
</a><a href="#h6-0-122" id="h6-0-122" class="d">-/* screen.c */
</a><a href="#h6-0-123" id="h6-0-123" class="d">-void applyrules(Client *c);		/* applies rules to c */
</a><a href="#h6-0-124" id="h6-0-124" class="d">-void arrange(void);			/* arranges all windows depending on the layout in use */
</a><a href="#h6-0-125" id="h6-0-125" class="d">-void compileregs(void);			/* initialize regexps of rules defined in config.h */
</a><a href="#h6-0-126" id="h6-0-126" class="d">-void focusnext(const char *arg);	/* focuses next visible client */
</a><a href="#h6-0-127" id="h6-0-127" class="d">-void focusprev(const char *arg);	/* focuses prev visible client */
</a><a href="#h6-0-128" id="h6-0-128" class="d">-const char *getsymbol(void);		/* returns symbol of enabled layout */
</a><a href="#h6-0-129" id="h6-0-129" class="d">-void initlayouts(void);			/* initialize layout array */
</a><a href="#h6-0-130" id="h6-0-130" class="d">-Bool isarrange(void (*func)());		/* returns True if func is the layout function in use */
</a><a href="#h6-0-131" id="h6-0-131" class="d">-Bool isfloating(void);			/* returns True if floating layout is enabled */
</a><a href="#h6-0-132" id="h6-0-132" class="d">-Bool isvisible(Client *c);		/* returns True if client is visible */
</a><a href="#h6-0-133" id="h6-0-133" class="d">-Client *nexttiled(Client *c);		/* returns tiled successor of c */
</a><a href="#h6-0-134" id="h6-0-134" class="d">-void restack(void);			/* restores z layers of all clients */
</a><a href="#h6-0-135" id="h6-0-135" class="d">-void setlayout(const char *arg);	/* sets layout, NULL means next layout */
</a><a href="#h6-0-136" id="h6-0-136" class="d">-void tag(const char *arg);		/* tags sel with arg&#39;s index */
</a><a href="#h6-0-137" id="h6-0-137" class="d">-void togglefloating(const char *arg);	/* toggles sel between floating/tiled state */
</a><a href="#h6-0-138" id="h6-0-138" class="d">-void togglemax(const char *arg);	/* toggles maximization of floating client */
</a><a href="#h6-0-139" id="h6-0-139" class="d">-void toggletag(const char *arg);	/* toggles sel tags with arg&#39;s index */
</a><a href="#h6-0-140" id="h6-0-140" class="d">-void toggleview(const char *arg);	/* toggles the tag with arg&#39;s index (in)visible */
</a><a href="#h6-0-141" id="h6-0-141" class="d">-void view(const char *arg);		/* views the tag with arg&#39;s index */
</a><a href="#h6-0-142" id="h6-0-142" class="d">-
</a><a href="#h6-0-143" id="h6-0-143" class="d">-/* util.c */
</a><a href="#h6-0-144" id="h6-0-144" class="d">-void *emallocz(unsigned int size);	/* allocates zero-initialized memory, exits on error */
</a><a href="#h6-0-145" id="h6-0-145" class="d">-void eprint(const char *errstr, ...);	/* prints errstr and exits with 1 */
</a><a href="#h6-0-146" id="h6-0-146" class="d">-void spawn(const char *arg);		/* forks a new subprocess with arg&#39;s cmd */
</a><b>diff --git a/<a id="h7" href="../file/event.c.html">event.c</a> b/<a href="../file/event.c.html">event.c</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -1,375 +0,0 @@
</a><a href="#h7-0-0" id="h7-0-0" class="d">-/* See LICENSE file for copyright and license details. */
</a><a href="#h7-0-1" id="h7-0-1" class="d">-#include &quot;dwm.h&quot;
</a><a href="#h7-0-2" id="h7-0-2" class="d">-#include &lt;stdlib.h&gt;
</a><a href="#h7-0-3" id="h7-0-3" class="d">-#include &lt;X11/keysym.h&gt;
</a><a href="#h7-0-4" id="h7-0-4" class="d">-#include &lt;X11/Xatom.h&gt;
</a><a href="#h7-0-5" id="h7-0-5" class="d">-#include &lt;X11/Xutil.h&gt;
</a><a href="#h7-0-6" id="h7-0-6" class="d">-
</a><a href="#h7-0-7" id="h7-0-7" class="d">-/* static */
</a><a href="#h7-0-8" id="h7-0-8" class="d">-
</a><a href="#h7-0-9" id="h7-0-9" class="d">-typedef struct {
</a><a href="#h7-0-10" id="h7-0-10" class="d">-	unsigned long mod;
</a><a href="#h7-0-11" id="h7-0-11" class="d">-	KeySym keysym;
</a><a href="#h7-0-12" id="h7-0-12" class="d">-	void (*func)(const char *arg);
</a><a href="#h7-0-13" id="h7-0-13" class="d">-	const char *arg;
</a><a href="#h7-0-14" id="h7-0-14" class="d">-} Key;
</a><a href="#h7-0-15" id="h7-0-15" class="d">-
</a><a href="#h7-0-16" id="h7-0-16" class="d">-#define CLEANMASK(mask)		(mask &amp; ~(numlockmask | LockMask))
</a><a href="#h7-0-17" id="h7-0-17" class="d">-#define MOUSEMASK		(BUTTONMASK | PointerMotionMask)
</a><a href="#h7-0-18" id="h7-0-18" class="d">-
</a><a href="#h7-0-19" id="h7-0-19" class="d">-static Client *
</a><a href="#h7-0-20" id="h7-0-20" class="d">-getclient(Window w) {
</a><a href="#h7-0-21" id="h7-0-21" class="d">-	Client *c;
</a><a href="#h7-0-22" id="h7-0-22" class="d">-
</a><a href="#h7-0-23" id="h7-0-23" class="d">-	for(c = clients; c &amp;&amp; c-&gt;win != w; c = c-&gt;next);
</a><a href="#h7-0-24" id="h7-0-24" class="d">-	return c;
</a><a href="#h7-0-25" id="h7-0-25" class="d">-}
</a><a href="#h7-0-26" id="h7-0-26" class="d">-
</a><a href="#h7-0-27" id="h7-0-27" class="d">-static void
</a><a href="#h7-0-28" id="h7-0-28" class="d">-movemouse(Client *c) {
</a><a href="#h7-0-29" id="h7-0-29" class="d">-	int x1, y1, ocx, ocy, di, nx, ny;
</a><a href="#h7-0-30" id="h7-0-30" class="d">-	unsigned int dui;
</a><a href="#h7-0-31" id="h7-0-31" class="d">-	Window dummy;
</a><a href="#h7-0-32" id="h7-0-32" class="d">-	XEvent ev;
</a><a href="#h7-0-33" id="h7-0-33" class="d">-
</a><a href="#h7-0-34" id="h7-0-34" class="d">-	ocx = nx = c-&gt;x;
</a><a href="#h7-0-35" id="h7-0-35" class="d">-	ocy = ny = c-&gt;y;
</a><a href="#h7-0-36" id="h7-0-36" class="d">-	if(XGrabPointer(dpy, root, False, MOUSEMASK, GrabModeAsync, GrabModeAsync,
</a><a href="#h7-0-37" id="h7-0-37" class="d">-			None, cursor[CurMove], CurrentTime) != GrabSuccess)
</a><a href="#h7-0-38" id="h7-0-38" class="d">-		return;
</a><a href="#h7-0-39" id="h7-0-39" class="d">-	c-&gt;ismax = False;
</a><a href="#h7-0-40" id="h7-0-40" class="d">-	XQueryPointer(dpy, root, &amp;dummy, &amp;dummy, &amp;x1, &amp;y1, &amp;di, &amp;di, &amp;dui);
</a><a href="#h7-0-41" id="h7-0-41" class="d">-	for(;;) {
</a><a href="#h7-0-42" id="h7-0-42" class="d">-		XMaskEvent(dpy, MOUSEMASK | ExposureMask | SubstructureRedirectMask, &amp;ev);
</a><a href="#h7-0-43" id="h7-0-43" class="d">-		switch (ev.type) {
</a><a href="#h7-0-44" id="h7-0-44" class="d">-		case ButtonRelease:
</a><a href="#h7-0-45" id="h7-0-45" class="d">-			XUngrabPointer(dpy, CurrentTime);
</a><a href="#h7-0-46" id="h7-0-46" class="d">-			return;
</a><a href="#h7-0-47" id="h7-0-47" class="d">-		case ConfigureRequest:
</a><a href="#h7-0-48" id="h7-0-48" class="d">-		case Expose:
</a><a href="#h7-0-49" id="h7-0-49" class="d">-		case MapRequest:
</a><a href="#h7-0-50" id="h7-0-50" class="d">-			handler[ev.type](&amp;ev);
</a><a href="#h7-0-51" id="h7-0-51" class="d">-			break;
</a><a href="#h7-0-52" id="h7-0-52" class="d">-		case MotionNotify:
</a><a href="#h7-0-53" id="h7-0-53" class="d">-			XSync(dpy, False);
</a><a href="#h7-0-54" id="h7-0-54" class="d">-			nx = ocx + (ev.xmotion.x - x1);
</a><a href="#h7-0-55" id="h7-0-55" class="d">-			ny = ocy + (ev.xmotion.y - y1);
</a><a href="#h7-0-56" id="h7-0-56" class="d">-			if(abs(wax + nx) &lt; SNAP)
</a><a href="#h7-0-57" id="h7-0-57" class="d">-				nx = wax;
</a><a href="#h7-0-58" id="h7-0-58" class="d">-			else if(abs((wax + waw) - (nx + c-&gt;w + 2 * c-&gt;border)) &lt; SNAP)
</a><a href="#h7-0-59" id="h7-0-59" class="d">-				nx = wax + waw - c-&gt;w - 2 * c-&gt;border;
</a><a href="#h7-0-60" id="h7-0-60" class="d">-			if(abs(way - ny) &lt; SNAP)
</a><a href="#h7-0-61" id="h7-0-61" class="d">-				ny = way;
</a><a href="#h7-0-62" id="h7-0-62" class="d">-			else if(abs((way + wah) - (ny + c-&gt;h + 2 * c-&gt;border)) &lt; SNAP)
</a><a href="#h7-0-63" id="h7-0-63" class="d">-				ny = way + wah - c-&gt;h - 2 * c-&gt;border;
</a><a href="#h7-0-64" id="h7-0-64" class="d">-			resize(c, nx, ny, c-&gt;w, c-&gt;h, False);
</a><a href="#h7-0-65" id="h7-0-65" class="d">-			break;
</a><a href="#h7-0-66" id="h7-0-66" class="d">-		}
</a><a href="#h7-0-67" id="h7-0-67" class="d">-	}
</a><a href="#h7-0-68" id="h7-0-68" class="d">-}
</a><a href="#h7-0-69" id="h7-0-69" class="d">-
</a><a href="#h7-0-70" id="h7-0-70" class="d">-static void
</a><a href="#h7-0-71" id="h7-0-71" class="d">-resizemouse(Client *c) {
</a><a href="#h7-0-72" id="h7-0-72" class="d">-	int ocx, ocy;
</a><a href="#h7-0-73" id="h7-0-73" class="d">-	int nw, nh;
</a><a href="#h7-0-74" id="h7-0-74" class="d">-	XEvent ev;
</a><a href="#h7-0-75" id="h7-0-75" class="d">-
</a><a href="#h7-0-76" id="h7-0-76" class="d">-	ocx = c-&gt;x;
</a><a href="#h7-0-77" id="h7-0-77" class="d">-	ocy = c-&gt;y;
</a><a href="#h7-0-78" id="h7-0-78" class="d">-	if(XGrabPointer(dpy, root, False, MOUSEMASK, GrabModeAsync, GrabModeAsync,
</a><a href="#h7-0-79" id="h7-0-79" class="d">-			None, cursor[CurResize], CurrentTime) != GrabSuccess)
</a><a href="#h7-0-80" id="h7-0-80" class="d">-		return;
</a><a href="#h7-0-81" id="h7-0-81" class="d">-	c-&gt;ismax = False;
</a><a href="#h7-0-82" id="h7-0-82" class="d">-	XWarpPointer(dpy, None, c-&gt;win, 0, 0, 0, 0, c-&gt;w + c-&gt;border - 1, c-&gt;h + c-&gt;border - 1);
</a><a href="#h7-0-83" id="h7-0-83" class="d">-	for(;;) {
</a><a href="#h7-0-84" id="h7-0-84" class="d">-		XMaskEvent(dpy, MOUSEMASK | ExposureMask | SubstructureRedirectMask , &amp;ev);
</a><a href="#h7-0-85" id="h7-0-85" class="d">-		switch(ev.type) {
</a><a href="#h7-0-86" id="h7-0-86" class="d">-		case ButtonRelease:
</a><a href="#h7-0-87" id="h7-0-87" class="d">-			XWarpPointer(dpy, None, c-&gt;win, 0, 0, 0, 0,
</a><a href="#h7-0-88" id="h7-0-88" class="d">-					c-&gt;w + c-&gt;border - 1, c-&gt;h + c-&gt;border - 1);
</a><a href="#h7-0-89" id="h7-0-89" class="d">-			XUngrabPointer(dpy, CurrentTime);
</a><a href="#h7-0-90" id="h7-0-90" class="d">-			while(XCheckMaskEvent(dpy, EnterWindowMask, &amp;ev));
</a><a href="#h7-0-91" id="h7-0-91" class="d">-			return;
</a><a href="#h7-0-92" id="h7-0-92" class="d">-		case ConfigureRequest:
</a><a href="#h7-0-93" id="h7-0-93" class="d">-		case Expose:
</a><a href="#h7-0-94" id="h7-0-94" class="d">-		case MapRequest:
</a><a href="#h7-0-95" id="h7-0-95" class="d">-			handler[ev.type](&amp;ev);
</a><a href="#h7-0-96" id="h7-0-96" class="d">-			break;
</a><a href="#h7-0-97" id="h7-0-97" class="d">-		case MotionNotify:
</a><a href="#h7-0-98" id="h7-0-98" class="d">-			XSync(dpy, False);
</a><a href="#h7-0-99" id="h7-0-99" class="d">-			if((nw = ev.xmotion.x - ocx - 2 * c-&gt;border + 1) &lt;= 0)
</a><a href="#h7-0-100" id="h7-0-100" class="d">-				nw = 1;
</a><a href="#h7-0-101" id="h7-0-101" class="d">-			if((nh = ev.xmotion.y - ocy - 2 * c-&gt;border + 1) &lt;= 0)
</a><a href="#h7-0-102" id="h7-0-102" class="d">-				nh = 1;
</a><a href="#h7-0-103" id="h7-0-103" class="d">-			resize(c, c-&gt;x, c-&gt;y, nw, nh, True);
</a><a href="#h7-0-104" id="h7-0-104" class="d">-			break;
</a><a href="#h7-0-105" id="h7-0-105" class="d">-		}
</a><a href="#h7-0-106" id="h7-0-106" class="d">-	}
</a><a href="#h7-0-107" id="h7-0-107" class="d">-}
</a><a href="#h7-0-108" id="h7-0-108" class="d">-
</a><a href="#h7-0-109" id="h7-0-109" class="d">-static void
</a><a href="#h7-0-110" id="h7-0-110" class="d">-buttonpress(XEvent *e) {
</a><a href="#h7-0-111" id="h7-0-111" class="d">-	unsigned int i, x;
</a><a href="#h7-0-112" id="h7-0-112" class="d">-	Client *c;
</a><a href="#h7-0-113" id="h7-0-113" class="d">-	XButtonPressedEvent *ev = &amp;e-&gt;xbutton;
</a><a href="#h7-0-114" id="h7-0-114" class="d">-
</a><a href="#h7-0-115" id="h7-0-115" class="d">-	if(barwin == ev-&gt;window) {
</a><a href="#h7-0-116" id="h7-0-116" class="d">-		x = 0;
</a><a href="#h7-0-117" id="h7-0-117" class="d">-		for(i = 0; i &lt; ntags; i++) {
</a><a href="#h7-0-118" id="h7-0-118" class="d">-			x += textw(tags[i]);
</a><a href="#h7-0-119" id="h7-0-119" class="d">-			if(ev-&gt;x &lt; x) {
</a><a href="#h7-0-120" id="h7-0-120" class="d">-				if(ev-&gt;button == Button1) {
</a><a href="#h7-0-121" id="h7-0-121" class="d">-					if(ev-&gt;state &amp; MODKEY)
</a><a href="#h7-0-122" id="h7-0-122" class="d">-						tag(tags[i]);
</a><a href="#h7-0-123" id="h7-0-123" class="d">-					else
</a><a href="#h7-0-124" id="h7-0-124" class="d">-						view(tags[i]);
</a><a href="#h7-0-125" id="h7-0-125" class="d">-				}
</a><a href="#h7-0-126" id="h7-0-126" class="d">-				else if(ev-&gt;button == Button3) {
</a><a href="#h7-0-127" id="h7-0-127" class="d">-					if(ev-&gt;state &amp; MODKEY)
</a><a href="#h7-0-128" id="h7-0-128" class="d">-						toggletag(tags[i]);
</a><a href="#h7-0-129" id="h7-0-129" class="d">-					else
</a><a href="#h7-0-130" id="h7-0-130" class="d">-						toggleview(tags[i]);
</a><a href="#h7-0-131" id="h7-0-131" class="d">-				}
</a><a href="#h7-0-132" id="h7-0-132" class="d">-				return;
</a><a href="#h7-0-133" id="h7-0-133" class="d">-			}
</a><a href="#h7-0-134" id="h7-0-134" class="d">-		}
</a><a href="#h7-0-135" id="h7-0-135" class="d">-		if((ev-&gt;x &lt; x + blw) &amp;&amp; ev-&gt;button == Button1)
</a><a href="#h7-0-136" id="h7-0-136" class="d">-			setlayout(NULL);
</a><a href="#h7-0-137" id="h7-0-137" class="d">-	}
</a><a href="#h7-0-138" id="h7-0-138" class="d">-	else if((c = getclient(ev-&gt;window))) {
</a><a href="#h7-0-139" id="h7-0-139" class="d">-		focus(c);
</a><a href="#h7-0-140" id="h7-0-140" class="d">-		if(CLEANMASK(ev-&gt;state) != MODKEY)
</a><a href="#h7-0-141" id="h7-0-141" class="d">-			return;
</a><a href="#h7-0-142" id="h7-0-142" class="d">-		if(ev-&gt;button == Button1 &amp;&amp; (isfloating() || c-&gt;isfloating)) {
</a><a href="#h7-0-143" id="h7-0-143" class="d">-			restack();
</a><a href="#h7-0-144" id="h7-0-144" class="d">-			movemouse(c);
</a><a href="#h7-0-145" id="h7-0-145" class="d">-		}
</a><a href="#h7-0-146" id="h7-0-146" class="d">-		else if(ev-&gt;button == Button2)
</a><a href="#h7-0-147" id="h7-0-147" class="d">-			zoom(NULL);
</a><a href="#h7-0-148" id="h7-0-148" class="d">-		else if(ev-&gt;button == Button3
</a><a href="#h7-0-149" id="h7-0-149" class="d">-		&amp;&amp; (isfloating() || c-&gt;isfloating) &amp;&amp; !c-&gt;isfixed)
</a><a href="#h7-0-150" id="h7-0-150" class="d">-		{
</a><a href="#h7-0-151" id="h7-0-151" class="d">-			restack();
</a><a href="#h7-0-152" id="h7-0-152" class="d">-			resizemouse(c);
</a><a href="#h7-0-153" id="h7-0-153" class="d">-		}
</a><a href="#h7-0-154" id="h7-0-154" class="d">-	}
</a><a href="#h7-0-155" id="h7-0-155" class="d">-}
</a><a href="#h7-0-156" id="h7-0-156" class="d">-
</a><a href="#h7-0-157" id="h7-0-157" class="d">-static void
</a><a href="#h7-0-158" id="h7-0-158" class="d">-configurerequest(XEvent *e) {
</a><a href="#h7-0-159" id="h7-0-159" class="d">-	Client *c;
</a><a href="#h7-0-160" id="h7-0-160" class="d">-	XConfigureRequestEvent *ev = &amp;e-&gt;xconfigurerequest;
</a><a href="#h7-0-161" id="h7-0-161" class="d">-	XWindowChanges wc;
</a><a href="#h7-0-162" id="h7-0-162" class="d">-
</a><a href="#h7-0-163" id="h7-0-163" class="d">-	if((c = getclient(ev-&gt;window))) {
</a><a href="#h7-0-164" id="h7-0-164" class="d">-		c-&gt;ismax = False;
</a><a href="#h7-0-165" id="h7-0-165" class="d">-		if(ev-&gt;value_mask &amp; CWBorderWidth)
</a><a href="#h7-0-166" id="h7-0-166" class="d">-			c-&gt;border = ev-&gt;border_width;
</a><a href="#h7-0-167" id="h7-0-167" class="d">-		if(c-&gt;isfixed || c-&gt;isfloating || isfloating()) {
</a><a href="#h7-0-168" id="h7-0-168" class="d">-			if(ev-&gt;value_mask &amp; CWX)
</a><a href="#h7-0-169" id="h7-0-169" class="d">-				c-&gt;x = ev-&gt;x;
</a><a href="#h7-0-170" id="h7-0-170" class="d">-			if(ev-&gt;value_mask &amp; CWY)
</a><a href="#h7-0-171" id="h7-0-171" class="d">-				c-&gt;y = ev-&gt;y;
</a><a href="#h7-0-172" id="h7-0-172" class="d">-			if(ev-&gt;value_mask &amp; CWWidth)
</a><a href="#h7-0-173" id="h7-0-173" class="d">-				c-&gt;w = ev-&gt;width;
</a><a href="#h7-0-174" id="h7-0-174" class="d">-			if(ev-&gt;value_mask &amp; CWHeight)
</a><a href="#h7-0-175" id="h7-0-175" class="d">-				c-&gt;h = ev-&gt;height;
</a><a href="#h7-0-176" id="h7-0-176" class="d">-			if((c-&gt;x + c-&gt;w) &gt; sw &amp;&amp; c-&gt;isfloating)
</a><a href="#h7-0-177" id="h7-0-177" class="d">-				c-&gt;x = sw / 2 - c-&gt;w / 2; /* center in x direction */
</a><a href="#h7-0-178" id="h7-0-178" class="d">-			if((c-&gt;y + c-&gt;h) &gt; sh &amp;&amp; c-&gt;isfloating)
</a><a href="#h7-0-179" id="h7-0-179" class="d">-				c-&gt;y = sh / 2 - c-&gt;h / 2; /* center in y direction */
</a><a href="#h7-0-180" id="h7-0-180" class="d">-			if((ev-&gt;value_mask &amp; (CWX | CWY))
</a><a href="#h7-0-181" id="h7-0-181" class="d">-			&amp;&amp; !(ev-&gt;value_mask &amp; (CWWidth | CWHeight)))
</a><a href="#h7-0-182" id="h7-0-182" class="d">-				configure(c);
</a><a href="#h7-0-183" id="h7-0-183" class="d">-			if(isvisible(c))
</a><a href="#h7-0-184" id="h7-0-184" class="d">-				XMoveResizeWindow(dpy, c-&gt;win, c-&gt;x, c-&gt;y, c-&gt;w, c-&gt;h);
</a><a href="#h7-0-185" id="h7-0-185" class="d">-		}
</a><a href="#h7-0-186" id="h7-0-186" class="d">-		else
</a><a href="#h7-0-187" id="h7-0-187" class="d">-			configure(c);
</a><a href="#h7-0-188" id="h7-0-188" class="d">-	}
</a><a href="#h7-0-189" id="h7-0-189" class="d">-	else {
</a><a href="#h7-0-190" id="h7-0-190" class="d">-		wc.x = ev-&gt;x;
</a><a href="#h7-0-191" id="h7-0-191" class="d">-		wc.y = ev-&gt;y;
</a><a href="#h7-0-192" id="h7-0-192" class="d">-		wc.width = ev-&gt;width;
</a><a href="#h7-0-193" id="h7-0-193" class="d">-		wc.height = ev-&gt;height;
</a><a href="#h7-0-194" id="h7-0-194" class="d">-		wc.border_width = ev-&gt;border_width;
</a><a href="#h7-0-195" id="h7-0-195" class="d">-		wc.sibling = ev-&gt;above;
</a><a href="#h7-0-196" id="h7-0-196" class="d">-		wc.stack_mode = ev-&gt;detail;
</a><a href="#h7-0-197" id="h7-0-197" class="d">-		XConfigureWindow(dpy, ev-&gt;window, ev-&gt;value_mask, &amp;wc);
</a><a href="#h7-0-198" id="h7-0-198" class="d">-	}
</a><a href="#h7-0-199" id="h7-0-199" class="d">-	XSync(dpy, False);
</a><a href="#h7-0-200" id="h7-0-200" class="d">-}
</a><a href="#h7-0-201" id="h7-0-201" class="d">-
</a><a href="#h7-0-202" id="h7-0-202" class="d">-static void
</a><a href="#h7-0-203" id="h7-0-203" class="d">-configurenotify(XEvent *e) {
</a><a href="#h7-0-204" id="h7-0-204" class="d">-	XConfigureEvent *ev = &amp;e-&gt;xconfigure;
</a><a href="#h7-0-205" id="h7-0-205" class="d">-
</a><a href="#h7-0-206" id="h7-0-206" class="d">-	if (ev-&gt;window == root &amp;&amp; (ev-&gt;width != sw || ev-&gt;height != sh)) {
</a><a href="#h7-0-207" id="h7-0-207" class="d">-		sw = ev-&gt;width;
</a><a href="#h7-0-208" id="h7-0-208" class="d">-		sh = ev-&gt;height;
</a><a href="#h7-0-209" id="h7-0-209" class="d">-		XFreePixmap(dpy, dc.drawable);
</a><a href="#h7-0-210" id="h7-0-210" class="d">-		dc.drawable = XCreatePixmap(dpy, root, sw, bh, DefaultDepth(dpy, screen));
</a><a href="#h7-0-211" id="h7-0-211" class="d">-		XResizeWindow(dpy, barwin, sw, bh);
</a><a href="#h7-0-212" id="h7-0-212" class="d">-		updatebarpos();
</a><a href="#h7-0-213" id="h7-0-213" class="d">-		arrange();
</a><a href="#h7-0-214" id="h7-0-214" class="d">-	}
</a><a href="#h7-0-215" id="h7-0-215" class="d">-}
</a><a href="#h7-0-216" id="h7-0-216" class="d">-
</a><a href="#h7-0-217" id="h7-0-217" class="d">-static void
</a><a href="#h7-0-218" id="h7-0-218" class="d">-destroynotify(XEvent *e) {
</a><a href="#h7-0-219" id="h7-0-219" class="d">-	Client *c;
</a><a href="#h7-0-220" id="h7-0-220" class="d">-	XDestroyWindowEvent *ev = &amp;e-&gt;xdestroywindow;
</a><a href="#h7-0-221" id="h7-0-221" class="d">-
</a><a href="#h7-0-222" id="h7-0-222" class="d">-	if((c = getclient(ev-&gt;window)))
</a><a href="#h7-0-223" id="h7-0-223" class="d">-		unmanage(c);
</a><a href="#h7-0-224" id="h7-0-224" class="d">-}
</a><a href="#h7-0-225" id="h7-0-225" class="d">-
</a><a href="#h7-0-226" id="h7-0-226" class="d">-static void
</a><a href="#h7-0-227" id="h7-0-227" class="d">-enternotify(XEvent *e) {
</a><a href="#h7-0-228" id="h7-0-228" class="d">-	Client *c;
</a><a href="#h7-0-229" id="h7-0-229" class="d">-	XCrossingEvent *ev = &amp;e-&gt;xcrossing;
</a><a href="#h7-0-230" id="h7-0-230" class="d">-
</a><a href="#h7-0-231" id="h7-0-231" class="d">-	if(ev-&gt;mode != NotifyNormal || ev-&gt;detail == NotifyInferior)
</a><a href="#h7-0-232" id="h7-0-232" class="d">-		return;
</a><a href="#h7-0-233" id="h7-0-233" class="d">-	if((c = getclient(ev-&gt;window)))
</a><a href="#h7-0-234" id="h7-0-234" class="d">-		focus(c);
</a><a href="#h7-0-235" id="h7-0-235" class="d">-	else if(ev-&gt;window == root) {
</a><a href="#h7-0-236" id="h7-0-236" class="d">-		selscreen = True;
</a><a href="#h7-0-237" id="h7-0-237" class="d">-		focus(NULL);
</a><a href="#h7-0-238" id="h7-0-238" class="d">-	}
</a><a href="#h7-0-239" id="h7-0-239" class="d">-}
</a><a href="#h7-0-240" id="h7-0-240" class="d">-
</a><a href="#h7-0-241" id="h7-0-241" class="d">-static void
</a><a href="#h7-0-242" id="h7-0-242" class="d">-expose(XEvent *e) {
</a><a href="#h7-0-243" id="h7-0-243" class="d">-	XExposeEvent *ev = &amp;e-&gt;xexpose;
</a><a href="#h7-0-244" id="h7-0-244" class="d">-
</a><a href="#h7-0-245" id="h7-0-245" class="d">-	if(ev-&gt;count == 0) {
</a><a href="#h7-0-246" id="h7-0-246" class="d">-		if(barwin == ev-&gt;window)
</a><a href="#h7-0-247" id="h7-0-247" class="d">-			drawbar();
</a><a href="#h7-0-248" id="h7-0-248" class="d">-	}
</a><a href="#h7-0-249" id="h7-0-249" class="d">-}
</a><a href="#h7-0-250" id="h7-0-250" class="d">-
</a><a href="#h7-0-251" id="h7-0-251" class="d">-static void
</a><a href="#h7-0-252" id="h7-0-252" class="d">-keypress(XEvent *e) {
</a><a href="#h7-0-253" id="h7-0-253" class="d">-	KEYS
</a><a href="#h7-0-254" id="h7-0-254" class="d">-	unsigned int len = sizeof keys / sizeof keys[0];
</a><a href="#h7-0-255" id="h7-0-255" class="d">-	unsigned int i;
</a><a href="#h7-0-256" id="h7-0-256" class="d">-	KeySym keysym;
</a><a href="#h7-0-257" id="h7-0-257" class="d">-	XKeyEvent *ev = &amp;e-&gt;xkey;
</a><a href="#h7-0-258" id="h7-0-258" class="d">-
</a><a href="#h7-0-259" id="h7-0-259" class="d">-	keysym = XKeycodeToKeysym(dpy, (KeyCode)ev-&gt;keycode, 0);
</a><a href="#h7-0-260" id="h7-0-260" class="d">-	for(i = 0; i &lt; len; i++)
</a><a href="#h7-0-261" id="h7-0-261" class="d">-		if(keysym == keys[i].keysym
</a><a href="#h7-0-262" id="h7-0-262" class="d">-		&amp;&amp; CLEANMASK(keys[i].mod) == CLEANMASK(ev-&gt;state))
</a><a href="#h7-0-263" id="h7-0-263" class="d">-		{
</a><a href="#h7-0-264" id="h7-0-264" class="d">-			if(keys[i].func)
</a><a href="#h7-0-265" id="h7-0-265" class="d">-				keys[i].func(keys[i].arg);
</a><a href="#h7-0-266" id="h7-0-266" class="d">-		}
</a><a href="#h7-0-267" id="h7-0-267" class="d">-}
</a><a href="#h7-0-268" id="h7-0-268" class="d">-
</a><a href="#h7-0-269" id="h7-0-269" class="d">-static void
</a><a href="#h7-0-270" id="h7-0-270" class="d">-leavenotify(XEvent *e) {
</a><a href="#h7-0-271" id="h7-0-271" class="d">-	XCrossingEvent *ev = &amp;e-&gt;xcrossing;
</a><a href="#h7-0-272" id="h7-0-272" class="d">-
</a><a href="#h7-0-273" id="h7-0-273" class="d">-	if((ev-&gt;window == root) &amp;&amp; !ev-&gt;same_screen) {
</a><a href="#h7-0-274" id="h7-0-274" class="d">-		selscreen = False;
</a><a href="#h7-0-275" id="h7-0-275" class="d">-		focus(NULL);
</a><a href="#h7-0-276" id="h7-0-276" class="d">-	}
</a><a href="#h7-0-277" id="h7-0-277" class="d">-}
</a><a href="#h7-0-278" id="h7-0-278" class="d">-
</a><a href="#h7-0-279" id="h7-0-279" class="d">-static void
</a><a href="#h7-0-280" id="h7-0-280" class="d">-mappingnotify(XEvent *e) {
</a><a href="#h7-0-281" id="h7-0-281" class="d">-	XMappingEvent *ev = &amp;e-&gt;xmapping;
</a><a href="#h7-0-282" id="h7-0-282" class="d">-
</a><a href="#h7-0-283" id="h7-0-283" class="d">-	XRefreshKeyboardMapping(ev);
</a><a href="#h7-0-284" id="h7-0-284" class="d">-	if(ev-&gt;request == MappingKeyboard)
</a><a href="#h7-0-285" id="h7-0-285" class="d">-		grabkeys();
</a><a href="#h7-0-286" id="h7-0-286" class="d">-}
</a><a href="#h7-0-287" id="h7-0-287" class="d">-
</a><a href="#h7-0-288" id="h7-0-288" class="d">-static void
</a><a href="#h7-0-289" id="h7-0-289" class="d">-maprequest(XEvent *e) {
</a><a href="#h7-0-290" id="h7-0-290" class="d">-	static XWindowAttributes wa;
</a><a href="#h7-0-291" id="h7-0-291" class="d">-	XMapRequestEvent *ev = &amp;e-&gt;xmaprequest;
</a><a href="#h7-0-292" id="h7-0-292" class="d">-
</a><a href="#h7-0-293" id="h7-0-293" class="d">-	if(!XGetWindowAttributes(dpy, ev-&gt;window, &amp;wa))
</a><a href="#h7-0-294" id="h7-0-294" class="d">-		return;
</a><a href="#h7-0-295" id="h7-0-295" class="d">-	if(wa.override_redirect)
</a><a href="#h7-0-296" id="h7-0-296" class="d">-		return;
</a><a href="#h7-0-297" id="h7-0-297" class="d">-	if(!getclient(ev-&gt;window))
</a><a href="#h7-0-298" id="h7-0-298" class="d">-		manage(ev-&gt;window, &amp;wa);
</a><a href="#h7-0-299" id="h7-0-299" class="d">-}
</a><a href="#h7-0-300" id="h7-0-300" class="d">-
</a><a href="#h7-0-301" id="h7-0-301" class="d">-static void
</a><a href="#h7-0-302" id="h7-0-302" class="d">-propertynotify(XEvent *e) {
</a><a href="#h7-0-303" id="h7-0-303" class="d">-	Client *c;
</a><a href="#h7-0-304" id="h7-0-304" class="d">-	Window trans;
</a><a href="#h7-0-305" id="h7-0-305" class="d">-	XPropertyEvent *ev = &amp;e-&gt;xproperty;
</a><a href="#h7-0-306" id="h7-0-306" class="d">-
</a><a href="#h7-0-307" id="h7-0-307" class="d">-	if(ev-&gt;state == PropertyDelete)
</a><a href="#h7-0-308" id="h7-0-308" class="d">-		return; /* ignore */
</a><a href="#h7-0-309" id="h7-0-309" class="d">-	if((c = getclient(ev-&gt;window))) {
</a><a href="#h7-0-310" id="h7-0-310" class="d">-		switch (ev-&gt;atom) {
</a><a href="#h7-0-311" id="h7-0-311" class="d">-			default: break;
</a><a href="#h7-0-312" id="h7-0-312" class="d">-			case XA_WM_TRANSIENT_FOR:
</a><a href="#h7-0-313" id="h7-0-313" class="d">-				XGetTransientForHint(dpy, c-&gt;win, &amp;trans);
</a><a href="#h7-0-314" id="h7-0-314" class="d">-				if(!c-&gt;isfloating &amp;&amp; (c-&gt;isfloating = (getclient(trans) != NULL)))
</a><a href="#h7-0-315" id="h7-0-315" class="d">-					arrange();
</a><a href="#h7-0-316" id="h7-0-316" class="d">-				break;
</a><a href="#h7-0-317" id="h7-0-317" class="d">-			case XA_WM_NORMAL_HINTS:
</a><a href="#h7-0-318" id="h7-0-318" class="d">-				updatesizehints(c);
</a><a href="#h7-0-319" id="h7-0-319" class="d">-				break;
</a><a href="#h7-0-320" id="h7-0-320" class="d">-		}
</a><a href="#h7-0-321" id="h7-0-321" class="d">-		if(ev-&gt;atom == XA_WM_NAME || ev-&gt;atom == netatom[NetWMName]) {
</a><a href="#h7-0-322" id="h7-0-322" class="d">-			updatetitle(c);
</a><a href="#h7-0-323" id="h7-0-323" class="d">-			if(c == sel)
</a><a href="#h7-0-324" id="h7-0-324" class="d">-				drawbar();
</a><a href="#h7-0-325" id="h7-0-325" class="d">-		}
</a><a href="#h7-0-326" id="h7-0-326" class="d">-	}
</a><a href="#h7-0-327" id="h7-0-327" class="d">-}
</a><a href="#h7-0-328" id="h7-0-328" class="d">-
</a><a href="#h7-0-329" id="h7-0-329" class="d">-static void
</a><a href="#h7-0-330" id="h7-0-330" class="d">-unmapnotify(XEvent *e) {
</a><a href="#h7-0-331" id="h7-0-331" class="d">-	Client *c;
</a><a href="#h7-0-332" id="h7-0-332" class="d">-	XUnmapEvent *ev = &amp;e-&gt;xunmap;
</a><a href="#h7-0-333" id="h7-0-333" class="d">-
</a><a href="#h7-0-334" id="h7-0-334" class="d">-	if((c = getclient(ev-&gt;window)))
</a><a href="#h7-0-335" id="h7-0-335" class="d">-		unmanage(c);
</a><a href="#h7-0-336" id="h7-0-336" class="d">-}
</a><a href="#h7-0-337" id="h7-0-337" class="d">-
</a><a href="#h7-0-338" id="h7-0-338" class="d">-/* extern */
</a><a href="#h7-0-339" id="h7-0-339" class="d">-
</a><a href="#h7-0-340" id="h7-0-340" class="d">-void (*handler[LASTEvent]) (XEvent *) = {
</a><a href="#h7-0-341" id="h7-0-341" class="d">-	[ButtonPress] = buttonpress,
</a><a href="#h7-0-342" id="h7-0-342" class="d">-	[ConfigureRequest] = configurerequest,
</a><a href="#h7-0-343" id="h7-0-343" class="d">-	[ConfigureNotify] = configurenotify,
</a><a href="#h7-0-344" id="h7-0-344" class="d">-	[DestroyNotify] = destroynotify,
</a><a href="#h7-0-345" id="h7-0-345" class="d">-	[EnterNotify] = enternotify,
</a><a href="#h7-0-346" id="h7-0-346" class="d">-	[LeaveNotify] = leavenotify,
</a><a href="#h7-0-347" id="h7-0-347" class="d">-	[Expose] = expose,
</a><a href="#h7-0-348" id="h7-0-348" class="d">-	[KeyPress] = keypress,
</a><a href="#h7-0-349" id="h7-0-349" class="d">-	[MappingNotify] = mappingnotify,
</a><a href="#h7-0-350" id="h7-0-350" class="d">-	[MapRequest] = maprequest,
</a><a href="#h7-0-351" id="h7-0-351" class="d">-	[PropertyNotify] = propertynotify,
</a><a href="#h7-0-352" id="h7-0-352" class="d">-	[UnmapNotify] = unmapnotify
</a><a href="#h7-0-353" id="h7-0-353" class="d">-};
</a><a href="#h7-0-354" id="h7-0-354" class="d">-
</a><a href="#h7-0-355" id="h7-0-355" class="d">-void
</a><a href="#h7-0-356" id="h7-0-356" class="d">-grabkeys(void) {
</a><a href="#h7-0-357" id="h7-0-357" class="d">-	KEYS
</a><a href="#h7-0-358" id="h7-0-358" class="d">-	unsigned int len = sizeof keys / sizeof keys[0];
</a><a href="#h7-0-359" id="h7-0-359" class="d">-	unsigned int i;
</a><a href="#h7-0-360" id="h7-0-360" class="d">-	KeyCode code;
</a><a href="#h7-0-361" id="h7-0-361" class="d">-
</a><a href="#h7-0-362" id="h7-0-362" class="d">-	XUngrabKey(dpy, AnyKey, AnyModifier, root);
</a><a href="#h7-0-363" id="h7-0-363" class="d">-	for(i = 0; i &lt; len; i++) {
</a><a href="#h7-0-364" id="h7-0-364" class="d">-		code = XKeysymToKeycode(dpy, keys[i].keysym);
</a><a href="#h7-0-365" id="h7-0-365" class="d">-		XGrabKey(dpy, code, keys[i].mod, root, True,
</a><a href="#h7-0-366" id="h7-0-366" class="d">-				GrabModeAsync, GrabModeAsync);
</a><a href="#h7-0-367" id="h7-0-367" class="d">-		XGrabKey(dpy, code, keys[i].mod | LockMask, root, True,
</a><a href="#h7-0-368" id="h7-0-368" class="d">-				GrabModeAsync, GrabModeAsync);
</a><a href="#h7-0-369" id="h7-0-369" class="d">-		XGrabKey(dpy, code, keys[i].mod | numlockmask, root, True,
</a><a href="#h7-0-370" id="h7-0-370" class="d">-				GrabModeAsync, GrabModeAsync);
</a><a href="#h7-0-371" id="h7-0-371" class="d">-		XGrabKey(dpy, code, keys[i].mod | numlockmask | LockMask, root, True,
</a><a href="#h7-0-372" id="h7-0-372" class="d">-				GrabModeAsync, GrabModeAsync);
</a><a href="#h7-0-373" id="h7-0-373" class="d">-	}
</a><a href="#h7-0-374" id="h7-0-374" class="d">-}
</a><b>diff --git a/<a id="h8" href="../file/main.c.html">main.c</a> b/<a href="../file/main.c.html">main.c</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -1,296 +0,0 @@
</a><a href="#h8-0-0" id="h8-0-0" class="d">-/* See LICENSE file for copyright and license details. */
</a><a href="#h8-0-1" id="h8-0-1" class="d">-#include &quot;dwm.h&quot;
</a><a href="#h8-0-2" id="h8-0-2" class="d">-#include &lt;errno.h&gt;
</a><a href="#h8-0-3" id="h8-0-3" class="d">-#include &lt;locale.h&gt;
</a><a href="#h8-0-4" id="h8-0-4" class="d">-#include &lt;stdio.h&gt;
</a><a href="#h8-0-5" id="h8-0-5" class="d">-#include &lt;stdlib.h&gt;
</a><a href="#h8-0-6" id="h8-0-6" class="d">-#include &lt;string.h&gt;
</a><a href="#h8-0-7" id="h8-0-7" class="d">-#include &lt;unistd.h&gt;
</a><a href="#h8-0-8" id="h8-0-8" class="d">-#include &lt;sys/select.h&gt;
</a><a href="#h8-0-9" id="h8-0-9" class="d">-#include &lt;X11/cursorfont.h&gt;
</a><a href="#h8-0-10" id="h8-0-10" class="d">-#include &lt;X11/keysym.h&gt;
</a><a href="#h8-0-11" id="h8-0-11" class="d">-#include &lt;X11/Xatom.h&gt;
</a><a href="#h8-0-12" id="h8-0-12" class="d">-#include &lt;X11/Xproto.h&gt;
</a><a href="#h8-0-13" id="h8-0-13" class="d">-#include &lt;X11/Xutil.h&gt;
</a><a href="#h8-0-14" id="h8-0-14" class="d">-
</a><a href="#h8-0-15" id="h8-0-15" class="d">-/* extern */
</a><a href="#h8-0-16" id="h8-0-16" class="d">-
</a><a href="#h8-0-17" id="h8-0-17" class="d">-char stext[256];
</a><a href="#h8-0-18" id="h8-0-18" class="d">-int screen, sx, sy, sw, sh, wax, way, waw, wah;
</a><a href="#h8-0-19" id="h8-0-19" class="d">-unsigned int ntags;
</a><a href="#h8-0-20" id="h8-0-20" class="d">-unsigned int numlockmask = 0;
</a><a href="#h8-0-21" id="h8-0-21" class="d">-Atom wmatom[WMLast], netatom[NetLast];
</a><a href="#h8-0-22" id="h8-0-22" class="d">-Bool *seltags;
</a><a href="#h8-0-23" id="h8-0-23" class="d">-Bool selscreen = True;
</a><a href="#h8-0-24" id="h8-0-24" class="d">-Client *clients = NULL;
</a><a href="#h8-0-25" id="h8-0-25" class="d">-Client *sel = NULL;
</a><a href="#h8-0-26" id="h8-0-26" class="d">-Client *stack = NULL;
</a><a href="#h8-0-27" id="h8-0-27" class="d">-Cursor cursor[CurLast];
</a><a href="#h8-0-28" id="h8-0-28" class="d">-Display *dpy;
</a><a href="#h8-0-29" id="h8-0-29" class="d">-Window root;
</a><a href="#h8-0-30" id="h8-0-30" class="d">-
</a><a href="#h8-0-31" id="h8-0-31" class="d">-/* static */
</a><a href="#h8-0-32" id="h8-0-32" class="d">-
</a><a href="#h8-0-33" id="h8-0-33" class="d">-static int (*xerrorxlib)(Display *, XErrorEvent *);
</a><a href="#h8-0-34" id="h8-0-34" class="d">-static Bool otherwm, readin;
</a><a href="#h8-0-35" id="h8-0-35" class="d">-static Bool running = True;
</a><a href="#h8-0-36" id="h8-0-36" class="d">-
</a><a href="#h8-0-37" id="h8-0-37" class="d">-static void
</a><a href="#h8-0-38" id="h8-0-38" class="d">-cleanup(void) {
</a><a href="#h8-0-39" id="h8-0-39" class="d">-	close(STDIN_FILENO);
</a><a href="#h8-0-40" id="h8-0-40" class="d">-	while(stack) {
</a><a href="#h8-0-41" id="h8-0-41" class="d">-		unban(stack);
</a><a href="#h8-0-42" id="h8-0-42" class="d">-		unmanage(stack);
</a><a href="#h8-0-43" id="h8-0-43" class="d">-	}
</a><a href="#h8-0-44" id="h8-0-44" class="d">-	if(dc.font.set)
</a><a href="#h8-0-45" id="h8-0-45" class="d">-		XFreeFontSet(dpy, dc.font.set);
</a><a href="#h8-0-46" id="h8-0-46" class="d">-	else
</a><a href="#h8-0-47" id="h8-0-47" class="d">-		XFreeFont(dpy, dc.font.xfont);
</a><a href="#h8-0-48" id="h8-0-48" class="d">-	XUngrabKey(dpy, AnyKey, AnyModifier, root);
</a><a href="#h8-0-49" id="h8-0-49" class="d">-	XFreePixmap(dpy, dc.drawable);
</a><a href="#h8-0-50" id="h8-0-50" class="d">-	XFreeGC(dpy, dc.gc);
</a><a href="#h8-0-51" id="h8-0-51" class="d">-	XDestroyWindow(dpy, barwin);
</a><a href="#h8-0-52" id="h8-0-52" class="d">-	XFreeCursor(dpy, cursor[CurNormal]);
</a><a href="#h8-0-53" id="h8-0-53" class="d">-	XFreeCursor(dpy, cursor[CurResize]);
</a><a href="#h8-0-54" id="h8-0-54" class="d">-	XFreeCursor(dpy, cursor[CurMove]);
</a><a href="#h8-0-55" id="h8-0-55" class="d">-	XSetInputFocus(dpy, PointerRoot, RevertToPointerRoot, CurrentTime);
</a><a href="#h8-0-56" id="h8-0-56" class="d">-	XSync(dpy, False);
</a><a href="#h8-0-57" id="h8-0-57" class="d">-	free(seltags);
</a><a href="#h8-0-58" id="h8-0-58" class="d">-}
</a><a href="#h8-0-59" id="h8-0-59" class="d">-
</a><a href="#h8-0-60" id="h8-0-60" class="d">-static long
</a><a href="#h8-0-61" id="h8-0-61" class="d">-getstate(Window w) {
</a><a href="#h8-0-62" id="h8-0-62" class="d">-	int format, status;
</a><a href="#h8-0-63" id="h8-0-63" class="d">-	long result = -1;
</a><a href="#h8-0-64" id="h8-0-64" class="d">-	unsigned char *p = NULL;
</a><a href="#h8-0-65" id="h8-0-65" class="d">-	unsigned long n, extra;
</a><a href="#h8-0-66" id="h8-0-66" class="d">-	Atom real;
</a><a href="#h8-0-67" id="h8-0-67" class="d">-
</a><a href="#h8-0-68" id="h8-0-68" class="d">-	status = XGetWindowProperty(dpy, w, wmatom[WMState], 0L, 2L, False, wmatom[WMState],
</a><a href="#h8-0-69" id="h8-0-69" class="d">-			&amp;real, &amp;format, &amp;n, &amp;extra, (unsigned char **)&amp;p);
</a><a href="#h8-0-70" id="h8-0-70" class="d">-	if(status != Success)
</a><a href="#h8-0-71" id="h8-0-71" class="d">-		return -1;
</a><a href="#h8-0-72" id="h8-0-72" class="d">-	if(n != 0)
</a><a href="#h8-0-73" id="h8-0-73" class="d">-		result = *p;
</a><a href="#h8-0-74" id="h8-0-74" class="d">-	XFree(p);
</a><a href="#h8-0-75" id="h8-0-75" class="d">-	return result;
</a><a href="#h8-0-76" id="h8-0-76" class="d">-}
</a><a href="#h8-0-77" id="h8-0-77" class="d">-
</a><a href="#h8-0-78" id="h8-0-78" class="d">-static void
</a><a href="#h8-0-79" id="h8-0-79" class="d">-scan(void) {
</a><a href="#h8-0-80" id="h8-0-80" class="d">-	unsigned int i, num;
</a><a href="#h8-0-81" id="h8-0-81" class="d">-	Window *wins, d1, d2;
</a><a href="#h8-0-82" id="h8-0-82" class="d">-	XWindowAttributes wa;
</a><a href="#h8-0-83" id="h8-0-83" class="d">-
</a><a href="#h8-0-84" id="h8-0-84" class="d">-	wins = NULL;
</a><a href="#h8-0-85" id="h8-0-85" class="d">-	if(XQueryTree(dpy, root, &amp;d1, &amp;d2, &amp;wins, &amp;num)) {
</a><a href="#h8-0-86" id="h8-0-86" class="d">-		for(i = 0; i &lt; num; i++) {
</a><a href="#h8-0-87" id="h8-0-87" class="d">-			if(!XGetWindowAttributes(dpy, wins[i], &amp;wa)
</a><a href="#h8-0-88" id="h8-0-88" class="d">-			|| wa.override_redirect || XGetTransientForHint(dpy, wins[i], &amp;d1))
</a><a href="#h8-0-89" id="h8-0-89" class="d">-				continue;
</a><a href="#h8-0-90" id="h8-0-90" class="d">-			if(wa.map_state == IsViewable || getstate(wins[i]) == IconicState)
</a><a href="#h8-0-91" id="h8-0-91" class="d">-				manage(wins[i], &amp;wa);
</a><a href="#h8-0-92" id="h8-0-92" class="d">-		}
</a><a href="#h8-0-93" id="h8-0-93" class="d">-		for(i = 0; i &lt; num; i++) { /* now the transients */
</a><a href="#h8-0-94" id="h8-0-94" class="d">-			if(!XGetWindowAttributes(dpy, wins[i], &amp;wa))
</a><a href="#h8-0-95" id="h8-0-95" class="d">-				continue;
</a><a href="#h8-0-96" id="h8-0-96" class="d">-			if(XGetTransientForHint(dpy, wins[i], &amp;d1)
</a><a href="#h8-0-97" id="h8-0-97" class="d">-			&amp;&amp; (wa.map_state == IsViewable || getstate(wins[i]) == IconicState))
</a><a href="#h8-0-98" id="h8-0-98" class="d">-				manage(wins[i], &amp;wa);
</a><a href="#h8-0-99" id="h8-0-99" class="d">-		}
</a><a href="#h8-0-100" id="h8-0-100" class="d">-	}
</a><a href="#h8-0-101" id="h8-0-101" class="d">-	if(wins)
</a><a href="#h8-0-102" id="h8-0-102" class="d">-		XFree(wins);
</a><a href="#h8-0-103" id="h8-0-103" class="d">-}
</a><a href="#h8-0-104" id="h8-0-104" class="d">-
</a><a href="#h8-0-105" id="h8-0-105" class="d">-static void
</a><a href="#h8-0-106" id="h8-0-106" class="d">-setup(void) {
</a><a href="#h8-0-107" id="h8-0-107" class="d">-	int i, j;
</a><a href="#h8-0-108" id="h8-0-108" class="d">-	unsigned int mask;
</a><a href="#h8-0-109" id="h8-0-109" class="d">-	Window w;
</a><a href="#h8-0-110" id="h8-0-110" class="d">-	XModifierKeymap *modmap;
</a><a href="#h8-0-111" id="h8-0-111" class="d">-	XSetWindowAttributes wa;
</a><a href="#h8-0-112" id="h8-0-112" class="d">-
</a><a href="#h8-0-113" id="h8-0-113" class="d">-	/* init atoms */
</a><a href="#h8-0-114" id="h8-0-114" class="d">-	wmatom[WMProtocols] = XInternAtom(dpy, &quot;WM_PROTOCOLS&quot;, False);
</a><a href="#h8-0-115" id="h8-0-115" class="d">-	wmatom[WMDelete] = XInternAtom(dpy, &quot;WM_DELETE_WINDOW&quot;, False);
</a><a href="#h8-0-116" id="h8-0-116" class="d">-	wmatom[WMName] = XInternAtom(dpy, &quot;WM_NAME&quot;, False);
</a><a href="#h8-0-117" id="h8-0-117" class="d">-	wmatom[WMState] = XInternAtom(dpy, &quot;WM_STATE&quot;, False);
</a><a href="#h8-0-118" id="h8-0-118" class="d">-	netatom[NetSupported] = XInternAtom(dpy, &quot;_NET_SUPPORTED&quot;, False);
</a><a href="#h8-0-119" id="h8-0-119" class="d">-	netatom[NetWMName] = XInternAtom(dpy, &quot;_NET_WM_NAME&quot;, False);
</a><a href="#h8-0-120" id="h8-0-120" class="d">-	XChangeProperty(dpy, root, netatom[NetSupported], XA_ATOM, 32,
</a><a href="#h8-0-121" id="h8-0-121" class="d">-			PropModeReplace, (unsigned char *) netatom, NetLast);
</a><a href="#h8-0-122" id="h8-0-122" class="d">-	/* init cursors */
</a><a href="#h8-0-123" id="h8-0-123" class="d">-	cursor[CurNormal] = XCreateFontCursor(dpy, XC_left_ptr);
</a><a href="#h8-0-124" id="h8-0-124" class="d">-	cursor[CurResize] = XCreateFontCursor(dpy, XC_sizing);
</a><a href="#h8-0-125" id="h8-0-125" class="d">-	cursor[CurMove] = XCreateFontCursor(dpy, XC_fleur);
</a><a href="#h8-0-126" id="h8-0-126" class="d">-	/* init modifier map */
</a><a href="#h8-0-127" id="h8-0-127" class="d">-	modmap = XGetModifierMapping(dpy);
</a><a href="#h8-0-128" id="h8-0-128" class="d">-	for (i = 0; i &lt; 8; i++)
</a><a href="#h8-0-129" id="h8-0-129" class="d">-		for (j = 0; j &lt; modmap-&gt;max_keypermod; j++) {
</a><a href="#h8-0-130" id="h8-0-130" class="d">-			if(modmap-&gt;modifiermap[i * modmap-&gt;max_keypermod + j]
</a><a href="#h8-0-131" id="h8-0-131" class="d">-					== XKeysymToKeycode(dpy, XK_Num_Lock))
</a><a href="#h8-0-132" id="h8-0-132" class="d">-				numlockmask = (1 &lt;&lt; i);
</a><a href="#h8-0-133" id="h8-0-133" class="d">-		}
</a><a href="#h8-0-134" id="h8-0-134" class="d">-	XFreeModifiermap(modmap);
</a><a href="#h8-0-135" id="h8-0-135" class="d">-	/* select for events */
</a><a href="#h8-0-136" id="h8-0-136" class="d">-	wa.event_mask = SubstructureRedirectMask | SubstructureNotifyMask
</a><a href="#h8-0-137" id="h8-0-137" class="d">-		| EnterWindowMask | LeaveWindowMask | StructureNotifyMask;
</a><a href="#h8-0-138" id="h8-0-138" class="d">-	wa.cursor = cursor[CurNormal];
</a><a href="#h8-0-139" id="h8-0-139" class="d">-	XChangeWindowAttributes(dpy, root, CWEventMask | CWCursor, &amp;wa);
</a><a href="#h8-0-140" id="h8-0-140" class="d">-	XSelectInput(dpy, root, wa.event_mask);
</a><a href="#h8-0-141" id="h8-0-141" class="d">-	grabkeys();
</a><a href="#h8-0-142" id="h8-0-142" class="d">-	compileregs();
</a><a href="#h8-0-143" id="h8-0-143" class="d">-	for(ntags = 0; tags[ntags]; ntags++);
</a><a href="#h8-0-144" id="h8-0-144" class="d">-	seltags = emallocz(sizeof(Bool) * ntags);
</a><a href="#h8-0-145" id="h8-0-145" class="d">-	seltags[0] = True;
</a><a href="#h8-0-146" id="h8-0-146" class="d">-	/* geometry */
</a><a href="#h8-0-147" id="h8-0-147" class="d">-	sx = sy = 0;
</a><a href="#h8-0-148" id="h8-0-148" class="d">-	sw = DisplayWidth(dpy, screen);
</a><a href="#h8-0-149" id="h8-0-149" class="d">-	sh = DisplayHeight(dpy, screen);
</a><a href="#h8-0-150" id="h8-0-150" class="d">-	initstyle();
</a><a href="#h8-0-151" id="h8-0-151" class="d">-	initlayouts();
</a><a href="#h8-0-152" id="h8-0-152" class="d">-	initbar();
</a><a href="#h8-0-153" id="h8-0-153" class="d">-	/* multihead support */
</a><a href="#h8-0-154" id="h8-0-154" class="d">-	selscreen = XQueryPointer(dpy, root, &amp;w, &amp;w, &amp;i, &amp;i, &amp;i, &amp;i, &amp;mask);
</a><a href="#h8-0-155" id="h8-0-155" class="d">-}
</a><a href="#h8-0-156" id="h8-0-156" class="d">-
</a><a href="#h8-0-157" id="h8-0-157" class="d">-/*
</a><a href="#h8-0-158" id="h8-0-158" class="d">- * Startup Error handler to check if another window manager
</a><a href="#h8-0-159" id="h8-0-159" class="d">- * is already running.
</a><a href="#h8-0-160" id="h8-0-160" class="d">- */
</a><a href="#h8-0-161" id="h8-0-161" class="d">-static int
</a><a href="#h8-0-162" id="h8-0-162" class="d">-xerrorstart(Display *dsply, XErrorEvent *ee) {
</a><a href="#h8-0-163" id="h8-0-163" class="d">-	otherwm = True;
</a><a href="#h8-0-164" id="h8-0-164" class="d">-	return -1;
</a><a href="#h8-0-165" id="h8-0-165" class="d">-}
</a><a href="#h8-0-166" id="h8-0-166" class="d">-
</a><a href="#h8-0-167" id="h8-0-167" class="d">-/* extern */
</a><a href="#h8-0-168" id="h8-0-168" class="d">-
</a><a href="#h8-0-169" id="h8-0-169" class="d">-Bool
</a><a href="#h8-0-170" id="h8-0-170" class="d">-gettextprop(Window w, Atom atom, char *text, unsigned int size) {
</a><a href="#h8-0-171" id="h8-0-171" class="d">-	char **list = NULL;
</a><a href="#h8-0-172" id="h8-0-172" class="d">-	int n;
</a><a href="#h8-0-173" id="h8-0-173" class="d">-	XTextProperty name;
</a><a href="#h8-0-174" id="h8-0-174" class="d">-
</a><a href="#h8-0-175" id="h8-0-175" class="d">-	if(!text || size == 0)
</a><a href="#h8-0-176" id="h8-0-176" class="d">-		return False;
</a><a href="#h8-0-177" id="h8-0-177" class="d">-	text[0] = &#39;\0&#39;;
</a><a href="#h8-0-178" id="h8-0-178" class="d">-	XGetTextProperty(dpy, w, &amp;name, atom);
</a><a href="#h8-0-179" id="h8-0-179" class="d">-	if(!name.nitems)
</a><a href="#h8-0-180" id="h8-0-180" class="d">-		return False;
</a><a href="#h8-0-181" id="h8-0-181" class="d">-	if(name.encoding == XA_STRING)
</a><a href="#h8-0-182" id="h8-0-182" class="d">-		strncpy(text, (char *)name.value, size - 1);
</a><a href="#h8-0-183" id="h8-0-183" class="d">-	else {
</a><a href="#h8-0-184" id="h8-0-184" class="d">-		if(XmbTextPropertyToTextList(dpy, &amp;name, &amp;list, &amp;n) &gt;= Success
</a><a href="#h8-0-185" id="h8-0-185" class="d">-		&amp;&amp; n &gt; 0 &amp;&amp; *list)
</a><a href="#h8-0-186" id="h8-0-186" class="d">-		{
</a><a href="#h8-0-187" id="h8-0-187" class="d">-			strncpy(text, *list, size - 1);
</a><a href="#h8-0-188" id="h8-0-188" class="d">-			XFreeStringList(list);
</a><a href="#h8-0-189" id="h8-0-189" class="d">-		}
</a><a href="#h8-0-190" id="h8-0-190" class="d">-	}
</a><a href="#h8-0-191" id="h8-0-191" class="d">-	text[size - 1] = &#39;\0&#39;;
</a><a href="#h8-0-192" id="h8-0-192" class="d">-	XFree(name.value);
</a><a href="#h8-0-193" id="h8-0-193" class="d">-	return True;
</a><a href="#h8-0-194" id="h8-0-194" class="d">-}
</a><a href="#h8-0-195" id="h8-0-195" class="d">-
</a><a href="#h8-0-196" id="h8-0-196" class="d">-void
</a><a href="#h8-0-197" id="h8-0-197" class="d">-quit(const char *arg) {
</a><a href="#h8-0-198" id="h8-0-198" class="d">-	readin = running = False;
</a><a href="#h8-0-199" id="h8-0-199" class="d">-}
</a><a href="#h8-0-200" id="h8-0-200" class="d">-
</a><a href="#h8-0-201" id="h8-0-201" class="d">-/* There&#39;s no way to check accesses to destroyed windows, thus those cases are
</a><a href="#h8-0-202" id="h8-0-202" class="d">- * ignored (especially on UnmapNotify&#39;s).  Other types of errors call Xlibs
</a><a href="#h8-0-203" id="h8-0-203" class="d">- * default error handler, which may call exit.
</a><a href="#h8-0-204" id="h8-0-204" class="d">- */
</a><a href="#h8-0-205" id="h8-0-205" class="d">-int
</a><a href="#h8-0-206" id="h8-0-206" class="d">-xerror(Display *dpy, XErrorEvent *ee) {
</a><a href="#h8-0-207" id="h8-0-207" class="d">-	if(ee-&gt;error_code == BadWindow
</a><a href="#h8-0-208" id="h8-0-208" class="d">-	|| (ee-&gt;request_code == X_SetInputFocus &amp;&amp; ee-&gt;error_code == BadMatch)
</a><a href="#h8-0-209" id="h8-0-209" class="d">-	|| (ee-&gt;request_code == X_PolyText8 &amp;&amp; ee-&gt;error_code == BadDrawable)
</a><a href="#h8-0-210" id="h8-0-210" class="d">-	|| (ee-&gt;request_code == X_PolyFillRectangle &amp;&amp; ee-&gt;error_code == BadDrawable)
</a><a href="#h8-0-211" id="h8-0-211" class="d">-	|| (ee-&gt;request_code == X_PolySegment &amp;&amp; ee-&gt;error_code == BadDrawable)
</a><a href="#h8-0-212" id="h8-0-212" class="d">-	|| (ee-&gt;request_code == X_ConfigureWindow &amp;&amp; ee-&gt;error_code == BadMatch)
</a><a href="#h8-0-213" id="h8-0-213" class="d">-	|| (ee-&gt;request_code == X_GrabKey &amp;&amp; ee-&gt;error_code == BadAccess)
</a><a href="#h8-0-214" id="h8-0-214" class="d">-	|| (ee-&gt;request_code == X_CopyArea &amp;&amp; ee-&gt;error_code == BadDrawable))
</a><a href="#h8-0-215" id="h8-0-215" class="d">-		return 0;
</a><a href="#h8-0-216" id="h8-0-216" class="d">-	fprintf(stderr, &quot;dwm: fatal error: request code=%d, error code=%d\n&quot;,
</a><a href="#h8-0-217" id="h8-0-217" class="d">-		ee-&gt;request_code, ee-&gt;error_code);
</a><a href="#h8-0-218" id="h8-0-218" class="d">-	return xerrorxlib(dpy, ee); /* may call exit */
</a><a href="#h8-0-219" id="h8-0-219" class="d">-}
</a><a href="#h8-0-220" id="h8-0-220" class="d">-
</a><a href="#h8-0-221" id="h8-0-221" class="d">-int
</a><a href="#h8-0-222" id="h8-0-222" class="d">-main(int argc, char *argv[]) {
</a><a href="#h8-0-223" id="h8-0-223" class="d">-	char *p;
</a><a href="#h8-0-224" id="h8-0-224" class="d">-	int r, xfd;
</a><a href="#h8-0-225" id="h8-0-225" class="d">-	fd_set rd;
</a><a href="#h8-0-226" id="h8-0-226" class="d">-	XEvent ev;
</a><a href="#h8-0-227" id="h8-0-227" class="d">-
</a><a href="#h8-0-228" id="h8-0-228" class="d">-	if(argc == 2 &amp;&amp; !strcmp(&quot;-v&quot;, argv[1]))
</a><a href="#h8-0-229" id="h8-0-229" class="d">-		eprint(&quot;dwm-&quot;VERSION&quot;, © 2006-2007 A. R. Garbe, S. van Dijk, J. Salmi, P. Hruby, S. Nagy\n&quot;);
</a><a href="#h8-0-230" id="h8-0-230" class="d">-	else if(argc != 1)
</a><a href="#h8-0-231" id="h8-0-231" class="d">-		eprint(&quot;usage: dwm [-v]\n&quot;);
</a><a href="#h8-0-232" id="h8-0-232" class="d">-	setlocale(LC_CTYPE, &quot;&quot;);
</a><a href="#h8-0-233" id="h8-0-233" class="d">-	if(!(dpy = XOpenDisplay(0)))
</a><a href="#h8-0-234" id="h8-0-234" class="d">-		eprint(&quot;dwm: cannot open display\n&quot;);
</a><a href="#h8-0-235" id="h8-0-235" class="d">-	xfd = ConnectionNumber(dpy);
</a><a href="#h8-0-236" id="h8-0-236" class="d">-	screen = DefaultScreen(dpy);
</a><a href="#h8-0-237" id="h8-0-237" class="d">-	root = RootWindow(dpy, screen);
</a><a href="#h8-0-238" id="h8-0-238" class="d">-	otherwm = False;
</a><a href="#h8-0-239" id="h8-0-239" class="d">-	XSetErrorHandler(xerrorstart);
</a><a href="#h8-0-240" id="h8-0-240" class="d">-	/* this causes an error if some other window manager is running */
</a><a href="#h8-0-241" id="h8-0-241" class="d">-	XSelectInput(dpy, root, SubstructureRedirectMask);
</a><a href="#h8-0-242" id="h8-0-242" class="d">-	XSync(dpy, False);
</a><a href="#h8-0-243" id="h8-0-243" class="d">-	if(otherwm)
</a><a href="#h8-0-244" id="h8-0-244" class="d">-		eprint(&quot;dwm: another window manager is already running\n&quot;);
</a><a href="#h8-0-245" id="h8-0-245" class="d">-
</a><a href="#h8-0-246" id="h8-0-246" class="d">-	XSync(dpy, False);
</a><a href="#h8-0-247" id="h8-0-247" class="d">-	XSetErrorHandler(NULL);
</a><a href="#h8-0-248" id="h8-0-248" class="d">-	xerrorxlib = XSetErrorHandler(xerror);
</a><a href="#h8-0-249" id="h8-0-249" class="d">-	XSync(dpy, False);
</a><a href="#h8-0-250" id="h8-0-250" class="d">-	setup();
</a><a href="#h8-0-251" id="h8-0-251" class="d">-	drawbar();
</a><a href="#h8-0-252" id="h8-0-252" class="d">-	scan();
</a><a href="#h8-0-253" id="h8-0-253" class="d">-
</a><a href="#h8-0-254" id="h8-0-254" class="d">-	/* main event loop, also reads status text from stdin */
</a><a href="#h8-0-255" id="h8-0-255" class="d">-	XSync(dpy, False);
</a><a href="#h8-0-256" id="h8-0-256" class="d">-	readin = True;
</a><a href="#h8-0-257" id="h8-0-257" class="d">-	while(running) {
</a><a href="#h8-0-258" id="h8-0-258" class="d">-		FD_ZERO(&amp;rd);
</a><a href="#h8-0-259" id="h8-0-259" class="d">-		if(readin)
</a><a href="#h8-0-260" id="h8-0-260" class="d">-			FD_SET(STDIN_FILENO, &amp;rd);
</a><a href="#h8-0-261" id="h8-0-261" class="d">-		FD_SET(xfd, &amp;rd);
</a><a href="#h8-0-262" id="h8-0-262" class="d">-		if(select(xfd + 1, &amp;rd, NULL, NULL, NULL) == -1) {
</a><a href="#h8-0-263" id="h8-0-263" class="d">-			if(errno == EINTR)
</a><a href="#h8-0-264" id="h8-0-264" class="d">-				continue;
</a><a href="#h8-0-265" id="h8-0-265" class="d">-			eprint(&quot;select failed\n&quot;);
</a><a href="#h8-0-266" id="h8-0-266" class="d">-		}
</a><a href="#h8-0-267" id="h8-0-267" class="d">-		if(FD_ISSET(STDIN_FILENO, &amp;rd)) {
</a><a href="#h8-0-268" id="h8-0-268" class="d">-			switch(r = read(STDIN_FILENO, stext, sizeof stext - 1)) {
</a><a href="#h8-0-269" id="h8-0-269" class="d">-			case -1:
</a><a href="#h8-0-270" id="h8-0-270" class="d">-				strncpy(stext, strerror(errno), sizeof stext - 1);
</a><a href="#h8-0-271" id="h8-0-271" class="d">-				stext[sizeof stext - 1] = &#39;\0&#39;;
</a><a href="#h8-0-272" id="h8-0-272" class="d">-				readin = False;
</a><a href="#h8-0-273" id="h8-0-273" class="d">-				break;
</a><a href="#h8-0-274" id="h8-0-274" class="d">-			case 0:
</a><a href="#h8-0-275" id="h8-0-275" class="d">-				strncpy(stext, &quot;EOF&quot;, 4);
</a><a href="#h8-0-276" id="h8-0-276" class="d">-				readin = False;
</a><a href="#h8-0-277" id="h8-0-277" class="d">-				break;
</a><a href="#h8-0-278" id="h8-0-278" class="d">-			default:
</a><a href="#h8-0-279" id="h8-0-279" class="d">-				for(stext[r] = &#39;\0&#39;, p = stext + strlen(stext) - 1; p &gt;= stext &amp;&amp; *p == &#39;\n&#39;; *p-- = &#39;\0&#39;);
</a><a href="#h8-0-280" id="h8-0-280" class="d">-				for(; p &gt;= stext &amp;&amp; *p != &#39;\n&#39;; --p);
</a><a href="#h8-0-281" id="h8-0-281" class="d">-				if(p &gt; stext)
</a><a href="#h8-0-282" id="h8-0-282" class="d">-					strncpy(stext, p + 1, sizeof stext);
</a><a href="#h8-0-283" id="h8-0-283" class="d">-			}
</a><a href="#h8-0-284" id="h8-0-284" class="d">-			drawbar();
</a><a href="#h8-0-285" id="h8-0-285" class="d">-		}
</a><a href="#h8-0-286" id="h8-0-286" class="d">-		while(XPending(dpy)) {
</a><a href="#h8-0-287" id="h8-0-287" class="d">-			XNextEvent(dpy, &amp;ev);
</a><a href="#h8-0-288" id="h8-0-288" class="d">-			if(handler[ev.type])
</a><a href="#h8-0-289" id="h8-0-289" class="d">-				(handler[ev.type])(&amp;ev); /* call handler */
</a><a href="#h8-0-290" id="h8-0-290" class="d">-		}
</a><a href="#h8-0-291" id="h8-0-291" class="d">-	}
</a><a href="#h8-0-292" id="h8-0-292" class="d">-	cleanup();
</a><a href="#h8-0-293" id="h8-0-293" class="d">-	XCloseDisplay(dpy);
</a><a href="#h8-0-294" id="h8-0-294" class="d">-	return 0;
</a><a href="#h8-0-295" id="h8-0-295" class="d">-}
</a><b>diff --git a/<a id="h9" href="../file/screen.c.html">screen.c</a> b/<a href="../file/screen.c.html">screen.c</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -1,340 +0,0 @@
</a><a href="#h9-0-0" id="h9-0-0" class="d">-/* See LICENSE file for copyright and license details. */
</a><a href="#h9-0-1" id="h9-0-1" class="d">-#include &quot;dwm.h&quot;
</a><a href="#h9-0-2" id="h9-0-2" class="d">-#include &lt;regex.h&gt;
</a><a href="#h9-0-3" id="h9-0-3" class="d">-#include &lt;stdio.h&gt;
</a><a href="#h9-0-4" id="h9-0-4" class="d">-#include &lt;stdlib.h&gt;
</a><a href="#h9-0-5" id="h9-0-5" class="d">-#include &lt;string.h&gt;
</a><a href="#h9-0-6" id="h9-0-6" class="d">-#include &lt;X11/Xutil.h&gt;
</a><a href="#h9-0-7" id="h9-0-7" class="d">-
</a><a href="#h9-0-8" id="h9-0-8" class="d">-/* static */
</a><a href="#h9-0-9" id="h9-0-9" class="d">-
</a><a href="#h9-0-10" id="h9-0-10" class="d">-typedef struct {
</a><a href="#h9-0-11" id="h9-0-11" class="d">-	const char *symbol;
</a><a href="#h9-0-12" id="h9-0-12" class="d">-	void (*arrange)(void);
</a><a href="#h9-0-13" id="h9-0-13" class="d">-} Layout;
</a><a href="#h9-0-14" id="h9-0-14" class="d">-
</a><a href="#h9-0-15" id="h9-0-15" class="d">-typedef struct {
</a><a href="#h9-0-16" id="h9-0-16" class="d">-	const char *prop;
</a><a href="#h9-0-17" id="h9-0-17" class="d">-	const char *tags;
</a><a href="#h9-0-18" id="h9-0-18" class="d">-	Bool isfloating;
</a><a href="#h9-0-19" id="h9-0-19" class="d">-} Rule;
</a><a href="#h9-0-20" id="h9-0-20" class="d">-
</a><a href="#h9-0-21" id="h9-0-21" class="d">-typedef struct {
</a><a href="#h9-0-22" id="h9-0-22" class="d">-	regex_t *propregex;
</a><a href="#h9-0-23" id="h9-0-23" class="d">-	regex_t *tagregex;
</a><a href="#h9-0-24" id="h9-0-24" class="d">-} Regs;
</a><a href="#h9-0-25" id="h9-0-25" class="d">-
</a><a href="#h9-0-26" id="h9-0-26" class="d">-TAGS
</a><a href="#h9-0-27" id="h9-0-27" class="d">-RULES
</a><a href="#h9-0-28" id="h9-0-28" class="d">-
</a><a href="#h9-0-29" id="h9-0-29" class="d">-static unsigned int nrules = 0;
</a><a href="#h9-0-30" id="h9-0-30" class="d">-static unsigned int nlayouts = 0;
</a><a href="#h9-0-31" id="h9-0-31" class="d">-static unsigned int ltidx = 0; /* default */
</a><a href="#h9-0-32" id="h9-0-32" class="d">-static Regs *regs = NULL;
</a><a href="#h9-0-33" id="h9-0-33" class="d">-
</a><a href="#h9-0-34" id="h9-0-34" class="d">-static unsigned int
</a><a href="#h9-0-35" id="h9-0-35" class="d">-idxoftag(const char *tag) {
</a><a href="#h9-0-36" id="h9-0-36" class="d">-	unsigned int i;
</a><a href="#h9-0-37" id="h9-0-37" class="d">-
</a><a href="#h9-0-38" id="h9-0-38" class="d">-	for(i = 0; i &lt; ntags; i++)
</a><a href="#h9-0-39" id="h9-0-39" class="d">-		if(tags[i] == tag)
</a><a href="#h9-0-40" id="h9-0-40" class="d">-			return i;
</a><a href="#h9-0-41" id="h9-0-41" class="d">-	return 0;
</a><a href="#h9-0-42" id="h9-0-42" class="d">-}
</a><a href="#h9-0-43" id="h9-0-43" class="d">-
</a><a href="#h9-0-44" id="h9-0-44" class="d">-static void
</a><a href="#h9-0-45" id="h9-0-45" class="d">-floating(void) { /* default floating layout */
</a><a href="#h9-0-46" id="h9-0-46" class="d">-	Client *c;
</a><a href="#h9-0-47" id="h9-0-47" class="d">-
</a><a href="#h9-0-48" id="h9-0-48" class="d">-	for(c = clients; c; c = c-&gt;next)
</a><a href="#h9-0-49" id="h9-0-49" class="d">-		if(isvisible(c))
</a><a href="#h9-0-50" id="h9-0-50" class="d">-			resize(c, c-&gt;x, c-&gt;y, c-&gt;w, c-&gt;h, True);
</a><a href="#h9-0-51" id="h9-0-51" class="d">-}
</a><a href="#h9-0-52" id="h9-0-52" class="d">-
</a><a href="#h9-0-53" id="h9-0-53" class="d">-LAYOUTS
</a><a href="#h9-0-54" id="h9-0-54" class="d">-
</a><a href="#h9-0-55" id="h9-0-55" class="d">-/* extern */
</a><a href="#h9-0-56" id="h9-0-56" class="d">-
</a><a href="#h9-0-57" id="h9-0-57" class="d">-unsigned int blw = 0;
</a><a href="#h9-0-58" id="h9-0-58" class="d">-
</a><a href="#h9-0-59" id="h9-0-59" class="d">-void
</a><a href="#h9-0-60" id="h9-0-60" class="d">-applyrules(Client *c) {
</a><a href="#h9-0-61" id="h9-0-61" class="d">-	static char buf[512];
</a><a href="#h9-0-62" id="h9-0-62" class="d">-	unsigned int i, j;
</a><a href="#h9-0-63" id="h9-0-63" class="d">-	regmatch_t tmp;
</a><a href="#h9-0-64" id="h9-0-64" class="d">-	Bool matched = False;
</a><a href="#h9-0-65" id="h9-0-65" class="d">-	XClassHint ch = { 0 };
</a><a href="#h9-0-66" id="h9-0-66" class="d">-
</a><a href="#h9-0-67" id="h9-0-67" class="d">-	/* rule matching */
</a><a href="#h9-0-68" id="h9-0-68" class="d">-	XGetClassHint(dpy, c-&gt;win, &amp;ch);
</a><a href="#h9-0-69" id="h9-0-69" class="d">-	snprintf(buf, sizeof buf, &quot;%s:%s:%s&quot;,
</a><a href="#h9-0-70" id="h9-0-70" class="d">-			ch.res_class ? ch.res_class : &quot;&quot;,
</a><a href="#h9-0-71" id="h9-0-71" class="d">-			ch.res_name ? ch.res_name : &quot;&quot;, c-&gt;name);
</a><a href="#h9-0-72" id="h9-0-72" class="d">-	for(i = 0; i &lt; nrules; i++)
</a><a href="#h9-0-73" id="h9-0-73" class="d">-		if(regs[i].propregex &amp;&amp; !regexec(regs[i].propregex, buf, 1, &amp;tmp, 0)) {
</a><a href="#h9-0-74" id="h9-0-74" class="d">-			c-&gt;isfloating = rules[i].isfloating;
</a><a href="#h9-0-75" id="h9-0-75" class="d">-			for(j = 0; regs[i].tagregex &amp;&amp; j &lt; ntags; j++) {
</a><a href="#h9-0-76" id="h9-0-76" class="d">-				if(!regexec(regs[i].tagregex, tags[j], 1, &amp;tmp, 0)) {
</a><a href="#h9-0-77" id="h9-0-77" class="d">-					matched = True;
</a><a href="#h9-0-78" id="h9-0-78" class="d">-					c-&gt;tags[j] = True;
</a><a href="#h9-0-79" id="h9-0-79" class="d">-				}
</a><a href="#h9-0-80" id="h9-0-80" class="d">-			}
</a><a href="#h9-0-81" id="h9-0-81" class="d">-		}
</a><a href="#h9-0-82" id="h9-0-82" class="d">-	if(ch.res_class)
</a><a href="#h9-0-83" id="h9-0-83" class="d">-		XFree(ch.res_class);
</a><a href="#h9-0-84" id="h9-0-84" class="d">-	if(ch.res_name)
</a><a href="#h9-0-85" id="h9-0-85" class="d">-		XFree(ch.res_name);
</a><a href="#h9-0-86" id="h9-0-86" class="d">-	if(!matched)
</a><a href="#h9-0-87" id="h9-0-87" class="d">-		for(i = 0; i &lt; ntags; i++)
</a><a href="#h9-0-88" id="h9-0-88" class="d">-			c-&gt;tags[i] = seltags[i];
</a><a href="#h9-0-89" id="h9-0-89" class="d">-}
</a><a href="#h9-0-90" id="h9-0-90" class="d">-
</a><a href="#h9-0-91" id="h9-0-91" class="d">-void
</a><a href="#h9-0-92" id="h9-0-92" class="d">-arrange(void) {
</a><a href="#h9-0-93" id="h9-0-93" class="d">-	Client *c;
</a><a href="#h9-0-94" id="h9-0-94" class="d">-
</a><a href="#h9-0-95" id="h9-0-95" class="d">-	for(c = clients; c; c = c-&gt;next)
</a><a href="#h9-0-96" id="h9-0-96" class="d">-		if(isvisible(c))
</a><a href="#h9-0-97" id="h9-0-97" class="d">-			unban(c);
</a><a href="#h9-0-98" id="h9-0-98" class="d">-		else
</a><a href="#h9-0-99" id="h9-0-99" class="d">-			ban(c);
</a><a href="#h9-0-100" id="h9-0-100" class="d">-	layouts[ltidx].arrange();
</a><a href="#h9-0-101" id="h9-0-101" class="d">-	focus(NULL);
</a><a href="#h9-0-102" id="h9-0-102" class="d">-	restack();
</a><a href="#h9-0-103" id="h9-0-103" class="d">-}
</a><a href="#h9-0-104" id="h9-0-104" class="d">-
</a><a href="#h9-0-105" id="h9-0-105" class="d">-void
</a><a href="#h9-0-106" id="h9-0-106" class="d">-compileregs(void) {
</a><a href="#h9-0-107" id="h9-0-107" class="d">-	unsigned int i;
</a><a href="#h9-0-108" id="h9-0-108" class="d">-	regex_t *reg;
</a><a href="#h9-0-109" id="h9-0-109" class="d">-
</a><a href="#h9-0-110" id="h9-0-110" class="d">-	if(regs)
</a><a href="#h9-0-111" id="h9-0-111" class="d">-		return;
</a><a href="#h9-0-112" id="h9-0-112" class="d">-	nrules = sizeof rules / sizeof rules[0];
</a><a href="#h9-0-113" id="h9-0-113" class="d">-	regs = emallocz(nrules * sizeof(Regs));
</a><a href="#h9-0-114" id="h9-0-114" class="d">-	for(i = 0; i &lt; nrules; i++) {
</a><a href="#h9-0-115" id="h9-0-115" class="d">-		if(rules[i].prop) {
</a><a href="#h9-0-116" id="h9-0-116" class="d">-			reg = emallocz(sizeof(regex_t));
</a><a href="#h9-0-117" id="h9-0-117" class="d">-			if(regcomp(reg, rules[i].prop, REG_EXTENDED))
</a><a href="#h9-0-118" id="h9-0-118" class="d">-				free(reg);
</a><a href="#h9-0-119" id="h9-0-119" class="d">-			else
</a><a href="#h9-0-120" id="h9-0-120" class="d">-				regs[i].propregex = reg;
</a><a href="#h9-0-121" id="h9-0-121" class="d">-		}
</a><a href="#h9-0-122" id="h9-0-122" class="d">-		if(rules[i].tags) {
</a><a href="#h9-0-123" id="h9-0-123" class="d">-			reg = emallocz(sizeof(regex_t));
</a><a href="#h9-0-124" id="h9-0-124" class="d">-			if(regcomp(reg, rules[i].tags, REG_EXTENDED))
</a><a href="#h9-0-125" id="h9-0-125" class="d">-				free(reg);
</a><a href="#h9-0-126" id="h9-0-126" class="d">-			else
</a><a href="#h9-0-127" id="h9-0-127" class="d">-				regs[i].tagregex = reg;
</a><a href="#h9-0-128" id="h9-0-128" class="d">-		}
</a><a href="#h9-0-129" id="h9-0-129" class="d">-	}
</a><a href="#h9-0-130" id="h9-0-130" class="d">-}
</a><a href="#h9-0-131" id="h9-0-131" class="d">-
</a><a href="#h9-0-132" id="h9-0-132" class="d">-void
</a><a href="#h9-0-133" id="h9-0-133" class="d">-focusnext(const char *arg) {
</a><a href="#h9-0-134" id="h9-0-134" class="d">-	Client *c;
</a><a href="#h9-0-135" id="h9-0-135" class="d">-
</a><a href="#h9-0-136" id="h9-0-136" class="d">-	if(!sel)
</a><a href="#h9-0-137" id="h9-0-137" class="d">-		return;
</a><a href="#h9-0-138" id="h9-0-138" class="d">-	for(c = sel-&gt;next; c &amp;&amp; !isvisible(c); c = c-&gt;next);
</a><a href="#h9-0-139" id="h9-0-139" class="d">-	if(!c)
</a><a href="#h9-0-140" id="h9-0-140" class="d">-		for(c = clients; c &amp;&amp; !isvisible(c); c = c-&gt;next);
</a><a href="#h9-0-141" id="h9-0-141" class="d">-	if(c) {
</a><a href="#h9-0-142" id="h9-0-142" class="d">-		focus(c);
</a><a href="#h9-0-143" id="h9-0-143" class="d">-		restack();
</a><a href="#h9-0-144" id="h9-0-144" class="d">-	}
</a><a href="#h9-0-145" id="h9-0-145" class="d">-}
</a><a href="#h9-0-146" id="h9-0-146" class="d">-
</a><a href="#h9-0-147" id="h9-0-147" class="d">-void
</a><a href="#h9-0-148" id="h9-0-148" class="d">-focusprev(const char *arg) {
</a><a href="#h9-0-149" id="h9-0-149" class="d">-	Client *c;
</a><a href="#h9-0-150" id="h9-0-150" class="d">-
</a><a href="#h9-0-151" id="h9-0-151" class="d">-	if(!sel)
</a><a href="#h9-0-152" id="h9-0-152" class="d">-		return;
</a><a href="#h9-0-153" id="h9-0-153" class="d">-	for(c = sel-&gt;prev; c &amp;&amp; !isvisible(c); c = c-&gt;prev);
</a><a href="#h9-0-154" id="h9-0-154" class="d">-	if(!c) {
</a><a href="#h9-0-155" id="h9-0-155" class="d">-		for(c = clients; c &amp;&amp; c-&gt;next; c = c-&gt;next);
</a><a href="#h9-0-156" id="h9-0-156" class="d">-		for(; c &amp;&amp; !isvisible(c); c = c-&gt;prev);
</a><a href="#h9-0-157" id="h9-0-157" class="d">-	}
</a><a href="#h9-0-158" id="h9-0-158" class="d">-	if(c) {
</a><a href="#h9-0-159" id="h9-0-159" class="d">-		focus(c);
</a><a href="#h9-0-160" id="h9-0-160" class="d">-		restack();
</a><a href="#h9-0-161" id="h9-0-161" class="d">-	}
</a><a href="#h9-0-162" id="h9-0-162" class="d">-}
</a><a href="#h9-0-163" id="h9-0-163" class="d">-
</a><a href="#h9-0-164" id="h9-0-164" class="d">-const char *
</a><a href="#h9-0-165" id="h9-0-165" class="d">-getsymbol(void)
</a><a href="#h9-0-166" id="h9-0-166" class="d">-{
</a><a href="#h9-0-167" id="h9-0-167" class="d">-	return layouts[ltidx].symbol;
</a><a href="#h9-0-168" id="h9-0-168" class="d">-}
</a><a href="#h9-0-169" id="h9-0-169" class="d">-
</a><a href="#h9-0-170" id="h9-0-170" class="d">-void
</a><a href="#h9-0-171" id="h9-0-171" class="d">-initlayouts(void) {
</a><a href="#h9-0-172" id="h9-0-172" class="d">-	unsigned int i, w;
</a><a href="#h9-0-173" id="h9-0-173" class="d">-
</a><a href="#h9-0-174" id="h9-0-174" class="d">-	nlayouts = sizeof layouts / sizeof layouts[0];
</a><a href="#h9-0-175" id="h9-0-175" class="d">-	for(blw = i = 0; i &lt; nlayouts; i++) {
</a><a href="#h9-0-176" id="h9-0-176" class="d">-		w = textw(layouts[i].symbol);
</a><a href="#h9-0-177" id="h9-0-177" class="d">-		if(w &gt; blw)
</a><a href="#h9-0-178" id="h9-0-178" class="d">-			blw = w;
</a><a href="#h9-0-179" id="h9-0-179" class="d">-	}
</a><a href="#h9-0-180" id="h9-0-180" class="d">-}
</a><a href="#h9-0-181" id="h9-0-181" class="d">-
</a><a href="#h9-0-182" id="h9-0-182" class="d">-Bool
</a><a href="#h9-0-183" id="h9-0-183" class="d">-isfloating(void) {
</a><a href="#h9-0-184" id="h9-0-184" class="d">-	return layouts[ltidx].arrange == floating;
</a><a href="#h9-0-185" id="h9-0-185" class="d">-}
</a><a href="#h9-0-186" id="h9-0-186" class="d">-
</a><a href="#h9-0-187" id="h9-0-187" class="d">-Bool
</a><a href="#h9-0-188" id="h9-0-188" class="d">-isarrange(void (*func)())
</a><a href="#h9-0-189" id="h9-0-189" class="d">-{
</a><a href="#h9-0-190" id="h9-0-190" class="d">-	return func == layouts[ltidx].arrange;
</a><a href="#h9-0-191" id="h9-0-191" class="d">-}
</a><a href="#h9-0-192" id="h9-0-192" class="d">-
</a><a href="#h9-0-193" id="h9-0-193" class="d">-Bool
</a><a href="#h9-0-194" id="h9-0-194" class="d">-isvisible(Client *c) {
</a><a href="#h9-0-195" id="h9-0-195" class="d">-	unsigned int i;
</a><a href="#h9-0-196" id="h9-0-196" class="d">-
</a><a href="#h9-0-197" id="h9-0-197" class="d">-	for(i = 0; i &lt; ntags; i++)
</a><a href="#h9-0-198" id="h9-0-198" class="d">-		if(c-&gt;tags[i] &amp;&amp; seltags[i])
</a><a href="#h9-0-199" id="h9-0-199" class="d">-			return True;
</a><a href="#h9-0-200" id="h9-0-200" class="d">-	return False;
</a><a href="#h9-0-201" id="h9-0-201" class="d">-}
</a><a href="#h9-0-202" id="h9-0-202" class="d">-
</a><a href="#h9-0-203" id="h9-0-203" class="d">-Client *
</a><a href="#h9-0-204" id="h9-0-204" class="d">-nexttiled(Client *c) {
</a><a href="#h9-0-205" id="h9-0-205" class="d">-	for(; c &amp;&amp; (c-&gt;isfloating || !isvisible(c)); c = c-&gt;next);
</a><a href="#h9-0-206" id="h9-0-206" class="d">-	return c;
</a><a href="#h9-0-207" id="h9-0-207" class="d">-}
</a><a href="#h9-0-208" id="h9-0-208" class="d">-
</a><a href="#h9-0-209" id="h9-0-209" class="d">-void
</a><a href="#h9-0-210" id="h9-0-210" class="d">-restack(void) {
</a><a href="#h9-0-211" id="h9-0-211" class="d">-	Client *c;
</a><a href="#h9-0-212" id="h9-0-212" class="d">-	XEvent ev;
</a><a href="#h9-0-213" id="h9-0-213" class="d">-	XWindowChanges wc;
</a><a href="#h9-0-214" id="h9-0-214" class="d">-
</a><a href="#h9-0-215" id="h9-0-215" class="d">-	drawbar();
</a><a href="#h9-0-216" id="h9-0-216" class="d">-	if(!sel)
</a><a href="#h9-0-217" id="h9-0-217" class="d">-		return;
</a><a href="#h9-0-218" id="h9-0-218" class="d">-	if(sel-&gt;isfloating || isfloating())
</a><a href="#h9-0-219" id="h9-0-219" class="d">-		XRaiseWindow(dpy, sel-&gt;win);
</a><a href="#h9-0-220" id="h9-0-220" class="d">-	if(!isfloating()) {
</a><a href="#h9-0-221" id="h9-0-221" class="d">-		wc.stack_mode = Below;
</a><a href="#h9-0-222" id="h9-0-222" class="d">-		wc.sibling = barwin;
</a><a href="#h9-0-223" id="h9-0-223" class="d">-		if(!sel-&gt;isfloating) {
</a><a href="#h9-0-224" id="h9-0-224" class="d">-			XConfigureWindow(dpy, sel-&gt;win, CWSibling | CWStackMode, &amp;wc);
</a><a href="#h9-0-225" id="h9-0-225" class="d">-			wc.sibling = sel-&gt;win;
</a><a href="#h9-0-226" id="h9-0-226" class="d">-		}
</a><a href="#h9-0-227" id="h9-0-227" class="d">-		for(c = nexttiled(clients); c; c = nexttiled(c-&gt;next)) {
</a><a href="#h9-0-228" id="h9-0-228" class="d">-			if(c == sel)
</a><a href="#h9-0-229" id="h9-0-229" class="d">-				continue;
</a><a href="#h9-0-230" id="h9-0-230" class="d">-			XConfigureWindow(dpy, c-&gt;win, CWSibling | CWStackMode, &amp;wc);
</a><a href="#h9-0-231" id="h9-0-231" class="d">-			wc.sibling = c-&gt;win;
</a><a href="#h9-0-232" id="h9-0-232" class="d">-		}
</a><a href="#h9-0-233" id="h9-0-233" class="d">-	}
</a><a href="#h9-0-234" id="h9-0-234" class="d">-	XSync(dpy, False);
</a><a href="#h9-0-235" id="h9-0-235" class="d">-	while(XCheckMaskEvent(dpy, EnterWindowMask, &amp;ev));
</a><a href="#h9-0-236" id="h9-0-236" class="d">-}
</a><a href="#h9-0-237" id="h9-0-237" class="d">-
</a><a href="#h9-0-238" id="h9-0-238" class="d">-void
</a><a href="#h9-0-239" id="h9-0-239" class="d">-setlayout(const char *arg) {
</a><a href="#h9-0-240" id="h9-0-240" class="d">-	unsigned int i;
</a><a href="#h9-0-241" id="h9-0-241" class="d">-
</a><a href="#h9-0-242" id="h9-0-242" class="d">-	if(!arg) {
</a><a href="#h9-0-243" id="h9-0-243" class="d">-		if(++ltidx == nlayouts)
</a><a href="#h9-0-244" id="h9-0-244" class="d">-			ltidx = 0;;
</a><a href="#h9-0-245" id="h9-0-245" class="d">-	}
</a><a href="#h9-0-246" id="h9-0-246" class="d">-	else {
</a><a href="#h9-0-247" id="h9-0-247" class="d">-		for(i = 0; i &lt; nlayouts; i++)
</a><a href="#h9-0-248" id="h9-0-248" class="d">-			if(!strcmp(arg, layouts[i].symbol))
</a><a href="#h9-0-249" id="h9-0-249" class="d">-				break;
</a><a href="#h9-0-250" id="h9-0-250" class="d">-		if(i == nlayouts)
</a><a href="#h9-0-251" id="h9-0-251" class="d">-			return;
</a><a href="#h9-0-252" id="h9-0-252" class="d">-		ltidx = i;
</a><a href="#h9-0-253" id="h9-0-253" class="d">-	}
</a><a href="#h9-0-254" id="h9-0-254" class="d">-	if(sel)
</a><a href="#h9-0-255" id="h9-0-255" class="d">-		arrange();
</a><a href="#h9-0-256" id="h9-0-256" class="d">-	else
</a><a href="#h9-0-257" id="h9-0-257" class="d">-		drawbar();
</a><a href="#h9-0-258" id="h9-0-258" class="d">-}
</a><a href="#h9-0-259" id="h9-0-259" class="d">-
</a><a href="#h9-0-260" id="h9-0-260" class="d">-void
</a><a href="#h9-0-261" id="h9-0-261" class="d">-tag(const char *arg) {
</a><a href="#h9-0-262" id="h9-0-262" class="d">-	unsigned int i;
</a><a href="#h9-0-263" id="h9-0-263" class="d">-
</a><a href="#h9-0-264" id="h9-0-264" class="d">-	if(!sel)
</a><a href="#h9-0-265" id="h9-0-265" class="d">-		return;
</a><a href="#h9-0-266" id="h9-0-266" class="d">-	for(i = 0; i &lt; ntags; i++)
</a><a href="#h9-0-267" id="h9-0-267" class="d">-		sel-&gt;tags[i] = arg == NULL;
</a><a href="#h9-0-268" id="h9-0-268" class="d">-	i = idxoftag(arg);
</a><a href="#h9-0-269" id="h9-0-269" class="d">-	if(i &gt;= 0 &amp;&amp; i &lt; ntags)
</a><a href="#h9-0-270" id="h9-0-270" class="d">-		sel-&gt;tags[i] = True;
</a><a href="#h9-0-271" id="h9-0-271" class="d">-	arrange();
</a><a href="#h9-0-272" id="h9-0-272" class="d">-}
</a><a href="#h9-0-273" id="h9-0-273" class="d">-
</a><a href="#h9-0-274" id="h9-0-274" class="d">-void
</a><a href="#h9-0-275" id="h9-0-275" class="d">-togglefloating(const char *arg) {
</a><a href="#h9-0-276" id="h9-0-276" class="d">-	if(!sel)
</a><a href="#h9-0-277" id="h9-0-277" class="d">-		return;
</a><a href="#h9-0-278" id="h9-0-278" class="d">-	sel-&gt;isfloating = !sel-&gt;isfloating;
</a><a href="#h9-0-279" id="h9-0-279" class="d">-	if(sel-&gt;isfloating)
</a><a href="#h9-0-280" id="h9-0-280" class="d">-		resize(sel, sel-&gt;x, sel-&gt;y, sel-&gt;w, sel-&gt;h, True);
</a><a href="#h9-0-281" id="h9-0-281" class="d">-	arrange();
</a><a href="#h9-0-282" id="h9-0-282" class="d">-}
</a><a href="#h9-0-283" id="h9-0-283" class="d">-
</a><a href="#h9-0-284" id="h9-0-284" class="d">-void
</a><a href="#h9-0-285" id="h9-0-285" class="d">-togglemax(const char *arg) {
</a><a href="#h9-0-286" id="h9-0-286" class="d">-	XEvent ev;
</a><a href="#h9-0-287" id="h9-0-287" class="d">-
</a><a href="#h9-0-288" id="h9-0-288" class="d">-	if(!sel || (!isfloating() &amp;&amp; !sel-&gt;isfloating) || sel-&gt;isfixed)
</a><a href="#h9-0-289" id="h9-0-289" class="d">-		return;
</a><a href="#h9-0-290" id="h9-0-290" class="d">-	if((sel-&gt;ismax = !sel-&gt;ismax)) {
</a><a href="#h9-0-291" id="h9-0-291" class="d">-		sel-&gt;rx = sel-&gt;x;
</a><a href="#h9-0-292" id="h9-0-292" class="d">-		sel-&gt;ry = sel-&gt;y;
</a><a href="#h9-0-293" id="h9-0-293" class="d">-		sel-&gt;rw = sel-&gt;w;
</a><a href="#h9-0-294" id="h9-0-294" class="d">-		sel-&gt;rh = sel-&gt;h;
</a><a href="#h9-0-295" id="h9-0-295" class="d">-		resize(sel, wax, way, waw - 2 * sel-&gt;border, wah - 2 * sel-&gt;border, True);
</a><a href="#h9-0-296" id="h9-0-296" class="d">-	}
</a><a href="#h9-0-297" id="h9-0-297" class="d">-	else
</a><a href="#h9-0-298" id="h9-0-298" class="d">-		resize(sel, sel-&gt;rx, sel-&gt;ry, sel-&gt;rw, sel-&gt;rh, True);
</a><a href="#h9-0-299" id="h9-0-299" class="d">-	drawbar();
</a><a href="#h9-0-300" id="h9-0-300" class="d">-	while(XCheckMaskEvent(dpy, EnterWindowMask, &amp;ev));
</a><a href="#h9-0-301" id="h9-0-301" class="d">-}
</a><a href="#h9-0-302" id="h9-0-302" class="d">-
</a><a href="#h9-0-303" id="h9-0-303" class="d">-void
</a><a href="#h9-0-304" id="h9-0-304" class="d">-toggletag(const char *arg) {
</a><a href="#h9-0-305" id="h9-0-305" class="d">-	unsigned int i, j;
</a><a href="#h9-0-306" id="h9-0-306" class="d">-
</a><a href="#h9-0-307" id="h9-0-307" class="d">-	if(!sel)
</a><a href="#h9-0-308" id="h9-0-308" class="d">-		return;
</a><a href="#h9-0-309" id="h9-0-309" class="d">-	i = idxoftag(arg);
</a><a href="#h9-0-310" id="h9-0-310" class="d">-	sel-&gt;tags[i] = !sel-&gt;tags[i];
</a><a href="#h9-0-311" id="h9-0-311" class="d">-	for(j = 0; j &lt; ntags &amp;&amp; !sel-&gt;tags[j]; j++);
</a><a href="#h9-0-312" id="h9-0-312" class="d">-	if(j == ntags)
</a><a href="#h9-0-313" id="h9-0-313" class="d">-		sel-&gt;tags[i] = True;
</a><a href="#h9-0-314" id="h9-0-314" class="d">-	arrange();
</a><a href="#h9-0-315" id="h9-0-315" class="d">-}
</a><a href="#h9-0-316" id="h9-0-316" class="d">-
</a><a href="#h9-0-317" id="h9-0-317" class="d">-void
</a><a href="#h9-0-318" id="h9-0-318" class="d">-toggleview(const char *arg) {
</a><a href="#h9-0-319" id="h9-0-319" class="d">-	unsigned int i, j;
</a><a href="#h9-0-320" id="h9-0-320" class="d">-
</a><a href="#h9-0-321" id="h9-0-321" class="d">-	i = idxoftag(arg);
</a><a href="#h9-0-322" id="h9-0-322" class="d">-	seltags[i] = !seltags[i];
</a><a href="#h9-0-323" id="h9-0-323" class="d">-	for(j = 0; j &lt; ntags &amp;&amp; !seltags[j]; j++);
</a><a href="#h9-0-324" id="h9-0-324" class="d">-	if(j == ntags)
</a><a href="#h9-0-325" id="h9-0-325" class="d">-		seltags[i] = True; /* cannot toggle last view */
</a><a href="#h9-0-326" id="h9-0-326" class="d">-	arrange();
</a><a href="#h9-0-327" id="h9-0-327" class="d">-}
</a><a href="#h9-0-328" id="h9-0-328" class="d">-
</a><a href="#h9-0-329" id="h9-0-329" class="d">-void
</a><a href="#h9-0-330" id="h9-0-330" class="d">-view(const char *arg) {
</a><a href="#h9-0-331" id="h9-0-331" class="d">-	unsigned int i;
</a><a href="#h9-0-332" id="h9-0-332" class="d">-
</a><a href="#h9-0-333" id="h9-0-333" class="d">-	for(i = 0; i &lt; ntags; i++)
</a><a href="#h9-0-334" id="h9-0-334" class="d">-		seltags[i] = arg == NULL;
</a><a href="#h9-0-335" id="h9-0-335" class="d">-	i = idxoftag(arg);
</a><a href="#h9-0-336" id="h9-0-336" class="d">-	if(i &gt;= 0 &amp;&amp; i &lt; ntags)
</a><a href="#h9-0-337" id="h9-0-337" class="d">-		seltags[i] = True;
</a><a href="#h9-0-338" id="h9-0-338" class="d">-	arrange();
</a><a href="#h9-0-339" id="h9-0-339" class="d">-}
</a><b>diff --git a/<a id="h10" href="../file/tile.c.html">tile.c</a> b/<a href="../file/tile.c.html">tile.c</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -1,85 +0,0 @@
</a><a href="#h10-0-0" id="h10-0-0" class="d">-/* See LICENSE file for copyright and license details. */
</a><a href="#h10-0-1" id="h10-0-1" class="d">-#include &quot;dwm.h&quot;
</a><a href="#h10-0-2" id="h10-0-2" class="d">-#include &lt;stdio.h&gt;
</a><a href="#h10-0-3" id="h10-0-3" class="d">-
</a><a href="#h10-0-4" id="h10-0-4" class="d">-/* static */
</a><a href="#h10-0-5" id="h10-0-5" class="d">-
</a><a href="#h10-0-6" id="h10-0-6" class="d">-static double mwfact = MWFACT;
</a><a href="#h10-0-7" id="h10-0-7" class="d">-
</a><a href="#h10-0-8" id="h10-0-8" class="d">-/* extern */
</a><a href="#h10-0-9" id="h10-0-9" class="d">-
</a><a href="#h10-0-10" id="h10-0-10" class="d">-void
</a><a href="#h10-0-11" id="h10-0-11" class="d">-setmwfact(const char *arg) {
</a><a href="#h10-0-12" id="h10-0-12" class="d">-	double delta;
</a><a href="#h10-0-13" id="h10-0-13" class="d">-
</a><a href="#h10-0-14" id="h10-0-14" class="d">-	if(!isarrange(tile))
</a><a href="#h10-0-15" id="h10-0-15" class="d">-		return;
</a><a href="#h10-0-16" id="h10-0-16" class="d">-	/* arg handling, manipulate mwfact */
</a><a href="#h10-0-17" id="h10-0-17" class="d">-	if(arg == NULL)
</a><a href="#h10-0-18" id="h10-0-18" class="d">-		mwfact = MWFACT;
</a><a href="#h10-0-19" id="h10-0-19" class="d">-	else if(1 == sscanf(arg, &quot;%lf&quot;, &amp;delta)) {
</a><a href="#h10-0-20" id="h10-0-20" class="d">-		if(arg[0] != &#39;+&#39; &amp;&amp; arg[0] != &#39;-&#39;)
</a><a href="#h10-0-21" id="h10-0-21" class="d">-			mwfact = delta;
</a><a href="#h10-0-22" id="h10-0-22" class="d">-		else
</a><a href="#h10-0-23" id="h10-0-23" class="d">-			mwfact += delta;
</a><a href="#h10-0-24" id="h10-0-24" class="d">-		if(mwfact &lt; 0.1)
</a><a href="#h10-0-25" id="h10-0-25" class="d">-			mwfact = 0.1;
</a><a href="#h10-0-26" id="h10-0-26" class="d">-		else if(mwfact &gt; 0.9)
</a><a href="#h10-0-27" id="h10-0-27" class="d">-			mwfact = 0.9;
</a><a href="#h10-0-28" id="h10-0-28" class="d">-	}
</a><a href="#h10-0-29" id="h10-0-29" class="d">-	arrange();
</a><a href="#h10-0-30" id="h10-0-30" class="d">-}
</a><a href="#h10-0-31" id="h10-0-31" class="d">-
</a><a href="#h10-0-32" id="h10-0-32" class="d">-void
</a><a href="#h10-0-33" id="h10-0-33" class="d">-tile(void) {
</a><a href="#h10-0-34" id="h10-0-34" class="d">-	unsigned int i, n, nx, ny, nw, nh, mw, th;
</a><a href="#h10-0-35" id="h10-0-35" class="d">-	Client *c;
</a><a href="#h10-0-36" id="h10-0-36" class="d">-
</a><a href="#h10-0-37" id="h10-0-37" class="d">-	for(n = 0, c = nexttiled(clients); c; c = nexttiled(c-&gt;next))
</a><a href="#h10-0-38" id="h10-0-38" class="d">-		n++;
</a><a href="#h10-0-39" id="h10-0-39" class="d">-
</a><a href="#h10-0-40" id="h10-0-40" class="d">-	/* window geoms */
</a><a href="#h10-0-41" id="h10-0-41" class="d">-	mw = (n == 1) ? waw : mwfact * waw;
</a><a href="#h10-0-42" id="h10-0-42" class="d">-	th = (n &gt; 1) ? wah / (n - 1) : 0;
</a><a href="#h10-0-43" id="h10-0-43" class="d">-	if(n &gt; 1 &amp;&amp; th &lt; bh)
</a><a href="#h10-0-44" id="h10-0-44" class="d">-		th = wah;
</a><a href="#h10-0-45" id="h10-0-45" class="d">-
</a><a href="#h10-0-46" id="h10-0-46" class="d">-	nx = wax;
</a><a href="#h10-0-47" id="h10-0-47" class="d">-	ny = way;
</a><a href="#h10-0-48" id="h10-0-48" class="d">-	for(i = 0, c = nexttiled(clients); c; c = nexttiled(c-&gt;next), i++) {
</a><a href="#h10-0-49" id="h10-0-49" class="d">-		c-&gt;ismax = False;
</a><a href="#h10-0-50" id="h10-0-50" class="d">-		if(i == 0) { /* master */
</a><a href="#h10-0-51" id="h10-0-51" class="d">-			nw = mw - 2 * c-&gt;border;
</a><a href="#h10-0-52" id="h10-0-52" class="d">-			nh = wah - 2 * c-&gt;border;
</a><a href="#h10-0-53" id="h10-0-53" class="d">-		}
</a><a href="#h10-0-54" id="h10-0-54" class="d">-		else {  /* tile window */
</a><a href="#h10-0-55" id="h10-0-55" class="d">-			if(i == 1) {
</a><a href="#h10-0-56" id="h10-0-56" class="d">-				ny = way;
</a><a href="#h10-0-57" id="h10-0-57" class="d">-				nx += mw;
</a><a href="#h10-0-58" id="h10-0-58" class="d">-			}
</a><a href="#h10-0-59" id="h10-0-59" class="d">-			nw = waw - mw - 2 * c-&gt;border;
</a><a href="#h10-0-60" id="h10-0-60" class="d">-			if(i + 1 == n) /* remainder */
</a><a href="#h10-0-61" id="h10-0-61" class="d">-				nh = (way + wah) - ny - 2 * c-&gt;border;
</a><a href="#h10-0-62" id="h10-0-62" class="d">-			else
</a><a href="#h10-0-63" id="h10-0-63" class="d">-				nh = th - 2 * c-&gt;border;
</a><a href="#h10-0-64" id="h10-0-64" class="d">-		}
</a><a href="#h10-0-65" id="h10-0-65" class="d">-		resize(c, nx, ny, nw, nh, RESIZEHINTS);
</a><a href="#h10-0-66" id="h10-0-66" class="d">-		if(n &gt; 1 &amp;&amp; th != wah)
</a><a href="#h10-0-67" id="h10-0-67" class="d">-			ny += nh + 2 * c-&gt;border;
</a><a href="#h10-0-68" id="h10-0-68" class="d">-	}
</a><a href="#h10-0-69" id="h10-0-69" class="d">-}
</a><a href="#h10-0-70" id="h10-0-70" class="d">-
</a><a href="#h10-0-71" id="h10-0-71" class="d">-void
</a><a href="#h10-0-72" id="h10-0-72" class="d">-zoom(const char *arg) {
</a><a href="#h10-0-73" id="h10-0-73" class="d">-	Client *c;
</a><a href="#h10-0-74" id="h10-0-74" class="d">-
</a><a href="#h10-0-75" id="h10-0-75" class="d">-	if(!sel || !isarrange(tile) || sel-&gt;isfloating)
</a><a href="#h10-0-76" id="h10-0-76" class="d">-		return;
</a><a href="#h10-0-77" id="h10-0-77" class="d">-	if((c = sel) == nexttiled(clients))
</a><a href="#h10-0-78" id="h10-0-78" class="d">-		if(!(c = nexttiled(c-&gt;next)))
</a><a href="#h10-0-79" id="h10-0-79" class="d">-			return;
</a><a href="#h10-0-80" id="h10-0-80" class="d">-	detach(c);
</a><a href="#h10-0-81" id="h10-0-81" class="d">-	attach(c);
</a><a href="#h10-0-82" id="h10-0-82" class="d">-	focus(c);
</a><a href="#h10-0-83" id="h10-0-83" class="d">-	arrange();
</a><a href="#h10-0-84" id="h10-0-84" class="d">-}
</a><b>diff --git a/<a id="h11" href="../file/tile.h.html">tile.h</a> b/<a href="../file/tile.h.html">tile.h</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -1,6 +0,0 @@
</a><a href="#h11-0-0" id="h11-0-0" class="d">-/* See LICENSE file for copyright and license details. */
</a><a href="#h11-0-1" id="h11-0-1" class="d">-
</a><a href="#h11-0-2" id="h11-0-2" class="d">-/* tile.c */
</a><a href="#h11-0-3" id="h11-0-3" class="d">-void setmwfact(const char *arg);	/* sets master width factor */
</a><a href="#h11-0-4" id="h11-0-4" class="d">-void tile(void);			/* arranges all windows tiled */
</a><a href="#h11-0-5" id="h11-0-5" class="d">-void zoom(const char *arg);		/* zooms the focused client to master area, arg is ignored */
</a><b>diff --git a/<a id="h12" href="../file/util.c.html">util.c</a> b/<a href="../file/util.c.html">util.c</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -1,52 +0,0 @@
</a><a href="#h12-0-0" id="h12-0-0" class="d">-/* See LICENSE file for copyright and license details. */
</a><a href="#h12-0-1" id="h12-0-1" class="d">-#include &quot;dwm.h&quot;
</a><a href="#h12-0-2" id="h12-0-2" class="d">-#include &lt;stdarg.h&gt;
</a><a href="#h12-0-3" id="h12-0-3" class="d">-#include &lt;stdio.h&gt;
</a><a href="#h12-0-4" id="h12-0-4" class="d">-#include &lt;stdlib.h&gt;
</a><a href="#h12-0-5" id="h12-0-5" class="d">-#include &lt;sys/wait.h&gt;
</a><a href="#h12-0-6" id="h12-0-6" class="d">-#include &lt;unistd.h&gt;
</a><a href="#h12-0-7" id="h12-0-7" class="d">-
</a><a href="#h12-0-8" id="h12-0-8" class="d">-/* extern */
</a><a href="#h12-0-9" id="h12-0-9" class="d">-
</a><a href="#h12-0-10" id="h12-0-10" class="d">-void *
</a><a href="#h12-0-11" id="h12-0-11" class="d">-emallocz(unsigned int size) {
</a><a href="#h12-0-12" id="h12-0-12" class="d">-	void *res = calloc(1, size);
</a><a href="#h12-0-13" id="h12-0-13" class="d">-
</a><a href="#h12-0-14" id="h12-0-14" class="d">-	if(!res)
</a><a href="#h12-0-15" id="h12-0-15" class="d">-		eprint(&quot;fatal: could not malloc() %u bytes\n&quot;, size);
</a><a href="#h12-0-16" id="h12-0-16" class="d">-	return res;
</a><a href="#h12-0-17" id="h12-0-17" class="d">-}
</a><a href="#h12-0-18" id="h12-0-18" class="d">-
</a><a href="#h12-0-19" id="h12-0-19" class="d">-void
</a><a href="#h12-0-20" id="h12-0-20" class="d">-eprint(const char *errstr, ...) {
</a><a href="#h12-0-21" id="h12-0-21" class="d">-	va_list ap;
</a><a href="#h12-0-22" id="h12-0-22" class="d">-
</a><a href="#h12-0-23" id="h12-0-23" class="d">-	va_start(ap, errstr);
</a><a href="#h12-0-24" id="h12-0-24" class="d">-	vfprintf(stderr, errstr, ap);
</a><a href="#h12-0-25" id="h12-0-25" class="d">-	va_end(ap);
</a><a href="#h12-0-26" id="h12-0-26" class="d">-	exit(EXIT_FAILURE);
</a><a href="#h12-0-27" id="h12-0-27" class="d">-}
</a><a href="#h12-0-28" id="h12-0-28" class="d">-
</a><a href="#h12-0-29" id="h12-0-29" class="d">-void
</a><a href="#h12-0-30" id="h12-0-30" class="d">-spawn(const char *arg) {
</a><a href="#h12-0-31" id="h12-0-31" class="d">-	static char *shell = NULL;
</a><a href="#h12-0-32" id="h12-0-32" class="d">-
</a><a href="#h12-0-33" id="h12-0-33" class="d">-	if(!shell &amp;&amp; !(shell = getenv(&quot;SHELL&quot;)))
</a><a href="#h12-0-34" id="h12-0-34" class="d">-		shell = &quot;/bin/sh&quot;;
</a><a href="#h12-0-35" id="h12-0-35" class="d">-	if(!arg)
</a><a href="#h12-0-36" id="h12-0-36" class="d">-		return;
</a><a href="#h12-0-37" id="h12-0-37" class="d">-	/* The double-fork construct avoids zombie processes and keeps the code
</a><a href="#h12-0-38" id="h12-0-38" class="d">-	 * clean from stupid signal handlers. */
</a><a href="#h12-0-39" id="h12-0-39" class="d">-	if(fork() == 0) {
</a><a href="#h12-0-40" id="h12-0-40" class="d">-		if(fork() == 0) {
</a><a href="#h12-0-41" id="h12-0-41" class="d">-			if(dpy)
</a><a href="#h12-0-42" id="h12-0-42" class="d">-				close(ConnectionNumber(dpy));
</a><a href="#h12-0-43" id="h12-0-43" class="d">-			setsid();
</a><a href="#h12-0-44" id="h12-0-44" class="d">-			execl(shell, shell, &quot;-c&quot;, arg, (char *)NULL);
</a><a href="#h12-0-45" id="h12-0-45" class="d">-			fprintf(stderr, &quot;dwm: execl &#39;%s -c %s&#39;&quot;, shell, arg);
</a><a href="#h12-0-46" id="h12-0-46" class="d">-			perror(&quot; failed&quot;);
</a><a href="#h12-0-47" id="h12-0-47" class="d">-		}
</a><a href="#h12-0-48" id="h12-0-48" class="d">-		exit(0);
</a><a href="#h12-0-49" id="h12-0-49" class="d">-	}
</a><a href="#h12-0-50" id="h12-0-50" class="d">-	wait(0);
</a><a href="#h12-0-51" id="h12-0-51" class="d">-}
</a></pre>
</div>
</body>
</html>
