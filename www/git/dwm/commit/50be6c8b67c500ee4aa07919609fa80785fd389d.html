<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>cleaned up settags-handling - dwm - dynamic window manager
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="dwm Atom Feed" href="../atom.xml" />
<link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="/logo.png" alt="" width="32" height="32" /></a></td><td><h1>dwm</h1><span class="desc">dynamic window manager
</span></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/50be6c8b67c500ee4aa07919609fa80785fd389d.html">50be6c8b67c500ee4aa07919609fa80785fd389d</a>
<b>parent</b> <a href="../commit/7d156dee1e80f7d26aa0a31a6d2c75af06cbaa9a.html">7d156dee1e80f7d26aa0a31a6d2c75af06cbaa9a</a>
<b>Author:</b> Anselm R. Garbe &lt;<a href="mailto:garbeam@gmail.com">garbeam@gmail.com</a>&gt;
<b>Date:</b>   Sat, 18 Aug 2007 13:48:05 +0200

cleaned up settags-handling
<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">client.c</a></td><td> | </td><td class="num">45</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">dwm.h</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">layout.c</a></td><td> | </td><td class="num">18</td><td><span class="i">+++++++++</span><span class="d">---------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">tag.c</a></td><td> | </td><td class="num">104</td><td><span class="i">++++++++++++++++++++++++++</span><span class="d">-----------------------------------------------------</span></td></tr>
</table></pre><pre>4 files changed, 90 insertions(+), 81 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/client.c.html">client.c</a> b/<a href="../file/client.c.html">client.c</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -7,6 +7,8 @@
</a> 
 /* static */
 
<a href="#h0-0-3" id="h0-0-3" class="i">+static char config[128];
</a><a href="#h0-0-4" id="h0-0-4" class="i">+
</a> static void
 attachstack(Client *c) {
 	c-&gt;snext = stack;
<a href="#h0-1" id="h0-1" class="h">@@ -179,8 +181,31 @@ killclient(const char *arg) {
</a> 		XKillClient(dpy, sel-&gt;win);
 }
 
<a href="#h0-1-3" id="h0-1-3" class="i">+Bool
</a><a href="#h0-1-4" id="h0-1-4" class="i">+loadconfig(Client *c) {
</a><a href="#h0-1-5" id="h0-1-5" class="i">+	unsigned int i;
</a><a href="#h0-1-6" id="h0-1-6" class="i">+	Bool result = False;
</a><a href="#h0-1-7" id="h0-1-7" class="i">+	XTextProperty name;
</a><a href="#h0-1-8" id="h0-1-8" class="i">+
</a><a href="#h0-1-9" id="h0-1-9" class="i">+	/* check if window has set a property */
</a><a href="#h0-1-10" id="h0-1-10" class="i">+	name.nitems = 0;
</a><a href="#h0-1-11" id="h0-1-11" class="i">+	XGetTextProperty(dpy, c-&gt;win, &amp;name, dwmconfig);
</a><a href="#h0-1-12" id="h0-1-12" class="i">+	if(name.nitems &amp;&amp; name.encoding == XA_STRING) {
</a><a href="#h0-1-13" id="h0-1-13" class="i">+		strncpy(config, (char *)name.value, sizeof config - 1);
</a><a href="#h0-1-14" id="h0-1-14" class="i">+		config[sizeof config - 1] = &#39;\0&#39;;
</a><a href="#h0-1-15" id="h0-1-15" class="i">+		XFree(name.value);
</a><a href="#h0-1-16" id="h0-1-16" class="i">+		for(i = 0; i &lt; ntags &amp;&amp; i &lt; sizeof config - 1 &amp;&amp; config[i] != &#39;\0&#39;; i++)
</a><a href="#h0-1-17" id="h0-1-17" class="i">+			if((c-&gt;tags[i] = config[i] == &#39;1&#39;))
</a><a href="#h0-1-18" id="h0-1-18" class="i">+				result = True;
</a><a href="#h0-1-19" id="h0-1-19" class="i">+		if(i &lt; sizeof config - 1 &amp;&amp; config[i] != &#39;\0&#39;)
</a><a href="#h0-1-20" id="h0-1-20" class="i">+			c-&gt;isfloating = config[i] == &#39;1&#39;;
</a><a href="#h0-1-21" id="h0-1-21" class="i">+	}
</a><a href="#h0-1-22" id="h0-1-22" class="i">+	return result;
</a><a href="#h0-1-23" id="h0-1-23" class="i">+}
</a><a href="#h0-1-24" id="h0-1-24" class="i">+
</a> void
 manage(Window w, XWindowAttributes *wa) {
<a href="#h0-1-27" id="h0-1-27" class="i">+	unsigned int i;
</a> 	Client *c, *t = NULL;
 	Window trans;
 	Status rettrans;
<a href="#h0-2" id="h0-2" class="h">@@ -221,9 +246,14 @@ manage(Window w, XWindowAttributes *wa) {
</a> 	updatetitle(c);
 	if((rettrans = XGetTransientForHint(dpy, w, &amp;trans) == Success))
 		for(t = clients; t &amp;&amp; t-&gt;win != trans; t = t-&gt;next);
<a href="#h0-2-3" id="h0-2-3" class="d">-	settags(c, t);
</a><a href="#h0-2-4" id="h0-2-4" class="i">+	if(t)
</a><a href="#h0-2-5" id="h0-2-5" class="i">+		for(i = 0; i &lt; ntags; i++)
</a><a href="#h0-2-6" id="h0-2-6" class="i">+			c-&gt;tags[i] = t-&gt;tags[i];
</a><a href="#h0-2-7" id="h0-2-7" class="i">+	if(!loadconfig(c))
</a><a href="#h0-2-8" id="h0-2-8" class="i">+		applyrules(c);
</a> 	if(!c-&gt;isfloating)
 		c-&gt;isfloating = (rettrans == Success) || c-&gt;isfixed;
<a href="#h0-2-11" id="h0-2-11" class="i">+	saveconfig(c);
</a> 	attach(c);
 	attachstack(c);
 	XMoveResizeWindow(dpy, c-&gt;win, c-&gt;x, c-&gt;y, c-&gt;w, c-&gt;h); /* some windows require this */
<a href="#h0-3" id="h0-3" class="h">@@ -295,6 +325,19 @@ resize(Client *c, int x, int y, int w, int h, Bool sizehints) {
</a> }
 
 void
<a href="#h0-3-3" id="h0-3-3" class="i">+saveconfig(Client *c) {
</a><a href="#h0-3-4" id="h0-3-4" class="i">+	unsigned int i;
</a><a href="#h0-3-5" id="h0-3-5" class="i">+
</a><a href="#h0-3-6" id="h0-3-6" class="i">+	for(i = 0; i &lt; ntags &amp;&amp; i &lt; sizeof config - 1; i++)
</a><a href="#h0-3-7" id="h0-3-7" class="i">+		config[i] = c-&gt;tags[i] ? &#39;1&#39; : &#39;0&#39;;
</a><a href="#h0-3-8" id="h0-3-8" class="i">+	if(i &lt; sizeof config - 1)
</a><a href="#h0-3-9" id="h0-3-9" class="i">+		config[i++] = c-&gt;isfloating ? &#39;1&#39; : &#39;0&#39;;
</a><a href="#h0-3-10" id="h0-3-10" class="i">+	config[i] = &#39;\0&#39;;
</a><a href="#h0-3-11" id="h0-3-11" class="i">+	XChangeProperty(dpy, c-&gt;win, dwmconfig, XA_STRING, 8,
</a><a href="#h0-3-12" id="h0-3-12" class="i">+			PropModeReplace, (unsigned char *)config, i);
</a><a href="#h0-3-13" id="h0-3-13" class="i">+}
</a><a href="#h0-3-14" id="h0-3-14" class="i">+
</a><a href="#h0-3-15" id="h0-3-15" class="i">+void
</a> unban(Client *c) {
 	if(!c-&gt;isbanned)
 		return;
<b>diff --git a/<a id="h1" href="../file/dwm.h.html">dwm.h</a> b/<a href="../file/dwm.h.html">dwm.h</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -96,9 +96,11 @@ void configure(Client *c);		/* send synthetic configure event */
</a> void detach(Client *c);			/* detaches c from global client list */
 void focus(Client *c);			/* focus c if visible &amp;&amp; !NULL, or focus top visible */
 void killclient(const char *arg);	/* kill sel  nicely */
<a href="#h1-0-3" id="h1-0-3" class="i">+Bool loadconfig(Client *c);		/* loads client properties */
</a> void manage(Window w, XWindowAttributes *wa);	/* manage new client */
 void resize(Client *c, int x, int y,
 		int w, int h, Bool sizehints);	/* resize with given coordinates c*/
<a href="#h1-0-7" id="h1-0-7" class="i">+void saveconfig(Client *c);		/* saves client properties */
</a> void unban(Client *c);			/* unbans c */
 void unmanage(Client *c, long state);	/* unmanage c */
 void updatesizehints(Client *c);	/* update the size hint variables of c */
<a href="#h1-1" id="h1-1" class="h">@@ -132,9 +134,9 @@ void quit(const char *arg);		/* quit dwm nicely */
</a> int xerror(Display *dsply, XErrorEvent *ee);	/* dwm&#39;s X error handler */
 
 /* tag.c */
<a href="#h1-1-3" id="h1-1-3" class="i">+void applyrules(Client *c);		/* applies rules to c */
</a> void compileregs(void);			/* initialize regexps of rules defined in config.h */
 Bool isvisible(Client *c);		/* returns True if client is visible */
<a href="#h1-1-6" id="h1-1-6" class="d">-void settags(Client *c, Client *trans);	/* sets tags of c */
</a> void tag(const char *arg);		/* tags sel with arg&#39;s index */
 void togglefloating(const char *arg);	/* toggles sel between floating/tiled state */
 void toggletag(const char *arg);	/* toggles sel tags with arg&#39;s index */
<b>diff --git a/<a id="h2" href="../file/layout.c.html">layout.c</a> b/<a href="../file/layout.c.html">layout.c</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -10,7 +10,7 @@ typedef struct {
</a> } Layout;
 
 unsigned int blw = 0;
<a href="#h2-0-3" id="h2-0-3" class="d">-static unsigned int sellayout = 0; /* default */
</a><a href="#h2-0-4" id="h2-0-4" class="i">+static unsigned int ltidx = 0; /* default */
</a> 
 static void
 floating(void) { /* default floating layout */
<a href="#h2-1" id="h2-1" class="h">@@ -36,7 +36,7 @@ arrange(void) {
</a> 			unban(c);
 		else
 			ban(c);
<a href="#h2-1-3" id="h2-1-3" class="d">-	layouts[sellayout].arrange();
</a><a href="#h2-1-4" id="h2-1-4" class="i">+	layouts[ltidx].arrange();
</a> 	focus(NULL);
 	restack();
 }
<a href="#h2-2" id="h2-2" class="h">@@ -76,25 +76,25 @@ focusprev(const char *arg) {
</a> const char *
 getsymbol(void)
 {
<a href="#h2-2-3" id="h2-2-3" class="d">-	return layouts[sellayout].symbol;
</a><a href="#h2-2-4" id="h2-2-4" class="i">+	return layouts[ltidx].symbol;
</a> }
 
 Bool
 isfloating(void) {
<a href="#h2-2-9" id="h2-2-9" class="d">-	return layouts[sellayout].arrange == floating;
</a><a href="#h2-2-10" id="h2-2-10" class="i">+	return layouts[ltidx].arrange == floating;
</a> }
 
 Bool
 isarrange(void (*func)())
 {
<a href="#h2-2-16" id="h2-2-16" class="d">-	return func == layouts[sellayout].arrange;
</a><a href="#h2-2-17" id="h2-2-17" class="i">+	return func == layouts[ltidx].arrange;
</a> }
 
 void
 initlayouts(void) {
 	unsigned int i, w;
 
<a href="#h2-2-24" id="h2-2-24" class="d">-	/* TODO deserialize sellayout if present */
</a><a href="#h2-2-25" id="h2-2-25" class="i">+	/* TODO deserialize ltidx if present */
</a> 	nlayouts = sizeof layouts / sizeof layouts[0];
 	for(blw = i = 0; i &lt; nlayouts; i++) {
 		w = textw(layouts[i].symbol);
<a href="#h2-3" id="h2-3" class="h">@@ -143,14 +143,14 @@ setlayout(const char *arg) {
</a> 	int i;
 
 	if(!arg) {
<a href="#h2-3-3" id="h2-3-3" class="d">-		if(++sellayout == nlayouts)
</a><a href="#h2-3-4" id="h2-3-4" class="d">-			sellayout = 0;;
</a><a href="#h2-3-5" id="h2-3-5" class="i">+		if(++ltidx == nlayouts)
</a><a href="#h2-3-6" id="h2-3-6" class="i">+			ltidx = 0;;
</a> 	}
 	else {
 		i = atoi(arg);
 		if(i &lt; 0 || i &gt;= nlayouts)
 			return;
<a href="#h2-3-12" id="h2-3-12" class="d">-		sellayout = i;
</a><a href="#h2-3-13" id="h2-3-13" class="i">+		ltidx = i;
</a> 	}
 	if(sel)
 		arrange();
<b>diff --git a/<a id="h3" href="../file/tag.c.html">tag.c</a> b/<a href="../file/tag.c.html">tag.c</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -27,19 +27,6 @@ static Regs *regs = NULL;
</a> static unsigned int nrules = 0;
 static char prop[512];
 
<a href="#h3-0-3" id="h3-0-3" class="d">-static void
</a><a href="#h3-0-4" id="h3-0-4" class="d">-persistconfig(Client *c) {
</a><a href="#h3-0-5" id="h3-0-5" class="d">-	unsigned int i;
</a><a href="#h3-0-6" id="h3-0-6" class="d">-
</a><a href="#h3-0-7" id="h3-0-7" class="d">-	for(i = 0; i &lt; ntags &amp;&amp; i &lt; sizeof prop - 1; i++)
</a><a href="#h3-0-8" id="h3-0-8" class="d">-		prop[i] = c-&gt;tags[i] ? &#39;1&#39; : &#39;0&#39;;
</a><a href="#h3-0-9" id="h3-0-9" class="d">-	if(i &lt; sizeof prop - 1)
</a><a href="#h3-0-10" id="h3-0-10" class="d">-		prop[i++] = c-&gt;isfloating ? &#39;1&#39; : &#39;0&#39;;
</a><a href="#h3-0-11" id="h3-0-11" class="d">-	prop[i] = &#39;\0&#39;;
</a><a href="#h3-0-12" id="h3-0-12" class="d">-	XChangeProperty(dpy, c-&gt;win, dwmconfig, XA_STRING, 8,
</a><a href="#h3-0-13" id="h3-0-13" class="d">-			PropModeReplace, (unsigned char *)prop, i);
</a><a href="#h3-0-14" id="h3-0-14" class="d">-}
</a><a href="#h3-0-15" id="h3-0-15" class="d">-
</a> static unsigned int
 idxoftag(const char *tag) {
 	unsigned int i;
<a href="#h3-1" id="h3-1" class="h">@@ -53,6 +40,37 @@ idxoftag(const char *tag) {
</a> /* extern */
 
 void
<a href="#h3-1-3" id="h3-1-3" class="i">+applyrules(Client *c) {
</a><a href="#h3-1-4" id="h3-1-4" class="i">+	unsigned int i, j;
</a><a href="#h3-1-5" id="h3-1-5" class="i">+	regmatch_t tmp;
</a><a href="#h3-1-6" id="h3-1-6" class="i">+	Bool matched = False;
</a><a href="#h3-1-7" id="h3-1-7" class="i">+	XClassHint ch = { 0 };
</a><a href="#h3-1-8" id="h3-1-8" class="i">+
</a><a href="#h3-1-9" id="h3-1-9" class="i">+	/* rule matching */
</a><a href="#h3-1-10" id="h3-1-10" class="i">+	XGetClassHint(dpy, c-&gt;win, &amp;ch);
</a><a href="#h3-1-11" id="h3-1-11" class="i">+	snprintf(prop, sizeof prop, &quot;%s:%s:%s&quot;,
</a><a href="#h3-1-12" id="h3-1-12" class="i">+			ch.res_class ? ch.res_class : &quot;&quot;,
</a><a href="#h3-1-13" id="h3-1-13" class="i">+			ch.res_name ? ch.res_name : &quot;&quot;, c-&gt;name);
</a><a href="#h3-1-14" id="h3-1-14" class="i">+	for(i = 0; i &lt; nrules; i++)
</a><a href="#h3-1-15" id="h3-1-15" class="i">+		if(regs[i].propregex &amp;&amp; !regexec(regs[i].propregex, prop, 1, &amp;tmp, 0)) {
</a><a href="#h3-1-16" id="h3-1-16" class="i">+			c-&gt;isfloating = rules[i].isfloating;
</a><a href="#h3-1-17" id="h3-1-17" class="i">+			for(j = 0; regs[i].tagregex &amp;&amp; j &lt; ntags; j++) {
</a><a href="#h3-1-18" id="h3-1-18" class="i">+				if(!regexec(regs[i].tagregex, tags[j], 1, &amp;tmp, 0)) {
</a><a href="#h3-1-19" id="h3-1-19" class="i">+					matched = True;
</a><a href="#h3-1-20" id="h3-1-20" class="i">+					c-&gt;tags[j] = True;
</a><a href="#h3-1-21" id="h3-1-21" class="i">+				}
</a><a href="#h3-1-22" id="h3-1-22" class="i">+			}
</a><a href="#h3-1-23" id="h3-1-23" class="i">+		}
</a><a href="#h3-1-24" id="h3-1-24" class="i">+	if(ch.res_class)
</a><a href="#h3-1-25" id="h3-1-25" class="i">+		XFree(ch.res_class);
</a><a href="#h3-1-26" id="h3-1-26" class="i">+	if(ch.res_name)
</a><a href="#h3-1-27" id="h3-1-27" class="i">+		XFree(ch.res_name);
</a><a href="#h3-1-28" id="h3-1-28" class="i">+	if(!matched)
</a><a href="#h3-1-29" id="h3-1-29" class="i">+		for(i = 0; i &lt; ntags; i++)
</a><a href="#h3-1-30" id="h3-1-30" class="i">+			c-&gt;tags[i] = seltags[i];
</a><a href="#h3-1-31" id="h3-1-31" class="i">+}
</a><a href="#h3-1-32" id="h3-1-32" class="i">+
</a><a href="#h3-1-33" id="h3-1-33" class="i">+void
</a> compileregs(void) {
 	unsigned int i;
 	regex_t *reg;
<a href="#h3-2" id="h3-2" class="h">@@ -90,60 +108,6 @@ isvisible(Client *c) {
</a> }
 
 void
<a href="#h3-2-3" id="h3-2-3" class="d">-settags(Client *c, Client *trans) {
</a><a href="#h3-2-4" id="h3-2-4" class="d">-	unsigned int i, j;
</a><a href="#h3-2-5" id="h3-2-5" class="d">-	regmatch_t tmp;
</a><a href="#h3-2-6" id="h3-2-6" class="d">-	Bool matched = trans != NULL;
</a><a href="#h3-2-7" id="h3-2-7" class="d">-	XClassHint ch = { 0 };
</a><a href="#h3-2-8" id="h3-2-8" class="d">-	XTextProperty name;
</a><a href="#h3-2-9" id="h3-2-9" class="d">-
</a><a href="#h3-2-10" id="h3-2-10" class="d">-	if(matched) {
</a><a href="#h3-2-11" id="h3-2-11" class="d">-		for(i = 0; i &lt; ntags; i++)
</a><a href="#h3-2-12" id="h3-2-12" class="d">-			c-&gt;tags[i] = trans-&gt;tags[i];
</a><a href="#h3-2-13" id="h3-2-13" class="d">-	}
</a><a href="#h3-2-14" id="h3-2-14" class="d">-	else {
</a><a href="#h3-2-15" id="h3-2-15" class="d">-		/* check if window has set a property */
</a><a href="#h3-2-16" id="h3-2-16" class="d">-		name.nitems = 0;
</a><a href="#h3-2-17" id="h3-2-17" class="d">-		XGetTextProperty(dpy, c-&gt;win, &amp;name, dwmconfig);
</a><a href="#h3-2-18" id="h3-2-18" class="d">-		if(name.nitems &amp;&amp; name.encoding == XA_STRING) {
</a><a href="#h3-2-19" id="h3-2-19" class="d">-			strncpy(prop, (char *)name.value, sizeof prop - 1);
</a><a href="#h3-2-20" id="h3-2-20" class="d">-			prop[sizeof prop - 1] = &#39;\0&#39;;
</a><a href="#h3-2-21" id="h3-2-21" class="d">-			XFree(name.value);
</a><a href="#h3-2-22" id="h3-2-22" class="d">-			for(i = 0; i &lt; ntags &amp;&amp; i &lt; sizeof prop - 1 &amp;&amp; prop[i] != &#39;\0&#39;; i++)
</a><a href="#h3-2-23" id="h3-2-23" class="d">-				if((c-&gt;tags[i] = prop[i] == &#39;1&#39;))
</a><a href="#h3-2-24" id="h3-2-24" class="d">-					matched = True;
</a><a href="#h3-2-25" id="h3-2-25" class="d">-			if(i &lt; sizeof prop - 1 &amp;&amp; prop[i] != &#39;\0&#39;)
</a><a href="#h3-2-26" id="h3-2-26" class="d">-				c-&gt;isfloating = prop[i] == &#39;1&#39;;
</a><a href="#h3-2-27" id="h3-2-27" class="d">-		}
</a><a href="#h3-2-28" id="h3-2-28" class="d">-	}
</a><a href="#h3-2-29" id="h3-2-29" class="d">-	if(!matched) {
</a><a href="#h3-2-30" id="h3-2-30" class="d">-		/* rule matching */
</a><a href="#h3-2-31" id="h3-2-31" class="d">-		XGetClassHint(dpy, c-&gt;win, &amp;ch);
</a><a href="#h3-2-32" id="h3-2-32" class="d">-		snprintf(prop, sizeof prop, &quot;%s:%s:%s&quot;,
</a><a href="#h3-2-33" id="h3-2-33" class="d">-				ch.res_class ? ch.res_class : &quot;&quot;,
</a><a href="#h3-2-34" id="h3-2-34" class="d">-				ch.res_name ? ch.res_name : &quot;&quot;, c-&gt;name);
</a><a href="#h3-2-35" id="h3-2-35" class="d">-		for(i = 0; i &lt; nrules; i++)
</a><a href="#h3-2-36" id="h3-2-36" class="d">-			if(regs[i].propregex &amp;&amp; !regexec(regs[i].propregex, prop, 1, &amp;tmp, 0)) {
</a><a href="#h3-2-37" id="h3-2-37" class="d">-				c-&gt;isfloating = rules[i].isfloating;
</a><a href="#h3-2-38" id="h3-2-38" class="d">-				for(j = 0; regs[i].tagregex &amp;&amp; j &lt; ntags; j++) {
</a><a href="#h3-2-39" id="h3-2-39" class="d">-					if(!regexec(regs[i].tagregex, tags[j], 1, &amp;tmp, 0)) {
</a><a href="#h3-2-40" id="h3-2-40" class="d">-						matched = True;
</a><a href="#h3-2-41" id="h3-2-41" class="d">-						c-&gt;tags[j] = True;
</a><a href="#h3-2-42" id="h3-2-42" class="d">-					}
</a><a href="#h3-2-43" id="h3-2-43" class="d">-				}
</a><a href="#h3-2-44" id="h3-2-44" class="d">-			}
</a><a href="#h3-2-45" id="h3-2-45" class="d">-		if(ch.res_class)
</a><a href="#h3-2-46" id="h3-2-46" class="d">-			XFree(ch.res_class);
</a><a href="#h3-2-47" id="h3-2-47" class="d">-		if(ch.res_name)
</a><a href="#h3-2-48" id="h3-2-48" class="d">-			XFree(ch.res_name);
</a><a href="#h3-2-49" id="h3-2-49" class="d">-	}
</a><a href="#h3-2-50" id="h3-2-50" class="d">-	if(!matched)
</a><a href="#h3-2-51" id="h3-2-51" class="d">-		for(i = 0; i &lt; ntags; i++)
</a><a href="#h3-2-52" id="h3-2-52" class="d">-			c-&gt;tags[i] = seltags[i];
</a><a href="#h3-2-53" id="h3-2-53" class="d">-	persistconfig(c);
</a><a href="#h3-2-54" id="h3-2-54" class="d">-}
</a><a href="#h3-2-55" id="h3-2-55" class="d">-
</a><a href="#h3-2-56" id="h3-2-56" class="d">-void
</a> tag(const char *arg) {
 	unsigned int i;
 
<a href="#h3-3" id="h3-3" class="h">@@ -154,7 +118,7 @@ tag(const char *arg) {
</a> 	i = idxoftag(arg);
 	if(i &gt;= 0 &amp;&amp; i &lt; ntags)
 		sel-&gt;tags[i] = True;
<a href="#h3-3-3" id="h3-3-3" class="d">-	persistconfig(sel);
</a><a href="#h3-3-4" id="h3-3-4" class="i">+	saveconfig(sel);
</a> 	arrange();
 }
 
<a href="#h3-4" id="h3-4" class="h">@@ -165,7 +129,7 @@ togglefloating(const char *arg) {
</a> 	sel-&gt;isfloating = !sel-&gt;isfloating;
 	if(sel-&gt;isfloating) {
 		resize(sel, sel-&gt;x, sel-&gt;y, sel-&gt;w, sel-&gt;h, True);
<a href="#h3-4-3" id="h3-4-3" class="d">-		persistconfig(sel);
</a><a href="#h3-4-4" id="h3-4-4" class="i">+		saveconfig(sel);
</a> 	}
 	arrange();
 }
<a href="#h3-5" id="h3-5" class="h">@@ -181,7 +145,7 @@ toggletag(const char *arg) {
</a> 	for(j = 0; j &lt; ntags &amp;&amp; !sel-&gt;tags[j]; j++);
 	if(j == ntags)
 		sel-&gt;tags[i] = True;
<a href="#h3-5-3" id="h3-5-3" class="d">-	persistconfig(sel);
</a><a href="#h3-5-4" id="h3-5-4" class="i">+	saveconfig(sel);
</a> 	arrange();
 }
 
</pre>
</div>
</body>
</html>
