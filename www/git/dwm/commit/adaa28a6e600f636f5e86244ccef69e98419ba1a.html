<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>proceeded with cleaning up, sorting functions, etc - dwm - dynamic window manager
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="dwm Atom Feed" href="../atom.xml" />
<link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="/logo.png" alt="" width="32" height="32" /></a></td><td><h1>dwm</h1><span class="desc">dynamic window manager
</span></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/adaa28a6e600f636f5e86244ccef69e98419ba1a.html">adaa28a6e600f636f5e86244ccef69e98419ba1a</a>
<b>parent</b> <a href="../commit/dba23062bad40afb1a90f60b6897cf9e1ca5035b.html">dba23062bad40afb1a90f60b6897cf9e1ca5035b</a>
<b>Author:</b> Anselm R. Garbe &lt;<a href="mailto:garbeam@wmii.de">garbeam@wmii.de</a>&gt;
<b>Date:</b>   Sat, 15 Jul 2006 17:00:56 +0200

proceeded with cleaning up, sorting functions, etc

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">client.c</a></td><td> | </td><td class="num">411</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">draw.c</a></td><td> | </td><td class="num">146</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">dwm.h</a></td><td> | </td><td class="num">39</td><td><span class="i">+++++++++++++++++++</span><span class="d">--------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">event.c</a></td><td> | </td><td class="num">266</td><td><span class="i">++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">main.c</a></td><td> | </td><td class="num">71</td><td><span class="i">+++++++++++++++++++++++++++++</span><span class="d">------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">tag.c</a></td><td> | </td><td class="num">118</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">util.c</a></td><td> | </td><td class="num">24</td><td><span class="i">+++++++++++++</span><span class="d">-----------</span></td></tr>
</table></pre><pre>7 files changed, 532 insertions(+), 543 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/client.c.html">client.c</a> b/<a href="../file/client.c.html">client.c</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -2,21 +2,14 @@
</a>  * (C)opyright MMVI Anselm R. Garbe &lt;garbeam at gmail dot com&gt;
  * See LICENSE file for license details.
  */
<a href="#h0-0-3" id="h0-0-3" class="i">+#include &quot;dwm.h&quot;
</a> 
 #include &lt;stdlib.h&gt;
<a href="#h0-0-6" id="h0-0-6" class="d">-#include &lt;stdio.h&gt;
</a> #include &lt;string.h&gt;
 #include &lt;X11/Xatom.h&gt;
 #include &lt;X11/Xutil.h&gt;
 
<a href="#h0-0-11" id="h0-0-11" class="d">-#include &quot;dwm.h&quot;
</a><a href="#h0-0-12" id="h0-0-12" class="d">-
</a><a href="#h0-0-13" id="h0-0-13" class="d">-void
</a><a href="#h0-0-14" id="h0-0-14" class="d">-ban(Client *c)
</a><a href="#h0-0-15" id="h0-0-15" class="d">-{
</a><a href="#h0-0-16" id="h0-0-16" class="d">-	XMoveWindow(dpy, c-&gt;win, c-&gt;x + 2 * sw, c-&gt;y);
</a><a href="#h0-0-17" id="h0-0-17" class="d">-	XMoveWindow(dpy, c-&gt;title, c-&gt;tx + 2 * sw, c-&gt;ty);
</a><a href="#h0-0-18" id="h0-0-18" class="d">-}
</a><a href="#h0-0-19" id="h0-0-19" class="i">+/* static functions */
</a> 
 static void
 resizetitle(Client *c)
<a href="#h0-1" id="h0-1" class="h">@@ -35,70 +28,141 @@ resizetitle(Client *c)
</a> 	XMoveResizeWindow(dpy, c-&gt;title, c-&gt;tx, c-&gt;ty, c-&gt;tw, c-&gt;th);
 }
 
<a href="#h0-1-3" id="h0-1-3" class="i">+static int
</a><a href="#h0-1-4" id="h0-1-4" class="i">+xerrordummy(Display *dsply, XErrorEvent *ee)
</a><a href="#h0-1-5" id="h0-1-5" class="i">+{
</a><a href="#h0-1-6" id="h0-1-6" class="i">+	return 0;
</a><a href="#h0-1-7" id="h0-1-7" class="i">+}
</a><a href="#h0-1-8" id="h0-1-8" class="i">+
</a><a href="#h0-1-9" id="h0-1-9" class="i">+/* extern functions */
</a><a href="#h0-1-10" id="h0-1-10" class="i">+
</a> void
<a href="#h0-1-12" id="h0-1-12" class="d">-settitle(Client *c)
</a><a href="#h0-1-13" id="h0-1-13" class="i">+ban(Client *c)
</a> {
<a href="#h0-1-15" id="h0-1-15" class="d">-	XTextProperty name;
</a><a href="#h0-1-16" id="h0-1-16" class="d">-	int n;
</a><a href="#h0-1-17" id="h0-1-17" class="d">-	char **list = NULL;
</a><a href="#h0-1-18" id="h0-1-18" class="i">+	XMoveWindow(dpy, c-&gt;win, c-&gt;x + 2 * sw, c-&gt;y);
</a><a href="#h0-1-19" id="h0-1-19" class="i">+	XMoveWindow(dpy, c-&gt;title, c-&gt;tx + 2 * sw, c-&gt;ty);
</a><a href="#h0-1-20" id="h0-1-20" class="i">+}
</a> 
<a href="#h0-1-22" id="h0-1-22" class="d">-	name.nitems = 0;
</a><a href="#h0-1-23" id="h0-1-23" class="d">-	c-&gt;name[0] = 0;
</a><a href="#h0-1-24" id="h0-1-24" class="d">-	XGetTextProperty(dpy, c-&gt;win, &amp;name, net_atom[NetWMName]);
</a><a href="#h0-1-25" id="h0-1-25" class="d">-	if(!name.nitems)
</a><a href="#h0-1-26" id="h0-1-26" class="d">-		XGetWMName(dpy, c-&gt;win, &amp;name);
</a><a href="#h0-1-27" id="h0-1-27" class="d">-	if(!name.nitems)
</a><a href="#h0-1-28" id="h0-1-28" class="i">+void
</a><a href="#h0-1-29" id="h0-1-29" class="i">+focus(Client *c)
</a><a href="#h0-1-30" id="h0-1-30" class="i">+{
</a><a href="#h0-1-31" id="h0-1-31" class="i">+	Client *old = sel;
</a><a href="#h0-1-32" id="h0-1-32" class="i">+	XEvent ev;
</a><a href="#h0-1-33" id="h0-1-33" class="i">+
</a><a href="#h0-1-34" id="h0-1-34" class="i">+	XFlush(dpy);
</a><a href="#h0-1-35" id="h0-1-35" class="i">+	sel = c;
</a><a href="#h0-1-36" id="h0-1-36" class="i">+	if(old &amp;&amp; old != c)
</a><a href="#h0-1-37" id="h0-1-37" class="i">+		drawtitle(old);
</a><a href="#h0-1-38" id="h0-1-38" class="i">+	drawtitle(c);
</a><a href="#h0-1-39" id="h0-1-39" class="i">+	XSetInputFocus(dpy, c-&gt;win, RevertToPointerRoot, CurrentTime);
</a><a href="#h0-1-40" id="h0-1-40" class="i">+	XFlush(dpy);
</a><a href="#h0-1-41" id="h0-1-41" class="i">+	while(XCheckMaskEvent(dpy, EnterWindowMask, &amp;ev));
</a><a href="#h0-1-42" id="h0-1-42" class="i">+}
</a><a href="#h0-1-43" id="h0-1-43" class="i">+
</a><a href="#h0-1-44" id="h0-1-44" class="i">+void
</a><a href="#h0-1-45" id="h0-1-45" class="i">+focusnext(Arg *arg)
</a><a href="#h0-1-46" id="h0-1-46" class="i">+{
</a><a href="#h0-1-47" id="h0-1-47" class="i">+	Client *c;
</a><a href="#h0-1-48" id="h0-1-48" class="i">+   
</a><a href="#h0-1-49" id="h0-1-49" class="i">+	if(!sel)
</a> 		return;
<a href="#h0-1-51" id="h0-1-51" class="d">-	if(name.encoding == XA_STRING)
</a><a href="#h0-1-52" id="h0-1-52" class="d">-		strncpy(c-&gt;name, (char *)name.value, sizeof(c-&gt;name));
</a><a href="#h0-1-53" id="h0-1-53" class="d">-	else {
</a><a href="#h0-1-54" id="h0-1-54" class="d">-		if(XmbTextPropertyToTextList(dpy, &amp;name, &amp;list, &amp;n) &gt;= Success
</a><a href="#h0-1-55" id="h0-1-55" class="d">-				&amp;&amp; n &gt; 0 &amp;&amp; *list)
</a><a href="#h0-1-56" id="h0-1-56" class="d">-		{
</a><a href="#h0-1-57" id="h0-1-57" class="d">-			strncpy(c-&gt;name, *list, sizeof(c-&gt;name));
</a><a href="#h0-1-58" id="h0-1-58" class="d">-			XFreeStringList(list);
</a><a href="#h0-1-59" id="h0-1-59" class="d">-		}
</a><a href="#h0-1-60" id="h0-1-60" class="i">+
</a><a href="#h0-1-61" id="h0-1-61" class="i">+	if(!(c = getnext(sel-&gt;next)))
</a><a href="#h0-1-62" id="h0-1-62" class="i">+		c = getnext(clients);
</a><a href="#h0-1-63" id="h0-1-63" class="i">+	if(c) {
</a><a href="#h0-1-64" id="h0-1-64" class="i">+		higher(c);
</a><a href="#h0-1-65" id="h0-1-65" class="i">+		c-&gt;revert = sel;
</a><a href="#h0-1-66" id="h0-1-66" class="i">+		focus(c);
</a> 	}
<a href="#h0-1-68" id="h0-1-68" class="d">-	XFree(name.value);
</a><a href="#h0-1-69" id="h0-1-69" class="d">-	resizetitle(c);
</a> }
 
 void
<a href="#h0-1-73" id="h0-1-73" class="d">-setsize(Client *c)
</a><a href="#h0-1-74" id="h0-1-74" class="i">+focusprev(Arg *arg)
</a> {
<a href="#h0-1-76" id="h0-1-76" class="d">-	XSizeHints size;
</a><a href="#h0-1-77" id="h0-1-77" class="d">-	long msize;
</a><a href="#h0-1-78" id="h0-1-78" class="d">-	if(!XGetWMNormalHints(dpy, c-&gt;win, &amp;size, &amp;msize) || !size.flags)
</a><a href="#h0-1-79" id="h0-1-79" class="d">-		size.flags = PSize;
</a><a href="#h0-1-80" id="h0-1-80" class="d">-	c-&gt;flags = size.flags;
</a><a href="#h0-1-81" id="h0-1-81" class="d">-	if(c-&gt;flags &amp; PBaseSize) {
</a><a href="#h0-1-82" id="h0-1-82" class="d">-		c-&gt;basew = size.base_width;
</a><a href="#h0-1-83" id="h0-1-83" class="d">-		c-&gt;baseh = size.base_height;
</a><a href="#h0-1-84" id="h0-1-84" class="i">+	Client *c;
</a><a href="#h0-1-85" id="h0-1-85" class="i">+
</a><a href="#h0-1-86" id="h0-1-86" class="i">+	if(!sel)
</a><a href="#h0-1-87" id="h0-1-87" class="i">+		return;
</a><a href="#h0-1-88" id="h0-1-88" class="i">+
</a><a href="#h0-1-89" id="h0-1-89" class="i">+	if((c = sel-&gt;revert &amp;&amp; sel-&gt;revert-&gt;tags[tsel] ? sel-&gt;revert : NULL)) {
</a><a href="#h0-1-90" id="h0-1-90" class="i">+		higher(c);
</a><a href="#h0-1-91" id="h0-1-91" class="i">+		focus(c);
</a> 	}
<a href="#h0-1-93" id="h0-1-93" class="d">-	else
</a><a href="#h0-1-94" id="h0-1-94" class="d">-		c-&gt;basew = c-&gt;baseh = 0;
</a><a href="#h0-1-95" id="h0-1-95" class="d">-	if(c-&gt;flags &amp; PResizeInc) {
</a><a href="#h0-1-96" id="h0-1-96" class="d">-		c-&gt;incw = size.width_inc;
</a><a href="#h0-1-97" id="h0-1-97" class="d">-		c-&gt;inch = size.height_inc;
</a><a href="#h0-1-98" id="h0-1-98" class="i">+}
</a><a href="#h0-1-99" id="h0-1-99" class="i">+
</a><a href="#h0-1-100" id="h0-1-100" class="i">+Client *
</a><a href="#h0-1-101" id="h0-1-101" class="i">+getclient(Window w)
</a><a href="#h0-1-102" id="h0-1-102" class="i">+{
</a><a href="#h0-1-103" id="h0-1-103" class="i">+	Client *c;
</a><a href="#h0-1-104" id="h0-1-104" class="i">+	for(c = clients; c; c = c-&gt;next)
</a><a href="#h0-1-105" id="h0-1-105" class="i">+		if(c-&gt;win == w)
</a><a href="#h0-1-106" id="h0-1-106" class="i">+			return c;
</a><a href="#h0-1-107" id="h0-1-107" class="i">+	return NULL;
</a><a href="#h0-1-108" id="h0-1-108" class="i">+}
</a><a href="#h0-1-109" id="h0-1-109" class="i">+
</a><a href="#h0-1-110" id="h0-1-110" class="i">+Client *
</a><a href="#h0-1-111" id="h0-1-111" class="i">+getctitle(Window w)
</a><a href="#h0-1-112" id="h0-1-112" class="i">+{
</a><a href="#h0-1-113" id="h0-1-113" class="i">+	Client *c;
</a><a href="#h0-1-114" id="h0-1-114" class="i">+	for(c = clients; c; c = c-&gt;next)
</a><a href="#h0-1-115" id="h0-1-115" class="i">+		if(c-&gt;title == w)
</a><a href="#h0-1-116" id="h0-1-116" class="i">+			return c;
</a><a href="#h0-1-117" id="h0-1-117" class="i">+	return NULL;
</a><a href="#h0-1-118" id="h0-1-118" class="i">+}
</a><a href="#h0-1-119" id="h0-1-119" class="i">+
</a><a href="#h0-1-120" id="h0-1-120" class="i">+void
</a><a href="#h0-1-121" id="h0-1-121" class="i">+gravitate(Client *c, Bool invert)
</a><a href="#h0-1-122" id="h0-1-122" class="i">+{
</a><a href="#h0-1-123" id="h0-1-123" class="i">+	int dx = 0, dy = 0;
</a><a href="#h0-1-124" id="h0-1-124" class="i">+
</a><a href="#h0-1-125" id="h0-1-125" class="i">+	switch(c-&gt;grav) {
</a><a href="#h0-1-126" id="h0-1-126" class="i">+	case StaticGravity:
</a><a href="#h0-1-127" id="h0-1-127" class="i">+	case NorthWestGravity:
</a><a href="#h0-1-128" id="h0-1-128" class="i">+	case NorthGravity:
</a><a href="#h0-1-129" id="h0-1-129" class="i">+	case NorthEastGravity:
</a><a href="#h0-1-130" id="h0-1-130" class="i">+		dy = c-&gt;border;
</a><a href="#h0-1-131" id="h0-1-131" class="i">+		break;
</a><a href="#h0-1-132" id="h0-1-132" class="i">+	case EastGravity:
</a><a href="#h0-1-133" id="h0-1-133" class="i">+	case CenterGravity:
</a><a href="#h0-1-134" id="h0-1-134" class="i">+	case WestGravity:
</a><a href="#h0-1-135" id="h0-1-135" class="i">+		dy = -(c-&gt;h / 2) + c-&gt;border;
</a><a href="#h0-1-136" id="h0-1-136" class="i">+		break;
</a><a href="#h0-1-137" id="h0-1-137" class="i">+	case SouthEastGravity:
</a><a href="#h0-1-138" id="h0-1-138" class="i">+	case SouthGravity:
</a><a href="#h0-1-139" id="h0-1-139" class="i">+	case SouthWestGravity:
</a><a href="#h0-1-140" id="h0-1-140" class="i">+		dy = -c-&gt;h;
</a><a href="#h0-1-141" id="h0-1-141" class="i">+		break;
</a><a href="#h0-1-142" id="h0-1-142" class="i">+	default:
</a><a href="#h0-1-143" id="h0-1-143" class="i">+		break;
</a> 	}
<a href="#h0-1-145" id="h0-1-145" class="d">-	else
</a><a href="#h0-1-146" id="h0-1-146" class="d">-		c-&gt;incw = c-&gt;inch = 0;
</a><a href="#h0-1-147" id="h0-1-147" class="d">-	if(c-&gt;flags &amp; PMaxSize) {
</a><a href="#h0-1-148" id="h0-1-148" class="d">-		c-&gt;maxw = size.max_width;
</a><a href="#h0-1-149" id="h0-1-149" class="d">-		c-&gt;maxh = size.max_height;
</a><a href="#h0-1-150" id="h0-1-150" class="i">+
</a><a href="#h0-1-151" id="h0-1-151" class="i">+	switch (c-&gt;grav) {
</a><a href="#h0-1-152" id="h0-1-152" class="i">+	case StaticGravity:
</a><a href="#h0-1-153" id="h0-1-153" class="i">+	case NorthWestGravity:
</a><a href="#h0-1-154" id="h0-1-154" class="i">+	case WestGravity:
</a><a href="#h0-1-155" id="h0-1-155" class="i">+	case SouthWestGravity:
</a><a href="#h0-1-156" id="h0-1-156" class="i">+		dx = c-&gt;border;
</a><a href="#h0-1-157" id="h0-1-157" class="i">+		break;
</a><a href="#h0-1-158" id="h0-1-158" class="i">+	case NorthGravity:
</a><a href="#h0-1-159" id="h0-1-159" class="i">+	case CenterGravity:
</a><a href="#h0-1-160" id="h0-1-160" class="i">+	case SouthGravity:
</a><a href="#h0-1-161" id="h0-1-161" class="i">+		dx = -(c-&gt;w / 2) + c-&gt;border;
</a><a href="#h0-1-162" id="h0-1-162" class="i">+		break;
</a><a href="#h0-1-163" id="h0-1-163" class="i">+	case NorthEastGravity:
</a><a href="#h0-1-164" id="h0-1-164" class="i">+	case EastGravity:
</a><a href="#h0-1-165" id="h0-1-165" class="i">+	case SouthEastGravity:
</a><a href="#h0-1-166" id="h0-1-166" class="i">+		dx = -(c-&gt;w + c-&gt;border);
</a><a href="#h0-1-167" id="h0-1-167" class="i">+		break;
</a><a href="#h0-1-168" id="h0-1-168" class="i">+	default:
</a><a href="#h0-1-169" id="h0-1-169" class="i">+		break;
</a> 	}
<a href="#h0-1-171" id="h0-1-171" class="d">-	else
</a><a href="#h0-1-172" id="h0-1-172" class="d">-		c-&gt;maxw = c-&gt;maxh = 0;
</a><a href="#h0-1-173" id="h0-1-173" class="d">-	if(c-&gt;flags &amp; PMinSize) {
</a><a href="#h0-1-174" id="h0-1-174" class="d">-		c-&gt;minw = size.min_width;
</a><a href="#h0-1-175" id="h0-1-175" class="d">-		c-&gt;minh = size.min_height;
</a><a href="#h0-1-176" id="h0-1-176" class="i">+
</a><a href="#h0-1-177" id="h0-1-177" class="i">+	if(invert) {
</a><a href="#h0-1-178" id="h0-1-178" class="i">+		dx = -dx;
</a><a href="#h0-1-179" id="h0-1-179" class="i">+		dy = -dy;
</a> 	}
<a href="#h0-1-181" id="h0-1-181" class="d">-	else
</a><a href="#h0-1-182" id="h0-1-182" class="d">-		c-&gt;minw = c-&gt;minh = 0;
</a><a href="#h0-1-183" id="h0-1-183" class="d">-	if(c-&gt;flags &amp; PWinGravity)
</a><a href="#h0-1-184" id="h0-1-184" class="d">-		c-&gt;grav = size.win_gravity;
</a><a href="#h0-1-185" id="h0-1-185" class="d">-	else
</a><a href="#h0-1-186" id="h0-1-186" class="d">-		c-&gt;grav = NorthWestGravity;
</a><a href="#h0-1-187" id="h0-1-187" class="i">+	c-&gt;x += dx;
</a><a href="#h0-1-188" id="h0-1-188" class="i">+	c-&gt;y += dy;
</a> }
 
 void
<a href="#h0-2" id="h0-2" class="h">@@ -109,26 +173,21 @@ higher(Client *c)
</a> }
 
 void
<a href="#h0-2-3" id="h0-2-3" class="d">-lower(Client *c)
</a><a href="#h0-2-4" id="h0-2-4" class="i">+killclient(Arg *arg)
</a> {
<a href="#h0-2-6" id="h0-2-6" class="d">-	XLowerWindow(dpy, c-&gt;title);
</a><a href="#h0-2-7" id="h0-2-7" class="d">-	XLowerWindow(dpy, c-&gt;win);
</a><a href="#h0-2-8" id="h0-2-8" class="i">+	if(!sel)
</a><a href="#h0-2-9" id="h0-2-9" class="i">+		return;
</a><a href="#h0-2-10" id="h0-2-10" class="i">+	if(sel-&gt;proto &amp; WM_PROTOCOL_DELWIN)
</a><a href="#h0-2-11" id="h0-2-11" class="i">+		sendevent(sel-&gt;win, wm_atom[WMProtocols], wm_atom[WMDelete]);
</a><a href="#h0-2-12" id="h0-2-12" class="i">+	else
</a><a href="#h0-2-13" id="h0-2-13" class="i">+		XKillClient(dpy, sel-&gt;win);
</a> }
 
 void
<a href="#h0-2-17" id="h0-2-17" class="d">-focus(Client *c)
</a><a href="#h0-2-18" id="h0-2-18" class="i">+lower(Client *c)
</a> {
<a href="#h0-2-20" id="h0-2-20" class="d">-	Client *old = sel;
</a><a href="#h0-2-21" id="h0-2-21" class="d">-	XEvent ev;
</a><a href="#h0-2-22" id="h0-2-22" class="d">-
</a><a href="#h0-2-23" id="h0-2-23" class="d">-	XFlush(dpy);
</a><a href="#h0-2-24" id="h0-2-24" class="d">-	sel = c;
</a><a href="#h0-2-25" id="h0-2-25" class="d">-	if(old &amp;&amp; old != c)
</a><a href="#h0-2-26" id="h0-2-26" class="d">-		drawtitle(old);
</a><a href="#h0-2-27" id="h0-2-27" class="d">-	drawtitle(c);
</a><a href="#h0-2-28" id="h0-2-28" class="d">-	XSetInputFocus(dpy, c-&gt;win, RevertToPointerRoot, CurrentTime);
</a><a href="#h0-2-29" id="h0-2-29" class="d">-	XFlush(dpy);
</a><a href="#h0-2-30" id="h0-2-30" class="d">-	while(XCheckMaskEvent(dpy, EnterWindowMask, &amp;ev));
</a><a href="#h0-2-31" id="h0-2-31" class="i">+	XLowerWindow(dpy, c-&gt;title);
</a><a href="#h0-2-32" id="h0-2-32" class="i">+	XLowerWindow(dpy, c-&gt;win);
</a> }
 
 void
<a href="#h0-3" id="h0-3" class="h">@@ -195,61 +254,18 @@ manage(Window w, XWindowAttributes *wa)
</a> }
 
 void
<a href="#h0-3-3" id="h0-3-3" class="d">-gravitate(Client *c, Bool invert)
</a><a href="#h0-3-4" id="h0-3-4" class="i">+maximize(Arg *arg)
</a> {
<a href="#h0-3-6" id="h0-3-6" class="d">-	int dx = 0, dy = 0;
</a><a href="#h0-3-7" id="h0-3-7" class="d">-
</a><a href="#h0-3-8" id="h0-3-8" class="d">-	switch(c-&gt;grav) {
</a><a href="#h0-3-9" id="h0-3-9" class="d">-	case StaticGravity:
</a><a href="#h0-3-10" id="h0-3-10" class="d">-	case NorthWestGravity:
</a><a href="#h0-3-11" id="h0-3-11" class="d">-	case NorthGravity:
</a><a href="#h0-3-12" id="h0-3-12" class="d">-	case NorthEastGravity:
</a><a href="#h0-3-13" id="h0-3-13" class="d">-		dy = c-&gt;border;
</a><a href="#h0-3-14" id="h0-3-14" class="d">-		break;
</a><a href="#h0-3-15" id="h0-3-15" class="d">-	case EastGravity:
</a><a href="#h0-3-16" id="h0-3-16" class="d">-	case CenterGravity:
</a><a href="#h0-3-17" id="h0-3-17" class="d">-	case WestGravity:
</a><a href="#h0-3-18" id="h0-3-18" class="d">-		dy = -(c-&gt;h / 2) + c-&gt;border;
</a><a href="#h0-3-19" id="h0-3-19" class="d">-		break;
</a><a href="#h0-3-20" id="h0-3-20" class="d">-	case SouthEastGravity:
</a><a href="#h0-3-21" id="h0-3-21" class="d">-	case SouthGravity:
</a><a href="#h0-3-22" id="h0-3-22" class="d">-	case SouthWestGravity:
</a><a href="#h0-3-23" id="h0-3-23" class="d">-		dy = -c-&gt;h;
</a><a href="#h0-3-24" id="h0-3-24" class="d">-		break;
</a><a href="#h0-3-25" id="h0-3-25" class="d">-	default:
</a><a href="#h0-3-26" id="h0-3-26" class="d">-		break;
</a><a href="#h0-3-27" id="h0-3-27" class="d">-	}
</a><a href="#h0-3-28" id="h0-3-28" class="d">-
</a><a href="#h0-3-29" id="h0-3-29" class="d">-	switch (c-&gt;grav) {
</a><a href="#h0-3-30" id="h0-3-30" class="d">-	case StaticGravity:
</a><a href="#h0-3-31" id="h0-3-31" class="d">-	case NorthWestGravity:
</a><a href="#h0-3-32" id="h0-3-32" class="d">-	case WestGravity:
</a><a href="#h0-3-33" id="h0-3-33" class="d">-	case SouthWestGravity:
</a><a href="#h0-3-34" id="h0-3-34" class="d">-		dx = c-&gt;border;
</a><a href="#h0-3-35" id="h0-3-35" class="d">-		break;
</a><a href="#h0-3-36" id="h0-3-36" class="d">-	case NorthGravity:
</a><a href="#h0-3-37" id="h0-3-37" class="d">-	case CenterGravity:
</a><a href="#h0-3-38" id="h0-3-38" class="d">-	case SouthGravity:
</a><a href="#h0-3-39" id="h0-3-39" class="d">-		dx = -(c-&gt;w / 2) + c-&gt;border;
</a><a href="#h0-3-40" id="h0-3-40" class="d">-		break;
</a><a href="#h0-3-41" id="h0-3-41" class="d">-	case NorthEastGravity:
</a><a href="#h0-3-42" id="h0-3-42" class="d">-	case EastGravity:
</a><a href="#h0-3-43" id="h0-3-43" class="d">-	case SouthEastGravity:
</a><a href="#h0-3-44" id="h0-3-44" class="d">-		dx = -(c-&gt;w + c-&gt;border);
</a><a href="#h0-3-45" id="h0-3-45" class="d">-		break;
</a><a href="#h0-3-46" id="h0-3-46" class="d">-	default:
</a><a href="#h0-3-47" id="h0-3-47" class="d">-		break;
</a><a href="#h0-3-48" id="h0-3-48" class="d">-	}
</a><a href="#h0-3-49" id="h0-3-49" class="d">-
</a><a href="#h0-3-50" id="h0-3-50" class="d">-	if(invert) {
</a><a href="#h0-3-51" id="h0-3-51" class="d">-		dx = -dx;
</a><a href="#h0-3-52" id="h0-3-52" class="d">-		dy = -dy;
</a><a href="#h0-3-53" id="h0-3-53" class="d">-	}
</a><a href="#h0-3-54" id="h0-3-54" class="d">-	c-&gt;x += dx;
</a><a href="#h0-3-55" id="h0-3-55" class="d">-	c-&gt;y += dy;
</a><a href="#h0-3-56" id="h0-3-56" class="i">+	if(!sel)
</a><a href="#h0-3-57" id="h0-3-57" class="i">+		return;
</a><a href="#h0-3-58" id="h0-3-58" class="i">+	sel-&gt;x = sx;
</a><a href="#h0-3-59" id="h0-3-59" class="i">+	sel-&gt;y = sy + bh;
</a><a href="#h0-3-60" id="h0-3-60" class="i">+	sel-&gt;w = sw - 2 * sel-&gt;border;
</a><a href="#h0-3-61" id="h0-3-61" class="i">+	sel-&gt;h = sh - 2 * sel-&gt;border - bh;
</a><a href="#h0-3-62" id="h0-3-62" class="i">+	higher(sel);
</a><a href="#h0-3-63" id="h0-3-63" class="i">+	resize(sel, False);
</a> }
 
<a href="#h0-3-66" id="h0-3-66" class="d">-
</a> void
 resize(Client *c, Bool inc)
 {
<a href="#h0-4" id="h0-4" class="h">@@ -290,10 +306,70 @@ resize(Client *c, Bool inc)
</a> 	XFlush(dpy);
 }
 
<a href="#h0-4-3" id="h0-4-3" class="d">-static int
</a><a href="#h0-4-4" id="h0-4-4" class="d">-xerrordummy(Display *dsply, XErrorEvent *ee)
</a><a href="#h0-4-5" id="h0-4-5" class="i">+void
</a><a href="#h0-4-6" id="h0-4-6" class="i">+setsize(Client *c)
</a> {
<a href="#h0-4-8" id="h0-4-8" class="d">-	return 0;
</a><a href="#h0-4-9" id="h0-4-9" class="i">+	XSizeHints size;
</a><a href="#h0-4-10" id="h0-4-10" class="i">+	long msize;
</a><a href="#h0-4-11" id="h0-4-11" class="i">+	if(!XGetWMNormalHints(dpy, c-&gt;win, &amp;size, &amp;msize) || !size.flags)
</a><a href="#h0-4-12" id="h0-4-12" class="i">+		size.flags = PSize;
</a><a href="#h0-4-13" id="h0-4-13" class="i">+	c-&gt;flags = size.flags;
</a><a href="#h0-4-14" id="h0-4-14" class="i">+	if(c-&gt;flags &amp; PBaseSize) {
</a><a href="#h0-4-15" id="h0-4-15" class="i">+		c-&gt;basew = size.base_width;
</a><a href="#h0-4-16" id="h0-4-16" class="i">+		c-&gt;baseh = size.base_height;
</a><a href="#h0-4-17" id="h0-4-17" class="i">+	}
</a><a href="#h0-4-18" id="h0-4-18" class="i">+	else
</a><a href="#h0-4-19" id="h0-4-19" class="i">+		c-&gt;basew = c-&gt;baseh = 0;
</a><a href="#h0-4-20" id="h0-4-20" class="i">+	if(c-&gt;flags &amp; PResizeInc) {
</a><a href="#h0-4-21" id="h0-4-21" class="i">+		c-&gt;incw = size.width_inc;
</a><a href="#h0-4-22" id="h0-4-22" class="i">+		c-&gt;inch = size.height_inc;
</a><a href="#h0-4-23" id="h0-4-23" class="i">+	}
</a><a href="#h0-4-24" id="h0-4-24" class="i">+	else
</a><a href="#h0-4-25" id="h0-4-25" class="i">+		c-&gt;incw = c-&gt;inch = 0;
</a><a href="#h0-4-26" id="h0-4-26" class="i">+	if(c-&gt;flags &amp; PMaxSize) {
</a><a href="#h0-4-27" id="h0-4-27" class="i">+		c-&gt;maxw = size.max_width;
</a><a href="#h0-4-28" id="h0-4-28" class="i">+		c-&gt;maxh = size.max_height;
</a><a href="#h0-4-29" id="h0-4-29" class="i">+	}
</a><a href="#h0-4-30" id="h0-4-30" class="i">+	else
</a><a href="#h0-4-31" id="h0-4-31" class="i">+		c-&gt;maxw = c-&gt;maxh = 0;
</a><a href="#h0-4-32" id="h0-4-32" class="i">+	if(c-&gt;flags &amp; PMinSize) {
</a><a href="#h0-4-33" id="h0-4-33" class="i">+		c-&gt;minw = size.min_width;
</a><a href="#h0-4-34" id="h0-4-34" class="i">+		c-&gt;minh = size.min_height;
</a><a href="#h0-4-35" id="h0-4-35" class="i">+	}
</a><a href="#h0-4-36" id="h0-4-36" class="i">+	else
</a><a href="#h0-4-37" id="h0-4-37" class="i">+		c-&gt;minw = c-&gt;minh = 0;
</a><a href="#h0-4-38" id="h0-4-38" class="i">+	if(c-&gt;flags &amp; PWinGravity)
</a><a href="#h0-4-39" id="h0-4-39" class="i">+		c-&gt;grav = size.win_gravity;
</a><a href="#h0-4-40" id="h0-4-40" class="i">+	else
</a><a href="#h0-4-41" id="h0-4-41" class="i">+		c-&gt;grav = NorthWestGravity;
</a><a href="#h0-4-42" id="h0-4-42" class="i">+}
</a><a href="#h0-4-43" id="h0-4-43" class="i">+
</a><a href="#h0-4-44" id="h0-4-44" class="i">+void
</a><a href="#h0-4-45" id="h0-4-45" class="i">+settitle(Client *c)
</a><a href="#h0-4-46" id="h0-4-46" class="i">+{
</a><a href="#h0-4-47" id="h0-4-47" class="i">+	XTextProperty name;
</a><a href="#h0-4-48" id="h0-4-48" class="i">+	int n;
</a><a href="#h0-4-49" id="h0-4-49" class="i">+	char **list = NULL;
</a><a href="#h0-4-50" id="h0-4-50" class="i">+
</a><a href="#h0-4-51" id="h0-4-51" class="i">+	name.nitems = 0;
</a><a href="#h0-4-52" id="h0-4-52" class="i">+	c-&gt;name[0] = 0;
</a><a href="#h0-4-53" id="h0-4-53" class="i">+	XGetTextProperty(dpy, c-&gt;win, &amp;name, net_atom[NetWMName]);
</a><a href="#h0-4-54" id="h0-4-54" class="i">+	if(!name.nitems)
</a><a href="#h0-4-55" id="h0-4-55" class="i">+		XGetWMName(dpy, c-&gt;win, &amp;name);
</a><a href="#h0-4-56" id="h0-4-56" class="i">+	if(!name.nitems)
</a><a href="#h0-4-57" id="h0-4-57" class="i">+		return;
</a><a href="#h0-4-58" id="h0-4-58" class="i">+	if(name.encoding == XA_STRING)
</a><a href="#h0-4-59" id="h0-4-59" class="i">+		strncpy(c-&gt;name, (char *)name.value, sizeof(c-&gt;name));
</a><a href="#h0-4-60" id="h0-4-60" class="i">+	else {
</a><a href="#h0-4-61" id="h0-4-61" class="i">+		if(XmbTextPropertyToTextList(dpy, &amp;name, &amp;list, &amp;n) &gt;= Success
</a><a href="#h0-4-62" id="h0-4-62" class="i">+				&amp;&amp; n &gt; 0 &amp;&amp; *list)
</a><a href="#h0-4-63" id="h0-4-63" class="i">+		{
</a><a href="#h0-4-64" id="h0-4-64" class="i">+			strncpy(c-&gt;name, *list, sizeof(c-&gt;name));
</a><a href="#h0-4-65" id="h0-4-65" class="i">+			XFreeStringList(list);
</a><a href="#h0-4-66" id="h0-4-66" class="i">+		}
</a><a href="#h0-4-67" id="h0-4-67" class="i">+	}
</a><a href="#h0-4-68" id="h0-4-68" class="i">+	XFree(name.value);
</a><a href="#h0-4-69" id="h0-4-69" class="i">+	resizetitle(c);
</a> }
 
 void
<a href="#h0-5" id="h0-5" class="h">@@ -325,26 +401,6 @@ unmanage(Client *c)
</a> 		focus(sel);
 }
 
<a href="#h0-5-3" id="h0-5-3" class="d">-Client *
</a><a href="#h0-5-4" id="h0-5-4" class="d">-getctitle(Window w)
</a><a href="#h0-5-5" id="h0-5-5" class="d">-{
</a><a href="#h0-5-6" id="h0-5-6" class="d">-	Client *c;
</a><a href="#h0-5-7" id="h0-5-7" class="d">-	for(c = clients; c; c = c-&gt;next)
</a><a href="#h0-5-8" id="h0-5-8" class="d">-		if(c-&gt;title == w)
</a><a href="#h0-5-9" id="h0-5-9" class="d">-			return c;
</a><a href="#h0-5-10" id="h0-5-10" class="d">-	return NULL;
</a><a href="#h0-5-11" id="h0-5-11" class="d">-}
</a><a href="#h0-5-12" id="h0-5-12" class="d">-
</a><a href="#h0-5-13" id="h0-5-13" class="d">-Client *
</a><a href="#h0-5-14" id="h0-5-14" class="d">-getclient(Window w)
</a><a href="#h0-5-15" id="h0-5-15" class="d">-{
</a><a href="#h0-5-16" id="h0-5-16" class="d">-	Client *c;
</a><a href="#h0-5-17" id="h0-5-17" class="d">-	for(c = clients; c; c = c-&gt;next)
</a><a href="#h0-5-18" id="h0-5-18" class="d">-		if(c-&gt;win == w)
</a><a href="#h0-5-19" id="h0-5-19" class="d">-			return c;
</a><a href="#h0-5-20" id="h0-5-20" class="d">-	return NULL;
</a><a href="#h0-5-21" id="h0-5-21" class="d">-}
</a><a href="#h0-5-22" id="h0-5-22" class="d">-
</a> void
 zoom(Arg *arg)
 {
<a href="#h0-6" id="h0-6" class="h">@@ -366,58 +422,3 @@ zoom(Arg *arg)
</a> 	arrange(NULL);
 	focus(sel);
 }
<a href="#h0-6-3" id="h0-6-3" class="d">-
</a><a href="#h0-6-4" id="h0-6-4" class="d">-void
</a><a href="#h0-6-5" id="h0-6-5" class="d">-maximize(Arg *arg)
</a><a href="#h0-6-6" id="h0-6-6" class="d">-{
</a><a href="#h0-6-7" id="h0-6-7" class="d">-	if(!sel)
</a><a href="#h0-6-8" id="h0-6-8" class="d">-		return;
</a><a href="#h0-6-9" id="h0-6-9" class="d">-	sel-&gt;x = sx;
</a><a href="#h0-6-10" id="h0-6-10" class="d">-	sel-&gt;y = sy + bh;
</a><a href="#h0-6-11" id="h0-6-11" class="d">-	sel-&gt;w = sw - 2 * sel-&gt;border;
</a><a href="#h0-6-12" id="h0-6-12" class="d">-	sel-&gt;h = sh - 2 * sel-&gt;border - bh;
</a><a href="#h0-6-13" id="h0-6-13" class="d">-	higher(sel);
</a><a href="#h0-6-14" id="h0-6-14" class="d">-	resize(sel, False);
</a><a href="#h0-6-15" id="h0-6-15" class="d">-}
</a><a href="#h0-6-16" id="h0-6-16" class="d">-
</a><a href="#h0-6-17" id="h0-6-17" class="d">-void
</a><a href="#h0-6-18" id="h0-6-18" class="d">-focusprev(Arg *arg)
</a><a href="#h0-6-19" id="h0-6-19" class="d">-{
</a><a href="#h0-6-20" id="h0-6-20" class="d">-	Client *c;
</a><a href="#h0-6-21" id="h0-6-21" class="d">-
</a><a href="#h0-6-22" id="h0-6-22" class="d">-	if(!sel)
</a><a href="#h0-6-23" id="h0-6-23" class="d">-		return;
</a><a href="#h0-6-24" id="h0-6-24" class="d">-
</a><a href="#h0-6-25" id="h0-6-25" class="d">-	if((c = sel-&gt;revert &amp;&amp; sel-&gt;revert-&gt;tags[tsel] ? sel-&gt;revert : NULL)) {
</a><a href="#h0-6-26" id="h0-6-26" class="d">-		higher(c);
</a><a href="#h0-6-27" id="h0-6-27" class="d">-		focus(c);
</a><a href="#h0-6-28" id="h0-6-28" class="d">-	}
</a><a href="#h0-6-29" id="h0-6-29" class="d">-}
</a><a href="#h0-6-30" id="h0-6-30" class="d">-
</a><a href="#h0-6-31" id="h0-6-31" class="d">-void
</a><a href="#h0-6-32" id="h0-6-32" class="d">-focusnext(Arg *arg)
</a><a href="#h0-6-33" id="h0-6-33" class="d">-{
</a><a href="#h0-6-34" id="h0-6-34" class="d">-	Client *c;
</a><a href="#h0-6-35" id="h0-6-35" class="d">-   
</a><a href="#h0-6-36" id="h0-6-36" class="d">-	if(!sel)
</a><a href="#h0-6-37" id="h0-6-37" class="d">-		return;
</a><a href="#h0-6-38" id="h0-6-38" class="d">-
</a><a href="#h0-6-39" id="h0-6-39" class="d">-	if(!(c = getnext(sel-&gt;next)))
</a><a href="#h0-6-40" id="h0-6-40" class="d">-		c = getnext(clients);
</a><a href="#h0-6-41" id="h0-6-41" class="d">-	if(c) {
</a><a href="#h0-6-42" id="h0-6-42" class="d">-		higher(c);
</a><a href="#h0-6-43" id="h0-6-43" class="d">-		c-&gt;revert = sel;
</a><a href="#h0-6-44" id="h0-6-44" class="d">-		focus(c);
</a><a href="#h0-6-45" id="h0-6-45" class="d">-	}
</a><a href="#h0-6-46" id="h0-6-46" class="d">-}
</a><a href="#h0-6-47" id="h0-6-47" class="d">-
</a><a href="#h0-6-48" id="h0-6-48" class="d">-void
</a><a href="#h0-6-49" id="h0-6-49" class="d">-killclient(Arg *arg)
</a><a href="#h0-6-50" id="h0-6-50" class="d">-{
</a><a href="#h0-6-51" id="h0-6-51" class="d">-	if(!sel)
</a><a href="#h0-6-52" id="h0-6-52" class="d">-		return;
</a><a href="#h0-6-53" id="h0-6-53" class="d">-	if(sel-&gt;proto &amp; WM_PROTOCOL_DELWIN)
</a><a href="#h0-6-54" id="h0-6-54" class="d">-		sendevent(sel-&gt;win, wm_atom[WMProtocols], wm_atom[WMDelete]);
</a><a href="#h0-6-55" id="h0-6-55" class="d">-	else
</a><a href="#h0-6-56" id="h0-6-56" class="d">-		XKillClient(dpy, sel-&gt;win);
</a><a href="#h0-6-57" id="h0-6-57" class="d">-}
</a><b>diff --git a/<a id="h1" href="../file/draw.c.html">draw.c</a> b/<a href="../file/draw.c.html">draw.c</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -2,13 +2,34 @@
</a>  * (C)opyright MMIV-MMVI Anselm R. Garbe &lt;garbeam at gmail dot com&gt;
  * See LICENSE file for license details.
  */
<a href="#h1-0-3" id="h1-0-3" class="i">+#include &quot;dwm.h&quot;
</a> 
 #include &lt;stdio.h&gt;
 #include &lt;string.h&gt;
<a href="#h1-0-7" id="h1-0-7" class="d">-
</a> #include &lt;X11/Xlocale.h&gt;
 
<a href="#h1-0-10" id="h1-0-10" class="d">-#include &quot;dwm.h&quot;
</a><a href="#h1-0-11" id="h1-0-11" class="i">+/* static functions */
</a><a href="#h1-0-12" id="h1-0-12" class="i">+
</a><a href="#h1-0-13" id="h1-0-13" class="i">+static void
</a><a href="#h1-0-14" id="h1-0-14" class="i">+drawborder(void)
</a><a href="#h1-0-15" id="h1-0-15" class="i">+{
</a><a href="#h1-0-16" id="h1-0-16" class="i">+	XPoint points[5];
</a><a href="#h1-0-17" id="h1-0-17" class="i">+	XSetLineAttributes(dpy, dc.gc, 1, LineSolid, CapButt, JoinMiter);
</a><a href="#h1-0-18" id="h1-0-18" class="i">+	XSetForeground(dpy, dc.gc, dc.border);
</a><a href="#h1-0-19" id="h1-0-19" class="i">+	points[0].x = dc.x;
</a><a href="#h1-0-20" id="h1-0-20" class="i">+	points[0].y = dc.y;
</a><a href="#h1-0-21" id="h1-0-21" class="i">+	points[1].x = dc.w - 1;
</a><a href="#h1-0-22" id="h1-0-22" class="i">+	points[1].y = 0;
</a><a href="#h1-0-23" id="h1-0-23" class="i">+	points[2].x = 0;
</a><a href="#h1-0-24" id="h1-0-24" class="i">+	points[2].y = dc.h - 1;
</a><a href="#h1-0-25" id="h1-0-25" class="i">+	points[3].x = -(dc.w - 1);
</a><a href="#h1-0-26" id="h1-0-26" class="i">+	points[3].y = 0;
</a><a href="#h1-0-27" id="h1-0-27" class="i">+	points[4].x = 0;
</a><a href="#h1-0-28" id="h1-0-28" class="i">+	points[4].y = -(dc.h - 1);
</a><a href="#h1-0-29" id="h1-0-29" class="i">+	XDrawLines(dpy, dc.drawable, dc.gc, points, 5, CoordModePrevious);
</a><a href="#h1-0-30" id="h1-0-30" class="i">+}
</a><a href="#h1-0-31" id="h1-0-31" class="i">+
</a><a href="#h1-0-32" id="h1-0-32" class="i">+/* extern functions */
</a> 
 void
 drawall()
<a href="#h1-1" id="h1-1" class="h">@@ -53,59 +74,6 @@ drawstatus()
</a> }
 
 void
<a href="#h1-1-3" id="h1-1-3" class="d">-drawtitle(Client *c)
</a><a href="#h1-1-4" id="h1-1-4" class="d">-{
</a><a href="#h1-1-5" id="h1-1-5" class="d">-	int i;
</a><a href="#h1-1-6" id="h1-1-6" class="d">-	Bool istile = arrange == dotile;
</a><a href="#h1-1-7" id="h1-1-7" class="d">-
</a><a href="#h1-1-8" id="h1-1-8" class="d">-	if(c == sel) {
</a><a href="#h1-1-9" id="h1-1-9" class="d">-		drawstatus();
</a><a href="#h1-1-10" id="h1-1-10" class="d">-		XUnmapWindow(dpy, c-&gt;title);
</a><a href="#h1-1-11" id="h1-1-11" class="d">-		XSetWindowBorder(dpy, c-&gt;win, dc.fg);
</a><a href="#h1-1-12" id="h1-1-12" class="d">-		return;
</a><a href="#h1-1-13" id="h1-1-13" class="d">-	}
</a><a href="#h1-1-14" id="h1-1-14" class="d">-
</a><a href="#h1-1-15" id="h1-1-15" class="d">-	XSetWindowBorder(dpy, c-&gt;win, dc.bg);
</a><a href="#h1-1-16" id="h1-1-16" class="d">-	XMapWindow(dpy, c-&gt;title);
</a><a href="#h1-1-17" id="h1-1-17" class="d">-
</a><a href="#h1-1-18" id="h1-1-18" class="d">-	dc.x = dc.y = 0;
</a><a href="#h1-1-19" id="h1-1-19" class="d">-
</a><a href="#h1-1-20" id="h1-1-20" class="d">-	dc.w = 0;
</a><a href="#h1-1-21" id="h1-1-21" class="d">-	for(i = 0; i &lt; TLast; i++) {
</a><a href="#h1-1-22" id="h1-1-22" class="d">-		if(c-&gt;tags[i]) {
</a><a href="#h1-1-23" id="h1-1-23" class="d">-			dc.x += dc.w;
</a><a href="#h1-1-24" id="h1-1-24" class="d">-			dc.w = textw(c-&gt;tags[i]);
</a><a href="#h1-1-25" id="h1-1-25" class="d">-			drawtext(c-&gt;tags[i], !istile, True);
</a><a href="#h1-1-26" id="h1-1-26" class="d">-		}
</a><a href="#h1-1-27" id="h1-1-27" class="d">-	}
</a><a href="#h1-1-28" id="h1-1-28" class="d">-	dc.x += dc.w;
</a><a href="#h1-1-29" id="h1-1-29" class="d">-	dc.w = textw(c-&gt;name);
</a><a href="#h1-1-30" id="h1-1-30" class="d">-	drawtext(c-&gt;name, !istile, True);
</a><a href="#h1-1-31" id="h1-1-31" class="d">-	XCopyArea(dpy, dc.drawable, c-&gt;title, dc.gc,
</a><a href="#h1-1-32" id="h1-1-32" class="d">-			0, 0, c-&gt;tw, c-&gt;th, 0, 0);
</a><a href="#h1-1-33" id="h1-1-33" class="d">-	XFlush(dpy);
</a><a href="#h1-1-34" id="h1-1-34" class="d">-}
</a><a href="#h1-1-35" id="h1-1-35" class="d">-
</a><a href="#h1-1-36" id="h1-1-36" class="d">-static void
</a><a href="#h1-1-37" id="h1-1-37" class="d">-drawborder(void)
</a><a href="#h1-1-38" id="h1-1-38" class="d">-{
</a><a href="#h1-1-39" id="h1-1-39" class="d">-	XPoint points[5];
</a><a href="#h1-1-40" id="h1-1-40" class="d">-	XSetLineAttributes(dpy, dc.gc, 1, LineSolid, CapButt, JoinMiter);
</a><a href="#h1-1-41" id="h1-1-41" class="d">-	XSetForeground(dpy, dc.gc, dc.border);
</a><a href="#h1-1-42" id="h1-1-42" class="d">-	points[0].x = dc.x;
</a><a href="#h1-1-43" id="h1-1-43" class="d">-	points[0].y = dc.y;
</a><a href="#h1-1-44" id="h1-1-44" class="d">-	points[1].x = dc.w - 1;
</a><a href="#h1-1-45" id="h1-1-45" class="d">-	points[1].y = 0;
</a><a href="#h1-1-46" id="h1-1-46" class="d">-	points[2].x = 0;
</a><a href="#h1-1-47" id="h1-1-47" class="d">-	points[2].y = dc.h - 1;
</a><a href="#h1-1-48" id="h1-1-48" class="d">-	points[3].x = -(dc.w - 1);
</a><a href="#h1-1-49" id="h1-1-49" class="d">-	points[3].y = 0;
</a><a href="#h1-1-50" id="h1-1-50" class="d">-	points[4].x = 0;
</a><a href="#h1-1-51" id="h1-1-51" class="d">-	points[4].y = -(dc.h - 1);
</a><a href="#h1-1-52" id="h1-1-52" class="d">-	XDrawLines(dpy, dc.drawable, dc.gc, points, 5, CoordModePrevious);
</a><a href="#h1-1-53" id="h1-1-53" class="d">-}
</a><a href="#h1-1-54" id="h1-1-54" class="d">-
</a><a href="#h1-1-55" id="h1-1-55" class="d">-void
</a> drawtext(const char *text, Bool invert, Bool border)
 {
 	int x, y, w, h;
<a href="#h1-2" id="h1-2" class="h">@@ -155,6 +123,40 @@ drawtext(const char *text, Bool invert, Bool border)
</a> 	}
 }
 
<a href="#h1-2-3" id="h1-2-3" class="i">+void
</a><a href="#h1-2-4" id="h1-2-4" class="i">+drawtitle(Client *c)
</a><a href="#h1-2-5" id="h1-2-5" class="i">+{
</a><a href="#h1-2-6" id="h1-2-6" class="i">+	int i;
</a><a href="#h1-2-7" id="h1-2-7" class="i">+	Bool istile = arrange == dotile;
</a><a href="#h1-2-8" id="h1-2-8" class="i">+
</a><a href="#h1-2-9" id="h1-2-9" class="i">+	if(c == sel) {
</a><a href="#h1-2-10" id="h1-2-10" class="i">+		drawstatus();
</a><a href="#h1-2-11" id="h1-2-11" class="i">+		XUnmapWindow(dpy, c-&gt;title);
</a><a href="#h1-2-12" id="h1-2-12" class="i">+		XSetWindowBorder(dpy, c-&gt;win, dc.fg);
</a><a href="#h1-2-13" id="h1-2-13" class="i">+		return;
</a><a href="#h1-2-14" id="h1-2-14" class="i">+	}
</a><a href="#h1-2-15" id="h1-2-15" class="i">+
</a><a href="#h1-2-16" id="h1-2-16" class="i">+	XSetWindowBorder(dpy, c-&gt;win, dc.bg);
</a><a href="#h1-2-17" id="h1-2-17" class="i">+	XMapWindow(dpy, c-&gt;title);
</a><a href="#h1-2-18" id="h1-2-18" class="i">+
</a><a href="#h1-2-19" id="h1-2-19" class="i">+	dc.x = dc.y = 0;
</a><a href="#h1-2-20" id="h1-2-20" class="i">+
</a><a href="#h1-2-21" id="h1-2-21" class="i">+	dc.w = 0;
</a><a href="#h1-2-22" id="h1-2-22" class="i">+	for(i = 0; i &lt; TLast; i++) {
</a><a href="#h1-2-23" id="h1-2-23" class="i">+		if(c-&gt;tags[i]) {
</a><a href="#h1-2-24" id="h1-2-24" class="i">+			dc.x += dc.w;
</a><a href="#h1-2-25" id="h1-2-25" class="i">+			dc.w = textw(c-&gt;tags[i]);
</a><a href="#h1-2-26" id="h1-2-26" class="i">+			drawtext(c-&gt;tags[i], !istile, True);
</a><a href="#h1-2-27" id="h1-2-27" class="i">+		}
</a><a href="#h1-2-28" id="h1-2-28" class="i">+	}
</a><a href="#h1-2-29" id="h1-2-29" class="i">+	dc.x += dc.w;
</a><a href="#h1-2-30" id="h1-2-30" class="i">+	dc.w = textw(c-&gt;name);
</a><a href="#h1-2-31" id="h1-2-31" class="i">+	drawtext(c-&gt;name, !istile, True);
</a><a href="#h1-2-32" id="h1-2-32" class="i">+	XCopyArea(dpy, dc.drawable, c-&gt;title, dc.gc,
</a><a href="#h1-2-33" id="h1-2-33" class="i">+			0, 0, c-&gt;tw, c-&gt;th, 0, 0);
</a><a href="#h1-2-34" id="h1-2-34" class="i">+	XFlush(dpy);
</a><a href="#h1-2-35" id="h1-2-35" class="i">+}
</a><a href="#h1-2-36" id="h1-2-36" class="i">+
</a> unsigned long
 getcolor(const char *colstr)
 {
<a href="#h1-3" id="h1-3" class="h">@@ -165,23 +167,6 @@ getcolor(const char *colstr)
</a> 	return color.pixel;
 }
 
<a href="#h1-3-3" id="h1-3-3" class="d">-unsigned int
</a><a href="#h1-3-4" id="h1-3-4" class="d">-textnw(char *text, unsigned int len)
</a><a href="#h1-3-5" id="h1-3-5" class="d">-{
</a><a href="#h1-3-6" id="h1-3-6" class="d">-	XRectangle r;
</a><a href="#h1-3-7" id="h1-3-7" class="d">-	if(dc.font.set) {
</a><a href="#h1-3-8" id="h1-3-8" class="d">-		XmbTextExtents(dc.font.set, text, len, NULL, &amp;r);
</a><a href="#h1-3-9" id="h1-3-9" class="d">-		return r.width;
</a><a href="#h1-3-10" id="h1-3-10" class="d">-	}
</a><a href="#h1-3-11" id="h1-3-11" class="d">-	return XTextWidth(dc.font.xfont, text, len);
</a><a href="#h1-3-12" id="h1-3-12" class="d">-}
</a><a href="#h1-3-13" id="h1-3-13" class="d">-
</a><a href="#h1-3-14" id="h1-3-14" class="d">-unsigned int
</a><a href="#h1-3-15" id="h1-3-15" class="d">-textw(char *text)
</a><a href="#h1-3-16" id="h1-3-16" class="d">-{
</a><a href="#h1-3-17" id="h1-3-17" class="d">-	return textnw(text, strlen(text)) + dc.font.height;
</a><a href="#h1-3-18" id="h1-3-18" class="d">-}
</a><a href="#h1-3-19" id="h1-3-19" class="d">-
</a> void
 setfont(const char *fontstr)
 {
<a href="#h1-4" id="h1-4" class="h">@@ -232,3 +217,20 @@ setfont(const char *fontstr)
</a> 	}
 	dc.font.height = dc.font.ascent + dc.font.descent;
 }
<a href="#h1-4-3" id="h1-4-3" class="i">+
</a><a href="#h1-4-4" id="h1-4-4" class="i">+unsigned int
</a><a href="#h1-4-5" id="h1-4-5" class="i">+textnw(char *text, unsigned int len)
</a><a href="#h1-4-6" id="h1-4-6" class="i">+{
</a><a href="#h1-4-7" id="h1-4-7" class="i">+	XRectangle r;
</a><a href="#h1-4-8" id="h1-4-8" class="i">+	if(dc.font.set) {
</a><a href="#h1-4-9" id="h1-4-9" class="i">+		XmbTextExtents(dc.font.set, text, len, NULL, &amp;r);
</a><a href="#h1-4-10" id="h1-4-10" class="i">+		return r.width;
</a><a href="#h1-4-11" id="h1-4-11" class="i">+	}
</a><a href="#h1-4-12" id="h1-4-12" class="i">+	return XTextWidth(dc.font.xfont, text, len);
</a><a href="#h1-4-13" id="h1-4-13" class="i">+}
</a><a href="#h1-4-14" id="h1-4-14" class="i">+
</a><a href="#h1-4-15" id="h1-4-15" class="i">+unsigned int
</a><a href="#h1-4-16" id="h1-4-16" class="i">+textw(char *text)
</a><a href="#h1-4-17" id="h1-4-17" class="i">+{
</a><a href="#h1-4-18" id="h1-4-18" class="i">+	return textnw(text, strlen(text)) + dc.font.height;
</a><a href="#h1-4-19" id="h1-4-19" class="i">+}
</a><b>diff --git a/<a id="h2" href="../file/dwm.h.html">dwm.h</a> b/<a href="../file/dwm.h.html">dwm.h</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -104,53 +104,52 @@ extern Client *clients, *sel;
</a> 
 /* client.c */
 extern void ban(Client *c);
<a href="#h2-0-3" id="h2-0-3" class="d">-extern void manage(Window w, XWindowAttributes *wa);
</a><a href="#h2-0-4" id="h2-0-4" class="d">-extern void unmanage(Client *c);
</a><a href="#h2-0-5" id="h2-0-5" class="d">-extern Client *getclient(Window w);
</a> extern void focus(Client *c);
<a href="#h2-0-7" id="h2-0-7" class="d">-extern void settitle(Client *c);
</a><a href="#h2-0-8" id="h2-0-8" class="d">-extern void resize(Client *c, Bool inc);
</a><a href="#h2-0-9" id="h2-0-9" class="d">-extern void setsize(Client *c);
</a><a href="#h2-0-10" id="h2-0-10" class="i">+extern void focusnext(Arg *arg);
</a><a href="#h2-0-11" id="h2-0-11" class="i">+extern void focusprev(Arg *arg);
</a><a href="#h2-0-12" id="h2-0-12" class="i">+extern Client *getclient(Window w);
</a> extern Client *getctitle(Window w);
<a href="#h2-0-14" id="h2-0-14" class="i">+extern void gravitate(Client *c, Bool invert);
</a> extern void higher(Client *c);
<a href="#h2-0-16" id="h2-0-16" class="i">+extern void killclient(Arg *arg);
</a> extern void lower(Client *c);
<a href="#h2-0-18" id="h2-0-18" class="d">-extern void gravitate(Client *c, Bool invert);
</a><a href="#h2-0-19" id="h2-0-19" class="d">-extern void zoom(Arg *arg);
</a><a href="#h2-0-20" id="h2-0-20" class="i">+extern void manage(Window w, XWindowAttributes *wa);
</a> extern void maximize(Arg *arg);
<a href="#h2-0-22" id="h2-0-22" class="d">-extern void focusprev(Arg *arg);
</a><a href="#h2-0-23" id="h2-0-23" class="d">-extern void focusnext(Arg *arg);
</a><a href="#h2-0-24" id="h2-0-24" class="d">-extern void killclient(Arg *arg);
</a><a href="#h2-0-25" id="h2-0-25" class="i">+extern void resize(Client *c, Bool inc);
</a><a href="#h2-0-26" id="h2-0-26" class="i">+extern void setsize(Client *c);
</a><a href="#h2-0-27" id="h2-0-27" class="i">+extern void settitle(Client *c);
</a><a href="#h2-0-28" id="h2-0-28" class="i">+extern void unmanage(Client *c);
</a><a href="#h2-0-29" id="h2-0-29" class="i">+extern void zoom(Arg *arg);
</a> 
 /* draw.c */
 extern void drawall();
 extern void drawstatus();
<a href="#h2-0-34" id="h2-0-34" class="d">-extern void drawtitle(Client *c);
</a> extern void drawtext(const char *text, Bool invert, Bool border);
<a href="#h2-0-36" id="h2-0-36" class="i">+extern void drawtitle(Client *c);
</a> extern unsigned long getcolor(const char *colstr);
 extern void setfont(const char *fontstr);
 extern unsigned int textnw(char *text, unsigned int len);
 extern unsigned int textw(char *text);
<a href="#h2-0-41" id="h2-0-41" class="d">-extern unsigned int texth(void);
</a> 
 /* event.c */
 extern void grabkeys();
 
 /* main.c */
<a href="#h2-0-47" id="h2-0-47" class="i">+extern int getproto(Window w);
</a> extern void quit(Arg *arg);
<a href="#h2-0-49" id="h2-0-49" class="d">-extern int xerror(Display *dsply, XErrorEvent *ee);
</a> extern void sendevent(Window w, Atom a, long value);
<a href="#h2-0-51" id="h2-0-51" class="d">-extern int getproto(Window w);
</a><a href="#h2-0-52" id="h2-0-52" class="i">+extern int xerror(Display *dsply, XErrorEvent *ee);
</a> 
 /* tag.c */
<a href="#h2-0-55" id="h2-0-55" class="d">-extern Client *getnext(Client *c);
</a><a href="#h2-0-56" id="h2-0-56" class="d">-extern void settags(Client *c);
</a><a href="#h2-0-57" id="h2-0-57" class="i">+extern void appendtag(Arg *arg);
</a> extern void dofloat(Arg *arg);
 extern void dotile(Arg *arg);
<a href="#h2-0-60" id="h2-0-60" class="d">-extern void view(Arg *arg);
</a><a href="#h2-0-61" id="h2-0-61" class="d">-extern void appendtag(Arg *arg);
</a><a href="#h2-0-62" id="h2-0-62" class="i">+extern Client *getnext(Client *c);
</a> extern void replacetag(Arg *arg);
<a href="#h2-0-64" id="h2-0-64" class="i">+extern void settags(Client *c);
</a><a href="#h2-0-65" id="h2-0-65" class="i">+extern void view(Arg *arg);
</a> 
 /* util.c */
<a href="#h2-0-68" id="h2-0-68" class="d">-extern void eprint(const char *errstr, ...);
</a> extern void *emallocz(unsigned int size);
<a href="#h2-0-70" id="h2-0-70" class="i">+extern void eprint(const char *errstr, ...);
</a> extern void spawn(Arg *arg);
<b>diff --git a/<a id="h3" href="../file/event.c.html">event.c</a> b/<a href="../file/event.c.html">event.c</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -2,17 +2,12 @@
</a>  * (C)opyright MMVI Anselm R. Garbe &lt;garbeam at gmail dot com&gt;
  * See LICENSE file for license details.
  */
<a href="#h3-0-3" id="h3-0-3" class="i">+#include &quot;dwm.h&quot;
</a> 
<a href="#h3-0-5" id="h3-0-5" class="d">-#include &lt;fcntl.h&gt;
</a><a href="#h3-0-6" id="h3-0-6" class="d">-#include &lt;stdio.h&gt;
</a> #include &lt;stdlib.h&gt;
<a href="#h3-0-8" id="h3-0-8" class="d">-#include &lt;string.h&gt;
</a><a href="#h3-0-9" id="h3-0-9" class="d">-#include &lt;unistd.h&gt;
</a> #include &lt;X11/keysym.h&gt;
 #include &lt;X11/Xatom.h&gt;
 
<a href="#h3-0-13" id="h3-0-13" class="d">-#include &quot;dwm.h&quot;
</a><a href="#h3-0-14" id="h3-0-14" class="d">-
</a> #define ButtonMask      (ButtonPressMask | ButtonReleaseMask)
 #define MouseMask       (ButtonMask | PointerMotionMask)
 
<a href="#h3-1" id="h3-1" class="h">@@ -54,130 +49,10 @@ Key key[] = {
</a> 
 /********** CUSTOMIZE **********/
 
<a href="#h3-1-3" id="h3-1-3" class="d">-/* local functions */
</a><a href="#h3-1-4" id="h3-1-4" class="d">-static void buttonpress(XEvent *e);
</a><a href="#h3-1-5" id="h3-1-5" class="d">-static void configurerequest(XEvent *e);
</a><a href="#h3-1-6" id="h3-1-6" class="d">-static void destroynotify(XEvent *e);
</a><a href="#h3-1-7" id="h3-1-7" class="d">-static void enternotify(XEvent *e);
</a><a href="#h3-1-8" id="h3-1-8" class="d">-static void leavenotify(XEvent *e);
</a><a href="#h3-1-9" id="h3-1-9" class="d">-static void expose(XEvent *e);
</a><a href="#h3-1-10" id="h3-1-10" class="d">-static void keypress(XEvent *e);
</a><a href="#h3-1-11" id="h3-1-11" class="d">-static void maprequest(XEvent *e);
</a><a href="#h3-1-12" id="h3-1-12" class="d">-static void propertynotify(XEvent *e);
</a><a href="#h3-1-13" id="h3-1-13" class="d">-static void unmapnotify(XEvent *e);
</a><a href="#h3-1-14" id="h3-1-14" class="d">-
</a><a href="#h3-1-15" id="h3-1-15" class="d">-void (*handler[LASTEvent]) (XEvent *) = {
</a><a href="#h3-1-16" id="h3-1-16" class="d">-	[ButtonPress] = buttonpress,
</a><a href="#h3-1-17" id="h3-1-17" class="d">-	[ConfigureRequest] = configurerequest,
</a><a href="#h3-1-18" id="h3-1-18" class="d">-	[DestroyNotify] = destroynotify,
</a><a href="#h3-1-19" id="h3-1-19" class="d">-	[EnterNotify] = enternotify,
</a><a href="#h3-1-20" id="h3-1-20" class="d">-	[LeaveNotify] = leavenotify,
</a><a href="#h3-1-21" id="h3-1-21" class="d">-	[Expose] = expose,
</a><a href="#h3-1-22" id="h3-1-22" class="d">-	[KeyPress] = keypress,
</a><a href="#h3-1-23" id="h3-1-23" class="d">-	[MapRequest] = maprequest,
</a><a href="#h3-1-24" id="h3-1-24" class="d">-	[PropertyNotify] = propertynotify,
</a><a href="#h3-1-25" id="h3-1-25" class="d">-	[UnmapNotify] = unmapnotify
</a><a href="#h3-1-26" id="h3-1-26" class="d">-};
</a><a href="#h3-1-27" id="h3-1-27" class="d">-
</a><a href="#h3-1-28" id="h3-1-28" class="d">-void
</a><a href="#h3-1-29" id="h3-1-29" class="d">-grabkeys()
</a><a href="#h3-1-30" id="h3-1-30" class="d">-{
</a><a href="#h3-1-31" id="h3-1-31" class="d">-	static unsigned int len = key ? sizeof(key) / sizeof(key[0]) : 0;
</a><a href="#h3-1-32" id="h3-1-32" class="d">-	unsigned int i;
</a><a href="#h3-1-33" id="h3-1-33" class="d">-	KeyCode code;
</a><a href="#h3-1-34" id="h3-1-34" class="d">-
</a><a href="#h3-1-35" id="h3-1-35" class="d">-	for(i = 0; i &lt; len; i++) {
</a><a href="#h3-1-36" id="h3-1-36" class="d">-		code = XKeysymToKeycode(dpy, key[i].keysym);
</a><a href="#h3-1-37" id="h3-1-37" class="d">-		XUngrabKey(dpy, code, key[i].mod, root);
</a><a href="#h3-1-38" id="h3-1-38" class="d">-		XGrabKey(dpy, code, key[i].mod, root, True,
</a><a href="#h3-1-39" id="h3-1-39" class="d">-				GrabModeAsync, GrabModeAsync);
</a><a href="#h3-1-40" id="h3-1-40" class="d">-	}
</a><a href="#h3-1-41" id="h3-1-41" class="d">-}
</a><a href="#h3-1-42" id="h3-1-42" class="d">-
</a><a href="#h3-1-43" id="h3-1-43" class="d">-static void
</a><a href="#h3-1-44" id="h3-1-44" class="d">-keypress(XEvent *e)
</a><a href="#h3-1-45" id="h3-1-45" class="d">-{
</a><a href="#h3-1-46" id="h3-1-46" class="d">-	XKeyEvent *ev = &amp;e-&gt;xkey;
</a><a href="#h3-1-47" id="h3-1-47" class="d">-	static unsigned int len = key ? sizeof(key) / sizeof(key[0]) : 0;
</a><a href="#h3-1-48" id="h3-1-48" class="d">-	unsigned int i;
</a><a href="#h3-1-49" id="h3-1-49" class="d">-	KeySym keysym;
</a><a href="#h3-1-50" id="h3-1-50" class="d">-
</a><a href="#h3-1-51" id="h3-1-51" class="d">-	keysym = XKeycodeToKeysym(dpy, (KeyCode)ev-&gt;keycode, 0);
</a><a href="#h3-1-52" id="h3-1-52" class="d">-	for(i = 0; i &lt; len; i++)
</a><a href="#h3-1-53" id="h3-1-53" class="d">-		if((keysym == key[i].keysym) &amp;&amp; (key[i].mod == ev-&gt;state)) {
</a><a href="#h3-1-54" id="h3-1-54" class="d">-			if(key[i].func)
</a><a href="#h3-1-55" id="h3-1-55" class="d">-				key[i].func(&amp;key[i].arg);
</a><a href="#h3-1-56" id="h3-1-56" class="d">-			return;
</a><a href="#h3-1-57" id="h3-1-57" class="d">-		}
</a><a href="#h3-1-58" id="h3-1-58" class="d">-}
</a><a href="#h3-1-59" id="h3-1-59" class="d">-
</a><a href="#h3-1-60" id="h3-1-60" class="d">-static void
</a><a href="#h3-1-61" id="h3-1-61" class="d">-resizemouse(Client *c)
</a><a href="#h3-1-62" id="h3-1-62" class="d">-{
</a><a href="#h3-1-63" id="h3-1-63" class="d">-	XEvent ev;
</a><a href="#h3-1-64" id="h3-1-64" class="d">-	int ocx, ocy;
</a><a href="#h3-1-65" id="h3-1-65" class="d">-
</a><a href="#h3-1-66" id="h3-1-66" class="d">-	ocx = c-&gt;x;
</a><a href="#h3-1-67" id="h3-1-67" class="d">-	ocy = c-&gt;y;
</a><a href="#h3-1-68" id="h3-1-68" class="d">-	if(XGrabPointer(dpy, root, False, MouseMask, GrabModeAsync, GrabModeAsync,
</a><a href="#h3-1-69" id="h3-1-69" class="d">-				None, cursor[CurResize], CurrentTime) != GrabSuccess)
</a><a href="#h3-1-70" id="h3-1-70" class="d">-		return;
</a><a href="#h3-1-71" id="h3-1-71" class="d">-	XWarpPointer(dpy, None, c-&gt;win, 0, 0, 0, 0, c-&gt;w, c-&gt;h);
</a><a href="#h3-1-72" id="h3-1-72" class="d">-	for(;;) {
</a><a href="#h3-1-73" id="h3-1-73" class="d">-		XMaskEvent(dpy, MouseMask | ExposureMask, &amp;ev);
</a><a href="#h3-1-74" id="h3-1-74" class="d">-		switch(ev.type) {
</a><a href="#h3-1-75" id="h3-1-75" class="d">-		default: break;
</a><a href="#h3-1-76" id="h3-1-76" class="d">-		case Expose:
</a><a href="#h3-1-77" id="h3-1-77" class="d">-			handler[Expose](&amp;ev);
</a><a href="#h3-1-78" id="h3-1-78" class="d">-			break;
</a><a href="#h3-1-79" id="h3-1-79" class="d">-		case MotionNotify:
</a><a href="#h3-1-80" id="h3-1-80" class="d">-			XFlush(dpy);
</a><a href="#h3-1-81" id="h3-1-81" class="d">-			c-&gt;w = abs(ocx - ev.xmotion.x);
</a><a href="#h3-1-82" id="h3-1-82" class="d">-			c-&gt;h = abs(ocy - ev.xmotion.y);
</a><a href="#h3-1-83" id="h3-1-83" class="d">-			c-&gt;x = (ocx &lt;= ev.xmotion.x) ? ocx : ocx - c-&gt;w;
</a><a href="#h3-1-84" id="h3-1-84" class="d">-			c-&gt;y = (ocy &lt;= ev.xmotion.y) ? ocy : ocy - c-&gt;h;
</a><a href="#h3-1-85" id="h3-1-85" class="d">-			resize(c, True);
</a><a href="#h3-1-86" id="h3-1-86" class="d">-			break;
</a><a href="#h3-1-87" id="h3-1-87" class="d">-		case ButtonRelease:
</a><a href="#h3-1-88" id="h3-1-88" class="d">-			XUngrabPointer(dpy, CurrentTime);
</a><a href="#h3-1-89" id="h3-1-89" class="d">-			return;
</a><a href="#h3-1-90" id="h3-1-90" class="d">-		}
</a><a href="#h3-1-91" id="h3-1-91" class="d">-	}
</a><a href="#h3-1-92" id="h3-1-92" class="d">-}
</a><a href="#h3-1-93" id="h3-1-93" class="d">-
</a><a href="#h3-1-94" id="h3-1-94" class="d">-static void
</a><a href="#h3-1-95" id="h3-1-95" class="d">-movemouse(Client *c)
</a><a href="#h3-1-96" id="h3-1-96" class="d">-{
</a><a href="#h3-1-97" id="h3-1-97" class="d">-	XEvent ev;
</a><a href="#h3-1-98" id="h3-1-98" class="d">-	int x1, y1, ocx, ocy, di;
</a><a href="#h3-1-99" id="h3-1-99" class="d">-	unsigned int dui;
</a><a href="#h3-1-100" id="h3-1-100" class="d">-	Window dummy;
</a><a href="#h3-1-101" id="h3-1-101" class="i">+/* static functions */
</a> 
<a href="#h3-1-103" id="h3-1-103" class="d">-	ocx = c-&gt;x;
</a><a href="#h3-1-104" id="h3-1-104" class="d">-	ocy = c-&gt;y;
</a><a href="#h3-1-105" id="h3-1-105" class="d">-	if(XGrabPointer(dpy, root, False, MouseMask, GrabModeAsync, GrabModeAsync,
</a><a href="#h3-1-106" id="h3-1-106" class="d">-				None, cursor[CurMove], CurrentTime) != GrabSuccess)
</a><a href="#h3-1-107" id="h3-1-107" class="d">-		return;
</a><a href="#h3-1-108" id="h3-1-108" class="d">-	XQueryPointer(dpy, root, &amp;dummy, &amp;dummy, &amp;x1, &amp;y1, &amp;di, &amp;di, &amp;dui);
</a><a href="#h3-1-109" id="h3-1-109" class="d">-	for(;;) {
</a><a href="#h3-1-110" id="h3-1-110" class="d">-		XMaskEvent(dpy, MouseMask | ExposureMask, &amp;ev);
</a><a href="#h3-1-111" id="h3-1-111" class="d">-		switch (ev.type) {
</a><a href="#h3-1-112" id="h3-1-112" class="d">-		default: break;
</a><a href="#h3-1-113" id="h3-1-113" class="d">-		case Expose:
</a><a href="#h3-1-114" id="h3-1-114" class="d">-			handler[Expose](&amp;ev);
</a><a href="#h3-1-115" id="h3-1-115" class="d">-			break;
</a><a href="#h3-1-116" id="h3-1-116" class="d">-		case MotionNotify:
</a><a href="#h3-1-117" id="h3-1-117" class="d">-			XFlush(dpy);
</a><a href="#h3-1-118" id="h3-1-118" class="d">-			c-&gt;x = ocx + (ev.xmotion.x - x1);
</a><a href="#h3-1-119" id="h3-1-119" class="d">-			c-&gt;y = ocy + (ev.xmotion.y - y1);
</a><a href="#h3-1-120" id="h3-1-120" class="d">-			resize(c, False);
</a><a href="#h3-1-121" id="h3-1-121" class="d">-			break;
</a><a href="#h3-1-122" id="h3-1-122" class="d">-		case ButtonRelease:
</a><a href="#h3-1-123" id="h3-1-123" class="d">-			XUngrabPointer(dpy, CurrentTime);
</a><a href="#h3-1-124" id="h3-1-124" class="d">-			return;
</a><a href="#h3-1-125" id="h3-1-125" class="d">-		}
</a><a href="#h3-1-126" id="h3-1-126" class="d">-	}
</a><a href="#h3-1-127" id="h3-1-127" class="d">-}
</a><a href="#h3-1-128" id="h3-1-128" class="i">+static void movemouse(Client *c);
</a><a href="#h3-1-129" id="h3-1-129" class="i">+static void resizemouse(Client *c);
</a> 
 static void
 buttonpress(XEvent *e)
<a href="#h3-2" id="h3-2" class="h">@@ -280,15 +155,6 @@ enternotify(XEvent *e)
</a> }
 
 static void
<a href="#h3-2-3" id="h3-2-3" class="d">-leavenotify(XEvent *e)
</a><a href="#h3-2-4" id="h3-2-4" class="d">-{
</a><a href="#h3-2-5" id="h3-2-5" class="d">-	XCrossingEvent *ev = &amp;e-&gt;xcrossing;
</a><a href="#h3-2-6" id="h3-2-6" class="d">-
</a><a href="#h3-2-7" id="h3-2-7" class="d">-	if((ev-&gt;window == root) &amp;&amp; !ev-&gt;same_screen)
</a><a href="#h3-2-8" id="h3-2-8" class="d">-		issel = True;
</a><a href="#h3-2-9" id="h3-2-9" class="d">-}
</a><a href="#h3-2-10" id="h3-2-10" class="d">-
</a><a href="#h3-2-11" id="h3-2-11" class="d">-static void
</a> expose(XEvent *e)
 {
 	XExposeEvent *ev = &amp;e-&gt;xexpose;
<a href="#h3-3" id="h3-3" class="h">@@ -303,6 +169,32 @@ expose(XEvent *e)
</a> }
 
 static void
<a href="#h3-3-3" id="h3-3-3" class="i">+keypress(XEvent *e)
</a><a href="#h3-3-4" id="h3-3-4" class="i">+{
</a><a href="#h3-3-5" id="h3-3-5" class="i">+	XKeyEvent *ev = &amp;e-&gt;xkey;
</a><a href="#h3-3-6" id="h3-3-6" class="i">+	static unsigned int len = key ? sizeof(key) / sizeof(key[0]) : 0;
</a><a href="#h3-3-7" id="h3-3-7" class="i">+	unsigned int i;
</a><a href="#h3-3-8" id="h3-3-8" class="i">+	KeySym keysym;
</a><a href="#h3-3-9" id="h3-3-9" class="i">+
</a><a href="#h3-3-10" id="h3-3-10" class="i">+	keysym = XKeycodeToKeysym(dpy, (KeyCode)ev-&gt;keycode, 0);
</a><a href="#h3-3-11" id="h3-3-11" class="i">+	for(i = 0; i &lt; len; i++)
</a><a href="#h3-3-12" id="h3-3-12" class="i">+		if((keysym == key[i].keysym) &amp;&amp; (key[i].mod == ev-&gt;state)) {
</a><a href="#h3-3-13" id="h3-3-13" class="i">+			if(key[i].func)
</a><a href="#h3-3-14" id="h3-3-14" class="i">+				key[i].func(&amp;key[i].arg);
</a><a href="#h3-3-15" id="h3-3-15" class="i">+			return;
</a><a href="#h3-3-16" id="h3-3-16" class="i">+		}
</a><a href="#h3-3-17" id="h3-3-17" class="i">+}
</a><a href="#h3-3-18" id="h3-3-18" class="i">+
</a><a href="#h3-3-19" id="h3-3-19" class="i">+static void
</a><a href="#h3-3-20" id="h3-3-20" class="i">+leavenotify(XEvent *e)
</a><a href="#h3-3-21" id="h3-3-21" class="i">+{
</a><a href="#h3-3-22" id="h3-3-22" class="i">+	XCrossingEvent *ev = &amp;e-&gt;xcrossing;
</a><a href="#h3-3-23" id="h3-3-23" class="i">+
</a><a href="#h3-3-24" id="h3-3-24" class="i">+	if((ev-&gt;window == root) &amp;&amp; !ev-&gt;same_screen)
</a><a href="#h3-3-25" id="h3-3-25" class="i">+		issel = True;
</a><a href="#h3-3-26" id="h3-3-26" class="i">+}
</a><a href="#h3-3-27" id="h3-3-27" class="i">+
</a><a href="#h3-3-28" id="h3-3-28" class="i">+static void
</a> maprequest(XEvent *e)
 {
 	XMapRequestEvent *ev = &amp;e-&gt;xmaprequest;
<a href="#h3-4" id="h3-4" class="h">@@ -322,6 +214,40 @@ maprequest(XEvent *e)
</a> }
 
 static void
<a href="#h3-4-3" id="h3-4-3" class="i">+movemouse(Client *c)
</a><a href="#h3-4-4" id="h3-4-4" class="i">+{
</a><a href="#h3-4-5" id="h3-4-5" class="i">+	XEvent ev;
</a><a href="#h3-4-6" id="h3-4-6" class="i">+	int x1, y1, ocx, ocy, di;
</a><a href="#h3-4-7" id="h3-4-7" class="i">+	unsigned int dui;
</a><a href="#h3-4-8" id="h3-4-8" class="i">+	Window dummy;
</a><a href="#h3-4-9" id="h3-4-9" class="i">+
</a><a href="#h3-4-10" id="h3-4-10" class="i">+	ocx = c-&gt;x;
</a><a href="#h3-4-11" id="h3-4-11" class="i">+	ocy = c-&gt;y;
</a><a href="#h3-4-12" id="h3-4-12" class="i">+	if(XGrabPointer(dpy, root, False, MouseMask, GrabModeAsync, GrabModeAsync,
</a><a href="#h3-4-13" id="h3-4-13" class="i">+				None, cursor[CurMove], CurrentTime) != GrabSuccess)
</a><a href="#h3-4-14" id="h3-4-14" class="i">+		return;
</a><a href="#h3-4-15" id="h3-4-15" class="i">+	XQueryPointer(dpy, root, &amp;dummy, &amp;dummy, &amp;x1, &amp;y1, &amp;di, &amp;di, &amp;dui);
</a><a href="#h3-4-16" id="h3-4-16" class="i">+	for(;;) {
</a><a href="#h3-4-17" id="h3-4-17" class="i">+		XMaskEvent(dpy, MouseMask | ExposureMask, &amp;ev);
</a><a href="#h3-4-18" id="h3-4-18" class="i">+		switch (ev.type) {
</a><a href="#h3-4-19" id="h3-4-19" class="i">+		default: break;
</a><a href="#h3-4-20" id="h3-4-20" class="i">+		case Expose:
</a><a href="#h3-4-21" id="h3-4-21" class="i">+			handler[Expose](&amp;ev);
</a><a href="#h3-4-22" id="h3-4-22" class="i">+			break;
</a><a href="#h3-4-23" id="h3-4-23" class="i">+		case MotionNotify:
</a><a href="#h3-4-24" id="h3-4-24" class="i">+			XFlush(dpy);
</a><a href="#h3-4-25" id="h3-4-25" class="i">+			c-&gt;x = ocx + (ev.xmotion.x - x1);
</a><a href="#h3-4-26" id="h3-4-26" class="i">+			c-&gt;y = ocy + (ev.xmotion.y - y1);
</a><a href="#h3-4-27" id="h3-4-27" class="i">+			resize(c, False);
</a><a href="#h3-4-28" id="h3-4-28" class="i">+			break;
</a><a href="#h3-4-29" id="h3-4-29" class="i">+		case ButtonRelease:
</a><a href="#h3-4-30" id="h3-4-30" class="i">+			XUngrabPointer(dpy, CurrentTime);
</a><a href="#h3-4-31" id="h3-4-31" class="i">+			return;
</a><a href="#h3-4-32" id="h3-4-32" class="i">+		}
</a><a href="#h3-4-33" id="h3-4-33" class="i">+	}
</a><a href="#h3-4-34" id="h3-4-34" class="i">+}
</a><a href="#h3-4-35" id="h3-4-35" class="i">+
</a><a href="#h3-4-36" id="h3-4-36" class="i">+static void
</a> propertynotify(XEvent *e)
 {
 	XPropertyEvent *ev = &amp;e-&gt;xproperty;
<a href="#h3-5" id="h3-5" class="h">@@ -355,6 +281,40 @@ propertynotify(XEvent *e)
</a> }
 
 static void
<a href="#h3-5-3" id="h3-5-3" class="i">+resizemouse(Client *c)
</a><a href="#h3-5-4" id="h3-5-4" class="i">+{
</a><a href="#h3-5-5" id="h3-5-5" class="i">+	XEvent ev;
</a><a href="#h3-5-6" id="h3-5-6" class="i">+	int ocx, ocy;
</a><a href="#h3-5-7" id="h3-5-7" class="i">+
</a><a href="#h3-5-8" id="h3-5-8" class="i">+	ocx = c-&gt;x;
</a><a href="#h3-5-9" id="h3-5-9" class="i">+	ocy = c-&gt;y;
</a><a href="#h3-5-10" id="h3-5-10" class="i">+	if(XGrabPointer(dpy, root, False, MouseMask, GrabModeAsync, GrabModeAsync,
</a><a href="#h3-5-11" id="h3-5-11" class="i">+				None, cursor[CurResize], CurrentTime) != GrabSuccess)
</a><a href="#h3-5-12" id="h3-5-12" class="i">+		return;
</a><a href="#h3-5-13" id="h3-5-13" class="i">+	XWarpPointer(dpy, None, c-&gt;win, 0, 0, 0, 0, c-&gt;w, c-&gt;h);
</a><a href="#h3-5-14" id="h3-5-14" class="i">+	for(;;) {
</a><a href="#h3-5-15" id="h3-5-15" class="i">+		XMaskEvent(dpy, MouseMask | ExposureMask, &amp;ev);
</a><a href="#h3-5-16" id="h3-5-16" class="i">+		switch(ev.type) {
</a><a href="#h3-5-17" id="h3-5-17" class="i">+		default: break;
</a><a href="#h3-5-18" id="h3-5-18" class="i">+		case Expose:
</a><a href="#h3-5-19" id="h3-5-19" class="i">+			handler[Expose](&amp;ev);
</a><a href="#h3-5-20" id="h3-5-20" class="i">+			break;
</a><a href="#h3-5-21" id="h3-5-21" class="i">+		case MotionNotify:
</a><a href="#h3-5-22" id="h3-5-22" class="i">+			XFlush(dpy);
</a><a href="#h3-5-23" id="h3-5-23" class="i">+			c-&gt;w = abs(ocx - ev.xmotion.x);
</a><a href="#h3-5-24" id="h3-5-24" class="i">+			c-&gt;h = abs(ocy - ev.xmotion.y);
</a><a href="#h3-5-25" id="h3-5-25" class="i">+			c-&gt;x = (ocx &lt;= ev.xmotion.x) ? ocx : ocx - c-&gt;w;
</a><a href="#h3-5-26" id="h3-5-26" class="i">+			c-&gt;y = (ocy &lt;= ev.xmotion.y) ? ocy : ocy - c-&gt;h;
</a><a href="#h3-5-27" id="h3-5-27" class="i">+			resize(c, True);
</a><a href="#h3-5-28" id="h3-5-28" class="i">+			break;
</a><a href="#h3-5-29" id="h3-5-29" class="i">+		case ButtonRelease:
</a><a href="#h3-5-30" id="h3-5-30" class="i">+			XUngrabPointer(dpy, CurrentTime);
</a><a href="#h3-5-31" id="h3-5-31" class="i">+			return;
</a><a href="#h3-5-32" id="h3-5-32" class="i">+		}
</a><a href="#h3-5-33" id="h3-5-33" class="i">+	}
</a><a href="#h3-5-34" id="h3-5-34" class="i">+}
</a><a href="#h3-5-35" id="h3-5-35" class="i">+
</a><a href="#h3-5-36" id="h3-5-36" class="i">+static void
</a> unmapnotify(XEvent *e)
 {
 	Client *c;
<a href="#h3-6" id="h3-6" class="h">@@ -363,3 +323,33 @@ unmapnotify(XEvent *e)
</a> 	if((c = getclient(ev-&gt;window)))
 		unmanage(c);
 }
<a href="#h3-6-3" id="h3-6-3" class="i">+
</a><a href="#h3-6-4" id="h3-6-4" class="i">+/* extern functions */
</a><a href="#h3-6-5" id="h3-6-5" class="i">+
</a><a href="#h3-6-6" id="h3-6-6" class="i">+void (*handler[LASTEvent]) (XEvent *) = {
</a><a href="#h3-6-7" id="h3-6-7" class="i">+	[ButtonPress] = buttonpress,
</a><a href="#h3-6-8" id="h3-6-8" class="i">+	[ConfigureRequest] = configurerequest,
</a><a href="#h3-6-9" id="h3-6-9" class="i">+	[DestroyNotify] = destroynotify,
</a><a href="#h3-6-10" id="h3-6-10" class="i">+	[EnterNotify] = enternotify,
</a><a href="#h3-6-11" id="h3-6-11" class="i">+	[LeaveNotify] = leavenotify,
</a><a href="#h3-6-12" id="h3-6-12" class="i">+	[Expose] = expose,
</a><a href="#h3-6-13" id="h3-6-13" class="i">+	[KeyPress] = keypress,
</a><a href="#h3-6-14" id="h3-6-14" class="i">+	[MapRequest] = maprequest,
</a><a href="#h3-6-15" id="h3-6-15" class="i">+	[PropertyNotify] = propertynotify,
</a><a href="#h3-6-16" id="h3-6-16" class="i">+	[UnmapNotify] = unmapnotify
</a><a href="#h3-6-17" id="h3-6-17" class="i">+};
</a><a href="#h3-6-18" id="h3-6-18" class="i">+
</a><a href="#h3-6-19" id="h3-6-19" class="i">+void
</a><a href="#h3-6-20" id="h3-6-20" class="i">+grabkeys()
</a><a href="#h3-6-21" id="h3-6-21" class="i">+{
</a><a href="#h3-6-22" id="h3-6-22" class="i">+	static unsigned int len = key ? sizeof(key) / sizeof(key[0]) : 0;
</a><a href="#h3-6-23" id="h3-6-23" class="i">+	unsigned int i;
</a><a href="#h3-6-24" id="h3-6-24" class="i">+	KeyCode code;
</a><a href="#h3-6-25" id="h3-6-25" class="i">+
</a><a href="#h3-6-26" id="h3-6-26" class="i">+	for(i = 0; i &lt; len; i++) {
</a><a href="#h3-6-27" id="h3-6-27" class="i">+		code = XKeysymToKeycode(dpy, key[i].keysym);
</a><a href="#h3-6-28" id="h3-6-28" class="i">+		XUngrabKey(dpy, code, key[i].mod, root);
</a><a href="#h3-6-29" id="h3-6-29" class="i">+		XGrabKey(dpy, code, key[i].mod, root, True,
</a><a href="#h3-6-30" id="h3-6-30" class="i">+				GrabModeAsync, GrabModeAsync);
</a><a href="#h3-6-31" id="h3-6-31" class="i">+	}
</a><a href="#h3-6-32" id="h3-6-32" class="i">+}
</a><b>diff --git a/<a id="h4" href="../file/main.c.html">main.c</a> b/<a href="../file/main.c.html">main.c</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -3,31 +3,17 @@
</a>  * See LICENSE file for license details.
  */
 
<a href="#h4-0-3" id="h4-0-3" class="i">+#include &quot;dwm.h&quot;
</a><a href="#h4-0-4" id="h4-0-4" class="i">+
</a> #include &lt;errno.h&gt;
<a href="#h4-0-6" id="h4-0-6" class="d">-#include &lt;stdarg.h&gt;
</a> #include &lt;stdio.h&gt;
 #include &lt;stdlib.h&gt;
 #include &lt;string.h&gt;
 #include &lt;unistd.h&gt;
<a href="#h4-0-11" id="h4-0-11" class="d">-
</a> #include &lt;X11/cursorfont.h&gt;
 #include &lt;X11/Xatom.h&gt;
 #include &lt;X11/Xproto.h&gt;
 
<a href="#h4-0-16" id="h4-0-16" class="d">-#include &quot;dwm.h&quot;
</a><a href="#h4-0-17" id="h4-0-17" class="d">-
</a><a href="#h4-0-18" id="h4-0-18" class="d">-/********** CUSTOMIZE **********/
</a><a href="#h4-0-19" id="h4-0-19" class="d">-
</a><a href="#h4-0-20" id="h4-0-20" class="d">-char *tags[TLast] = {
</a><a href="#h4-0-21" id="h4-0-21" class="d">-	[Tscratch] = &quot;scratch&quot;,
</a><a href="#h4-0-22" id="h4-0-22" class="d">-	[Tdev] = &quot;dev&quot;,
</a><a href="#h4-0-23" id="h4-0-23" class="d">-	[Twww] = &quot;www&quot;,
</a><a href="#h4-0-24" id="h4-0-24" class="d">-	[Twork] = &quot;work&quot;,
</a><a href="#h4-0-25" id="h4-0-25" class="d">-};
</a><a href="#h4-0-26" id="h4-0-26" class="d">-
</a><a href="#h4-0-27" id="h4-0-27" class="d">-/********** CUSTOMIZE **********/
</a><a href="#h4-0-28" id="h4-0-28" class="d">-
</a><a href="#h4-0-29" id="h4-0-29" class="d">-/* X structs */
</a> Display *dpy;
 Window root, barwin;
 Atom wm_atom[WMLast], net_atom[NetLast];
<a href="#h4-1" id="h4-1" class="h">@@ -48,8 +34,17 @@ static const char version[] =
</a> 	&quot;dwm-&quot; VERSION &quot;, (C)opyright MMVI Anselm R. Garbe\n&quot;;
 static int (*xerrorxlib)(Display *, XErrorEvent *);
 
<a href="#h4-1-3" id="h4-1-3" class="i">+/* static functions */
</a><a href="#h4-1-4" id="h4-1-4" class="i">+
</a> static void
<a href="#h4-1-6" id="h4-1-6" class="d">-usage() {	eprint(&quot;usage: dwm [-v]\n&quot;); }
</a><a href="#h4-1-7" id="h4-1-7" class="i">+cleanup()
</a><a href="#h4-1-8" id="h4-1-8" class="i">+{
</a><a href="#h4-1-9" id="h4-1-9" class="i">+	while(sel) {
</a><a href="#h4-1-10" id="h4-1-10" class="i">+		resize(sel, True);
</a><a href="#h4-1-11" id="h4-1-11" class="i">+		unmanage(sel);
</a><a href="#h4-1-12" id="h4-1-12" class="i">+	}
</a><a href="#h4-1-13" id="h4-1-13" class="i">+	XSetInputFocus(dpy, PointerRoot, RevertToPointerRoot, CurrentTime);
</a><a href="#h4-1-14" id="h4-1-14" class="i">+}
</a> 
 static void
 scan()
<a href="#h4-2" id="h4-2" class="h">@@ -73,22 +68,6 @@ scan()
</a> 		XFree(wins);
 }
 
<a href="#h4-2-3" id="h4-2-3" class="d">-static void
</a><a href="#h4-2-4" id="h4-2-4" class="d">-cleanup()
</a><a href="#h4-2-5" id="h4-2-5" class="d">-{
</a><a href="#h4-2-6" id="h4-2-6" class="d">-	while(sel) {
</a><a href="#h4-2-7" id="h4-2-7" class="d">-		resize(sel, True);
</a><a href="#h4-2-8" id="h4-2-8" class="d">-		unmanage(sel);
</a><a href="#h4-2-9" id="h4-2-9" class="d">-	}
</a><a href="#h4-2-10" id="h4-2-10" class="d">-	XSetInputFocus(dpy, PointerRoot, RevertToPointerRoot, CurrentTime);
</a><a href="#h4-2-11" id="h4-2-11" class="d">-}
</a><a href="#h4-2-12" id="h4-2-12" class="d">-
</a><a href="#h4-2-13" id="h4-2-13" class="d">-void
</a><a href="#h4-2-14" id="h4-2-14" class="d">-quit(Arg *arg)
</a><a href="#h4-2-15" id="h4-2-15" class="d">-{
</a><a href="#h4-2-16" id="h4-2-16" class="d">-	running = False;
</a><a href="#h4-2-17" id="h4-2-17" class="d">-}
</a><a href="#h4-2-18" id="h4-2-18" class="d">-
</a> static int
 win_property(Window w, Atom a, Atom t, long l, unsigned char **prop)
 {
<a href="#h4-3" id="h4-3" class="h">@@ -109,6 +88,19 @@ win_property(Window w, Atom a, Atom t, long l, unsigned char **prop)
</a> 	return res;
 }
 
<a href="#h4-3-3" id="h4-3-3" class="i">+/*
</a><a href="#h4-3-4" id="h4-3-4" class="i">+ * Startup Error handler to check if another window manager
</a><a href="#h4-3-5" id="h4-3-5" class="i">+ * is already running.
</a><a href="#h4-3-6" id="h4-3-6" class="i">+ */
</a><a href="#h4-3-7" id="h4-3-7" class="i">+static int
</a><a href="#h4-3-8" id="h4-3-8" class="i">+xerrorstart(Display *dsply, XErrorEvent *ee)
</a><a href="#h4-3-9" id="h4-3-9" class="i">+{
</a><a href="#h4-3-10" id="h4-3-10" class="i">+	otherwm = True;
</a><a href="#h4-3-11" id="h4-3-11" class="i">+	return -1;
</a><a href="#h4-3-12" id="h4-3-12" class="i">+}
</a><a href="#h4-3-13" id="h4-3-13" class="i">+
</a><a href="#h4-3-14" id="h4-3-14" class="i">+/* extern functions */
</a><a href="#h4-3-15" id="h4-3-15" class="i">+
</a> int
 getproto(Window w)
 {
<a href="#h4-4" id="h4-4" class="h">@@ -144,15 +136,10 @@ sendevent(Window w, Atom a, long value)
</a> 	XFlush(dpy);
 }
 
<a href="#h4-4-3" id="h4-4-3" class="d">-/*
</a><a href="#h4-4-4" id="h4-4-4" class="d">- * Startup Error handler to check if another window manager
</a><a href="#h4-4-5" id="h4-4-5" class="d">- * is already running.
</a><a href="#h4-4-6" id="h4-4-6" class="d">- */
</a><a href="#h4-4-7" id="h4-4-7" class="d">-static int
</a><a href="#h4-4-8" id="h4-4-8" class="d">-xerrorstart(Display *dsply, XErrorEvent *ee)
</a><a href="#h4-4-9" id="h4-4-9" class="i">+void
</a><a href="#h4-4-10" id="h4-4-10" class="i">+quit(Arg *arg)
</a> {
<a href="#h4-4-12" id="h4-4-12" class="d">-	otherwm = True;
</a><a href="#h4-4-13" id="h4-4-13" class="d">-	return -1;
</a><a href="#h4-4-14" id="h4-4-14" class="i">+	running = False;
</a> }
 
 /*
<a href="#h4-5" id="h4-5" class="h">@@ -201,7 +188,7 @@ main(int argc, char *argv[])
</a> 			exit(0);
 			break;
 		default:
<a href="#h4-5-3" id="h4-5-3" class="d">-			usage();
</a><a href="#h4-5-4" id="h4-5-4" class="i">+			eprint(&quot;usage: dwm [-v]\n&quot;);
</a> 			break;
 		}
 	}
<b>diff --git a/<a id="h5" href="../file/tag.c.html">tag.c</a> b/<a href="../file/tag.c.html">tag.c</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -2,71 +2,39 @@
</a>  * (C)opyright MMVI Anselm R. Garbe &lt;garbeam at gmail dot com&gt;
  * See LICENSE file for license details.
  */
<a href="#h5-0-3" id="h5-0-3" class="i">+#include &quot;dwm.h&quot;
</a> 
<a href="#h5-0-5" id="h5-0-5" class="d">-#include &lt;stdlib.h&gt;
</a><a href="#h5-0-6" id="h5-0-6" class="d">-#include &lt;stdio.h&gt;
</a> #include &lt;string.h&gt;
<a href="#h5-0-8" id="h5-0-8" class="d">-#include &lt;X11/Xatom.h&gt;
</a> #include &lt;X11/Xutil.h&gt;
 
<a href="#h5-0-11" id="h5-0-11" class="d">-#include &quot;dwm.h&quot;
</a><a href="#h5-0-12" id="h5-0-12" class="i">+/********** CUSTOMIZE **********/
</a><a href="#h5-0-13" id="h5-0-13" class="i">+
</a><a href="#h5-0-14" id="h5-0-14" class="i">+char *tags[TLast] = {
</a><a href="#h5-0-15" id="h5-0-15" class="i">+	[Tscratch] = &quot;scratch&quot;,
</a><a href="#h5-0-16" id="h5-0-16" class="i">+	[Tdev] = &quot;dev&quot;,
</a><a href="#h5-0-17" id="h5-0-17" class="i">+	[Twww] = &quot;www&quot;,
</a><a href="#h5-0-18" id="h5-0-18" class="i">+	[Twork] = &quot;work&quot;,
</a><a href="#h5-0-19" id="h5-0-19" class="i">+};
</a> 
 static Rule rule[] = {
 	/* class			instance	tags						dofloat */
 	{ &quot;Firefox-bin&quot;,	&quot;Gecko&quot;,	{ [Twww] = &quot;www&quot; },			False },
 };
 
<a href="#h5-0-26" id="h5-0-26" class="d">-void (*arrange)(Arg *) = dotile;
</a><a href="#h5-0-27" id="h5-0-27" class="i">+/********** CUSTOMIZE **********/
</a> 
<a href="#h5-0-29" id="h5-0-29" class="d">-Client *
</a><a href="#h5-0-30" id="h5-0-30" class="d">-getnext(Client *c)
</a><a href="#h5-0-31" id="h5-0-31" class="d">-{
</a><a href="#h5-0-32" id="h5-0-32" class="d">-	for(; c &amp;&amp; !c-&gt;tags[tsel]; c = c-&gt;next);
</a><a href="#h5-0-33" id="h5-0-33" class="d">-	return c;
</a><a href="#h5-0-34" id="h5-0-34" class="d">-}
</a><a href="#h5-0-35" id="h5-0-35" class="i">+/* extern functions */
</a><a href="#h5-0-36" id="h5-0-36" class="i">+
</a><a href="#h5-0-37" id="h5-0-37" class="i">+void (*arrange)(Arg *) = dotile;
</a> 
 void
<a href="#h5-0-40" id="h5-0-40" class="d">-settags(Client *c)
</a><a href="#h5-0-41" id="h5-0-41" class="i">+appendtag(Arg *arg)
</a> {
<a href="#h5-0-43" id="h5-0-43" class="d">-	XClassHint ch;
</a><a href="#h5-0-44" id="h5-0-44" class="d">-	static unsigned int len = rule ? sizeof(rule) / sizeof(rule[0]) : 0;
</a><a href="#h5-0-45" id="h5-0-45" class="d">-	unsigned int i, j;
</a><a href="#h5-0-46" id="h5-0-46" class="d">-	Bool matched = False;
</a><a href="#h5-0-47" id="h5-0-47" class="d">-
</a><a href="#h5-0-48" id="h5-0-48" class="d">-	if(!len) {
</a><a href="#h5-0-49" id="h5-0-49" class="d">-		c-&gt;tags[tsel] = tags[tsel];
</a><a href="#h5-0-50" id="h5-0-50" class="i">+	if(!sel)
</a> 		return;
<a href="#h5-0-52" id="h5-0-52" class="d">-	}
</a><a href="#h5-0-53" id="h5-0-53" class="d">-
</a><a href="#h5-0-54" id="h5-0-54" class="d">-	if(XGetClassHint(dpy, c-&gt;win, &amp;ch)) {
</a><a href="#h5-0-55" id="h5-0-55" class="d">-		if(ch.res_class &amp;&amp; ch.res_name) {
</a><a href="#h5-0-56" id="h5-0-56" class="d">-			for(i = 0; i &lt; len; i++)
</a><a href="#h5-0-57" id="h5-0-57" class="d">-				if(!strncmp(rule[i].class, ch.res_class, sizeof(rule[i].class))
</a><a href="#h5-0-58" id="h5-0-58" class="d">-					&amp;&amp; !strncmp(rule[i].instance, ch.res_name, sizeof(rule[i].instance)))
</a><a href="#h5-0-59" id="h5-0-59" class="d">-				{
</a><a href="#h5-0-60" id="h5-0-60" class="d">-					for(j = 0; j &lt; TLast; j++)
</a><a href="#h5-0-61" id="h5-0-61" class="d">-						c-&gt;tags[j] = rule[i].tags[j];
</a><a href="#h5-0-62" id="h5-0-62" class="d">-					c-&gt;dofloat = rule[i].dofloat;
</a><a href="#h5-0-63" id="h5-0-63" class="d">-					matched = True;
</a><a href="#h5-0-64" id="h5-0-64" class="d">-					break;
</a><a href="#h5-0-65" id="h5-0-65" class="d">-				}
</a><a href="#h5-0-66" id="h5-0-66" class="d">-		}
</a><a href="#h5-0-67" id="h5-0-67" class="d">-		if(ch.res_class)
</a><a href="#h5-0-68" id="h5-0-68" class="d">-			XFree(ch.res_class);
</a><a href="#h5-0-69" id="h5-0-69" class="d">-		if(ch.res_name)
</a><a href="#h5-0-70" id="h5-0-70" class="d">-			XFree(ch.res_name);
</a><a href="#h5-0-71" id="h5-0-71" class="d">-	}
</a> 
<a href="#h5-0-73" id="h5-0-73" class="d">-	if(!matched)
</a><a href="#h5-0-74" id="h5-0-74" class="d">-		c-&gt;tags[tsel] = tags[tsel];
</a><a href="#h5-0-75" id="h5-0-75" class="d">-}
</a><a href="#h5-0-76" id="h5-0-76" class="d">-
</a><a href="#h5-0-77" id="h5-0-77" class="d">-void
</a><a href="#h5-0-78" id="h5-0-78" class="d">-view(Arg *arg)
</a><a href="#h5-0-79" id="h5-0-79" class="d">-{
</a><a href="#h5-0-80" id="h5-0-80" class="d">-	tsel = arg-&gt;i;
</a><a href="#h5-0-81" id="h5-0-81" class="i">+	sel-&gt;tags[arg-&gt;i] = tags[arg-&gt;i];
</a> 	arrange(NULL);
<a href="#h5-0-83" id="h5-0-83" class="d">-	drawall();
</a> }
 
 void
<a href="#h5-1" id="h5-1" class="h">@@ -147,14 +115,11 @@ dotile(Arg *arg)
</a> 	drawall();
 }
 
<a href="#h5-1-3" id="h5-1-3" class="d">-void
</a><a href="#h5-1-4" id="h5-1-4" class="d">-appendtag(Arg *arg)
</a><a href="#h5-1-5" id="h5-1-5" class="i">+Client *
</a><a href="#h5-1-6" id="h5-1-6" class="i">+getnext(Client *c)
</a> {
<a href="#h5-1-8" id="h5-1-8" class="d">-	if(!sel)
</a><a href="#h5-1-9" id="h5-1-9" class="d">-		return;
</a><a href="#h5-1-10" id="h5-1-10" class="d">-
</a><a href="#h5-1-11" id="h5-1-11" class="d">-	sel-&gt;tags[arg-&gt;i] = tags[arg-&gt;i];
</a><a href="#h5-1-12" id="h5-1-12" class="d">-	arrange(NULL);
</a><a href="#h5-1-13" id="h5-1-13" class="i">+	for(; c &amp;&amp; !c-&gt;tags[tsel]; c = c-&gt;next);
</a><a href="#h5-1-14" id="h5-1-14" class="i">+	return c;
</a> }
 
 void
<a href="#h5-2" id="h5-2" class="h">@@ -169,3 +134,46 @@ replacetag(Arg *arg)
</a> 	appendtag(arg);
 }
 
<a href="#h5-2-3" id="h5-2-3" class="i">+void
</a><a href="#h5-2-4" id="h5-2-4" class="i">+settags(Client *c)
</a><a href="#h5-2-5" id="h5-2-5" class="i">+{
</a><a href="#h5-2-6" id="h5-2-6" class="i">+	XClassHint ch;
</a><a href="#h5-2-7" id="h5-2-7" class="i">+	static unsigned int len = rule ? sizeof(rule) / sizeof(rule[0]) : 0;
</a><a href="#h5-2-8" id="h5-2-8" class="i">+	unsigned int i, j;
</a><a href="#h5-2-9" id="h5-2-9" class="i">+	Bool matched = False;
</a><a href="#h5-2-10" id="h5-2-10" class="i">+
</a><a href="#h5-2-11" id="h5-2-11" class="i">+	if(!len) {
</a><a href="#h5-2-12" id="h5-2-12" class="i">+		c-&gt;tags[tsel] = tags[tsel];
</a><a href="#h5-2-13" id="h5-2-13" class="i">+		return;
</a><a href="#h5-2-14" id="h5-2-14" class="i">+	}
</a><a href="#h5-2-15" id="h5-2-15" class="i">+
</a><a href="#h5-2-16" id="h5-2-16" class="i">+	if(XGetClassHint(dpy, c-&gt;win, &amp;ch)) {
</a><a href="#h5-2-17" id="h5-2-17" class="i">+		if(ch.res_class &amp;&amp; ch.res_name) {
</a><a href="#h5-2-18" id="h5-2-18" class="i">+			for(i = 0; i &lt; len; i++)
</a><a href="#h5-2-19" id="h5-2-19" class="i">+				if(!strncmp(rule[i].class, ch.res_class, sizeof(rule[i].class))
</a><a href="#h5-2-20" id="h5-2-20" class="i">+					&amp;&amp; !strncmp(rule[i].instance, ch.res_name, sizeof(rule[i].instance)))
</a><a href="#h5-2-21" id="h5-2-21" class="i">+				{
</a><a href="#h5-2-22" id="h5-2-22" class="i">+					for(j = 0; j &lt; TLast; j++)
</a><a href="#h5-2-23" id="h5-2-23" class="i">+						c-&gt;tags[j] = rule[i].tags[j];
</a><a href="#h5-2-24" id="h5-2-24" class="i">+					c-&gt;dofloat = rule[i].dofloat;
</a><a href="#h5-2-25" id="h5-2-25" class="i">+					matched = True;
</a><a href="#h5-2-26" id="h5-2-26" class="i">+					break;
</a><a href="#h5-2-27" id="h5-2-27" class="i">+				}
</a><a href="#h5-2-28" id="h5-2-28" class="i">+		}
</a><a href="#h5-2-29" id="h5-2-29" class="i">+		if(ch.res_class)
</a><a href="#h5-2-30" id="h5-2-30" class="i">+			XFree(ch.res_class);
</a><a href="#h5-2-31" id="h5-2-31" class="i">+		if(ch.res_name)
</a><a href="#h5-2-32" id="h5-2-32" class="i">+			XFree(ch.res_name);
</a><a href="#h5-2-33" id="h5-2-33" class="i">+	}
</a><a href="#h5-2-34" id="h5-2-34" class="i">+
</a><a href="#h5-2-35" id="h5-2-35" class="i">+	if(!matched)
</a><a href="#h5-2-36" id="h5-2-36" class="i">+		c-&gt;tags[tsel] = tags[tsel];
</a><a href="#h5-2-37" id="h5-2-37" class="i">+}
</a><a href="#h5-2-38" id="h5-2-38" class="i">+
</a><a href="#h5-2-39" id="h5-2-39" class="i">+void
</a><a href="#h5-2-40" id="h5-2-40" class="i">+view(Arg *arg)
</a><a href="#h5-2-41" id="h5-2-41" class="i">+{
</a><a href="#h5-2-42" id="h5-2-42" class="i">+	tsel = arg-&gt;i;
</a><a href="#h5-2-43" id="h5-2-43" class="i">+	arrange(NULL);
</a><a href="#h5-2-44" id="h5-2-44" class="i">+	drawall();
</a><a href="#h5-2-45" id="h5-2-45" class="i">+}
</a><b>diff --git a/<a id="h6" href="../file/util.c.html">util.c</a> b/<a href="../file/util.c.html">util.c</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -2,24 +2,15 @@
</a>  * (C)opyright MMVI Anselm R. Garbe &lt;garbeam at gmail dot com&gt;
  * See LICENSE file for license details.
  */
<a href="#h6-0-3" id="h6-0-3" class="i">+#include &quot;dwm.h&quot;
</a> 
 #include &lt;stdarg.h&gt;
 #include &lt;stdio.h&gt;
 #include &lt;stdlib.h&gt;
<a href="#h6-0-8" id="h6-0-8" class="d">-#include &lt;sys/types.h&gt;
</a> #include &lt;sys/wait.h&gt;
 #include &lt;unistd.h&gt;
 
<a href="#h6-0-12" id="h6-0-12" class="d">-#include &quot;dwm.h&quot;
</a><a href="#h6-0-13" id="h6-0-13" class="d">-
</a><a href="#h6-0-14" id="h6-0-14" class="d">-void
</a><a href="#h6-0-15" id="h6-0-15" class="d">-eprint(const char *errstr, ...) {
</a><a href="#h6-0-16" id="h6-0-16" class="d">-	va_list ap;
</a><a href="#h6-0-17" id="h6-0-17" class="d">-	va_start(ap, errstr);
</a><a href="#h6-0-18" id="h6-0-18" class="d">-	vfprintf(stderr, errstr, ap);
</a><a href="#h6-0-19" id="h6-0-19" class="d">-	va_end(ap);
</a><a href="#h6-0-20" id="h6-0-20" class="d">-	exit(1);
</a><a href="#h6-0-21" id="h6-0-21" class="d">-}
</a><a href="#h6-0-22" id="h6-0-22" class="i">+/* static functions */
</a> 
 static void
 bad_malloc(unsigned int size)
<a href="#h6-1" id="h6-1" class="h">@@ -29,6 +20,8 @@ bad_malloc(unsigned int size)
</a> 	exit(1);
 }
 
<a href="#h6-1-3" id="h6-1-3" class="i">+/* extern functions */
</a><a href="#h6-1-4" id="h6-1-4" class="i">+
</a> void *
 emallocz(unsigned int size)
 {
<a href="#h6-2" id="h6-2" class="h">@@ -39,6 +32,15 @@ emallocz(unsigned int size)
</a> }
 
 void
<a href="#h6-2-3" id="h6-2-3" class="i">+eprint(const char *errstr, ...) {
</a><a href="#h6-2-4" id="h6-2-4" class="i">+	va_list ap;
</a><a href="#h6-2-5" id="h6-2-5" class="i">+	va_start(ap, errstr);
</a><a href="#h6-2-6" id="h6-2-6" class="i">+	vfprintf(stderr, errstr, ap);
</a><a href="#h6-2-7" id="h6-2-7" class="i">+	va_end(ap);
</a><a href="#h6-2-8" id="h6-2-8" class="i">+	exit(1);
</a><a href="#h6-2-9" id="h6-2-9" class="i">+}
</a><a href="#h6-2-10" id="h6-2-10" class="i">+
</a><a href="#h6-2-11" id="h6-2-11" class="i">+void
</a> spawn(Arg *arg)
 {
 	char **argv = (char **)arg-&gt;argv;
</pre>
</div>
</body>
</html>
