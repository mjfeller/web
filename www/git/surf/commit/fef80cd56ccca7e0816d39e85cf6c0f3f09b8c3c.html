<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Un(g)boolify to separate GTK dependant code from the rest - surf - surf browser, a WebKit based browser
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="surf Atom Feed" href="../atom.xml" />
<link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="/logo.png" alt="" width="32" height="32" /></a></td><td><h1>surf</h1><span class="desc">surf browser, a WebKit based browser
</span></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/fef80cd56ccca7e0816d39e85cf6c0f3f09b8c3c.html">fef80cd56ccca7e0816d39e85cf6c0f3f09b8c3c</a>
<b>parent</b> <a href="../commit/6124176b896b528d57aeab7e0eaa46271bcb59c5.html">6124176b896b528d57aeab7e0eaa46271bcb59c5</a>
<b>Author:</b> Quentin Rameau &lt;<a href="mailto:quinq@fifth.space">quinq@fifth.space</a>&gt;
<b>Date:</b>   Sun, 22 Nov 2015 02:03:26 +0100

Un(g)boolify to separate GTK dependant code from the rest

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">config.def.h</a></td><td> | </td><td class="num">40</td><td><span class="i">++++++++++++++++++++</span><span class="d">--------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">surf.c</a></td><td> | </td><td class="num">16</td><td><span class="i">+++++++</span><span class="d">---------</span></td></tr>
</table></pre><pre>2 files changed, 27 insertions(+), 29 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/config.def.h.html">config.def.h</a> b/<a href="../file/config.def.h.html">config.def.h</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -5,9 +5,9 @@ static char *scriptfile     = &quot;~/.surf/script.js&quot;;
</a> static char *styledir       = &quot;~/.surf/styles/&quot;;
 static char *cachedir       = &quot;~/.surf/cache/&quot;;
 
<a href="#h0-0-3" id="h0-0-3" class="d">-static Bool kioskmode       = FALSE; /* Ignore shortcuts */
</a><a href="#h0-0-4" id="h0-0-4" class="d">-static Bool showindicators  = TRUE;  /* Show indicators in window title */
</a><a href="#h0-0-5" id="h0-0-5" class="d">-static Bool runinfullscreen = FALSE; /* Run in fullscreen mode by default */
</a><a href="#h0-0-6" id="h0-0-6" class="i">+static int kioskmode       = 0;     /* Ignore shortcuts */
</a><a href="#h0-0-7" id="h0-0-7" class="i">+static int showindicators  = 1;     /* Show indicators in window title */
</a><a href="#h0-0-8" id="h0-0-8" class="i">+static int runinfullscreen = 0;     /* Run in fullscreen mode by default */
</a> 
 static guint defaultfontsize = 12;   /* Default font size */
 static gfloat zoomlevel     = 1.0;   /* Default zoom level */
<a href="#h0-1" id="h0-1" class="h">@@ -16,21 +16,21 @@ static gfloat zoomlevel     = 1.0;   /* Default zoom level */
</a> static char *cookiefile     = &quot;~/.surf/cookies.txt&quot;;
 static char *cookiepolicies = &quot;Aa@&quot;; /* A: accept all; a: accept nothing,
                                       * @: accept no third party */
<a href="#h0-1-3" id="h0-1-3" class="d">-static Bool strictssl       = FALSE; /* Refuse untrusted SSL connections */
</a><a href="#h0-1-4" id="h0-1-4" class="i">+static int strictssl       = 0; /* Refuse untrusted SSL connections */
</a> 
 /* Webkit default features */
<a href="#h0-1-7" id="h0-1-7" class="d">-static Bool enablescrollbars      = TRUE;
</a><a href="#h0-1-8" id="h0-1-8" class="d">-static Bool enablecaretbrowsing   = TRUE;
</a><a href="#h0-1-9" id="h0-1-9" class="d">-static Bool enablecache           = TRUE;
</a><a href="#h0-1-10" id="h0-1-10" class="d">-static Bool enableplugins         = TRUE;
</a><a href="#h0-1-11" id="h0-1-11" class="d">-static Bool enablescripts         = TRUE;
</a><a href="#h0-1-12" id="h0-1-12" class="d">-static Bool enableinspector       = TRUE;
</a><a href="#h0-1-13" id="h0-1-13" class="d">-static Bool enablestyle           = TRUE;
</a><a href="#h0-1-14" id="h0-1-14" class="d">-static Bool loadimages            = TRUE;
</a><a href="#h0-1-15" id="h0-1-15" class="d">-static Bool hidebackground        = FALSE;
</a><a href="#h0-1-16" id="h0-1-16" class="d">-static Bool allowgeolocation      = TRUE;
</a><a href="#h0-1-17" id="h0-1-17" class="d">-static Bool enablednsprefetching  = FALSE;
</a><a href="#h0-1-18" id="h0-1-18" class="d">-static Bool enableframeflattening = FALSE;
</a><a href="#h0-1-19" id="h0-1-19" class="i">+static int enablescrollbars      = 1;
</a><a href="#h0-1-20" id="h0-1-20" class="i">+static int enablecaretbrowsing   = 1;
</a><a href="#h0-1-21" id="h0-1-21" class="i">+static int enablecache           = 1;
</a><a href="#h0-1-22" id="h0-1-22" class="i">+static int enableplugins         = 1;
</a><a href="#h0-1-23" id="h0-1-23" class="i">+static int enablescripts         = 1;
</a><a href="#h0-1-24" id="h0-1-24" class="i">+static int enableinspector       = 1;
</a><a href="#h0-1-25" id="h0-1-25" class="i">+static int enablestyle           = 1;
</a><a href="#h0-1-26" id="h0-1-26" class="i">+static int loadimages            = 1;
</a><a href="#h0-1-27" id="h0-1-27" class="i">+static int hidebackground        = 0;
</a><a href="#h0-1-28" id="h0-1-28" class="i">+static int allowgeolocation      = 1;
</a><a href="#h0-1-29" id="h0-1-29" class="i">+static int enablednsprefetching  = 0;
</a><a href="#h0-1-30" id="h0-1-30" class="i">+static int enableframeflattening = 0;
</a> 
 static WebKitFindOptions findopts = WEBKIT_FIND_OPTIONS_CASE_INSENSITIVE |
                                     WEBKIT_FIND_OPTIONS_WRAP_AROUND;
<a href="#h0-2" id="h0-2" class="h">@@ -98,8 +98,8 @@ static Key keys[] = {
</a> 	{ 0,                     GDK_KEY_Escape, stop,       { 0 } },
 	{ MODKEY,                GDK_KEY_c,      stop,       { 0 } },
 
<a href="#h0-2-3" id="h0-2-3" class="d">-	{ MODKEY|GDK_SHIFT_MASK, GDK_KEY_r,      reload,     { .b = TRUE } },
</a><a href="#h0-2-4" id="h0-2-4" class="d">-	{ MODKEY,                GDK_KEY_r,      reload,     { .b = FALSE } },
</a><a href="#h0-2-5" id="h0-2-5" class="i">+	{ MODKEY|GDK_SHIFT_MASK, GDK_KEY_r,      reload,     { .b = 1 } },
</a><a href="#h0-2-6" id="h0-2-6" class="i">+	{ MODKEY,                GDK_KEY_r,      reload,     { .b = 0 } },
</a> 
 	{ MODKEY,                GDK_KEY_l,      navigate,   { .i = +1 } },
 	{ MODKEY,                GDK_KEY_h,      navigate,   { .i = -1 } },
<a href="#h0-3" id="h0-3" class="h">@@ -118,8 +118,8 @@ static Key keys[] = {
</a> 	{ MODKEY,                GDK_KEY_minus,  zoom,       { .i = -1 } },
 	{ MODKEY,                GDK_KEY_plus,   zoom,       { .i = +1 } },
 
<a href="#h0-3-3" id="h0-3-3" class="d">-	{ MODKEY,                GDK_KEY_p,      clipboard,  { .b = TRUE } },
</a><a href="#h0-3-4" id="h0-3-4" class="d">-	{ MODKEY,                GDK_KEY_y,      clipboard,  { .b = FALSE } },
</a><a href="#h0-3-5" id="h0-3-5" class="i">+	{ MODKEY,                GDK_KEY_p,      clipboard,  { .b = 1 } },
</a><a href="#h0-3-6" id="h0-3-6" class="i">+	{ MODKEY,                GDK_KEY_y,      clipboard,  { .b = 0 } },
</a> 
 	{ MODKEY,                GDK_KEY_n,      find,       { .i = +1 } },
 	{ MODKEY|GDK_SHIFT_MASK, GDK_KEY_n,      find,       { .i = -1 } },
<b>diff --git a/<a id="h1" href="../file/surf.c.html">surf.c</a> b/<a href="../file/surf.c.html">surf.c</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -56,8 +56,8 @@ enum {
</a> };
 
 typedef union {
<a href="#h1-0-3" id="h1-0-3" class="d">-	gboolean b;
</a><a href="#h1-0-4" id="h1-0-4" class="d">-	gint i;
</a><a href="#h1-0-5" id="h1-0-5" class="i">+	int b;
</a><a href="#h1-0-6" id="h1-0-6" class="i">+	int i;
</a> 	const void *v;
 } Arg;
 
<a href="#h1-1" id="h1-1" class="h">@@ -69,8 +69,7 @@ typedef struct Client {
</a> 	WebKitHitTestResult *mousepos;
 	GTlsCertificateFlags tlsflags;
 	Window xid;
<a href="#h1-1-3" id="h1-1-3" class="d">-	gint progress;
</a><a href="#h1-1-4" id="h1-1-4" class="d">-	gboolean fullscreen;
</a><a href="#h1-1-5" id="h1-1-5" class="i">+	int progress, fullscreen;
</a> 	const char *title, *targeturi;
 	const char *needle;
 	struct Client *next;
<a href="#h1-2" id="h1-2" class="h">@@ -122,7 +121,7 @@ static void runscript(Client *c);
</a> static void evalscript(Client *c, const char *jsstr, ...);
 static void updatewinid(Client *c);
 static void handleplumb(Client *c, const char *uri);
<a href="#h1-2-3" id="h1-2-3" class="d">-static void newwindow(Client *c, const Arg *a, gboolean noembed);
</a><a href="#h1-2-4" id="h1-2-4" class="i">+static void newwindow(Client *c, const Arg *a, int noembed);
</a> static void spawn(Client *c, const Arg *a);
 static void destroyclient(Client *c);
 static void cleanup(void);
<a href="#h1-3" id="h1-3" class="h">@@ -185,7 +184,7 @@ static char togglestats[10];
</a> static char pagestats[2];
 static Atom atoms[AtomLast];
 static Window embed;
<a href="#h1-3-3" id="h1-3-3" class="d">-static gboolean showxid = FALSE;
</a><a href="#h1-3-4" id="h1-3-4" class="i">+static int showxid;
</a> static int cookiepolicy;
 static Display *dpy;
 static Client *clients;
<a href="#h1-4" id="h1-4" class="h">@@ -1235,8 +1234,7 @@ pasteuri(GtkClipboard *clipboard, const char *text, gpointer d)
</a> void
 reload(Client *c, const Arg *a)
 {
<a href="#h1-4-3" id="h1-4-3" class="d">-	gboolean nocache = *(gboolean *)a;
</a><a href="#h1-4-4" id="h1-4-4" class="d">-	if (nocache)
</a><a href="#h1-4-5" id="h1-4-5" class="i">+	if (a-&gt;b)
</a> 		webkit_web_view_reload_bypass_cache(c-&gt;view);
 	else
 		webkit_web_view_reload(c-&gt;view);
<a href="#h1-5" id="h1-5" class="h">@@ -1542,7 +1540,7 @@ main(int argc, char *argv[])
</a> 		die(&quot;surf-&quot;VERSION&quot;, Â©2009-2015 surf engineers, &quot;
 		    &quot;see LICENSE for details\n&quot;);
 	case &#39;x&#39;:
<a href="#h1-5-3" id="h1-5-3" class="d">-		showxid = TRUE;
</a><a href="#h1-5-4" id="h1-5-4" class="i">+		showxid = 1;
</a> 		break;
 	case &#39;z&#39;:
 		zoomlevel = strtof(EARGF(usage()), NULL);
</pre>
</div>
</body>
</html>
