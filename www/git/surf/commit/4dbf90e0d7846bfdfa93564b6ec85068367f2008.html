<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>using gint instead of int (insane API, but ok.) - surf - surf browser, a WebKit based browser
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="surf Atom Feed" href="../atom.xml" />
<link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="/logo.png" alt="" width="32" height="32" /></a></td><td><h1>surf</h1><span class="desc">surf browser, a WebKit based browser
</span></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/4dbf90e0d7846bfdfa93564b6ec85068367f2008.html">4dbf90e0d7846bfdfa93564b6ec85068367f2008</a>
<b>parent</b> <a href="../commit/4cbfddf15907c96b55ac3381c9a402260a96ce9f.html">4cbfddf15907c96b55ac3381c9a402260a96ce9f</a>
<b>Author:</b> Enno Boland (tox) &lt;<a href="mailto:tox@s01.de">tox@s01.de</a>&gt;
<b>Date:</b>   Mon,  7 Sep 2009 15:10:25 +0200

using gint instead of int (insane API, but ok.)
<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">surf.c</a></td><td> | </td><td class="num">31</td><td><span class="i">++++++++++++</span><span class="d">-------------------</span></td></tr>
</table></pre><pre>1 file changed, 12 insertions(+), 19 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/surf.c.html">surf.c</a> b/<a href="../file/surf.c.html">surf.c</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -23,8 +23,7 @@ Atom urlprop;
</a> typedef union Arg Arg;
 union Arg {
 	const gboolean b;
<a href="#h0-0-3" id="h0-0-3" class="d">-	const int i;
</a><a href="#h0-0-4" id="h0-0-4" class="d">-	const unsigned int ui;
</a><a href="#h0-0-5" id="h0-0-5" class="i">+	const gint i;
</a> 	const void *v;
 } ;
 
<a href="#h0-1" id="h0-1" class="h">@@ -68,7 +67,7 @@ gboolean embed = FALSE;
</a> gboolean showxid = FALSE;
 gboolean ignore_once = FALSE;
 extern char *optarg;
<a href="#h0-1-3" id="h0-1-3" class="d">-extern int optind;
</a><a href="#h0-1-4" id="h0-1-4" class="i">+extern gint optind;
</a> 
 static void cleanup(void);
 static void proccookies(SoupMessage *m, Client *c);
<a href="#h0-2" id="h0-2" class="h">@@ -177,30 +176,24 @@ die(char *str) {
</a> 
 void
 drawindicator(Client *c) {
<a href="#h0-2-3" id="h0-2-3" class="d">-	GtkWidget *w;
</a> 	gint width;
<a href="#h0-2-5" id="h0-2-5" class="d">-	GdkGC *gc;
</a> 	gchar *uri;
<a href="#h0-2-7" id="h0-2-7" class="i">+	GtkWidget *w;
</a><a href="#h0-2-8" id="h0-2-8" class="i">+	GdkGC *gc;
</a> 	GdkColor fg;
 
<a href="#h0-2-11" id="h0-2-11" class="d">-
</a> 	uri = geturi(c);
 	w = c-&gt;indicator;
 	width = c-&gt;progress * w-&gt;allocation.width / 100;
<a href="#h0-2-15" id="h0-2-15" class="d">-
</a> 	gc = gdk_gc_new(w-&gt;window);
<a href="#h0-2-17" id="h0-2-17" class="d">-
</a> 	gdk_color_parse(strstr(uri, &quot;https://&quot;) == uri ?
 			progress_trust : progress, &amp;fg);
 	gdk_gc_set_rgb_fg_color(gc, &amp;fg);
 	gdk_draw_rectangle(w-&gt;window,
 			w-&gt;style-&gt;bg_gc[GTK_WIDGET_STATE(w)],
<a href="#h0-2-23" id="h0-2-23" class="d">-			TRUE,
</a><a href="#h0-2-24" id="h0-2-24" class="d">-			0, 0, w-&gt;allocation.width, w-&gt;allocation.height);
</a><a href="#h0-2-25" id="h0-2-25" class="d">-	gdk_draw_rectangle(w-&gt;window,
</a><a href="#h0-2-26" id="h0-2-26" class="d">-			gc,
</a><a href="#h0-2-27" id="h0-2-27" class="d">-			TRUE,
</a><a href="#h0-2-28" id="h0-2-28" class="d">-			0, 0, width, w-&gt;allocation.height);
</a><a href="#h0-2-29" id="h0-2-29" class="i">+			TRUE, 0, 0, w-&gt;allocation.width, w-&gt;allocation.height);
</a><a href="#h0-2-30" id="h0-2-30" class="i">+	gdk_draw_rectangle(w-&gt;window, gc, TRUE, 0, 0, width,
</a><a href="#h0-2-31" id="h0-2-31" class="i">+			w-&gt;allocation.height);
</a> 	g_object_unref(gc);/*g_free(gc);*/
 }
 
<a href="#h0-3" id="h0-3" class="h">@@ -216,7 +209,7 @@ download(WebKitDownload *o, GParamSpec *pspec, Client *c) {
</a> 
 	status = webkit_download_get_status(c-&gt;download);
 	if(status == WEBKIT_DOWNLOAD_STATUS_STARTED || status == WEBKIT_DOWNLOAD_STATUS_CREATED) {
<a href="#h0-3-3" id="h0-3-3" class="d">-		c-&gt;progress = (int)(webkit_download_get_progress(c-&gt;download)*100);
</a><a href="#h0-3-4" id="h0-3-4" class="i">+		c-&gt;progress = (gint)(webkit_download_get_progress(c-&gt;download)*100);
</a> 	}
 	update(c, NULL);
 }
<a href="#h0-4" id="h0-4" class="h">@@ -270,7 +263,7 @@ hideurl(Client *c, const Arg *arg) {
</a> 
 gboolean
 keypress(GtkWidget* w, GdkEventKey *ev, Client *c) {
<a href="#h0-4-3" id="h0-4-3" class="d">-	unsigned int i, focus;
</a><a href="#h0-4-4" id="h0-4-4" class="i">+	guint i, focus;
</a> 	gboolean processed = FALSE;
 
 	if(ev-&gt;type != GDK_KEY_PRESS)
<a href="#h0-5" id="h0-5" class="h">@@ -450,7 +443,7 @@ newclient(void) {
</a> 	c-&gt;next = clients;
 	clients = c;
 	if(showxid)
<a href="#h0-5-3" id="h0-5-3" class="d">-		printf(&quot;%u\n&quot;, (unsigned int)GDK_WINDOW_XID(GTK_WIDGET(c-&gt;win)-&gt;window));
</a><a href="#h0-5-4" id="h0-5-4" class="i">+		printf(&quot;%u\n&quot;, (guint)GDK_WINDOW_XID(GTK_WIDGET(c-&gt;win)-&gt;window));
</a> 	return c;
 }
 
<a href="#h0-6" id="h0-6" class="h">@@ -473,7 +466,7 @@ processx(GdkXEvent *e, GdkEvent *event, gpointer d) {
</a> 	Client *c = (Client *)d;
 	XPropertyEvent *ev;
 	Atom adummy;
<a href="#h0-6-3" id="h0-6-3" class="d">-	int idummy;
</a><a href="#h0-6-4" id="h0-6-4" class="i">+	gint idummy;
</a> 	unsigned long ldummy;
 	unsigned char *buf = NULL;
 	Arg arg;
<a href="#h0-7" id="h0-7" class="h">@@ -622,7 +615,7 @@ zoom(Client *c, const Arg *arg) {
</a> int main(int argc, char *argv[]) {
 	SoupSession *s;
 	Client *c;
<a href="#h0-7-3" id="h0-7-3" class="d">-	int o;
</a><a href="#h0-7-4" id="h0-7-4" class="i">+	gint o;
</a> 	const gchar *home, *filename;
 	Arg arg;
 
</pre>
</div>
</body>
</html>
