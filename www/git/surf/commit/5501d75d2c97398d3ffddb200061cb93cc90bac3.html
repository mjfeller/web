<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Fix some styling in the config.def.h, fix the DOWNLOAD macro and unify the variable naming a bit. - surf - surf browser, a WebKit based browser
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="surf Atom Feed" href="../atom.xml" />
<link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="/logo.png" alt="" width="32" height="32" /></a></td><td><h1>surf</h1><span class="desc">surf browser, a WebKit based browser
</span></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/5501d75d2c97398d3ffddb200061cb93cc90bac3.html">5501d75d2c97398d3ffddb200061cb93cc90bac3</a>
<b>parent</b> <a href="../commit/a7ea753f93837ee5eed1e2c80b6642d08e6143e0.html">a7ea753f93837ee5eed1e2c80b6642d08e6143e0</a>
<b>Author:</b> Christoph Lohmann &lt;<a href="mailto:20h@r-36.net">20h@r-36.net</a>&gt;
<b>Date:</b>   Tue, 20 Nov 2012 16:02:57 +0100

Fix some styling in the config.def.h, fix the DOWNLOAD macro and unify the
variable naming a bit.
<b>Diffstat:</b>
<table><tr><td class="A">A</td><td><a href="#h0">TODO.md</a></td><td> | </td><td class="num">8</td><td><span class="i">++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">config.def.h</a></td><td> | </td><td class="num">26</td><td><span class="i">++++++++++++++++</span><span class="d">----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">surf.c</a></td><td> | </td><td class="num">48</td><td><span class="i">+++++++++++++++++++++++++++</span><span class="d">---------------------</span></td></tr>
</table></pre><pre>3 files changed, 51 insertions(+), 31 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/TODO.md.html">TODO.md</a> b/<a href="../file/TODO.md.html">TODO.md</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -0,0 +1,8 @@
</a><a href="#h0-0-0" id="h0-0-0" class="i">+# TODO
</a><a href="#h0-0-1" id="h0-0-1" class="i">+
</a><a href="#h0-0-2" id="h0-0-2" class="i">+* suckless adblocking
</a><a href="#h0-0-3" id="h0-0-3" class="i">+* integrate the WebKitWebInspector API
</a><a href="#h0-0-4" id="h0-0-4" class="i">+* make scrollbars a switch and allow them to be disabled
</a><a href="#h0-0-5" id="h0-0-5" class="i">+* implement fullscreen mode (F11)
</a><a href="#h0-0-6" id="h0-0-6" class="i">+* replace webkit with something sane
</a><a href="#h0-0-7" id="h0-0-7" class="i">+
</a><b>diff --git a/<a id="h1" href="../file/config.def.h.html">config.def.h</a> b/<a href="../file/config.def.h.html">config.def.h</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -20,18 +20,23 @@ static int   indicator_thickness = 2;
</a> static Bool spatialbrowsing = TRUE;
 static Bool hidebackground  = FALSE;
 
<a href="#h1-0-3" id="h1-0-3" class="d">-#define SETPROP(p, q) { .v = (char *[]){ &quot;/bin/sh&quot;, &quot;-c&quot;, \
</a><a href="#h1-0-4" id="h1-0-4" class="d">-	&quot;prop=\&quot;`xprop -id $2 $0 | cut -d &#39;\&quot;&#39; -f 2 | dmenu`\&quot; &amp;&amp;&quot; \
</a><a href="#h1-0-5" id="h1-0-5" class="d">-	&quot;xprop -id $2 -f $1 8s -set $1 \&quot;$prop\&quot;&quot;, \
</a><a href="#h1-0-6" id="h1-0-6" class="d">-	p, q, winid, NULL } }
</a><a href="#h1-0-7" id="h1-0-7" class="i">+#define SETPROP(p, q) { \
</a><a href="#h1-0-8" id="h1-0-8" class="i">+	.v = (char *[]){ &quot;/bin/sh&quot;, &quot;-c&quot;, \
</a><a href="#h1-0-9" id="h1-0-9" class="i">+		&quot;prop=\&quot;`xprop -id $2 $0 | cut -d &#39;\&quot;&#39; -f 2 | dmenu`\&quot; &amp;&amp;&quot; \
</a><a href="#h1-0-10" id="h1-0-10" class="i">+		&quot;xprop -id $2 -f $1 8s -set $1 \&quot;$prop\&quot;&quot;, \
</a><a href="#h1-0-11" id="h1-0-11" class="i">+		p, q, winid, NULL \
</a><a href="#h1-0-12" id="h1-0-12" class="i">+	} \
</a><a href="#h1-0-13" id="h1-0-13" class="i">+}
</a> 
 /* DOWNLOAD(URI, referer) */
 #define DOWNLOAD(d, r) { \
 	.v = (char *[]){ &quot;/bin/sh&quot;, &quot;-c&quot;, \
<a href="#h1-0-18" id="h1-0-18" class="d">-	&quot;xterm -e \&quot;wget &#39;$0&#39; \
</a><a href="#h1-0-19" id="h1-0-19" class="d">---load-cookies ~/.surf/cookies.txt \
</a><a href="#h1-0-20" id="h1-0-20" class="d">---user-agent &#39;$1&#39; \
</a><a href="#h1-0-21" id="h1-0-21" class="d">---referer &#39;$2&#39; ; sleep 5\&quot;&quot;, d, useragent, NULL } }
</a><a href="#h1-0-22" id="h1-0-22" class="i">+		&quot;xterm -e \&quot;wget &#39;$0&#39;&quot; \
</a><a href="#h1-0-23" id="h1-0-23" class="i">+		&quot; --load-cookies ~/.surf/cookies.txt&quot; \
</a><a href="#h1-0-24" id="h1-0-24" class="i">+		&quot; --user-agent &#39;$1&#39;&quot; \
</a><a href="#h1-0-25" id="h1-0-25" class="i">+		&quot; --referer &#39;$2&#39; ; sleep 5\&quot;&quot;, d, useragent, r, NULL \
</a><a href="#h1-0-26" id="h1-0-26" class="i">+	} \
</a><a href="#h1-0-27" id="h1-0-27" class="i">+}
</a> 
 #define MODKEY GDK_CONTROL_MASK
 
<a href="#h1-1" id="h1-1" class="h">@@ -61,9 +66,10 @@ static Key keys[] = {
</a>     { MODKEY,               GDK_slash,  spawn,      SETPROP(&quot;_SURF_FIND&quot;, &quot;_SURF_FIND&quot;) },
     { MODKEY,               GDK_n,      find,       { .b = TRUE } },
     { MODKEY|GDK_SHIFT_MASK,GDK_n,      find,       { .b = FALSE } },
<a href="#h1-1-3" id="h1-1-3" class="d">-    { MODKEY,               GDK_v,      toggle,     { .v = &quot;enable-plugins&quot; } },
</a><a href="#h1-1-4" id="h1-1-4" class="i">+
</a><a href="#h1-1-5" id="h1-1-5" class="i">+    { MODKEY|GDK_SHIFT_MASK,GDK_c,      toggle,     { .v = &quot;enable-caret-browsing&quot; } },
</a>     { MODKEY|GDK_SHIFT_MASK,GDK_i,      toggle,     { .v = &quot;auto-load-images&quot; } },
<a href="#h1-1-7" id="h1-1-7" class="d">-    { MODKEY,               GDK_c,      toggle,     { .v = &quot;enable-caret-browsing&quot; } },
</a>     { MODKEY|GDK_SHIFT_MASK,GDK_s,      toggle,     { .v = &quot;enable-scripts&quot; } },
<a href="#h1-1-9" id="h1-1-9" class="i">+    { MODKEY|GDK_SHIFT_MASK,GDK_v,      toggle,     { .v = &quot;enable-plugins&quot; } },
</a> };
 
<b>diff --git a/<a id="h2" href="../file/surf.c.html">surf.c</a> b/<a href="../file/surf.c.html">surf.c</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -78,7 +78,8 @@ static Client *clients = NULL;
</a> static GdkNativeWindow embed = 0;
 static gboolean showxid = FALSE;
 static char winid[64];
<a href="#h2-0-3" id="h2-0-3" class="d">-static gboolean loadimage = 1, plugin = 1, script = 1, using_proxy = 0;
</a><a href="#h2-0-4" id="h2-0-4" class="i">+static gboolean loadimages = 1, enableplugins = 1, enablescripts = 1,
</a><a href="#h2-0-5" id="h2-0-5" class="i">+		usingproxy = 0;
</a> static char togglestat[5];
 
 static char *buildpath(const char *path);
<a href="#h2-1" id="h2-1" class="h">@@ -359,13 +360,13 @@ drawindicator(Client *c) {
</a> 	width = c-&gt;progress * w-&gt;allocation.width / 100;
 	gc = gdk_gc_new(w-&gt;window);
 	if(strstr(uri, &quot;https://&quot;) == uri) {
<a href="#h2-1-3" id="h2-1-3" class="d">-		if(using_proxy) {
</a><a href="#h2-1-4" id="h2-1-4" class="i">+		if(usingproxy) {
</a> 			colorname = c-&gt;sslfailed? progress_proxy_untrust : progress_proxy_trust;
 		} else {
 			colorname = c-&gt;sslfailed? progress_untrust : progress_trust;
 		}
 	} else {
<a href="#h2-1-10" id="h2-1-10" class="d">-		if(using_proxy) {
</a><a href="#h2-1-11" id="h2-1-11" class="i">+		if(usingproxy) {
</a> 			colorname = progress_proxy;
 		} else {
 			colorname = progress;
<a href="#h2-2" id="h2-2" class="h">@@ -612,10 +613,11 @@ newclient(void) {
</a> 	g_object_set(G_OBJECT(settings), &quot;user-agent&quot;, ua, NULL);
 	uri = g_strconcat(&quot;file://&quot;, stylefile, NULL);
 	g_object_set(G_OBJECT(settings), &quot;user-stylesheet-uri&quot;, uri, NULL);
<a href="#h2-2-3" id="h2-2-3" class="d">-	g_object_set(G_OBJECT(settings), &quot;auto-load-images&quot;, loadimage, NULL);
</a><a href="#h2-2-4" id="h2-2-4" class="d">-	g_object_set(G_OBJECT(settings), &quot;enable-plugins&quot;, plugin, NULL);
</a><a href="#h2-2-5" id="h2-2-5" class="d">-	g_object_set(G_OBJECT(settings), &quot;enable-scripts&quot;, script, NULL);
</a><a href="#h2-2-6" id="h2-2-6" class="d">-	g_object_set(G_OBJECT(settings), &quot;enable-spatial-navigation&quot;, spatialbrowsing, NULL);
</a><a href="#h2-2-7" id="h2-2-7" class="i">+	g_object_set(G_OBJECT(settings), &quot;auto-load-images&quot;, loadimages, NULL);
</a><a href="#h2-2-8" id="h2-2-8" class="i">+	g_object_set(G_OBJECT(settings), &quot;enable-plugins&quot;, enableplugins, NULL);
</a><a href="#h2-2-9" id="h2-2-9" class="i">+	g_object_set(G_OBJECT(settings), &quot;enable-scripts&quot;, enablescripts, NULL);
</a><a href="#h2-2-10" id="h2-2-10" class="i">+	g_object_set(G_OBJECT(settings), &quot;enable-spatial-navigation&quot;,
</a><a href="#h2-2-11" id="h2-2-11" class="i">+			spatialbrowsing, NULL);
</a> 
 	g_free(uri);
 
<a href="#h2-3" id="h2-3" class="h">@@ -651,11 +653,11 @@ newwindow(Client *c, const Arg *arg, gboolean noembed) {
</a> 		snprintf(tmp, LENGTH(tmp), &quot;%u\n&quot;, (int)embed);
 		cmd[i++] = tmp;
 	}
<a href="#h2-3-3" id="h2-3-3" class="d">-	if(!script)
</a><a href="#h2-3-4" id="h2-3-4" class="i">+	if(!enablescripts)
</a> 		cmd[i++] = &quot;-s&quot;;
<a href="#h2-3-6" id="h2-3-6" class="d">-	if(!plugin)
</a><a href="#h2-3-7" id="h2-3-7" class="i">+	if(!enableplugins)
</a> 		cmd[i++] = &quot;-p&quot;;
<a href="#h2-3-9" id="h2-3-9" class="d">-	if(!loadimage)
</a><a href="#h2-3-10" id="h2-3-10" class="i">+	if(!loadimages)
</a> 		cmd[i++] = &quot;-i&quot;;
 	if(showxid)
 		cmd[i++] = &quot;-x&quot;;
<a href="#h2-4" id="h2-4" class="h">@@ -843,7 +845,7 @@ setup(void) {
</a> 		g_object_set(G_OBJECT(s), &quot;proxy-uri&quot;, puri, NULL);
 		soup_uri_free(puri);
 		g_free(new_proxy);
<a href="#h2-4-3" id="h2-4-3" class="d">-		using_proxy = 1;
</a><a href="#h2-4-4" id="h2-4-4" class="i">+		usingproxy = 1;
</a> 	}
 }
 
<a href="#h2-5" id="h2-5" class="h">@@ -914,16 +916,20 @@ gettogglestat(Client *c){
</a> 	gboolean value;
 	WebKitWebSettings *settings = webkit_web_view_get_settings(c-&gt;view);
 
<a href="#h2-5-3" id="h2-5-3" class="d">-	togglestat[4] = &#39;\0&#39;;
</a><a href="#h2-5-4" id="h2-5-4" class="i">+	g_object_get(G_OBJECT(settings), &quot;enable-caret-browsing&quot;,
</a><a href="#h2-5-5" id="h2-5-5" class="i">+			&amp;value, NULL);
</a><a href="#h2-5-6" id="h2-5-6" class="i">+	togglestat[0] = value? &#39;C&#39;: &#39;c&#39;;
</a><a href="#h2-5-7" id="h2-5-7" class="i">+
</a> 	g_object_get(G_OBJECT(settings), &quot;auto-load-images&quot;, &amp;value, NULL);
<a href="#h2-5-9" id="h2-5-9" class="d">-	togglestat[0] = value?&#39;I&#39;:&#39;i&#39;;
</a><a href="#h2-5-10" id="h2-5-10" class="i">+	togglestat[1] = value? &#39;I&#39;: &#39;i&#39;;
</a><a href="#h2-5-11" id="h2-5-11" class="i">+
</a> 	g_object_get(G_OBJECT(settings), &quot;enable-scripts&quot;, &amp;value, NULL);
<a href="#h2-5-13" id="h2-5-13" class="d">-	togglestat[1] = value?&#39;S&#39;:&#39;s&#39;;
</a><a href="#h2-5-14" id="h2-5-14" class="i">+	togglestat[2] = value? &#39;S&#39;: &#39;s&#39;;
</a><a href="#h2-5-15" id="h2-5-15" class="i">+
</a> 	g_object_get(G_OBJECT(settings), &quot;enable-plugins&quot;, &amp;value, NULL);
<a href="#h2-5-17" id="h2-5-17" class="d">-	togglestat[2] = value?&#39;V&#39;:&#39;v&#39;;
</a><a href="#h2-5-18" id="h2-5-18" class="d">-	g_object_get(G_OBJECT(settings), &quot;enable-caret-browsing&quot;,
</a><a href="#h2-5-19" id="h2-5-19" class="d">-			&amp;value, NULL);
</a><a href="#h2-5-20" id="h2-5-20" class="d">-	togglestat[3] = value?&#39;C&#39;:&#39;c&#39;;
</a><a href="#h2-5-21" id="h2-5-21" class="i">+	togglestat[3] = value? &#39;V&#39;: &#39;v&#39;;
</a><a href="#h2-5-22" id="h2-5-22" class="i">+
</a><a href="#h2-5-23" id="h2-5-23" class="i">+	togglestat[4] = &#39;\0&#39;;
</a> }
 
 
<a href="#h2-6" id="h2-6" class="h">@@ -995,16 +1001,16 @@ main(int argc, char *argv[]) {
</a> 		embed = strtol(EARGF(usage()), NULL, 0);
 		break;
 	case &#39;i&#39;:
<a href="#h2-6-3" id="h2-6-3" class="d">-		loadimage = 0;
</a><a href="#h2-6-4" id="h2-6-4" class="i">+		loadimages = 0;
</a> 		break;
 	case &#39;p&#39;:
<a href="#h2-6-7" id="h2-6-7" class="d">-		plugin = 0;
</a><a href="#h2-6-8" id="h2-6-8" class="i">+		enableplugins = 0;
</a> 		break;
 	case &#39;r&#39;:
 		scriptfile = EARGF(usage());
 		break;
 	case &#39;s&#39;:
<a href="#h2-6-14" id="h2-6-14" class="d">-		script = 0;
</a><a href="#h2-6-15" id="h2-6-15" class="i">+		enablescripts = 0;
</a> 		break;
 	case &#39;t&#39;:
 		stylefile = EARGF(usage());
</pre>
</div>
</body>
</html>
