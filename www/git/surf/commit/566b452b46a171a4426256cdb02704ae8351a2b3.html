<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Port surf to gtk3 - surf - surf browser, a WebKit based browser
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="surf Atom Feed" href="../atom.xml" />
<link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="/logo.png" alt="" width="32" height="32" /></a></td><td><h1>surf</h1><span class="desc">surf browser, a WebKit based browser
</span></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/566b452b46a171a4426256cdb02704ae8351a2b3.html">566b452b46a171a4426256cdb02704ae8351a2b3</a>
<b>parent</b> <a href="../commit/9b1e1873b0929ff397abf5ba523390c9f01f807f.html">9b1e1873b0929ff397abf5ba523390c9f01f807f</a>
<b>Author:</b> Quentin Rameau &lt;<a href="mailto:quinq@fifth.space">quinq@fifth.space</a>&gt;
<b>Date:</b>   Mon, 11 May 2015 12:48:40 +0200

Port surf to gtk3

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">config.def.h</a></td><td> | </td><td class="num">88</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">config.mk</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">surf.c</a></td><td> | </td><td class="num">47</td><td><span class="i">++++++++++++++++++++++++</span><span class="d">-----------------------</span></td></tr>
</table></pre><pre>3 files changed, 70 insertions(+), 69 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/config.def.h.html">config.def.h</a> b/<a href="../file/config.def.h.html">config.def.h</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -83,50 +83,50 @@ static SiteStyle styles[] = {
</a>  * edit the CLEANMASK() macro.
  */
 static Key keys[] = {
<a href="#h0-0-3" id="h0-0-3" class="d">-	/* modifier             keyval      function    arg             Focus */
</a><a href="#h0-0-4" id="h0-0-4" class="d">-	{ MODKEY|GDK_SHIFT_MASK,GDK_r,      reload,     { .b = TRUE } },
</a><a href="#h0-0-5" id="h0-0-5" class="d">-	{ MODKEY,               GDK_r,      reload,     { .b = FALSE } },
</a><a href="#h0-0-6" id="h0-0-6" class="d">-	{ MODKEY|GDK_SHIFT_MASK,GDK_p,      print,      { 0 } },
</a><a href="#h0-0-7" id="h0-0-7" class="d">-
</a><a href="#h0-0-8" id="h0-0-8" class="d">-	{ MODKEY,               GDK_p,      clipboard,  { .b = TRUE } },
</a><a href="#h0-0-9" id="h0-0-9" class="d">-	{ MODKEY,               GDK_y,      clipboard,  { .b = FALSE } },
</a><a href="#h0-0-10" id="h0-0-10" class="d">-
</a><a href="#h0-0-11" id="h0-0-11" class="d">-	{ MODKEY|GDK_SHIFT_MASK,GDK_j,      zoom,       { .i = -1 } },
</a><a href="#h0-0-12" id="h0-0-12" class="d">-	{ MODKEY|GDK_SHIFT_MASK,GDK_k,      zoom,       { .i = +1 } },
</a><a href="#h0-0-13" id="h0-0-13" class="d">-	{ MODKEY|GDK_SHIFT_MASK,GDK_q,      zoom,       { .i = 0  } },
</a><a href="#h0-0-14" id="h0-0-14" class="d">-	{ MODKEY,               GDK_minus,  zoom,       { .i = -1 } },
</a><a href="#h0-0-15" id="h0-0-15" class="d">-	{ MODKEY,               GDK_plus,   zoom,       { .i = +1 } },
</a><a href="#h0-0-16" id="h0-0-16" class="d">-
</a><a href="#h0-0-17" id="h0-0-17" class="d">-	{ MODKEY,               GDK_l,      navigate,   { .i = +1 } },
</a><a href="#h0-0-18" id="h0-0-18" class="d">-	{ MODKEY,               GDK_h,      navigate,   { .i = -1 } },
</a><a href="#h0-0-19" id="h0-0-19" class="d">-
</a><a href="#h0-0-20" id="h0-0-20" class="d">-	{ MODKEY,               GDK_j,      scroll_v,   { .i = +1 } },
</a><a href="#h0-0-21" id="h0-0-21" class="d">-	{ MODKEY,               GDK_k,      scroll_v,   { .i = -1 } },
</a><a href="#h0-0-22" id="h0-0-22" class="d">-	{ MODKEY,               GDK_b,      scroll_v,   { .i = -10000 } },
</a><a href="#h0-0-23" id="h0-0-23" class="d">-	{ MODKEY,               GDK_space,  scroll_v,   { .i = +10000 } },
</a><a href="#h0-0-24" id="h0-0-24" class="d">-	{ MODKEY,               GDK_i,      scroll_h,   { .i = +1 } },
</a><a href="#h0-0-25" id="h0-0-25" class="d">-	{ MODKEY,               GDK_u,      scroll_h,   { .i = -1 } },
</a><a href="#h0-0-26" id="h0-0-26" class="d">-
</a><a href="#h0-0-27" id="h0-0-27" class="d">-	{ 0,                    GDK_F11,    fullscreen, { 0 } },
</a><a href="#h0-0-28" id="h0-0-28" class="d">-	{ 0,                    GDK_Escape, stop,       { 0 } },
</a><a href="#h0-0-29" id="h0-0-29" class="d">-	{ MODKEY,               GDK_o,      source,     { 0 } },
</a><a href="#h0-0-30" id="h0-0-30" class="d">-	{ MODKEY|GDK_SHIFT_MASK,GDK_o,      inspector,  { 0 } },
</a><a href="#h0-0-31" id="h0-0-31" class="d">-
</a><a href="#h0-0-32" id="h0-0-32" class="d">-	{ MODKEY,               GDK_g,      spawn,      SETPROP(&quot;_SURF_URI&quot;, &quot;_SURF_GO&quot;) },
</a><a href="#h0-0-33" id="h0-0-33" class="d">-	{ MODKEY,               GDK_f,      spawn,      SETPROP(&quot;_SURF_FIND&quot;, &quot;_SURF_FIND&quot;) },
</a><a href="#h0-0-34" id="h0-0-34" class="d">-	{ MODKEY,               GDK_slash,  spawn,      SETPROP(&quot;_SURF_FIND&quot;, &quot;_SURF_FIND&quot;) },
</a><a href="#h0-0-35" id="h0-0-35" class="d">-
</a><a href="#h0-0-36" id="h0-0-36" class="d">-	{ MODKEY,               GDK_n,      find,       { .b = TRUE } },
</a><a href="#h0-0-37" id="h0-0-37" class="d">-	{ MODKEY|GDK_SHIFT_MASK,GDK_n,      find,       { .b = FALSE } },
</a><a href="#h0-0-38" id="h0-0-38" class="d">-
</a><a href="#h0-0-39" id="h0-0-39" class="d">-	{ MODKEY|GDK_SHIFT_MASK,GDK_c,      toggle,     { .v = &quot;enable-caret-browsing&quot; } },
</a><a href="#h0-0-40" id="h0-0-40" class="d">-	{ MODKEY|GDK_SHIFT_MASK,GDK_i,      toggle,     { .v = &quot;auto-load-images&quot; } },
</a><a href="#h0-0-41" id="h0-0-41" class="d">-	{ MODKEY|GDK_SHIFT_MASK,GDK_s,      toggle,     { .v = &quot;enable-scripts&quot; } },
</a><a href="#h0-0-42" id="h0-0-42" class="d">-	{ MODKEY|GDK_SHIFT_MASK,GDK_v,      toggle,     { .v = &quot;enable-plugins&quot; } },
</a><a href="#h0-0-43" id="h0-0-43" class="d">-	{ MODKEY|GDK_SHIFT_MASK,GDK_a,      togglecookiepolicy, { 0 } },
</a><a href="#h0-0-44" id="h0-0-44" class="d">-	{ MODKEY|GDK_SHIFT_MASK,GDK_m,      togglestyle, { 0 } },
</a><a href="#h0-0-45" id="h0-0-45" class="d">-	{ MODKEY|GDK_SHIFT_MASK,GDK_b,      togglescrollbars, { 0 } },
</a><a href="#h0-0-46" id="h0-0-46" class="d">-	{ MODKEY|GDK_SHIFT_MASK,GDK_g,      togglegeolocation, { 0 } },
</a><a href="#h0-0-47" id="h0-0-47" class="i">+	/* modifier	         keyval          function    arg */
</a><a href="#h0-0-48" id="h0-0-48" class="i">+	{ MODKEY|GDK_SHIFT_MASK, GDK_KEY_r,      reload,     { .b = TRUE } },
</a><a href="#h0-0-49" id="h0-0-49" class="i">+	{ MODKEY,                GDK_KEY_r,      reload,     { .b = FALSE } },
</a><a href="#h0-0-50" id="h0-0-50" class="i">+	{ MODKEY|GDK_SHIFT_MASK, GDK_KEY_p,      print,      { 0 } },
</a><a href="#h0-0-51" id="h0-0-51" class="i">+
</a><a href="#h0-0-52" id="h0-0-52" class="i">+	{ MODKEY,                GDK_KEY_p,      clipboard,  { .b = TRUE } },
</a><a href="#h0-0-53" id="h0-0-53" class="i">+	{ MODKEY,                GDK_KEY_y,      clipboard,  { .b = FALSE } },
</a><a href="#h0-0-54" id="h0-0-54" class="i">+
</a><a href="#h0-0-55" id="h0-0-55" class="i">+	{ MODKEY|GDK_SHIFT_MASK, GDK_KEY_j,      zoom,       { .i = -1 } },
</a><a href="#h0-0-56" id="h0-0-56" class="i">+	{ MODKEY|GDK_SHIFT_MASK, GDK_KEY_k,      zoom,       { .i = +1 } },
</a><a href="#h0-0-57" id="h0-0-57" class="i">+	{ MODKEY|GDK_SHIFT_MASK, GDK_KEY_q,      zoom,       { .i = 0  } },
</a><a href="#h0-0-58" id="h0-0-58" class="i">+	{ MODKEY,                GDK_KEY_minus,  zoom,       { .i = -1 } },
</a><a href="#h0-0-59" id="h0-0-59" class="i">+	{ MODKEY,                GDK_KEY_plus,   zoom,       { .i = +1 } },
</a><a href="#h0-0-60" id="h0-0-60" class="i">+
</a><a href="#h0-0-61" id="h0-0-61" class="i">+	{ MODKEY,                GDK_KEY_l,      navigate,   { .i = +1 } },
</a><a href="#h0-0-62" id="h0-0-62" class="i">+	{ MODKEY,                GDK_KEY_h,      navigate,   { .i = -1 } },
</a><a href="#h0-0-63" id="h0-0-63" class="i">+
</a><a href="#h0-0-64" id="h0-0-64" class="i">+	{ MODKEY,                GDK_KEY_j,      scroll_v,   { .i = +1 } },
</a><a href="#h0-0-65" id="h0-0-65" class="i">+	{ MODKEY,                GDK_KEY_k,      scroll_v,   { .i = -1 } },
</a><a href="#h0-0-66" id="h0-0-66" class="i">+	{ MODKEY,                GDK_KEY_b,      scroll_v,   { .i = -10000 } },
</a><a href="#h0-0-67" id="h0-0-67" class="i">+	{ MODKEY,                GDK_KEY_space,  scroll_v,   { .i = +10000 } },
</a><a href="#h0-0-68" id="h0-0-68" class="i">+	{ MODKEY,                GDK_KEY_i,      scroll_h,   { .i = +1 } },
</a><a href="#h0-0-69" id="h0-0-69" class="i">+	{ MODKEY,                GDK_KEY_u,      scroll_h,   { .i = -1 } },
</a><a href="#h0-0-70" id="h0-0-70" class="i">+
</a><a href="#h0-0-71" id="h0-0-71" class="i">+	{ 0,                     GDK_KEY_F11,    fullscreen, { 0 } },
</a><a href="#h0-0-72" id="h0-0-72" class="i">+	{ 0,                     GDK_KEY_Escape, stop,       { 0 } },
</a><a href="#h0-0-73" id="h0-0-73" class="i">+	{ MODKEY,                GDK_KEY_o,      source,     { 0 } },
</a><a href="#h0-0-74" id="h0-0-74" class="i">+	{ MODKEY|GDK_SHIFT_MASK, GDK_KEY_o,      inspector,  { 0 } },
</a><a href="#h0-0-75" id="h0-0-75" class="i">+
</a><a href="#h0-0-76" id="h0-0-76" class="i">+	{ MODKEY,                GDK_KEY_g,      spawn,      SETPROP(&quot;_SURF_URI&quot;, &quot;_SURF_GO&quot;) },
</a><a href="#h0-0-77" id="h0-0-77" class="i">+	{ MODKEY,                GDK_KEY_f,      spawn,      SETPROP(&quot;_SURF_FIND&quot;, &quot;_SURF_FIND&quot;) },
</a><a href="#h0-0-78" id="h0-0-78" class="i">+	{ MODKEY,                GDK_KEY_slash,  spawn,      SETPROP(&quot;_SURF_FIND&quot;, &quot;_SURF_FIND&quot;) },
</a><a href="#h0-0-79" id="h0-0-79" class="i">+
</a><a href="#h0-0-80" id="h0-0-80" class="i">+	{ MODKEY,                GDK_KEY_n,      find,       { .b = TRUE } },
</a><a href="#h0-0-81" id="h0-0-81" class="i">+	{ MODKEY|GDK_SHIFT_MASK, GDK_KEY_n,      find,       { .b = FALSE } },
</a><a href="#h0-0-82" id="h0-0-82" class="i">+
</a><a href="#h0-0-83" id="h0-0-83" class="i">+	{ MODKEY|GDK_SHIFT_MASK, GDK_KEY_c,      toggle,     { .v = &quot;enable-caret-browsing&quot; } },
</a><a href="#h0-0-84" id="h0-0-84" class="i">+	{ MODKEY|GDK_SHIFT_MASK, GDK_KEY_i,      toggle,     { .v = &quot;auto-load-images&quot; } },
</a><a href="#h0-0-85" id="h0-0-85" class="i">+	{ MODKEY|GDK_SHIFT_MASK, GDK_KEY_s,      toggle,     { .v = &quot;enable-scripts&quot; } },
</a><a href="#h0-0-86" id="h0-0-86" class="i">+	{ MODKEY|GDK_SHIFT_MASK, GDK_KEY_v,      toggle,     { .v = &quot;enable-plugins&quot; } },
</a><a href="#h0-0-87" id="h0-0-87" class="i">+	{ MODKEY|GDK_SHIFT_MASK, GDK_KEY_a,      togglecookiepolicy, { 0 } },
</a><a href="#h0-0-88" id="h0-0-88" class="i">+	{ MODKEY|GDK_SHIFT_MASK, GDK_KEY_m,      togglestyle, { 0 } },
</a><a href="#h0-0-89" id="h0-0-89" class="i">+	{ MODKEY|GDK_SHIFT_MASK, GDK_KEY_b,      togglescrollbars, { 0 } },
</a><a href="#h0-0-90" id="h0-0-90" class="i">+	{ MODKEY|GDK_SHIFT_MASK, GDK_KEY_g,      togglegeolocation, { 0 } },
</a> };
 
 /* button definitions */
<b>diff --git a/<a id="h1" href="../file/config.mk.html">config.mk</a> b/<a href="../file/config.mk.html">config.mk</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -10,8 +10,8 @@ MANPREFIX = ${PREFIX}/share/man
</a> X11INC = /usr/X11R6/include
 X11LIB = /usr/X11R6/lib
 
<a href="#h1-0-3" id="h1-0-3" class="d">-GTKINC = `pkg-config --cflags gtk+-2.0 webkit-1.0`
</a><a href="#h1-0-4" id="h1-0-4" class="d">-GTKLIB = `pkg-config --libs gtk+-2.0 webkit-1.0`
</a><a href="#h1-0-5" id="h1-0-5" class="i">+GTKINC = `pkg-config --cflags gtk+-3.0 webkitgtk-3.0`
</a><a href="#h1-0-6" id="h1-0-6" class="i">+GTKLIB = `pkg-config --libs gtk+-3.0 webkitgtk-3.0`
</a> 
 # includes and libs
 INCS = -I. -I/usr/include -I${X11INC} ${GTKINC}
<b>diff --git a/<a id="h2" href="../file/surf.c.html">surf.c</a> b/<a href="../file/surf.c.html">surf.c</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -5,6 +5,7 @@
</a> #include &lt;signal.h&gt;
 #include &lt;X11/X.h&gt;
 #include &lt;X11/Xatom.h&gt;
<a href="#h2-0-3" id="h2-0-3" class="i">+#include &lt;gtk/gtkx.h&gt;
</a> #include &lt;gtk/gtk.h&gt;
 #include &lt;gdk/gdkx.h&gt;
 #include &lt;gdk/gdk.h&gt;
<a href="#h2-1" id="h2-1" class="h">@@ -55,6 +56,7 @@ union Arg {
</a> 
 typedef struct Client {
 	GtkWidget *win, *scroll, *vbox, *pane;
<a href="#h2-1-3" id="h2-1-3" class="i">+	Window xid;
</a> 	WebKitWebView *view;
 	WebKitWebInspector *inspector;
 	char *title, *linkhover;
<a href="#h2-2" id="h2-2" class="h">@@ -99,7 +101,7 @@ typedef struct {
</a> static Display *dpy;
 static Atom atoms[AtomLast];
 static Client *clients = NULL;
<a href="#h2-2-3" id="h2-2-3" class="d">-static GdkNativeWindow embed = 0;
</a><a href="#h2-2-4" id="h2-2-4" class="i">+static Window embed = 0;
</a> static gboolean showxid = FALSE;
 static char winid[64];
 static gboolean usingproxy = 0;
<a href="#h2-3" id="h2-3" class="h">@@ -625,9 +627,9 @@ getatom(Client *c, int a)
</a> 	unsigned long ldummy;
 	unsigned char *p = NULL;
 
<a href="#h2-3-3" id="h2-3-3" class="d">-	XGetWindowProperty(dpy, GDK_WINDOW_XID(GTK_WIDGET(c-&gt;win)-&gt;window),
</a><a href="#h2-3-4" id="h2-3-4" class="d">-	                   atoms[a], 0L, BUFSIZ, False, XA_STRING,
</a><a href="#h2-3-5" id="h2-3-5" class="d">-	                   &amp;adummy, &amp;idummy, &amp;ldummy, &amp;ldummy, &amp;p);
</a><a href="#h2-3-6" id="h2-3-6" class="i">+	XGetWindowProperty(dpy, c-&gt;xid,
</a><a href="#h2-3-7" id="h2-3-7" class="i">+			   atoms[a], 0L, BUFSIZ, False, XA_STRING,
</a><a href="#h2-3-8" id="h2-3-8" class="i">+			   &amp;adummy, &amp;idummy, &amp;ldummy, &amp;ldummy, &amp;p);
</a> 	if (p)
 		strncpy(buf, (char *)p, LENGTH(buf)-1);
 	else
<a href="#h2-4" id="h2-4" class="h">@@ -870,6 +872,7 @@ newclient(void)
</a> 	WebKitWebFrame *frame;
 	GdkGeometry hints = { 1, 1 };
 	GdkScreen *screen;
<a href="#h2-4-3" id="h2-4-3" class="i">+	GdkWindow *gwin;
</a> 	gdouble dpi;
 	char *ua;
 
<a href="#h2-5" id="h2-5" class="h">@@ -911,10 +914,10 @@ newclient(void)
</a> 		addaccelgroup(c);
 
 	/* Pane */
<a href="#h2-5-3" id="h2-5-3" class="d">-	c-&gt;pane = gtk_vpaned_new();
</a><a href="#h2-5-4" id="h2-5-4" class="i">+	c-&gt;pane = gtk_paned_new(GTK_ORIENTATION_VERTICAL);
</a> 
 	/* VBox */
<a href="#h2-5-7" id="h2-5-7" class="d">-	c-&gt;vbox = gtk_vbox_new(FALSE, 0);
</a><a href="#h2-5-8" id="h2-5-8" class="i">+	c-&gt;vbox = gtk_box_new(GTK_ORIENTATION_VERTICAL, 0);
</a> 	gtk_paned_pack1(GTK_PANED(c-&gt;pane), c-&gt;vbox, TRUE, TRUE);
 
 	/* Webview */
<a href="#h2-6" id="h2-6" class="h">@@ -994,10 +997,12 @@ newclient(void)
</a> 	gtk_widget_show(c-&gt;scroll);
 	gtk_widget_show(GTK_WIDGET(c-&gt;view));
 	gtk_widget_show(c-&gt;win);
<a href="#h2-6-3" id="h2-6-3" class="i">+	gwin = gtk_widget_get_window(GTK_WIDGET(c-&gt;win));
</a><a href="#h2-6-4" id="h2-6-4" class="i">+	c-&gt;xid = gdk_x11_window_get_xid(gwin);
</a> 	gtk_window_set_geometry_hints(GTK_WINDOW(c-&gt;win), NULL, &amp;hints,
<a href="#h2-6-6" id="h2-6-6" class="d">-	                              GDK_HINT_MIN_SIZE);
</a><a href="#h2-6-7" id="h2-6-7" class="d">-	gdk_window_set_events(GTK_WIDGET(c-&gt;win)-&gt;window, GDK_ALL_EVENTS_MASK);
</a><a href="#h2-6-8" id="h2-6-8" class="d">-	gdk_window_add_filter(GTK_WIDGET(c-&gt;win)-&gt;window, processx, c);
</a><a href="#h2-6-9" id="h2-6-9" class="i">+				      GDK_HINT_MIN_SIZE);
</a><a href="#h2-6-10" id="h2-6-10" class="i">+	gdk_window_set_events(gwin, GDK_ALL_EVENTS_MASK);
</a><a href="#h2-6-11" id="h2-6-11" class="i">+	gdk_window_add_filter(gwin, processx, c);
</a> 	webkit_web_view_set_full_content_zoom(c-&gt;view, TRUE);
 
 	runscript(frame);
<a href="#h2-7" id="h2-7" class="h">@@ -1031,7 +1036,7 @@ newclient(void)
</a> 	 * It is equivalent to firefox&#39;s &quot;layout.css.devPixelsPerPx&quot; setting.
 	 */
 	if (zoomto96dpi) {
<a href="#h2-7-3" id="h2-7-3" class="d">-		screen = gdk_window_get_screen(GTK_WIDGET(c-&gt;win)-&gt;window);
</a><a href="#h2-7-4" id="h2-7-4" class="i">+		screen = gdk_window_get_screen(gwin);
</a> 		dpi = gdk_screen_get_resolution(screen);
 		if (dpi != -1) {
 			g_object_set(G_OBJECT(settings),
<a href="#h2-8" id="h2-8" class="h">@@ -1069,8 +1074,7 @@ newclient(void)
</a> 
 	if (showxid) {
 		gdk_display_sync(gtk_widget_get_display(c-&gt;win));
<a href="#h2-8-3" id="h2-8-3" class="d">-		printf(&quot;%u\n&quot;,
</a><a href="#h2-8-4" id="h2-8-4" class="d">-		       (guint)GDK_WINDOW_XID(GTK_WIDGET(c-&gt;win)-&gt;window));
</a><a href="#h2-8-5" id="h2-8-5" class="i">+		printf(&quot;%lu\n&quot;, c-&gt;xid);
</a> 		fflush(NULL);
                 if (fclose(stdout) != 0) {
 			die(&quot;Error closing stdout&quot;);
<a href="#h2-9" id="h2-9" class="h">@@ -1150,15 +1154,13 @@ menuactivate(GtkMenuItem *item, Client *c)
</a> 	 * context-menu-action-12   stop
 	 */
 
<a href="#h2-9-3" id="h2-9-3" class="d">-	GtkAction *a = NULL;
</a><a href="#h2-9-4" id="h2-9-4" class="d">-	const char *name, *uri;
</a><a href="#h2-9-5" id="h2-9-5" class="i">+	const gchar *name, *uri;
</a> 	GtkClipboard *prisel, *clpbrd;
 
<a href="#h2-9-8" id="h2-9-8" class="d">-	a = gtk_activatable_get_related_action(GTK_ACTIVATABLE(item));
</a><a href="#h2-9-9" id="h2-9-9" class="d">-	if (a == NULL)
</a><a href="#h2-9-10" id="h2-9-10" class="i">+	name = gtk_actionable_get_action_name(GTK_ACTIONABLE(item));
</a><a href="#h2-9-11" id="h2-9-11" class="i">+	if (name == NULL)
</a> 		return;
 
<a href="#h2-9-14" id="h2-9-14" class="d">-	name = gtk_action_get_name(a);
</a> 	if (!g_strcmp0(name, &quot;context-menu-action-3&quot;)) {
 		prisel = gtk_clipboard_get(GDK_SELECTION_PRIMARY);
 		gtk_clipboard_set_text(prisel, c-&gt;linkhover, -1);
<a href="#h2-10" id="h2-10" class="h">@@ -1281,9 +1283,9 @@ void
</a> setatom(Client *c, int a, const char *v)
 {
 	XSync(dpy, False);
<a href="#h2-10-3" id="h2-10-3" class="d">-	XChangeProperty(dpy, GDK_WINDOW_XID(GTK_WIDGET(c-&gt;win)-&gt;window),
</a><a href="#h2-10-4" id="h2-10-4" class="d">-	                atoms[a], XA_STRING, 8, PropModeReplace,
</a><a href="#h2-10-5" id="h2-10-5" class="d">-	                (unsigned char *)v, strlen(v) + 1);
</a><a href="#h2-10-6" id="h2-10-6" class="i">+	XChangeProperty(dpy, c-&gt;xid,
</a><a href="#h2-10-7" id="h2-10-7" class="i">+			atoms[a], XA_STRING, 8, PropModeReplace,
</a><a href="#h2-10-8" id="h2-10-8" class="i">+			(unsigned char *)v, strlen(v) + 1);
</a> }
 
 void
<a href="#h2-11" id="h2-11" class="h">@@ -1300,7 +1302,7 @@ setup(void)
</a> 	sigchld(0);
 	gtk_init(NULL, NULL);
 
<a href="#h2-11-3" id="h2-11-3" class="d">-	dpy = GDK_DISPLAY();
</a><a href="#h2-11-4" id="h2-11-4" class="i">+	dpy = GDK_DISPLAY_XDISPLAY(gdk_display_get_default());
</a> 
 	/* atoms */
 	atoms[AtomFind] = XInternAtom(dpy, &quot;_SURF_FIND&quot;, False);
<a href="#h2-12" id="h2-12" class="h">@@ -1618,8 +1620,7 @@ updatetitle(Client *c)
</a> void
 updatewinid(Client *c)
 {
<a href="#h2-12-3" id="h2-12-3" class="d">-	snprintf(winid, LENGTH(winid), &quot;%u&quot;,
</a><a href="#h2-12-4" id="h2-12-4" class="d">-	         (int)GDK_WINDOW_XID(GTK_WIDGET(c-&gt;win)-&gt;window));
</a><a href="#h2-12-5" id="h2-12-5" class="i">+	snprintf(winid, LENGTH(winid), &quot;%lu&quot;, c-&gt;xid);
</a> }
 
 void
</pre>
</div>
</body>
</html>
